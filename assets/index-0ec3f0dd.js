function Lw(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var Uq=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function po(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Mw={exports:{}},ff={},kw={exports:{}},be={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tl=Symbol.for("react.element"),nR=Symbol.for("react.portal"),rR=Symbol.for("react.fragment"),iR=Symbol.for("react.strict_mode"),sR=Symbol.for("react.profiler"),oR=Symbol.for("react.provider"),aR=Symbol.for("react.context"),lR=Symbol.for("react.forward_ref"),cR=Symbol.for("react.suspense"),uR=Symbol.for("react.memo"),fR=Symbol.for("react.lazy"),Pv=Symbol.iterator;function dR(t){return t===null||typeof t!="object"?null:(t=Pv&&t[Pv]||t["@@iterator"],typeof t=="function"?t:null)}var Iw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ow=Object.assign,Nw={};function go(t,e,n){this.props=t,this.context=e,this.refs=Nw,this.updater=n||Iw}go.prototype.isReactComponent={};go.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};go.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Dw(){}Dw.prototype=go.prototype;function im(t,e,n){this.props=t,this.context=e,this.refs=Nw,this.updater=n||Iw}var sm=im.prototype=new Dw;sm.constructor=im;Ow(sm,go.prototype);sm.isPureReactComponent=!0;var Rv=Array.isArray,Fw=Object.prototype.hasOwnProperty,om={current:null},Uw={key:!0,ref:!0,__self:!0,__source:!0};function Bw(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)Fw.call(e,r)&&!Uw.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:tl,type:t,key:s,ref:o,props:i,_owner:om.current}}function hR(t,e){return{$$typeof:tl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function am(t){return typeof t=="object"&&t!==null&&t.$$typeof===tl}function pR(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Lv=/\/+/g;function Td(t,e){return typeof t=="object"&&t!==null&&t.key!=null?pR(""+t.key):e.toString(36)}function Oc(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case tl:case nR:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Td(o,0):r,Rv(i)?(n="",t!=null&&(n=t.replace(Lv,"$&/")+"/"),Oc(i,e,n,"",function(c){return c})):i!=null&&(am(i)&&(i=hR(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Lv,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",Rv(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+Td(s,a);o+=Oc(s,e,n,l,i)}else if(l=dR(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+Td(s,a++),o+=Oc(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Vl(t,e,n){if(t==null)return t;var r=[],i=0;return Oc(t,r,"","",function(s){return e.call(n,s,i++)}),r}function gR(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Lt={current:null},Nc={transition:null},mR={ReactCurrentDispatcher:Lt,ReactCurrentBatchConfig:Nc,ReactCurrentOwner:om};function zw(){throw Error("act(...) is not supported in production builds of React.")}be.Children={map:Vl,forEach:function(t,e,n){Vl(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Vl(t,function(){e++}),e},toArray:function(t){return Vl(t,function(e){return e})||[]},only:function(t){if(!am(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};be.Component=go;be.Fragment=rR;be.Profiler=sR;be.PureComponent=im;be.StrictMode=iR;be.Suspense=cR;be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mR;be.act=zw;be.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Ow({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=om.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)Fw.call(e,l)&&!Uw.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:tl,type:t.type,key:i,ref:s,props:r,_owner:o}};be.createContext=function(t){return t={$$typeof:aR,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:oR,_context:t},t.Consumer=t};be.createElement=Bw;be.createFactory=function(t){var e=Bw.bind(null,t);return e.type=t,e};be.createRef=function(){return{current:null}};be.forwardRef=function(t){return{$$typeof:lR,render:t}};be.isValidElement=am;be.lazy=function(t){return{$$typeof:fR,_payload:{_status:-1,_result:t},_init:gR}};be.memo=function(t,e){return{$$typeof:uR,type:t,compare:e===void 0?null:e}};be.startTransition=function(t){var e=Nc.transition;Nc.transition={};try{t()}finally{Nc.transition=e}};be.unstable_act=zw;be.useCallback=function(t,e){return Lt.current.useCallback(t,e)};be.useContext=function(t){return Lt.current.useContext(t)};be.useDebugValue=function(){};be.useDeferredValue=function(t){return Lt.current.useDeferredValue(t)};be.useEffect=function(t,e){return Lt.current.useEffect(t,e)};be.useId=function(){return Lt.current.useId()};be.useImperativeHandle=function(t,e,n){return Lt.current.useImperativeHandle(t,e,n)};be.useInsertionEffect=function(t,e){return Lt.current.useInsertionEffect(t,e)};be.useLayoutEffect=function(t,e){return Lt.current.useLayoutEffect(t,e)};be.useMemo=function(t,e){return Lt.current.useMemo(t,e)};be.useReducer=function(t,e,n){return Lt.current.useReducer(t,e,n)};be.useRef=function(t){return Lt.current.useRef(t)};be.useState=function(t){return Lt.current.useState(t)};be.useSyncExternalStore=function(t,e,n){return Lt.current.useSyncExternalStore(t,e,n)};be.useTransition=function(){return Lt.current.useTransition()};be.version="18.3.1";kw.exports=be;var S=kw.exports;const ve=po(S),vR=Lw({__proto__:null,default:ve},[S]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yR=S,_R=Symbol.for("react.element"),ER=Symbol.for("react.fragment"),wR=Object.prototype.hasOwnProperty,bR=yR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xR={key:!0,ref:!0,__self:!0,__source:!0};function jw(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)wR.call(e,r)&&!xR.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:_R,type:t,key:s,ref:o,props:i,_owner:bR.current}}ff.Fragment=ER;ff.jsx=jw;ff.jsxs=jw;Mw.exports=ff;var C=Mw.exports,rp={},Vw={exports:{}},rn={},$w={exports:{}},Gw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(z,ne){var Y=z.length;z.push(ne);e:for(;0<Y;){var re=Y-1>>>1,M=z[re];if(0<i(M,ne))z[re]=ne,z[Y]=M,Y=re;else break e}}function n(z){return z.length===0?null:z[0]}function r(z){if(z.length===0)return null;var ne=z[0],Y=z.pop();if(Y!==ne){z[0]=Y;e:for(var re=0,M=z.length,V=M>>>1;re<V;){var U=2*(re+1)-1,oe=z[U],Q=U+1,ie=z[Q];if(0>i(oe,Y))Q<M&&0>i(ie,oe)?(z[re]=ie,z[Q]=Y,re=Q):(z[re]=oe,z[U]=Y,re=U);else if(Q<M&&0>i(ie,Y))z[re]=ie,z[Q]=Y,re=Q;else break e}}return ne}function i(z,ne){var Y=z.sortIndex-ne.sortIndex;return Y!==0?Y:z.id-ne.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,d=null,f=3,h=!1,p=!1,m=!1,E=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(z){for(var ne=n(c);ne!==null;){if(ne.callback===null)r(c);else if(ne.startTime<=z)r(c),ne.sortIndex=ne.expirationTime,e(l,ne);else break;ne=n(c)}}function b(z){if(m=!1,y(z),!p)if(n(l)!==null)p=!0,de(T);else{var ne=n(c);ne!==null&&Pe(b,ne.startTime-z)}}function T(z,ne){p=!1,m&&(m=!1,v(I),I=-1),h=!0;var Y=f;try{for(y(ne),d=n(l);d!==null&&(!(d.expirationTime>ne)||z&&!F());){var re=d.callback;if(typeof re=="function"){d.callback=null,f=d.priorityLevel;var M=re(d.expirationTime<=ne);ne=t.unstable_now(),typeof M=="function"?d.callback=M:d===n(l)&&r(l),y(ne)}else r(l);d=n(l)}if(d!==null)var V=!0;else{var U=n(c);U!==null&&Pe(b,U.startTime-ne),V=!1}return V}finally{d=null,f=Y,h=!1}}var A=!1,R=null,I=-1,D=5,N=-1;function F(){return!(t.unstable_now()-N<D)}function q(){if(R!==null){var z=t.unstable_now();N=z;var ne=!0;try{ne=R(!0,z)}finally{ne?G():(A=!1,R=null)}}else A=!1}var G;if(typeof g=="function")G=function(){g(q)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,xe=W.port2;W.port1.onmessage=q,G=function(){xe.postMessage(null)}}else G=function(){E(q,0)};function de(z){R=z,A||(A=!0,G())}function Pe(z,ne){I=E(function(){z(t.unstable_now())},ne)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(z){z.callback=null},t.unstable_continueExecution=function(){p||h||(p=!0,de(T))},t.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<z?Math.floor(1e3/z):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(z){switch(f){case 1:case 2:case 3:var ne=3;break;default:ne=f}var Y=f;f=ne;try{return z()}finally{f=Y}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(z,ne){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var Y=f;f=z;try{return ne()}finally{f=Y}},t.unstable_scheduleCallback=function(z,ne,Y){var re=t.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?re+Y:re):Y=re,z){case 1:var M=-1;break;case 2:M=250;break;case 5:M=1073741823;break;case 4:M=1e4;break;default:M=5e3}return M=Y+M,z={id:u++,callback:ne,priorityLevel:z,startTime:Y,expirationTime:M,sortIndex:-1},Y>re?(z.sortIndex=Y,e(c,z),n(l)===null&&z===n(c)&&(m?(v(I),I=-1):m=!0,Pe(b,Y-re))):(z.sortIndex=M,e(l,z),p||h||(p=!0,de(T))),z},t.unstable_shouldYield=F,t.unstable_wrapCallback=function(z){var ne=f;return function(){var Y=f;f=ne;try{return z.apply(this,arguments)}finally{f=Y}}}})(Gw);$w.exports=Gw;var SR=$w.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TR=S,tn=SR;function $(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ww=new Set,Sa={};function Wi(t,e){$s(t,e),$s(t+"Capture",e)}function $s(t,e){for(Sa[t]=e,t=0;t<e.length;t++)Ww.add(e[t])}var ur=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ip=Object.prototype.hasOwnProperty,AR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Mv={},kv={};function CR(t){return ip.call(kv,t)?!0:ip.call(Mv,t)?!1:AR.test(t)?kv[t]=!0:(Mv[t]=!0,!1)}function PR(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function RR(t,e,n,r){if(e===null||typeof e>"u"||PR(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Mt(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var mt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){mt[t]=new Mt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];mt[e]=new Mt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){mt[t]=new Mt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){mt[t]=new Mt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){mt[t]=new Mt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){mt[t]=new Mt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){mt[t]=new Mt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){mt[t]=new Mt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){mt[t]=new Mt(t,5,!1,t.toLowerCase(),null,!1,!1)});var lm=/[\-:]([a-z])/g;function cm(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(lm,cm);mt[e]=new Mt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(lm,cm);mt[e]=new Mt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(lm,cm);mt[e]=new Mt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){mt[t]=new Mt(t,1,!1,t.toLowerCase(),null,!1,!1)});mt.xlinkHref=new Mt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){mt[t]=new Mt(t,1,!1,t.toLowerCase(),null,!0,!0)});function um(t,e,n,r){var i=mt.hasOwnProperty(e)?mt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(RR(e,n,i,r)&&(n=null),r||i===null?CR(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var _r=TR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,$l=Symbol.for("react.element"),gs=Symbol.for("react.portal"),ms=Symbol.for("react.fragment"),fm=Symbol.for("react.strict_mode"),sp=Symbol.for("react.profiler"),Hw=Symbol.for("react.provider"),Yw=Symbol.for("react.context"),dm=Symbol.for("react.forward_ref"),op=Symbol.for("react.suspense"),ap=Symbol.for("react.suspense_list"),hm=Symbol.for("react.memo"),Nr=Symbol.for("react.lazy"),Xw=Symbol.for("react.offscreen"),Iv=Symbol.iterator;function Lo(t){return t===null||typeof t!="object"?null:(t=Iv&&t[Iv]||t["@@iterator"],typeof t=="function"?t:null)}var Ke=Object.assign,Ad;function Qo(t){if(Ad===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Ad=e&&e[1]||""}return`
`+Ad+t}var Cd=!1;function Pd(t,e){if(!t||Cd)return"";Cd=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Cd=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Qo(t):""}function LR(t){switch(t.tag){case 5:return Qo(t.type);case 16:return Qo("Lazy");case 13:return Qo("Suspense");case 19:return Qo("SuspenseList");case 0:case 2:case 15:return t=Pd(t.type,!1),t;case 11:return t=Pd(t.type.render,!1),t;case 1:return t=Pd(t.type,!0),t;default:return""}}function lp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ms:return"Fragment";case gs:return"Portal";case sp:return"Profiler";case fm:return"StrictMode";case op:return"Suspense";case ap:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Yw:return(t.displayName||"Context")+".Consumer";case Hw:return(t._context.displayName||"Context")+".Provider";case dm:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case hm:return e=t.displayName||null,e!==null?e:lp(t.type)||"Memo";case Nr:e=t._payload,t=t._init;try{return lp(t(e))}catch{}}return null}function MR(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return lp(e);case 8:return e===fm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ri(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Kw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function kR(t){var e=Kw(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Gl(t){t._valueTracker||(t._valueTracker=kR(t))}function qw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Kw(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function au(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function cp(t,e){var n=e.checked;return Ke({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Ov(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=ri(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Zw(t,e){e=e.checked,e!=null&&um(t,"checked",e,!1)}function up(t,e){Zw(t,e);var n=ri(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?fp(t,e.type,n):e.hasOwnProperty("defaultValue")&&fp(t,e.type,ri(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Nv(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function fp(t,e,n){(e!=="number"||au(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Jo=Array.isArray;function Ms(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+ri(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function dp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error($(91));return Ke({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Dv(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error($(92));if(Jo(n)){if(1<n.length)throw Error($(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ri(n)}}function Qw(t,e){var n=ri(e.value),r=ri(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Fv(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Jw(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function hp(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Jw(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Wl,eb=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Wl=Wl||document.createElement("div"),Wl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Wl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ta(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var la={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},IR=["Webkit","ms","Moz","O"];Object.keys(la).forEach(function(t){IR.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),la[e]=la[t]})});function tb(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||la.hasOwnProperty(t)&&la[t]?(""+e).trim():e+"px"}function nb(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=tb(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var OR=Ke({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function pp(t,e){if(e){if(OR[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error($(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error($(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error($(61))}if(e.style!=null&&typeof e.style!="object")throw Error($(62))}}function gp(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var mp=null;function pm(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var vp=null,ks=null,Is=null;function Uv(t){if(t=il(t)){if(typeof vp!="function")throw Error($(280));var e=t.stateNode;e&&(e=mf(e),vp(t.stateNode,t.type,e))}}function rb(t){ks?Is?Is.push(t):Is=[t]:ks=t}function ib(){if(ks){var t=ks,e=Is;if(Is=ks=null,Uv(t),e)for(t=0;t<e.length;t++)Uv(e[t])}}function sb(t,e){return t(e)}function ob(){}var Rd=!1;function ab(t,e,n){if(Rd)return t(e,n);Rd=!0;try{return sb(t,e,n)}finally{Rd=!1,(ks!==null||Is!==null)&&(ob(),ib())}}function Aa(t,e){var n=t.stateNode;if(n===null)return null;var r=mf(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error($(231,e,typeof n));return n}var yp=!1;if(ur)try{var Mo={};Object.defineProperty(Mo,"passive",{get:function(){yp=!0}}),window.addEventListener("test",Mo,Mo),window.removeEventListener("test",Mo,Mo)}catch{yp=!1}function NR(t,e,n,r,i,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var ca=!1,lu=null,cu=!1,_p=null,DR={onError:function(t){ca=!0,lu=t}};function FR(t,e,n,r,i,s,o,a,l){ca=!1,lu=null,NR.apply(DR,arguments)}function UR(t,e,n,r,i,s,o,a,l){if(FR.apply(this,arguments),ca){if(ca){var c=lu;ca=!1,lu=null}else throw Error($(198));cu||(cu=!0,_p=c)}}function Hi(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function lb(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Bv(t){if(Hi(t)!==t)throw Error($(188))}function BR(t){var e=t.alternate;if(!e){if(e=Hi(t),e===null)throw Error($(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Bv(i),t;if(s===r)return Bv(i),e;s=s.sibling}throw Error($(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error($(189))}}if(n.alternate!==r)throw Error($(190))}if(n.tag!==3)throw Error($(188));return n.stateNode.current===n?t:e}function cb(t){return t=BR(t),t!==null?ub(t):null}function ub(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=ub(t);if(e!==null)return e;t=t.sibling}return null}var fb=tn.unstable_scheduleCallback,zv=tn.unstable_cancelCallback,zR=tn.unstable_shouldYield,jR=tn.unstable_requestPaint,tt=tn.unstable_now,VR=tn.unstable_getCurrentPriorityLevel,gm=tn.unstable_ImmediatePriority,db=tn.unstable_UserBlockingPriority,uu=tn.unstable_NormalPriority,$R=tn.unstable_LowPriority,hb=tn.unstable_IdlePriority,df=null,jn=null;function GR(t){if(jn&&typeof jn.onCommitFiberRoot=="function")try{jn.onCommitFiberRoot(df,t,void 0,(t.current.flags&128)===128)}catch{}}var An=Math.clz32?Math.clz32:YR,WR=Math.log,HR=Math.LN2;function YR(t){return t>>>=0,t===0?32:31-(WR(t)/HR|0)|0}var Hl=64,Yl=4194304;function ea(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function fu(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=ea(a):(s&=o,s!==0&&(r=ea(s)))}else o=n&~i,o!==0?r=ea(o):s!==0&&(r=ea(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-An(e),i=1<<n,r|=t[n],e&=~i;return r}function XR(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function KR(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-An(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=XR(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function Ep(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function pb(){var t=Hl;return Hl<<=1,!(Hl&4194240)&&(Hl=64),t}function Ld(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function nl(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-An(e),t[e]=n}function qR(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-An(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function mm(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-An(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Re=0;function gb(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var mb,vm,vb,yb,_b,wp=!1,Xl=[],Yr=null,Xr=null,Kr=null,Ca=new Map,Pa=new Map,Br=[],ZR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function jv(t,e){switch(t){case"focusin":case"focusout":Yr=null;break;case"dragenter":case"dragleave":Xr=null;break;case"mouseover":case"mouseout":Kr=null;break;case"pointerover":case"pointerout":Ca.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pa.delete(e.pointerId)}}function ko(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=il(e),e!==null&&vm(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function QR(t,e,n,r,i){switch(e){case"focusin":return Yr=ko(Yr,t,e,n,r,i),!0;case"dragenter":return Xr=ko(Xr,t,e,n,r,i),!0;case"mouseover":return Kr=ko(Kr,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Ca.set(s,ko(Ca.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Pa.set(s,ko(Pa.get(s)||null,t,e,n,r,i)),!0}return!1}function Eb(t){var e=Ti(t.target);if(e!==null){var n=Hi(e);if(n!==null){if(e=n.tag,e===13){if(e=lb(n),e!==null){t.blockedOn=e,_b(t.priority,function(){vb(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Dc(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=bp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);mp=r,n.target.dispatchEvent(r),mp=null}else return e=il(n),e!==null&&vm(e),t.blockedOn=n,!1;e.shift()}return!0}function Vv(t,e,n){Dc(t)&&n.delete(e)}function JR(){wp=!1,Yr!==null&&Dc(Yr)&&(Yr=null),Xr!==null&&Dc(Xr)&&(Xr=null),Kr!==null&&Dc(Kr)&&(Kr=null),Ca.forEach(Vv),Pa.forEach(Vv)}function Io(t,e){t.blockedOn===e&&(t.blockedOn=null,wp||(wp=!0,tn.unstable_scheduleCallback(tn.unstable_NormalPriority,JR)))}function Ra(t){function e(i){return Io(i,t)}if(0<Xl.length){Io(Xl[0],t);for(var n=1;n<Xl.length;n++){var r=Xl[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Yr!==null&&Io(Yr,t),Xr!==null&&Io(Xr,t),Kr!==null&&Io(Kr,t),Ca.forEach(e),Pa.forEach(e),n=0;n<Br.length;n++)r=Br[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Br.length&&(n=Br[0],n.blockedOn===null);)Eb(n),n.blockedOn===null&&Br.shift()}var Os=_r.ReactCurrentBatchConfig,du=!0;function eL(t,e,n,r){var i=Re,s=Os.transition;Os.transition=null;try{Re=1,ym(t,e,n,r)}finally{Re=i,Os.transition=s}}function tL(t,e,n,r){var i=Re,s=Os.transition;Os.transition=null;try{Re=4,ym(t,e,n,r)}finally{Re=i,Os.transition=s}}function ym(t,e,n,r){if(du){var i=bp(t,e,n,r);if(i===null)zd(t,e,r,hu,n),jv(t,r);else if(QR(i,t,e,n,r))r.stopPropagation();else if(jv(t,r),e&4&&-1<ZR.indexOf(t)){for(;i!==null;){var s=il(i);if(s!==null&&mb(s),s=bp(t,e,n,r),s===null&&zd(t,e,r,hu,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else zd(t,e,r,null,n)}}var hu=null;function bp(t,e,n,r){if(hu=null,t=pm(r),t=Ti(t),t!==null)if(e=Hi(t),e===null)t=null;else if(n=e.tag,n===13){if(t=lb(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return hu=t,null}function wb(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(VR()){case gm:return 1;case db:return 4;case uu:case $R:return 16;case hb:return 536870912;default:return 16}default:return 16}}var jr=null,_m=null,Fc=null;function bb(){if(Fc)return Fc;var t,e=_m,n=e.length,r,i="value"in jr?jr.value:jr.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return Fc=i.slice(t,1<r?1-r:void 0)}function Uc(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Kl(){return!0}function $v(){return!1}function sn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Kl:$v,this.isPropagationStopped=$v,this}return Ke(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Kl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Kl)},persist:function(){},isPersistent:Kl}),e}var mo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Em=sn(mo),rl=Ke({},mo,{view:0,detail:0}),nL=sn(rl),Md,kd,Oo,hf=Ke({},rl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:wm,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Oo&&(Oo&&t.type==="mousemove"?(Md=t.screenX-Oo.screenX,kd=t.screenY-Oo.screenY):kd=Md=0,Oo=t),Md)},movementY:function(t){return"movementY"in t?t.movementY:kd}}),Gv=sn(hf),rL=Ke({},hf,{dataTransfer:0}),iL=sn(rL),sL=Ke({},rl,{relatedTarget:0}),Id=sn(sL),oL=Ke({},mo,{animationName:0,elapsedTime:0,pseudoElement:0}),aL=sn(oL),lL=Ke({},mo,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),cL=sn(lL),uL=Ke({},mo,{data:0}),Wv=sn(uL),fL={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dL={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hL={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pL(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=hL[t])?!!e[t]:!1}function wm(){return pL}var gL=Ke({},rl,{key:function(t){if(t.key){var e=fL[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Uc(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?dL[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:wm,charCode:function(t){return t.type==="keypress"?Uc(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Uc(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),mL=sn(gL),vL=Ke({},hf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Hv=sn(vL),yL=Ke({},rl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:wm}),_L=sn(yL),EL=Ke({},mo,{propertyName:0,elapsedTime:0,pseudoElement:0}),wL=sn(EL),bL=Ke({},hf,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),xL=sn(bL),SL=[9,13,27,32],bm=ur&&"CompositionEvent"in window,ua=null;ur&&"documentMode"in document&&(ua=document.documentMode);var TL=ur&&"TextEvent"in window&&!ua,xb=ur&&(!bm||ua&&8<ua&&11>=ua),Yv=String.fromCharCode(32),Xv=!1;function Sb(t,e){switch(t){case"keyup":return SL.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Tb(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var vs=!1;function AL(t,e){switch(t){case"compositionend":return Tb(e);case"keypress":return e.which!==32?null:(Xv=!0,Yv);case"textInput":return t=e.data,t===Yv&&Xv?null:t;default:return null}}function CL(t,e){if(vs)return t==="compositionend"||!bm&&Sb(t,e)?(t=bb(),Fc=_m=jr=null,vs=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return xb&&e.locale!=="ko"?null:e.data;default:return null}}var PL={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Kv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!PL[t.type]:e==="textarea"}function Ab(t,e,n,r){rb(r),e=pu(e,"onChange"),0<e.length&&(n=new Em("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var fa=null,La=null;function RL(t){Fb(t,0)}function pf(t){var e=Es(t);if(qw(e))return t}function LL(t,e){if(t==="change")return e}var Cb=!1;if(ur){var Od;if(ur){var Nd="oninput"in document;if(!Nd){var qv=document.createElement("div");qv.setAttribute("oninput","return;"),Nd=typeof qv.oninput=="function"}Od=Nd}else Od=!1;Cb=Od&&(!document.documentMode||9<document.documentMode)}function Zv(){fa&&(fa.detachEvent("onpropertychange",Pb),La=fa=null)}function Pb(t){if(t.propertyName==="value"&&pf(La)){var e=[];Ab(e,La,t,pm(t)),ab(RL,e)}}function ML(t,e,n){t==="focusin"?(Zv(),fa=e,La=n,fa.attachEvent("onpropertychange",Pb)):t==="focusout"&&Zv()}function kL(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return pf(La)}function IL(t,e){if(t==="click")return pf(e)}function OL(t,e){if(t==="input"||t==="change")return pf(e)}function NL(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Rn=typeof Object.is=="function"?Object.is:NL;function Ma(t,e){if(Rn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!ip.call(e,i)||!Rn(t[i],e[i]))return!1}return!0}function Qv(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Jv(t,e){var n=Qv(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Qv(n)}}function Rb(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Rb(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Lb(){for(var t=window,e=au();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=au(t.document)}return e}function xm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function DL(t){var e=Lb(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Rb(n.ownerDocument.documentElement,n)){if(r!==null&&xm(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=Jv(n,s);var o=Jv(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var FL=ur&&"documentMode"in document&&11>=document.documentMode,ys=null,xp=null,da=null,Sp=!1;function ey(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Sp||ys==null||ys!==au(r)||(r=ys,"selectionStart"in r&&xm(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),da&&Ma(da,r)||(da=r,r=pu(xp,"onSelect"),0<r.length&&(e=new Em("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ys)))}function ql(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var _s={animationend:ql("Animation","AnimationEnd"),animationiteration:ql("Animation","AnimationIteration"),animationstart:ql("Animation","AnimationStart"),transitionend:ql("Transition","TransitionEnd")},Dd={},Mb={};ur&&(Mb=document.createElement("div").style,"AnimationEvent"in window||(delete _s.animationend.animation,delete _s.animationiteration.animation,delete _s.animationstart.animation),"TransitionEvent"in window||delete _s.transitionend.transition);function gf(t){if(Dd[t])return Dd[t];if(!_s[t])return t;var e=_s[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Mb)return Dd[t]=e[n];return t}var kb=gf("animationend"),Ib=gf("animationiteration"),Ob=gf("animationstart"),Nb=gf("transitionend"),Db=new Map,ty="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function oi(t,e){Db.set(t,e),Wi(e,[t])}for(var Fd=0;Fd<ty.length;Fd++){var Ud=ty[Fd],UL=Ud.toLowerCase(),BL=Ud[0].toUpperCase()+Ud.slice(1);oi(UL,"on"+BL)}oi(kb,"onAnimationEnd");oi(Ib,"onAnimationIteration");oi(Ob,"onAnimationStart");oi("dblclick","onDoubleClick");oi("focusin","onFocus");oi("focusout","onBlur");oi(Nb,"onTransitionEnd");$s("onMouseEnter",["mouseout","mouseover"]);$s("onMouseLeave",["mouseout","mouseover"]);$s("onPointerEnter",["pointerout","pointerover"]);$s("onPointerLeave",["pointerout","pointerover"]);Wi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Wi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Wi("onBeforeInput",["compositionend","keypress","textInput","paste"]);Wi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Wi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Wi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ta="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zL=new Set("cancel close invalid load scroll toggle".split(" ").concat(ta));function ny(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,UR(r,e,void 0,t),t.currentTarget=null}function Fb(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;ny(i,a,c),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;ny(i,a,c),s=l}}}if(cu)throw t=_p,cu=!1,_p=null,t}function je(t,e){var n=e[Rp];n===void 0&&(n=e[Rp]=new Set);var r=t+"__bubble";n.has(r)||(Ub(e,t,2,!1),n.add(r))}function Bd(t,e,n){var r=0;e&&(r|=4),Ub(n,t,r,e)}var Zl="_reactListening"+Math.random().toString(36).slice(2);function ka(t){if(!t[Zl]){t[Zl]=!0,Ww.forEach(function(n){n!=="selectionchange"&&(zL.has(n)||Bd(n,!1,t),Bd(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Zl]||(e[Zl]=!0,Bd("selectionchange",!1,e))}}function Ub(t,e,n,r){switch(wb(e)){case 1:var i=eL;break;case 4:i=tL;break;default:i=ym}n=i.bind(null,e,n,t),i=void 0,!yp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function zd(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Ti(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}ab(function(){var c=s,u=pm(n),d=[];e:{var f=Db.get(t);if(f!==void 0){var h=Em,p=t;switch(t){case"keypress":if(Uc(n)===0)break e;case"keydown":case"keyup":h=mL;break;case"focusin":p="focus",h=Id;break;case"focusout":p="blur",h=Id;break;case"beforeblur":case"afterblur":h=Id;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=Gv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=iL;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=_L;break;case kb:case Ib:case Ob:h=aL;break;case Nb:h=wL;break;case"scroll":h=nL;break;case"wheel":h=xL;break;case"copy":case"cut":case"paste":h=cL;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=Hv}var m=(e&4)!==0,E=!m&&t==="scroll",v=m?f!==null?f+"Capture":null:f;m=[];for(var g=c,y;g!==null;){y=g;var b=y.stateNode;if(y.tag===5&&b!==null&&(y=b,v!==null&&(b=Aa(g,v),b!=null&&m.push(Ia(g,b,y)))),E)break;g=g.return}0<m.length&&(f=new h(f,p,null,n,u),d.push({event:f,listeners:m}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",f&&n!==mp&&(p=n.relatedTarget||n.fromElement)&&(Ti(p)||p[fr]))break e;if((h||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,h?(p=n.relatedTarget||n.toElement,h=c,p=p?Ti(p):null,p!==null&&(E=Hi(p),p!==E||p.tag!==5&&p.tag!==6)&&(p=null)):(h=null,p=c),h!==p)){if(m=Gv,b="onMouseLeave",v="onMouseEnter",g="mouse",(t==="pointerout"||t==="pointerover")&&(m=Hv,b="onPointerLeave",v="onPointerEnter",g="pointer"),E=h==null?f:Es(h),y=p==null?f:Es(p),f=new m(b,g+"leave",h,n,u),f.target=E,f.relatedTarget=y,b=null,Ti(u)===c&&(m=new m(v,g+"enter",p,n,u),m.target=y,m.relatedTarget=E,b=m),E=b,h&&p)t:{for(m=h,v=p,g=0,y=m;y;y=ns(y))g++;for(y=0,b=v;b;b=ns(b))y++;for(;0<g-y;)m=ns(m),g--;for(;0<y-g;)v=ns(v),y--;for(;g--;){if(m===v||v!==null&&m===v.alternate)break t;m=ns(m),v=ns(v)}m=null}else m=null;h!==null&&ry(d,f,h,m,!1),p!==null&&E!==null&&ry(d,E,p,m,!0)}}e:{if(f=c?Es(c):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var T=LL;else if(Kv(f))if(Cb)T=OL;else{T=kL;var A=ML}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(T=IL);if(T&&(T=T(t,c))){Ab(d,T,n,u);break e}A&&A(t,f,c),t==="focusout"&&(A=f._wrapperState)&&A.controlled&&f.type==="number"&&fp(f,"number",f.value)}switch(A=c?Es(c):window,t){case"focusin":(Kv(A)||A.contentEditable==="true")&&(ys=A,xp=c,da=null);break;case"focusout":da=xp=ys=null;break;case"mousedown":Sp=!0;break;case"contextmenu":case"mouseup":case"dragend":Sp=!1,ey(d,n,u);break;case"selectionchange":if(FL)break;case"keydown":case"keyup":ey(d,n,u)}var R;if(bm)e:{switch(t){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else vs?Sb(t,n)&&(I="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(I="onCompositionStart");I&&(xb&&n.locale!=="ko"&&(vs||I!=="onCompositionStart"?I==="onCompositionEnd"&&vs&&(R=bb()):(jr=u,_m="value"in jr?jr.value:jr.textContent,vs=!0)),A=pu(c,I),0<A.length&&(I=new Wv(I,t,null,n,u),d.push({event:I,listeners:A}),R?I.data=R:(R=Tb(n),R!==null&&(I.data=R)))),(R=TL?AL(t,n):CL(t,n))&&(c=pu(c,"onBeforeInput"),0<c.length&&(u=new Wv("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:c}),u.data=R))}Fb(d,e)})}function Ia(t,e,n){return{instance:t,listener:e,currentTarget:n}}function pu(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Aa(t,n),s!=null&&r.unshift(Ia(t,s,i)),s=Aa(t,e),s!=null&&r.push(Ia(t,s,i))),t=t.return}return r}function ns(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function ry(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,i?(l=Aa(n,s),l!=null&&o.unshift(Ia(n,l,a))):i||(l=Aa(n,s),l!=null&&o.push(Ia(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var jL=/\r\n?/g,VL=/\u0000|\uFFFD/g;function iy(t){return(typeof t=="string"?t:""+t).replace(jL,`
`).replace(VL,"")}function Ql(t,e,n){if(e=iy(e),iy(t)!==e&&n)throw Error($(425))}function gu(){}var Tp=null,Ap=null;function Cp(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Pp=typeof setTimeout=="function"?setTimeout:void 0,$L=typeof clearTimeout=="function"?clearTimeout:void 0,sy=typeof Promise=="function"?Promise:void 0,GL=typeof queueMicrotask=="function"?queueMicrotask:typeof sy<"u"?function(t){return sy.resolve(null).then(t).catch(WL)}:Pp;function WL(t){setTimeout(function(){throw t})}function jd(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Ra(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Ra(e)}function qr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function oy(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var vo=Math.random().toString(36).slice(2),Fn="__reactFiber$"+vo,Oa="__reactProps$"+vo,fr="__reactContainer$"+vo,Rp="__reactEvents$"+vo,HL="__reactListeners$"+vo,YL="__reactHandles$"+vo;function Ti(t){var e=t[Fn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[fr]||n[Fn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=oy(t);t!==null;){if(n=t[Fn])return n;t=oy(t)}return e}t=n,n=t.parentNode}return null}function il(t){return t=t[Fn]||t[fr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Es(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error($(33))}function mf(t){return t[Oa]||null}var Lp=[],ws=-1;function ai(t){return{current:t}}function $e(t){0>ws||(t.current=Lp[ws],Lp[ws]=null,ws--)}function Ue(t,e){ws++,Lp[ws]=t.current,t.current=e}var ii={},St=ai(ii),Dt=ai(!1),Ni=ii;function Gs(t,e){var n=t.type.contextTypes;if(!n)return ii;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Ft(t){return t=t.childContextTypes,t!=null}function mu(){$e(Dt),$e(St)}function ay(t,e,n){if(St.current!==ii)throw Error($(168));Ue(St,e),Ue(Dt,n)}function Bb(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error($(108,MR(t)||"Unknown",i));return Ke({},n,r)}function vu(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ii,Ni=St.current,Ue(St,t),Ue(Dt,Dt.current),!0}function ly(t,e,n){var r=t.stateNode;if(!r)throw Error($(169));n?(t=Bb(t,e,Ni),r.__reactInternalMemoizedMergedChildContext=t,$e(Dt),$e(St),Ue(St,t)):$e(Dt),Ue(Dt,n)}var nr=null,vf=!1,Vd=!1;function zb(t){nr===null?nr=[t]:nr.push(t)}function XL(t){vf=!0,zb(t)}function li(){if(!Vd&&nr!==null){Vd=!0;var t=0,e=Re;try{var n=nr;for(Re=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}nr=null,vf=!1}catch(i){throw nr!==null&&(nr=nr.slice(t+1)),fb(gm,li),i}finally{Re=e,Vd=!1}}return null}var bs=[],xs=0,yu=null,_u=0,ln=[],cn=0,Di=null,or=1,ar="";function vi(t,e){bs[xs++]=_u,bs[xs++]=yu,yu=t,_u=e}function jb(t,e,n){ln[cn++]=or,ln[cn++]=ar,ln[cn++]=Di,Di=t;var r=or;t=ar;var i=32-An(r)-1;r&=~(1<<i),n+=1;var s=32-An(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,or=1<<32-An(e)+i|n<<i|r,ar=s+t}else or=1<<s|n<<i|r,ar=t}function Sm(t){t.return!==null&&(vi(t,1),jb(t,1,0))}function Tm(t){for(;t===yu;)yu=bs[--xs],bs[xs]=null,_u=bs[--xs],bs[xs]=null;for(;t===Di;)Di=ln[--cn],ln[cn]=null,ar=ln[--cn],ln[cn]=null,or=ln[--cn],ln[cn]=null}var Jt=null,Zt=null,Ge=!1,wn=null;function Vb(t,e){var n=un(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function cy(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Jt=t,Zt=qr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Jt=t,Zt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Di!==null?{id:or,overflow:ar}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=un(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Jt=t,Zt=null,!0):!1;default:return!1}}function Mp(t){return(t.mode&1)!==0&&(t.flags&128)===0}function kp(t){if(Ge){var e=Zt;if(e){var n=e;if(!cy(t,e)){if(Mp(t))throw Error($(418));e=qr(n.nextSibling);var r=Jt;e&&cy(t,e)?Vb(r,n):(t.flags=t.flags&-4097|2,Ge=!1,Jt=t)}}else{if(Mp(t))throw Error($(418));t.flags=t.flags&-4097|2,Ge=!1,Jt=t}}}function uy(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Jt=t}function Jl(t){if(t!==Jt)return!1;if(!Ge)return uy(t),Ge=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Cp(t.type,t.memoizedProps)),e&&(e=Zt)){if(Mp(t))throw $b(),Error($(418));for(;e;)Vb(t,e),e=qr(e.nextSibling)}if(uy(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error($(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Zt=qr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Zt=null}}else Zt=Jt?qr(t.stateNode.nextSibling):null;return!0}function $b(){for(var t=Zt;t;)t=qr(t.nextSibling)}function Ws(){Zt=Jt=null,Ge=!1}function Am(t){wn===null?wn=[t]:wn.push(t)}var KL=_r.ReactCurrentBatchConfig;function No(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error($(309));var r=n.stateNode}if(!r)throw Error($(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error($(284));if(!n._owner)throw Error($(290,t))}return t}function ec(t,e){throw t=Object.prototype.toString.call(e),Error($(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function fy(t){var e=t._init;return e(t._payload)}function Gb(t){function e(v,g){if(t){var y=v.deletions;y===null?(v.deletions=[g],v.flags|=16):y.push(g)}}function n(v,g){if(!t)return null;for(;g!==null;)e(v,g),g=g.sibling;return null}function r(v,g){for(v=new Map;g!==null;)g.key!==null?v.set(g.key,g):v.set(g.index,g),g=g.sibling;return v}function i(v,g){return v=ei(v,g),v.index=0,v.sibling=null,v}function s(v,g,y){return v.index=y,t?(y=v.alternate,y!==null?(y=y.index,y<g?(v.flags|=2,g):y):(v.flags|=2,g)):(v.flags|=1048576,g)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function a(v,g,y,b){return g===null||g.tag!==6?(g=Kd(y,v.mode,b),g.return=v,g):(g=i(g,y),g.return=v,g)}function l(v,g,y,b){var T=y.type;return T===ms?u(v,g,y.props.children,b,y.key):g!==null&&(g.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Nr&&fy(T)===g.type)?(b=i(g,y.props),b.ref=No(v,g,y),b.return=v,b):(b=Wc(y.type,y.key,y.props,null,v.mode,b),b.ref=No(v,g,y),b.return=v,b)}function c(v,g,y,b){return g===null||g.tag!==4||g.stateNode.containerInfo!==y.containerInfo||g.stateNode.implementation!==y.implementation?(g=qd(y,v.mode,b),g.return=v,g):(g=i(g,y.children||[]),g.return=v,g)}function u(v,g,y,b,T){return g===null||g.tag!==7?(g=ki(y,v.mode,b,T),g.return=v,g):(g=i(g,y),g.return=v,g)}function d(v,g,y){if(typeof g=="string"&&g!==""||typeof g=="number")return g=Kd(""+g,v.mode,y),g.return=v,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case $l:return y=Wc(g.type,g.key,g.props,null,v.mode,y),y.ref=No(v,null,g),y.return=v,y;case gs:return g=qd(g,v.mode,y),g.return=v,g;case Nr:var b=g._init;return d(v,b(g._payload),y)}if(Jo(g)||Lo(g))return g=ki(g,v.mode,y,null),g.return=v,g;ec(v,g)}return null}function f(v,g,y,b){var T=g!==null?g.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return T!==null?null:a(v,g,""+y,b);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case $l:return y.key===T?l(v,g,y,b):null;case gs:return y.key===T?c(v,g,y,b):null;case Nr:return T=y._init,f(v,g,T(y._payload),b)}if(Jo(y)||Lo(y))return T!==null?null:u(v,g,y,b,null);ec(v,y)}return null}function h(v,g,y,b,T){if(typeof b=="string"&&b!==""||typeof b=="number")return v=v.get(y)||null,a(g,v,""+b,T);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case $l:return v=v.get(b.key===null?y:b.key)||null,l(g,v,b,T);case gs:return v=v.get(b.key===null?y:b.key)||null,c(g,v,b,T);case Nr:var A=b._init;return h(v,g,y,A(b._payload),T)}if(Jo(b)||Lo(b))return v=v.get(y)||null,u(g,v,b,T,null);ec(g,b)}return null}function p(v,g,y,b){for(var T=null,A=null,R=g,I=g=0,D=null;R!==null&&I<y.length;I++){R.index>I?(D=R,R=null):D=R.sibling;var N=f(v,R,y[I],b);if(N===null){R===null&&(R=D);break}t&&R&&N.alternate===null&&e(v,R),g=s(N,g,I),A===null?T=N:A.sibling=N,A=N,R=D}if(I===y.length)return n(v,R),Ge&&vi(v,I),T;if(R===null){for(;I<y.length;I++)R=d(v,y[I],b),R!==null&&(g=s(R,g,I),A===null?T=R:A.sibling=R,A=R);return Ge&&vi(v,I),T}for(R=r(v,R);I<y.length;I++)D=h(R,v,I,y[I],b),D!==null&&(t&&D.alternate!==null&&R.delete(D.key===null?I:D.key),g=s(D,g,I),A===null?T=D:A.sibling=D,A=D);return t&&R.forEach(function(F){return e(v,F)}),Ge&&vi(v,I),T}function m(v,g,y,b){var T=Lo(y);if(typeof T!="function")throw Error($(150));if(y=T.call(y),y==null)throw Error($(151));for(var A=T=null,R=g,I=g=0,D=null,N=y.next();R!==null&&!N.done;I++,N=y.next()){R.index>I?(D=R,R=null):D=R.sibling;var F=f(v,R,N.value,b);if(F===null){R===null&&(R=D);break}t&&R&&F.alternate===null&&e(v,R),g=s(F,g,I),A===null?T=F:A.sibling=F,A=F,R=D}if(N.done)return n(v,R),Ge&&vi(v,I),T;if(R===null){for(;!N.done;I++,N=y.next())N=d(v,N.value,b),N!==null&&(g=s(N,g,I),A===null?T=N:A.sibling=N,A=N);return Ge&&vi(v,I),T}for(R=r(v,R);!N.done;I++,N=y.next())N=h(R,v,I,N.value,b),N!==null&&(t&&N.alternate!==null&&R.delete(N.key===null?I:N.key),g=s(N,g,I),A===null?T=N:A.sibling=N,A=N);return t&&R.forEach(function(q){return e(v,q)}),Ge&&vi(v,I),T}function E(v,g,y,b){if(typeof y=="object"&&y!==null&&y.type===ms&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case $l:e:{for(var T=y.key,A=g;A!==null;){if(A.key===T){if(T=y.type,T===ms){if(A.tag===7){n(v,A.sibling),g=i(A,y.props.children),g.return=v,v=g;break e}}else if(A.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Nr&&fy(T)===A.type){n(v,A.sibling),g=i(A,y.props),g.ref=No(v,A,y),g.return=v,v=g;break e}n(v,A);break}else e(v,A);A=A.sibling}y.type===ms?(g=ki(y.props.children,v.mode,b,y.key),g.return=v,v=g):(b=Wc(y.type,y.key,y.props,null,v.mode,b),b.ref=No(v,g,y),b.return=v,v=b)}return o(v);case gs:e:{for(A=y.key;g!==null;){if(g.key===A)if(g.tag===4&&g.stateNode.containerInfo===y.containerInfo&&g.stateNode.implementation===y.implementation){n(v,g.sibling),g=i(g,y.children||[]),g.return=v,v=g;break e}else{n(v,g);break}else e(v,g);g=g.sibling}g=qd(y,v.mode,b),g.return=v,v=g}return o(v);case Nr:return A=y._init,E(v,g,A(y._payload),b)}if(Jo(y))return p(v,g,y,b);if(Lo(y))return m(v,g,y,b);ec(v,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,g!==null&&g.tag===6?(n(v,g.sibling),g=i(g,y),g.return=v,v=g):(n(v,g),g=Kd(y,v.mode,b),g.return=v,v=g),o(v)):n(v,g)}return E}var Hs=Gb(!0),Wb=Gb(!1),Eu=ai(null),wu=null,Ss=null,Cm=null;function Pm(){Cm=Ss=wu=null}function Rm(t){var e=Eu.current;$e(Eu),t._currentValue=e}function Ip(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Ns(t,e){wu=t,Cm=Ss=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ot=!0),t.firstContext=null)}function hn(t){var e=t._currentValue;if(Cm!==t)if(t={context:t,memoizedValue:e,next:null},Ss===null){if(wu===null)throw Error($(308));Ss=t,wu.dependencies={lanes:0,firstContext:t}}else Ss=Ss.next=t;return e}var Ai=null;function Lm(t){Ai===null?Ai=[t]:Ai.push(t)}function Hb(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Lm(e)):(n.next=i.next,i.next=n),e.interleaved=n,dr(t,r)}function dr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Dr=!1;function Mm(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Yb(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function lr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Zr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ae&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,dr(t,n)}return i=r.interleaved,i===null?(e.next=e,Lm(r)):(e.next=i.next,i.next=e),r.interleaved=e,dr(t,n)}function Bc(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,mm(t,n)}}function dy(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function bu(t,e,n,r){var i=t.updateQueue;Dr=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(s!==null){var d=i.baseState;o=0,u=c=l=null,a=s;do{var f=a.lane,h=a.eventTime;if((r&f)===f){u!==null&&(u=u.next={eventTime:h,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,m=a;switch(f=e,h=n,m.tag){case 1:if(p=m.payload,typeof p=="function"){d=p.call(h,d,f);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,f=typeof p=="function"?p.call(h,d,f):p,f==null)break e;d=Ke({},d,f);break e;case 2:Dr=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=i.effects,f===null?i.effects=[a]:f.push(a))}else h={eventTime:h,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=h,l=d):u=u.next=h,o|=f;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;f=a,a=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(1);if(u===null&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Ui|=o,t.lanes=o,t.memoizedState=d}}function hy(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error($(191,i));i.call(r)}}}var sl={},Vn=ai(sl),Na=ai(sl),Da=ai(sl);function Ci(t){if(t===sl)throw Error($(174));return t}function km(t,e){switch(Ue(Da,e),Ue(Na,t),Ue(Vn,sl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:hp(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=hp(e,t)}$e(Vn),Ue(Vn,e)}function Ys(){$e(Vn),$e(Na),$e(Da)}function Xb(t){Ci(Da.current);var e=Ci(Vn.current),n=hp(e,t.type);e!==n&&(Ue(Na,t),Ue(Vn,n))}function Im(t){Na.current===t&&($e(Vn),$e(Na))}var He=ai(0);function xu(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var $d=[];function Om(){for(var t=0;t<$d.length;t++)$d[t]._workInProgressVersionPrimary=null;$d.length=0}var zc=_r.ReactCurrentDispatcher,Gd=_r.ReactCurrentBatchConfig,Fi=0,Xe=null,it=null,lt=null,Su=!1,ha=!1,Fa=0,qL=0;function yt(){throw Error($(321))}function Nm(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Rn(t[n],e[n]))return!1;return!0}function Dm(t,e,n,r,i,s){if(Fi=s,Xe=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,zc.current=t===null||t.memoizedState===null?e2:t2,t=n(r,i),ha){s=0;do{if(ha=!1,Fa=0,25<=s)throw Error($(301));s+=1,lt=it=null,e.updateQueue=null,zc.current=n2,t=n(r,i)}while(ha)}if(zc.current=Tu,e=it!==null&&it.next!==null,Fi=0,lt=it=Xe=null,Su=!1,e)throw Error($(300));return t}function Fm(){var t=Fa!==0;return Fa=0,t}function Dn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return lt===null?Xe.memoizedState=lt=t:lt=lt.next=t,lt}function pn(){if(it===null){var t=Xe.alternate;t=t!==null?t.memoizedState:null}else t=it.next;var e=lt===null?Xe.memoizedState:lt.next;if(e!==null)lt=e,it=t;else{if(t===null)throw Error($(310));it=t,t={memoizedState:it.memoizedState,baseState:it.baseState,baseQueue:it.baseQueue,queue:it.queue,next:null},lt===null?Xe.memoizedState=lt=t:lt=lt.next=t}return lt}function Ua(t,e){return typeof e=="function"?e(t):e}function Wd(t){var e=pn(),n=e.queue;if(n===null)throw Error($(311));n.lastRenderedReducer=t;var r=it,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,c=s;do{var u=c.lane;if((Fi&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,o=r):l=l.next=d,Xe.lanes|=u,Ui|=u}c=c.next}while(c!==null&&c!==s);l===null?o=r:l.next=a,Rn(r,e.memoizedState)||(Ot=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,Xe.lanes|=s,Ui|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Hd(t){var e=pn(),n=e.queue;if(n===null)throw Error($(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Rn(s,e.memoizedState)||(Ot=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function Kb(){}function qb(t,e){var n=Xe,r=pn(),i=e(),s=!Rn(r.memoizedState,i);if(s&&(r.memoizedState=i,Ot=!0),r=r.queue,Um(Jb.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||lt!==null&&lt.memoizedState.tag&1){if(n.flags|=2048,Ba(9,Qb.bind(null,n,r,i,e),void 0,null),ut===null)throw Error($(349));Fi&30||Zb(n,e,i)}return i}function Zb(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Xe.updateQueue,e===null?(e={lastEffect:null,stores:null},Xe.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Qb(t,e,n,r){e.value=n,e.getSnapshot=r,ex(e)&&tx(t)}function Jb(t,e,n){return n(function(){ex(e)&&tx(t)})}function ex(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Rn(t,n)}catch{return!0}}function tx(t){var e=dr(t,1);e!==null&&Cn(e,t,1,-1)}function py(t){var e=Dn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ua,lastRenderedState:t},e.queue=t,t=t.dispatch=JL.bind(null,Xe,t),[e.memoizedState,t]}function Ba(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Xe.updateQueue,e===null?(e={lastEffect:null,stores:null},Xe.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function nx(){return pn().memoizedState}function jc(t,e,n,r){var i=Dn();Xe.flags|=t,i.memoizedState=Ba(1|e,n,void 0,r===void 0?null:r)}function yf(t,e,n,r){var i=pn();r=r===void 0?null:r;var s=void 0;if(it!==null){var o=it.memoizedState;if(s=o.destroy,r!==null&&Nm(r,o.deps)){i.memoizedState=Ba(e,n,s,r);return}}Xe.flags|=t,i.memoizedState=Ba(1|e,n,s,r)}function gy(t,e){return jc(8390656,8,t,e)}function Um(t,e){return yf(2048,8,t,e)}function rx(t,e){return yf(4,2,t,e)}function ix(t,e){return yf(4,4,t,e)}function sx(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function ox(t,e,n){return n=n!=null?n.concat([t]):null,yf(4,4,sx.bind(null,e,t),n)}function Bm(){}function ax(t,e){var n=pn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Nm(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function lx(t,e){var n=pn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Nm(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function cx(t,e,n){return Fi&21?(Rn(n,e)||(n=pb(),Xe.lanes|=n,Ui|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ot=!0),t.memoizedState=n)}function ZL(t,e){var n=Re;Re=n!==0&&4>n?n:4,t(!0);var r=Gd.transition;Gd.transition={};try{t(!1),e()}finally{Re=n,Gd.transition=r}}function ux(){return pn().memoizedState}function QL(t,e,n){var r=Jr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},fx(t))dx(e,n);else if(n=Hb(t,e,n,r),n!==null){var i=Rt();Cn(n,t,r,i),hx(n,e,r)}}function JL(t,e,n){var r=Jr(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(fx(t))dx(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,Rn(a,o)){var l=e.interleaved;l===null?(i.next=i,Lm(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=Hb(t,e,i,r),n!==null&&(i=Rt(),Cn(n,t,r,i),hx(n,e,r))}}function fx(t){var e=t.alternate;return t===Xe||e!==null&&e===Xe}function dx(t,e){ha=Su=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function hx(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,mm(t,n)}}var Tu={readContext:hn,useCallback:yt,useContext:yt,useEffect:yt,useImperativeHandle:yt,useInsertionEffect:yt,useLayoutEffect:yt,useMemo:yt,useReducer:yt,useRef:yt,useState:yt,useDebugValue:yt,useDeferredValue:yt,useTransition:yt,useMutableSource:yt,useSyncExternalStore:yt,useId:yt,unstable_isNewReconciler:!1},e2={readContext:hn,useCallback:function(t,e){return Dn().memoizedState=[t,e===void 0?null:e],t},useContext:hn,useEffect:gy,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,jc(4194308,4,sx.bind(null,e,t),n)},useLayoutEffect:function(t,e){return jc(4194308,4,t,e)},useInsertionEffect:function(t,e){return jc(4,2,t,e)},useMemo:function(t,e){var n=Dn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Dn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=QL.bind(null,Xe,t),[r.memoizedState,t]},useRef:function(t){var e=Dn();return t={current:t},e.memoizedState=t},useState:py,useDebugValue:Bm,useDeferredValue:function(t){return Dn().memoizedState=t},useTransition:function(){var t=py(!1),e=t[0];return t=ZL.bind(null,t[1]),Dn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Xe,i=Dn();if(Ge){if(n===void 0)throw Error($(407));n=n()}else{if(n=e(),ut===null)throw Error($(349));Fi&30||Zb(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,gy(Jb.bind(null,r,s,t),[t]),r.flags|=2048,Ba(9,Qb.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Dn(),e=ut.identifierPrefix;if(Ge){var n=ar,r=or;n=(r&~(1<<32-An(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Fa++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=qL++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},t2={readContext:hn,useCallback:ax,useContext:hn,useEffect:Um,useImperativeHandle:ox,useInsertionEffect:rx,useLayoutEffect:ix,useMemo:lx,useReducer:Wd,useRef:nx,useState:function(){return Wd(Ua)},useDebugValue:Bm,useDeferredValue:function(t){var e=pn();return cx(e,it.memoizedState,t)},useTransition:function(){var t=Wd(Ua)[0],e=pn().memoizedState;return[t,e]},useMutableSource:Kb,useSyncExternalStore:qb,useId:ux,unstable_isNewReconciler:!1},n2={readContext:hn,useCallback:ax,useContext:hn,useEffect:Um,useImperativeHandle:ox,useInsertionEffect:rx,useLayoutEffect:ix,useMemo:lx,useReducer:Hd,useRef:nx,useState:function(){return Hd(Ua)},useDebugValue:Bm,useDeferredValue:function(t){var e=pn();return it===null?e.memoizedState=t:cx(e,it.memoizedState,t)},useTransition:function(){var t=Hd(Ua)[0],e=pn().memoizedState;return[t,e]},useMutableSource:Kb,useSyncExternalStore:qb,useId:ux,unstable_isNewReconciler:!1};function _n(t,e){if(t&&t.defaultProps){e=Ke({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Op(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ke({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var _f={isMounted:function(t){return(t=t._reactInternals)?Hi(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Rt(),i=Jr(t),s=lr(r,i);s.payload=e,n!=null&&(s.callback=n),e=Zr(t,s,i),e!==null&&(Cn(e,t,i,r),Bc(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Rt(),i=Jr(t),s=lr(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Zr(t,s,i),e!==null&&(Cn(e,t,i,r),Bc(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Rt(),r=Jr(t),i=lr(n,r);i.tag=2,e!=null&&(i.callback=e),e=Zr(t,i,r),e!==null&&(Cn(e,t,r,n),Bc(e,t,r))}};function my(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Ma(n,r)||!Ma(i,s):!0}function px(t,e,n){var r=!1,i=ii,s=e.contextType;return typeof s=="object"&&s!==null?s=hn(s):(i=Ft(e)?Ni:St.current,r=e.contextTypes,s=(r=r!=null)?Gs(t,i):ii),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=_f,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function vy(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&_f.enqueueReplaceState(e,e.state,null)}function Np(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Mm(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=hn(s):(s=Ft(e)?Ni:St.current,i.context=Gs(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Op(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&_f.enqueueReplaceState(i,i.state,null),bu(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Xs(t,e){try{var n="",r=e;do n+=LR(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Yd(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Dp(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var r2=typeof WeakMap=="function"?WeakMap:Map;function gx(t,e,n){n=lr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Cu||(Cu=!0,Hp=r),Dp(t,e)},n}function mx(t,e,n){n=lr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Dp(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Dp(t,e),typeof r!="function"&&(Qr===null?Qr=new Set([this]):Qr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function yy(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new r2;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=v2.bind(null,t,e,n),e.then(t,t))}function _y(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Ey(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=lr(-1,1),e.tag=2,Zr(n,e,1))),n.lanes|=1),t)}var i2=_r.ReactCurrentOwner,Ot=!1;function Ct(t,e,n,r){e.child=t===null?Wb(e,null,n,r):Hs(e,t.child,n,r)}function wy(t,e,n,r,i){n=n.render;var s=e.ref;return Ns(e,i),r=Dm(t,e,n,r,s,i),n=Fm(),t!==null&&!Ot?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,hr(t,e,i)):(Ge&&n&&Sm(e),e.flags|=1,Ct(t,e,r,i),e.child)}function by(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Ym(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,vx(t,e,s,r,i)):(t=Wc(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Ma,n(o,r)&&t.ref===e.ref)return hr(t,e,i)}return e.flags|=1,t=ei(s,r),t.ref=e.ref,t.return=e,e.child=t}function vx(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Ma(s,r)&&t.ref===e.ref)if(Ot=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Ot=!0);else return e.lanes=t.lanes,hr(t,e,i)}return Fp(t,e,n,r,i)}function yx(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ue(As,Yt),Yt|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ue(As,Yt),Yt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Ue(As,Yt),Yt|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Ue(As,Yt),Yt|=r;return Ct(t,e,i,n),e.child}function _x(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Fp(t,e,n,r,i){var s=Ft(n)?Ni:St.current;return s=Gs(e,s),Ns(e,i),n=Dm(t,e,n,r,s,i),r=Fm(),t!==null&&!Ot?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,hr(t,e,i)):(Ge&&r&&Sm(e),e.flags|=1,Ct(t,e,n,i),e.child)}function xy(t,e,n,r,i){if(Ft(n)){var s=!0;vu(e)}else s=!1;if(Ns(e,i),e.stateNode===null)Vc(t,e),px(e,n,r),Np(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=hn(c):(c=Ft(n)?Ni:St.current,c=Gs(e,c));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&vy(e,o,r,c),Dr=!1;var f=e.memoizedState;o.state=f,bu(e,r,o,i),l=e.memoizedState,a!==r||f!==l||Dt.current||Dr?(typeof u=="function"&&(Op(e,n,u,r),l=e.memoizedState),(a=Dr||my(e,n,a,r,f,l,c))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Yb(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:_n(e.type,a),o.props=c,d=e.pendingProps,f=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=hn(l):(l=Ft(n)?Ni:St.current,l=Gs(e,l));var h=n.getDerivedStateFromProps;(u=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||f!==l)&&vy(e,o,r,l),Dr=!1,f=e.memoizedState,o.state=f,bu(e,r,o,i);var p=e.memoizedState;a!==d||f!==p||Dt.current||Dr?(typeof h=="function"&&(Op(e,n,h,r),p=e.memoizedState),(c=Dr||my(e,n,c,r,f,p,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,p,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),o.props=r,o.state=p,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return Up(t,e,n,r,s,i)}function Up(t,e,n,r,i,s){_x(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&ly(e,n,!1),hr(t,e,s);r=e.stateNode,i2.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Hs(e,t.child,null,s),e.child=Hs(e,null,a,s)):Ct(t,e,a,s),e.memoizedState=r.state,i&&ly(e,n,!0),e.child}function Ex(t){var e=t.stateNode;e.pendingContext?ay(t,e.pendingContext,e.pendingContext!==e.context):e.context&&ay(t,e.context,!1),km(t,e.containerInfo)}function Sy(t,e,n,r,i){return Ws(),Am(i),e.flags|=256,Ct(t,e,n,r),e.child}var Bp={dehydrated:null,treeContext:null,retryLane:0};function zp(t){return{baseLanes:t,cachePool:null,transitions:null}}function wx(t,e,n){var r=e.pendingProps,i=He.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Ue(He,i&1),t===null)return kp(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=bf(o,r,0,null),t=ki(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=zp(n),e.memoizedState=Bp,t):zm(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return s2(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=ei(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=ei(a,s):(s=ki(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?zp(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=Bp,r}return s=t.child,t=s.sibling,r=ei(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function zm(t,e){return e=bf({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function tc(t,e,n,r){return r!==null&&Am(r),Hs(e,t.child,null,n),t=zm(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function s2(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=Yd(Error($(422))),tc(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=bf({mode:"visible",children:r.children},i,0,null),s=ki(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Hs(e,t.child,null,o),e.child.memoizedState=zp(o),e.memoizedState=Bp,s);if(!(e.mode&1))return tc(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error($(419)),r=Yd(s,r,void 0),tc(t,e,o,r)}if(a=(o&t.childLanes)!==0,Ot||a){if(r=ut,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,dr(t,i),Cn(r,t,i,-1))}return Hm(),r=Yd(Error($(421))),tc(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=y2.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Zt=qr(i.nextSibling),Jt=e,Ge=!0,wn=null,t!==null&&(ln[cn++]=or,ln[cn++]=ar,ln[cn++]=Di,or=t.id,ar=t.overflow,Di=e),e=zm(e,r.children),e.flags|=4096,e)}function Ty(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Ip(t.return,e,n)}function Xd(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function bx(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Ct(t,e,r.children,n),r=He.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Ty(t,n,e);else if(t.tag===19)Ty(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ue(He,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&xu(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Xd(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&xu(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Xd(e,!0,n,null,s);break;case"together":Xd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Vc(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function hr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ui|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error($(153));if(e.child!==null){for(t=e.child,n=ei(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ei(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function o2(t,e,n){switch(e.tag){case 3:Ex(e),Ws();break;case 5:Xb(e);break;case 1:Ft(e.type)&&vu(e);break;case 4:km(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Ue(Eu,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ue(He,He.current&1),e.flags|=128,null):n&e.child.childLanes?wx(t,e,n):(Ue(He,He.current&1),t=hr(t,e,n),t!==null?t.sibling:null);Ue(He,He.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return bx(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ue(He,He.current),r)break;return null;case 22:case 23:return e.lanes=0,yx(t,e,n)}return hr(t,e,n)}var xx,jp,Sx,Tx;xx=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};jp=function(){};Sx=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Ci(Vn.current);var s=null;switch(n){case"input":i=cp(t,i),r=cp(t,r),s=[];break;case"select":i=Ke({},i,{value:void 0}),r=Ke({},r,{value:void 0}),s=[];break;case"textarea":i=dp(t,i),r=dp(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=gu)}pp(n,r);var o;n=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Sa.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var l=r[c];if(a=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Sa.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&je("scroll",t),s||a===l||(s=[])):(s=s||[]).push(c,l))}n&&(s=s||[]).push("style",n);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};Tx=function(t,e,n,r){n!==r&&(e.flags|=4)};function Do(t,e){if(!Ge)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function _t(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function a2(t,e,n){var r=e.pendingProps;switch(Tm(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _t(e),null;case 1:return Ft(e.type)&&mu(),_t(e),null;case 3:return r=e.stateNode,Ys(),$e(Dt),$e(St),Om(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Jl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,wn!==null&&(Kp(wn),wn=null))),jp(t,e),_t(e),null;case 5:Im(e);var i=Ci(Da.current);if(n=e.type,t!==null&&e.stateNode!=null)Sx(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error($(166));return _t(e),null}if(t=Ci(Vn.current),Jl(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Fn]=e,r[Oa]=s,t=(e.mode&1)!==0,n){case"dialog":je("cancel",r),je("close",r);break;case"iframe":case"object":case"embed":je("load",r);break;case"video":case"audio":for(i=0;i<ta.length;i++)je(ta[i],r);break;case"source":je("error",r);break;case"img":case"image":case"link":je("error",r),je("load",r);break;case"details":je("toggle",r);break;case"input":Ov(r,s),je("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},je("invalid",r);break;case"textarea":Dv(r,s),je("invalid",r)}pp(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Ql(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Ql(r.textContent,a,t),i=["children",""+a]):Sa.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&je("scroll",r)}switch(n){case"input":Gl(r),Nv(r,s,!0);break;case"textarea":Gl(r),Fv(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=gu)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Jw(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Fn]=e,t[Oa]=r,xx(t,e,!1,!1),e.stateNode=t;e:{switch(o=gp(n,r),n){case"dialog":je("cancel",t),je("close",t),i=r;break;case"iframe":case"object":case"embed":je("load",t),i=r;break;case"video":case"audio":for(i=0;i<ta.length;i++)je(ta[i],t);i=r;break;case"source":je("error",t),i=r;break;case"img":case"image":case"link":je("error",t),je("load",t),i=r;break;case"details":je("toggle",t),i=r;break;case"input":Ov(t,r),i=cp(t,r),je("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Ke({},r,{value:void 0}),je("invalid",t);break;case"textarea":Dv(t,r),i=dp(t,r),je("invalid",t);break;default:i=r}pp(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?nb(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&eb(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Ta(t,l):typeof l=="number"&&Ta(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Sa.hasOwnProperty(s)?l!=null&&s==="onScroll"&&je("scroll",t):l!=null&&um(t,s,l,o))}switch(n){case"input":Gl(t),Nv(t,r,!1);break;case"textarea":Gl(t),Fv(t);break;case"option":r.value!=null&&t.setAttribute("value",""+ri(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Ms(t,!!r.multiple,s,!1):r.defaultValue!=null&&Ms(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=gu)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return _t(e),null;case 6:if(t&&e.stateNode!=null)Tx(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error($(166));if(n=Ci(Da.current),Ci(Vn.current),Jl(e)){if(r=e.stateNode,n=e.memoizedProps,r[Fn]=e,(s=r.nodeValue!==n)&&(t=Jt,t!==null))switch(t.tag){case 3:Ql(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ql(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Fn]=e,e.stateNode=r}return _t(e),null;case 13:if($e(He),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ge&&Zt!==null&&e.mode&1&&!(e.flags&128))$b(),Ws(),e.flags|=98560,s=!1;else if(s=Jl(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error($(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error($(317));s[Fn]=e}else Ws(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;_t(e),s=!1}else wn!==null&&(Kp(wn),wn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||He.current&1?st===0&&(st=3):Hm())),e.updateQueue!==null&&(e.flags|=4),_t(e),null);case 4:return Ys(),jp(t,e),t===null&&ka(e.stateNode.containerInfo),_t(e),null;case 10:return Rm(e.type._context),_t(e),null;case 17:return Ft(e.type)&&mu(),_t(e),null;case 19:if($e(He),s=e.memoizedState,s===null)return _t(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Do(s,!1);else{if(st!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=xu(t),o!==null){for(e.flags|=128,Do(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ue(He,He.current&1|2),e.child}t=t.sibling}s.tail!==null&&tt()>Ks&&(e.flags|=128,r=!0,Do(s,!1),e.lanes=4194304)}else{if(!r)if(t=xu(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Do(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Ge)return _t(e),null}else 2*tt()-s.renderingStartTime>Ks&&n!==1073741824&&(e.flags|=128,r=!0,Do(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=tt(),e.sibling=null,n=He.current,Ue(He,r?n&1|2:n&1),e):(_t(e),null);case 22:case 23:return Wm(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Yt&1073741824&&(_t(e),e.subtreeFlags&6&&(e.flags|=8192)):_t(e),null;case 24:return null;case 25:return null}throw Error($(156,e.tag))}function l2(t,e){switch(Tm(e),e.tag){case 1:return Ft(e.type)&&mu(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ys(),$e(Dt),$e(St),Om(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Im(e),null;case 13:if($e(He),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error($(340));Ws()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return $e(He),null;case 4:return Ys(),null;case 10:return Rm(e.type._context),null;case 22:case 23:return Wm(),null;case 24:return null;default:return null}}var nc=!1,bt=!1,c2=typeof WeakSet=="function"?WeakSet:Set,te=null;function Ts(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Je(t,e,r)}else n.current=null}function Vp(t,e,n){try{n()}catch(r){Je(t,e,r)}}var Ay=!1;function u2(t,e){if(Tp=du,t=Lb(),xm(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,u=0,d=t,f=null;t:for(;;){for(var h;d!==n||i!==0&&d.nodeType!==3||(a=o+i),d!==s||r!==0&&d.nodeType!==3||(l=o+r),d.nodeType===3&&(o+=d.nodeValue.length),(h=d.firstChild)!==null;)f=d,d=h;for(;;){if(d===t)break t;if(f===n&&++c===i&&(a=o),f===s&&++u===r&&(l=o),(h=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=h}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Ap={focusedElem:t,selectionRange:n},du=!1,te=e;te!==null;)if(e=te,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,te=t;else for(;te!==null;){e=te;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,E=p.memoizedState,v=e.stateNode,g=v.getSnapshotBeforeUpdate(e.elementType===e.type?m:_n(e.type,m),E);v.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error($(163))}}catch(b){Je(e,e.return,b)}if(t=e.sibling,t!==null){t.return=e.return,te=t;break}te=e.return}return p=Ay,Ay=!1,p}function pa(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Vp(e,n,s)}i=i.next}while(i!==r)}}function Ef(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function $p(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Ax(t){var e=t.alternate;e!==null&&(t.alternate=null,Ax(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Fn],delete e[Oa],delete e[Rp],delete e[HL],delete e[YL])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Cx(t){return t.tag===5||t.tag===3||t.tag===4}function Cy(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Cx(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Gp(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=gu));else if(r!==4&&(t=t.child,t!==null))for(Gp(t,e,n),t=t.sibling;t!==null;)Gp(t,e,n),t=t.sibling}function Wp(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Wp(t,e,n),t=t.sibling;t!==null;)Wp(t,e,n),t=t.sibling}var pt=null,En=!1;function Cr(t,e,n){for(n=n.child;n!==null;)Px(t,e,n),n=n.sibling}function Px(t,e,n){if(jn&&typeof jn.onCommitFiberUnmount=="function")try{jn.onCommitFiberUnmount(df,n)}catch{}switch(n.tag){case 5:bt||Ts(n,e);case 6:var r=pt,i=En;pt=null,Cr(t,e,n),pt=r,En=i,pt!==null&&(En?(t=pt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):pt.removeChild(n.stateNode));break;case 18:pt!==null&&(En?(t=pt,n=n.stateNode,t.nodeType===8?jd(t.parentNode,n):t.nodeType===1&&jd(t,n),Ra(t)):jd(pt,n.stateNode));break;case 4:r=pt,i=En,pt=n.stateNode.containerInfo,En=!0,Cr(t,e,n),pt=r,En=i;break;case 0:case 11:case 14:case 15:if(!bt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Vp(n,e,o),i=i.next}while(i!==r)}Cr(t,e,n);break;case 1:if(!bt&&(Ts(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Je(n,e,a)}Cr(t,e,n);break;case 21:Cr(t,e,n);break;case 22:n.mode&1?(bt=(r=bt)||n.memoizedState!==null,Cr(t,e,n),bt=r):Cr(t,e,n);break;default:Cr(t,e,n)}}function Py(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new c2),e.forEach(function(r){var i=_2.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function vn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:pt=a.stateNode,En=!1;break e;case 3:pt=a.stateNode.containerInfo,En=!0;break e;case 4:pt=a.stateNode.containerInfo,En=!0;break e}a=a.return}if(pt===null)throw Error($(160));Px(s,o,i),pt=null,En=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){Je(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Rx(e,t),e=e.sibling}function Rx(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(vn(e,t),kn(t),r&4){try{pa(3,t,t.return),Ef(3,t)}catch(m){Je(t,t.return,m)}try{pa(5,t,t.return)}catch(m){Je(t,t.return,m)}}break;case 1:vn(e,t),kn(t),r&512&&n!==null&&Ts(n,n.return);break;case 5:if(vn(e,t),kn(t),r&512&&n!==null&&Ts(n,n.return),t.flags&32){var i=t.stateNode;try{Ta(i,"")}catch(m){Je(t,t.return,m)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&Zw(i,s),gp(a,o);var c=gp(a,s);for(o=0;o<l.length;o+=2){var u=l[o],d=l[o+1];u==="style"?nb(i,d):u==="dangerouslySetInnerHTML"?eb(i,d):u==="children"?Ta(i,d):um(i,u,d,c)}switch(a){case"input":up(i,s);break;case"textarea":Qw(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var h=s.value;h!=null?Ms(i,!!s.multiple,h,!1):f!==!!s.multiple&&(s.defaultValue!=null?Ms(i,!!s.multiple,s.defaultValue,!0):Ms(i,!!s.multiple,s.multiple?[]:"",!1))}i[Oa]=s}catch(m){Je(t,t.return,m)}}break;case 6:if(vn(e,t),kn(t),r&4){if(t.stateNode===null)throw Error($(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(m){Je(t,t.return,m)}}break;case 3:if(vn(e,t),kn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ra(e.containerInfo)}catch(m){Je(t,t.return,m)}break;case 4:vn(e,t),kn(t);break;case 13:vn(e,t),kn(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||($m=tt())),r&4&&Py(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(bt=(c=bt)||u,vn(e,t),bt=c):vn(e,t),kn(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(te=t,u=t.child;u!==null;){for(d=te=u;te!==null;){switch(f=te,h=f.child,f.tag){case 0:case 11:case 14:case 15:pa(4,f,f.return);break;case 1:Ts(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){Je(r,n,m)}}break;case 5:Ts(f,f.return);break;case 22:if(f.memoizedState!==null){Ly(d);continue}}h!==null?(h.return=f,te=h):Ly(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{i=d.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=tb("display",o))}catch(m){Je(t,t.return,m)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(m){Je(t,t.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:vn(e,t),kn(t),r&4&&Py(t);break;case 21:break;default:vn(e,t),kn(t)}}function kn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Cx(n)){var r=n;break e}n=n.return}throw Error($(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Ta(i,""),r.flags&=-33);var s=Cy(t);Wp(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=Cy(t);Gp(t,a,o);break;default:throw Error($(161))}}catch(l){Je(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function f2(t,e,n){te=t,Lx(t)}function Lx(t,e,n){for(var r=(t.mode&1)!==0;te!==null;){var i=te,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||nc;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||bt;a=nc;var c=bt;if(nc=o,(bt=l)&&!c)for(te=i;te!==null;)o=te,l=o.child,o.tag===22&&o.memoizedState!==null?My(i):l!==null?(l.return=o,te=l):My(i);for(;s!==null;)te=s,Lx(s),s=s.sibling;te=i,nc=a,bt=c}Ry(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,te=s):Ry(t)}}function Ry(t){for(;te!==null;){var e=te;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:bt||Ef(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!bt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:_n(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&hy(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}hy(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&Ra(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error($(163))}bt||e.flags&512&&$p(e)}catch(f){Je(e,e.return,f)}}if(e===t){te=null;break}if(n=e.sibling,n!==null){n.return=e.return,te=n;break}te=e.return}}function Ly(t){for(;te!==null;){var e=te;if(e===t){te=null;break}var n=e.sibling;if(n!==null){n.return=e.return,te=n;break}te=e.return}}function My(t){for(;te!==null;){var e=te;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Ef(4,e)}catch(l){Je(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){Je(e,i,l)}}var s=e.return;try{$p(e)}catch(l){Je(e,s,l)}break;case 5:var o=e.return;try{$p(e)}catch(l){Je(e,o,l)}}}catch(l){Je(e,e.return,l)}if(e===t){te=null;break}var a=e.sibling;if(a!==null){a.return=e.return,te=a;break}te=e.return}}var d2=Math.ceil,Au=_r.ReactCurrentDispatcher,jm=_r.ReactCurrentOwner,fn=_r.ReactCurrentBatchConfig,Ae=0,ut=null,nt=null,gt=0,Yt=0,As=ai(0),st=0,za=null,Ui=0,wf=0,Vm=0,ga=null,It=null,$m=0,Ks=1/0,tr=null,Cu=!1,Hp=null,Qr=null,rc=!1,Vr=null,Pu=0,ma=0,Yp=null,$c=-1,Gc=0;function Rt(){return Ae&6?tt():$c!==-1?$c:$c=tt()}function Jr(t){return t.mode&1?Ae&2&&gt!==0?gt&-gt:KL.transition!==null?(Gc===0&&(Gc=pb()),Gc):(t=Re,t!==0||(t=window.event,t=t===void 0?16:wb(t.type)),t):1}function Cn(t,e,n,r){if(50<ma)throw ma=0,Yp=null,Error($(185));nl(t,n,r),(!(Ae&2)||t!==ut)&&(t===ut&&(!(Ae&2)&&(wf|=n),st===4&&zr(t,gt)),Ut(t,r),n===1&&Ae===0&&!(e.mode&1)&&(Ks=tt()+500,vf&&li()))}function Ut(t,e){var n=t.callbackNode;KR(t,e);var r=fu(t,t===ut?gt:0);if(r===0)n!==null&&zv(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&zv(n),e===1)t.tag===0?XL(ky.bind(null,t)):zb(ky.bind(null,t)),GL(function(){!(Ae&6)&&li()}),n=null;else{switch(gb(r)){case 1:n=gm;break;case 4:n=db;break;case 16:n=uu;break;case 536870912:n=hb;break;default:n=uu}n=Ux(n,Mx.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Mx(t,e){if($c=-1,Gc=0,Ae&6)throw Error($(327));var n=t.callbackNode;if(Ds()&&t.callbackNode!==n)return null;var r=fu(t,t===ut?gt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Ru(t,r);else{e=r;var i=Ae;Ae|=2;var s=Ix();(ut!==t||gt!==e)&&(tr=null,Ks=tt()+500,Mi(t,e));do try{g2();break}catch(a){kx(t,a)}while(1);Pm(),Au.current=s,Ae=i,nt!==null?e=0:(ut=null,gt=0,e=st)}if(e!==0){if(e===2&&(i=Ep(t),i!==0&&(r=i,e=Xp(t,i))),e===1)throw n=za,Mi(t,0),zr(t,r),Ut(t,tt()),n;if(e===6)zr(t,r);else{if(i=t.current.alternate,!(r&30)&&!h2(i)&&(e=Ru(t,r),e===2&&(s=Ep(t),s!==0&&(r=s,e=Xp(t,s))),e===1))throw n=za,Mi(t,0),zr(t,r),Ut(t,tt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error($(345));case 2:yi(t,It,tr);break;case 3:if(zr(t,r),(r&130023424)===r&&(e=$m+500-tt(),10<e)){if(fu(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Rt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Pp(yi.bind(null,t,It,tr),e);break}yi(t,It,tr);break;case 4:if(zr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-An(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=tt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*d2(r/1960))-r,10<r){t.timeoutHandle=Pp(yi.bind(null,t,It,tr),r);break}yi(t,It,tr);break;case 5:yi(t,It,tr);break;default:throw Error($(329))}}}return Ut(t,tt()),t.callbackNode===n?Mx.bind(null,t):null}function Xp(t,e){var n=ga;return t.current.memoizedState.isDehydrated&&(Mi(t,e).flags|=256),t=Ru(t,e),t!==2&&(e=It,It=n,e!==null&&Kp(e)),t}function Kp(t){It===null?It=t:It.push.apply(It,t)}function h2(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Rn(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function zr(t,e){for(e&=~Vm,e&=~wf,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-An(e),r=1<<n;t[n]=-1,e&=~r}}function ky(t){if(Ae&6)throw Error($(327));Ds();var e=fu(t,0);if(!(e&1))return Ut(t,tt()),null;var n=Ru(t,e);if(t.tag!==0&&n===2){var r=Ep(t);r!==0&&(e=r,n=Xp(t,r))}if(n===1)throw n=za,Mi(t,0),zr(t,e),Ut(t,tt()),n;if(n===6)throw Error($(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,yi(t,It,tr),Ut(t,tt()),null}function Gm(t,e){var n=Ae;Ae|=1;try{return t(e)}finally{Ae=n,Ae===0&&(Ks=tt()+500,vf&&li())}}function Bi(t){Vr!==null&&Vr.tag===0&&!(Ae&6)&&Ds();var e=Ae;Ae|=1;var n=fn.transition,r=Re;try{if(fn.transition=null,Re=1,t)return t()}finally{Re=r,fn.transition=n,Ae=e,!(Ae&6)&&li()}}function Wm(){Yt=As.current,$e(As)}function Mi(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,$L(n)),nt!==null)for(n=nt.return;n!==null;){var r=n;switch(Tm(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&mu();break;case 3:Ys(),$e(Dt),$e(St),Om();break;case 5:Im(r);break;case 4:Ys();break;case 13:$e(He);break;case 19:$e(He);break;case 10:Rm(r.type._context);break;case 22:case 23:Wm()}n=n.return}if(ut=t,nt=t=ei(t.current,null),gt=Yt=e,st=0,za=null,Vm=wf=Ui=0,It=ga=null,Ai!==null){for(e=0;e<Ai.length;e++)if(n=Ai[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Ai=null}return t}function kx(t,e){do{var n=nt;try{if(Pm(),zc.current=Tu,Su){for(var r=Xe.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Su=!1}if(Fi=0,lt=it=Xe=null,ha=!1,Fa=0,jm.current=null,n===null||n.return===null){st=1,za=e,nt=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=gt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=_y(o);if(h!==null){h.flags&=-257,Ey(h,o,a,s,e),h.mode&1&&yy(s,c,e),e=h,l=c;var p=e.updateQueue;if(p===null){var m=new Set;m.add(l),e.updateQueue=m}else p.add(l);break e}else{if(!(e&1)){yy(s,c,e),Hm();break e}l=Error($(426))}}else if(Ge&&a.mode&1){var E=_y(o);if(E!==null){!(E.flags&65536)&&(E.flags|=256),Ey(E,o,a,s,e),Am(Xs(l,a));break e}}s=l=Xs(l,a),st!==4&&(st=2),ga===null?ga=[s]:ga.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=gx(s,l,e);dy(s,v);break e;case 1:a=l;var g=s.type,y=s.stateNode;if(!(s.flags&128)&&(typeof g.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Qr===null||!Qr.has(y)))){s.flags|=65536,e&=-e,s.lanes|=e;var b=mx(s,a,e);dy(s,b);break e}}s=s.return}while(s!==null)}Nx(n)}catch(T){e=T,nt===n&&n!==null&&(nt=n=n.return);continue}break}while(1)}function Ix(){var t=Au.current;return Au.current=Tu,t===null?Tu:t}function Hm(){(st===0||st===3||st===2)&&(st=4),ut===null||!(Ui&268435455)&&!(wf&268435455)||zr(ut,gt)}function Ru(t,e){var n=Ae;Ae|=2;var r=Ix();(ut!==t||gt!==e)&&(tr=null,Mi(t,e));do try{p2();break}catch(i){kx(t,i)}while(1);if(Pm(),Ae=n,Au.current=r,nt!==null)throw Error($(261));return ut=null,gt=0,st}function p2(){for(;nt!==null;)Ox(nt)}function g2(){for(;nt!==null&&!zR();)Ox(nt)}function Ox(t){var e=Fx(t.alternate,t,Yt);t.memoizedProps=t.pendingProps,e===null?Nx(t):nt=e,jm.current=null}function Nx(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=l2(n,e),n!==null){n.flags&=32767,nt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{st=6,nt=null;return}}else if(n=a2(n,e,Yt),n!==null){nt=n;return}if(e=e.sibling,e!==null){nt=e;return}nt=e=t}while(e!==null);st===0&&(st=5)}function yi(t,e,n){var r=Re,i=fn.transition;try{fn.transition=null,Re=1,m2(t,e,n,r)}finally{fn.transition=i,Re=r}return null}function m2(t,e,n,r){do Ds();while(Vr!==null);if(Ae&6)throw Error($(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error($(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(qR(t,s),t===ut&&(nt=ut=null,gt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||rc||(rc=!0,Ux(uu,function(){return Ds(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=fn.transition,fn.transition=null;var o=Re;Re=1;var a=Ae;Ae|=4,jm.current=null,u2(t,n),Rx(n,t),DL(Ap),du=!!Tp,Ap=Tp=null,t.current=n,f2(n),jR(),Ae=a,Re=o,fn.transition=s}else t.current=n;if(rc&&(rc=!1,Vr=t,Pu=i),s=t.pendingLanes,s===0&&(Qr=null),GR(n.stateNode),Ut(t,tt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Cu)throw Cu=!1,t=Hp,Hp=null,t;return Pu&1&&t.tag!==0&&Ds(),s=t.pendingLanes,s&1?t===Yp?ma++:(ma=0,Yp=t):ma=0,li(),null}function Ds(){if(Vr!==null){var t=gb(Pu),e=fn.transition,n=Re;try{if(fn.transition=null,Re=16>t?16:t,Vr===null)var r=!1;else{if(t=Vr,Vr=null,Pu=0,Ae&6)throw Error($(331));var i=Ae;for(Ae|=4,te=t.current;te!==null;){var s=te,o=s.child;if(te.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(te=c;te!==null;){var u=te;switch(u.tag){case 0:case 11:case 15:pa(8,u,s)}var d=u.child;if(d!==null)d.return=u,te=d;else for(;te!==null;){u=te;var f=u.sibling,h=u.return;if(Ax(u),u===c){te=null;break}if(f!==null){f.return=h,te=f;break}te=h}}}var p=s.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var E=m.sibling;m.sibling=null,m=E}while(m!==null)}}te=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,te=o;else e:for(;te!==null;){if(s=te,s.flags&2048)switch(s.tag){case 0:case 11:case 15:pa(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,te=v;break e}te=s.return}}var g=t.current;for(te=g;te!==null;){o=te;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,te=y;else e:for(o=g;te!==null;){if(a=te,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Ef(9,a)}}catch(T){Je(a,a.return,T)}if(a===o){te=null;break e}var b=a.sibling;if(b!==null){b.return=a.return,te=b;break e}te=a.return}}if(Ae=i,li(),jn&&typeof jn.onPostCommitFiberRoot=="function")try{jn.onPostCommitFiberRoot(df,t)}catch{}r=!0}return r}finally{Re=n,fn.transition=e}}return!1}function Iy(t,e,n){e=Xs(n,e),e=gx(t,e,1),t=Zr(t,e,1),e=Rt(),t!==null&&(nl(t,1,e),Ut(t,e))}function Je(t,e,n){if(t.tag===3)Iy(t,t,n);else for(;e!==null;){if(e.tag===3){Iy(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Qr===null||!Qr.has(r))){t=Xs(n,t),t=mx(e,t,1),e=Zr(e,t,1),t=Rt(),e!==null&&(nl(e,1,t),Ut(e,t));break}}e=e.return}}function v2(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Rt(),t.pingedLanes|=t.suspendedLanes&n,ut===t&&(gt&n)===n&&(st===4||st===3&&(gt&130023424)===gt&&500>tt()-$m?Mi(t,0):Vm|=n),Ut(t,e)}function Dx(t,e){e===0&&(t.mode&1?(e=Yl,Yl<<=1,!(Yl&130023424)&&(Yl=4194304)):e=1);var n=Rt();t=dr(t,e),t!==null&&(nl(t,e,n),Ut(t,n))}function y2(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Dx(t,n)}function _2(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error($(314))}r!==null&&r.delete(e),Dx(t,n)}var Fx;Fx=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Dt.current)Ot=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ot=!1,o2(t,e,n);Ot=!!(t.flags&131072)}else Ot=!1,Ge&&e.flags&1048576&&jb(e,_u,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Vc(t,e),t=e.pendingProps;var i=Gs(e,St.current);Ns(e,n),i=Dm(null,e,r,t,i,n);var s=Fm();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ft(r)?(s=!0,vu(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Mm(e),i.updater=_f,e.stateNode=i,i._reactInternals=e,Np(e,r,t,n),e=Up(null,e,r,!0,s,n)):(e.tag=0,Ge&&s&&Sm(e),Ct(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Vc(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=w2(r),t=_n(r,t),i){case 0:e=Fp(null,e,r,t,n);break e;case 1:e=xy(null,e,r,t,n);break e;case 11:e=wy(null,e,r,t,n);break e;case 14:e=by(null,e,r,_n(r.type,t),n);break e}throw Error($(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:_n(r,i),Fp(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:_n(r,i),xy(t,e,r,i,n);case 3:e:{if(Ex(e),t===null)throw Error($(387));r=e.pendingProps,s=e.memoizedState,i=s.element,Yb(t,e),bu(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Xs(Error($(423)),e),e=Sy(t,e,r,n,i);break e}else if(r!==i){i=Xs(Error($(424)),e),e=Sy(t,e,r,n,i);break e}else for(Zt=qr(e.stateNode.containerInfo.firstChild),Jt=e,Ge=!0,wn=null,n=Wb(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ws(),r===i){e=hr(t,e,n);break e}Ct(t,e,r,n)}e=e.child}return e;case 5:return Xb(e),t===null&&kp(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Cp(r,i)?o=null:s!==null&&Cp(r,s)&&(e.flags|=32),_x(t,e),Ct(t,e,o,n),e.child;case 6:return t===null&&kp(e),null;case 13:return wx(t,e,n);case 4:return km(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Hs(e,null,r,n):Ct(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:_n(r,i),wy(t,e,r,i,n);case 7:return Ct(t,e,e.pendingProps,n),e.child;case 8:return Ct(t,e,e.pendingProps.children,n),e.child;case 12:return Ct(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Ue(Eu,r._currentValue),r._currentValue=o,s!==null)if(Rn(s.value,o)){if(s.children===i.children&&!Dt.current){e=hr(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=lr(-1,n&-n),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),Ip(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error($(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Ip(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Ct(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Ns(e,n),i=hn(i),r=r(i),e.flags|=1,Ct(t,e,r,n),e.child;case 14:return r=e.type,i=_n(r,e.pendingProps),i=_n(r.type,i),by(t,e,r,i,n);case 15:return vx(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:_n(r,i),Vc(t,e),e.tag=1,Ft(r)?(t=!0,vu(e)):t=!1,Ns(e,n),px(e,r,i),Np(e,r,i,n),Up(null,e,r,!0,t,n);case 19:return bx(t,e,n);case 22:return yx(t,e,n)}throw Error($(156,e.tag))};function Ux(t,e){return fb(t,e)}function E2(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function un(t,e,n,r){return new E2(t,e,n,r)}function Ym(t){return t=t.prototype,!(!t||!t.isReactComponent)}function w2(t){if(typeof t=="function")return Ym(t)?1:0;if(t!=null){if(t=t.$$typeof,t===dm)return 11;if(t===hm)return 14}return 2}function ei(t,e){var n=t.alternate;return n===null?(n=un(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Wc(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")Ym(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case ms:return ki(n.children,i,s,e);case fm:o=8,i|=8;break;case sp:return t=un(12,n,e,i|2),t.elementType=sp,t.lanes=s,t;case op:return t=un(13,n,e,i),t.elementType=op,t.lanes=s,t;case ap:return t=un(19,n,e,i),t.elementType=ap,t.lanes=s,t;case Xw:return bf(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Hw:o=10;break e;case Yw:o=9;break e;case dm:o=11;break e;case hm:o=14;break e;case Nr:o=16,r=null;break e}throw Error($(130,t==null?t:typeof t,""))}return e=un(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function ki(t,e,n,r){return t=un(7,t,r,e),t.lanes=n,t}function bf(t,e,n,r){return t=un(22,t,r,e),t.elementType=Xw,t.lanes=n,t.stateNode={isHidden:!1},t}function Kd(t,e,n){return t=un(6,t,null,e),t.lanes=n,t}function qd(t,e,n){return e=un(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function b2(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ld(0),this.expirationTimes=Ld(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ld(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Xm(t,e,n,r,i,s,o,a,l){return t=new b2(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=un(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Mm(s),t}function x2(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:gs,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Bx(t){if(!t)return ii;t=t._reactInternals;e:{if(Hi(t)!==t||t.tag!==1)throw Error($(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ft(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error($(171))}if(t.tag===1){var n=t.type;if(Ft(n))return Bb(t,n,e)}return e}function zx(t,e,n,r,i,s,o,a,l){return t=Xm(n,r,!0,t,i,s,o,a,l),t.context=Bx(null),n=t.current,r=Rt(),i=Jr(n),s=lr(r,i),s.callback=e??null,Zr(n,s,i),t.current.lanes=i,nl(t,i,r),Ut(t,r),t}function xf(t,e,n,r){var i=e.current,s=Rt(),o=Jr(i);return n=Bx(n),e.context===null?e.context=n:e.pendingContext=n,e=lr(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Zr(i,e,o),t!==null&&(Cn(t,i,o,s),Bc(t,i,o)),o}function Lu(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Oy(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Km(t,e){Oy(t,e),(t=t.alternate)&&Oy(t,e)}function S2(){return null}var jx=typeof reportError=="function"?reportError:function(t){console.error(t)};function qm(t){this._internalRoot=t}Sf.prototype.render=qm.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error($(409));xf(t,e,null,null)};Sf.prototype.unmount=qm.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Bi(function(){xf(null,t,null,null)}),e[fr]=null}};function Sf(t){this._internalRoot=t}Sf.prototype.unstable_scheduleHydration=function(t){if(t){var e=yb();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Br.length&&e!==0&&e<Br[n].priority;n++);Br.splice(n,0,t),n===0&&Eb(t)}};function Zm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Tf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Ny(){}function T2(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var c=Lu(o);s.call(c)}}var o=zx(e,r,t,0,null,!1,!1,"",Ny);return t._reactRootContainer=o,t[fr]=o.current,ka(t.nodeType===8?t.parentNode:t),Bi(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var c=Lu(l);a.call(c)}}var l=Xm(t,0,!1,null,null,!1,!1,"",Ny);return t._reactRootContainer=l,t[fr]=l.current,ka(t.nodeType===8?t.parentNode:t),Bi(function(){xf(e,l,n,r)}),l}function Af(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=Lu(o);a.call(l)}}xf(e,o,t,i)}else o=T2(n,e,t,i,r);return Lu(o)}mb=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ea(e.pendingLanes);n!==0&&(mm(e,n|1),Ut(e,tt()),!(Ae&6)&&(Ks=tt()+500,li()))}break;case 13:Bi(function(){var r=dr(t,1);if(r!==null){var i=Rt();Cn(r,t,1,i)}}),Km(t,1)}};vm=function(t){if(t.tag===13){var e=dr(t,134217728);if(e!==null){var n=Rt();Cn(e,t,134217728,n)}Km(t,134217728)}};vb=function(t){if(t.tag===13){var e=Jr(t),n=dr(t,e);if(n!==null){var r=Rt();Cn(n,t,e,r)}Km(t,e)}};yb=function(){return Re};_b=function(t,e){var n=Re;try{return Re=t,e()}finally{Re=n}};vp=function(t,e,n){switch(e){case"input":if(up(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=mf(r);if(!i)throw Error($(90));qw(r),up(r,i)}}}break;case"textarea":Qw(t,n);break;case"select":e=n.value,e!=null&&Ms(t,!!n.multiple,e,!1)}};sb=Gm;ob=Bi;var A2={usingClientEntryPoint:!1,Events:[il,Es,mf,rb,ib,Gm]},Fo={findFiberByHostInstance:Ti,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},C2={bundleType:Fo.bundleType,version:Fo.version,rendererPackageName:Fo.rendererPackageName,rendererConfig:Fo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_r.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=cb(t),t===null?null:t.stateNode},findFiberByHostInstance:Fo.findFiberByHostInstance||S2,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ic=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ic.isDisabled&&ic.supportsFiber)try{df=ic.inject(C2),jn=ic}catch{}}rn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=A2;rn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Zm(e))throw Error($(200));return x2(t,e,null,n)};rn.createRoot=function(t,e){if(!Zm(t))throw Error($(299));var n=!1,r="",i=jx;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Xm(t,1,!1,null,null,n,!1,r,i),t[fr]=e.current,ka(t.nodeType===8?t.parentNode:t),new qm(e)};rn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error($(188)):(t=Object.keys(t).join(","),Error($(268,t)));return t=cb(e),t=t===null?null:t.stateNode,t};rn.flushSync=function(t){return Bi(t)};rn.hydrate=function(t,e,n){if(!Tf(e))throw Error($(200));return Af(null,t,e,!0,n)};rn.hydrateRoot=function(t,e,n){if(!Zm(t))throw Error($(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=jx;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=zx(e,null,t,1,n??null,i,!1,s,o),t[fr]=e.current,ka(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Sf(e)};rn.render=function(t,e,n){if(!Tf(e))throw Error($(200));return Af(null,t,e,!1,n)};rn.unmountComponentAtNode=function(t){if(!Tf(t))throw Error($(40));return t._reactRootContainer?(Bi(function(){Af(null,null,t,!1,function(){t._reactRootContainer=null,t[fr]=null})}),!0):!1};rn.unstable_batchedUpdates=Gm;rn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Tf(n))throw Error($(200));if(t==null||t._reactInternals===void 0)throw Error($(38));return Af(t,e,n,!1,r)};rn.version="18.3.1-next-f1338f8080-20240426";function Vx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Vx)}catch(t){console.error(t)}}Vx(),Vw.exports=rn;var Cf=Vw.exports;const Pi=po(Cf);var Dy=Cf;rp.createRoot=Dy.createRoot,rp.hydrateRoot=Dy.hydrateRoot;function P2(t){const e=new Error(t);if(e.stack===void 0)try{throw e}catch{}return e}var R2=P2,me=R2;function L2(t){return!!t&&typeof t.then=="function"}var Ve=L2;function M2(t,e){if(t!=null)return t;throw me(e??"Got unexpected null or undefined")}var We=M2;function pe(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class Pf{getValue(){throw me("BaseLoadable")}toPromise(){throw me("BaseLoadable")}valueMaybe(){throw me("BaseLoadable")}valueOrThrow(){throw me(`Loadable expected value, but in "${this.state}" state`)}promiseMaybe(){throw me("BaseLoadable")}promiseOrThrow(){throw me(`Loadable expected promise, but in "${this.state}" state`)}errorMaybe(){throw me("BaseLoadable")}errorOrThrow(){throw me(`Loadable expected error, but in "${this.state}" state`)}is(e){return e.state===this.state&&e.contents===this.contents}map(e){throw me("BaseLoadable")}}class k2 extends Pf{constructor(e){super(),pe(this,"state","hasValue"),pe(this,"contents",void 0),this.contents=e}getValue(){return this.contents}toPromise(){return Promise.resolve(this.contents)}valueMaybe(){return this.contents}valueOrThrow(){return this.contents}promiseMaybe(){}errorMaybe(){}map(e){try{const n=e(this.contents);return Ve(n)?zi(n):qs(n)?n:ol(n)}catch(n){return Ve(n)?zi(n.next(()=>this.map(e))):Rf(n)}}}class I2 extends Pf{constructor(e){super(),pe(this,"state","hasError"),pe(this,"contents",void 0),this.contents=e}getValue(){throw this.contents}toPromise(){return Promise.reject(this.contents)}valueMaybe(){}promiseMaybe(){}errorMaybe(){return this.contents}errorOrThrow(){return this.contents}map(e){return this}}class $x extends Pf{constructor(e){super(),pe(this,"state","loading"),pe(this,"contents",void 0),this.contents=e}getValue(){throw this.contents}toPromise(){return this.contents}valueMaybe(){}promiseMaybe(){return this.contents}promiseOrThrow(){return this.contents}errorMaybe(){}map(e){return zi(this.contents.then(n=>{const r=e(n);if(qs(r)){const i=r;switch(i.state){case"hasValue":return i.contents;case"hasError":throw i.contents;case"loading":return i.contents}}return r}).catch(n=>{if(Ve(n))return n.then(()=>this.map(e).contents);throw n}))}}function ol(t){return Object.freeze(new k2(t))}function Rf(t){return Object.freeze(new I2(t))}function zi(t){return Object.freeze(new $x(t))}function Gx(){return Object.freeze(new $x(new Promise(()=>{})))}function O2(t){return t.every(e=>e.state==="hasValue")?ol(t.map(e=>e.contents)):t.some(e=>e.state==="hasError")?Rf(We(t.find(e=>e.state==="hasError"),"Invalid loadable passed to loadableAll").contents):zi(Promise.all(t.map(e=>e.contents)))}function Wx(t){const n=(Array.isArray(t)?t:Object.getOwnPropertyNames(t).map(i=>t[i])).map(i=>qs(i)?i:Ve(i)?zi(i):ol(i)),r=O2(n);return Array.isArray(t)?r:r.map(i=>Object.getOwnPropertyNames(t).reduce((s,o,a)=>({...s,[o]:i[a]}),{}))}function qs(t){return t instanceof Pf}const N2={of:t=>Ve(t)?zi(t):qs(t)?t:ol(t),error:t=>Rf(t),loading:()=>Gx(),all:Wx,isLoadable:qs};var Yi={loadableWithValue:ol,loadableWithError:Rf,loadableWithPromise:zi,loadableLoading:Gx,loadableAll:Wx,isLoadable:qs,RecoilLoadable:N2},D2=Yi.loadableWithValue,F2=Yi.loadableWithError,U2=Yi.loadableWithPromise,B2=Yi.loadableLoading,z2=Yi.loadableAll,j2=Yi.isLoadable,V2=Yi.RecoilLoadable,al=Object.freeze({__proto__:null,loadableWithValue:D2,loadableWithError:F2,loadableWithPromise:U2,loadableLoading:B2,loadableAll:z2,isLoadable:j2,RecoilLoadable:V2});const qp={RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED:!0,RECOIL_GKS_ENABLED:new Set(["recoil_hamt_2020","recoil_sync_external_store","recoil_suppress_rerender_in_callback","recoil_memory_managament_2020"])};function $2(t,e){var n,r;const i=(n=process.env[t])===null||n===void 0||(r=n.toLowerCase())===null||r===void 0?void 0:r.trim();if(i==null||i==="")return;if(!["true","false"].includes(i))throw me(`({}).${t} value must be 'true', 'false', or empty: ${i}`);e(i==="true")}function G2(t,e){var n;const r=(n=process.env[t])===null||n===void 0?void 0:n.trim();r==null||r===""||e(r.split(/\s*,\s*|\s+/))}function W2(){var t;typeof process>"u"||((t=process)===null||t===void 0?void 0:t.env)!=null&&($2("RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED",e=>{qp.RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED=e}),G2("RECOIL_GKS_ENABLED",e=>{e.forEach(n=>{qp.RECOIL_GKS_ENABLED.add(n)})}))}W2();var yo=qp;function Lf(t){return yo.RECOIL_GKS_ENABLED.has(t)}Lf.setPass=t=>{yo.RECOIL_GKS_ENABLED.add(t)};Lf.setFail=t=>{yo.RECOIL_GKS_ENABLED.delete(t)};Lf.clear=()=>{yo.RECOIL_GKS_ENABLED.clear()};var ke=Lf;function H2(t,e,{error:n}={}){return null}var Y2=H2,Qm=Y2,Zd,Qd,Jd;const X2=(Zd=ve.createMutableSource)!==null&&Zd!==void 0?Zd:ve.unstable_createMutableSource,Hx=(Qd=ve.useMutableSource)!==null&&Qd!==void 0?Qd:ve.unstable_useMutableSource,Yx=(Jd=ve.useSyncExternalStore)!==null&&Jd!==void 0?Jd:ve.unstable_useSyncExternalStore;function K2(){var t;const{ReactCurrentDispatcher:e,ReactCurrentOwner:n}=ve.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;return((t=e==null?void 0:e.current)!==null&&t!==void 0?t:n.currentDispatcher).useSyncExternalStore!=null}function q2(){return ke("recoil_transition_support")?{mode:"TRANSITION_SUPPORT",early:!0,concurrent:!0}:ke("recoil_sync_external_store")&&Yx!=null?{mode:"SYNC_EXTERNAL_STORE",early:!0,concurrent:!1}:ke("recoil_mutable_source")&&Hx!=null&&typeof window<"u"&&!window.$disableRecoilValueMutableSource_TEMP_HACK_DO_NOT_USE?ke("recoil_suppress_rerender_in_callback")?{mode:"MUTABLE_SOURCE",early:!0,concurrent:!0}:{mode:"MUTABLE_SOURCE",early:!1,concurrent:!1}:ke("recoil_suppress_rerender_in_callback")?{mode:"LEGACY",early:!0,concurrent:!1}:{mode:"LEGACY",early:!1,concurrent:!1}}function Z2(){return!1}var ll={createMutableSource:X2,useMutableSource:Hx,useSyncExternalStore:Yx,currentRendererSupportsUseSyncExternalStore:K2,reactMode:q2,isFastRefreshEnabled:Z2};class Jm{constructor(e){pe(this,"key",void 0),this.key=e}toJSON(){return{key:this.key}}}class Xx extends Jm{}class Kx extends Jm{}function Q2(t){return t instanceof Xx||t instanceof Kx}var Mf={AbstractRecoilValue:Jm,RecoilState:Xx,RecoilValueReadOnly:Kx,isRecoilValue:Q2},J2=Mf.AbstractRecoilValue,eM=Mf.RecoilState,tM=Mf.RecoilValueReadOnly,nM=Mf.isRecoilValue,Zs=Object.freeze({__proto__:null,AbstractRecoilValue:J2,RecoilState:eM,RecoilValueReadOnly:tM,isRecoilValue:nM});function rM(t,e){return function*(){let n=0;for(const r of t)yield e(r,n++)}()}var kf=rM;class qx{}const iM=new qx,ji=new Map,e0=new Map;function sM(t){return kf(t,e=>We(e0.get(e)))}function oM(t){if(ji.has(t)){const e=`Duplicate atom key "${t}". This is a FATAL ERROR in
      production. But it is safe to ignore this warning if it occurred because of
      hot module replacement.`;console.warn(e)}}function aM(t){yo.RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED&&oM(t.key),ji.set(t.key,t);const e=t.set==null?new Zs.RecoilValueReadOnly(t.key):new Zs.RecoilState(t.key);return e0.set(t.key,e),e}class Zx extends Error{}function lM(t){const e=ji.get(t);if(e==null)throw new Zx(`Missing definition for RecoilValue: "${t}""`);return e}function cM(t){return ji.get(t)}const Mu=new Map;function uM(t){var e;if(!ke("recoil_memory_managament_2020"))return;const n=ji.get(t);if(n!=null&&(e=n.shouldDeleteConfigOnRelease)!==null&&e!==void 0&&e.call(n)){var r;ji.delete(t),(r=Qx(t))===null||r===void 0||r(),Mu.delete(t)}}function fM(t,e){ke("recoil_memory_managament_2020")&&(e===void 0?Mu.delete(t):Mu.set(t,e))}function Qx(t){return Mu.get(t)}var jt={nodes:ji,recoilValues:e0,registerNode:aM,getNode:lM,getNodeMaybe:cM,deleteNodeConfigIfPossible:uM,setConfigDeletionHandler:fM,getConfigDeletionHandler:Qx,recoilValuesForKeys:sM,NodeMissingError:Zx,DefaultValue:qx,DEFAULT_VALUE:iM};function dM(t,e){e()}var hM={enqueueExecution:dM};function pM(t,e){return e={exports:{}},t(e,e.exports),e.exports}var gM=pM(function(t){var e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},n={},r=5,i=Math.pow(2,r),s=i-1,o=i/2,a=i/4,l={},c=function(L){return function(){return L}},u=n.hash=function(k){var L=typeof k>"u"?"undefined":e(k);if(L==="number")return k;L!=="string"&&(k+="");for(var j=0,H=0,K=k.length;H<K;++H){var ee=k.charCodeAt(H);j=(j<<5)-j+ee|0}return j},d=function(L){return L-=L>>1&1431655765,L=(L&858993459)+(L>>2&858993459),L=L+(L>>4)&252645135,L+=L>>8,L+=L>>16,L&127},f=function(L,j){return j>>>L&s},h=function(L){return 1<<L},p=function(L,j){return d(L&j-1)},m=function(L,j,H,K){var ee=K;if(!L){var ue=K.length;ee=new Array(ue);for(var ce=0;ce<ue;++ce)ee[ce]=K[ce]}return ee[j]=H,ee},E=function(L,j,H){var K=H.length-1,ee=0,ue=0,ce=H;if(L)ee=ue=j;else for(ce=new Array(K);ee<j;)ce[ue++]=H[ee++];for(++ee;ee<=K;)ce[ue++]=H[ee++];return L&&(ce.length=K),ce},v=function(L,j,H,K){var ee=K.length;if(L){for(var ue=ee;ue>=j;)K[ue--]=K[ue];return K[j]=H,K}for(var ce=0,ae=0,ge=new Array(ee+1);ce<j;)ge[ae++]=K[ce++];for(ge[j]=H;ce<ee;)ge[++ae]=K[ce++];return ge},g=1,y=2,b=3,T=4,A={__hamt_isEmpty:!0},R=function(L){return L===A||L&&L.__hamt_isEmpty},I=function(L,j,H,K){return{type:g,edit:L,hash:j,key:H,value:K,_modify:z}},D=function(L,j,H){return{type:y,edit:L,hash:j,children:H,_modify:ne}},N=function(L,j,H){return{type:b,edit:L,mask:j,children:H,_modify:Y}},F=function(L,j,H){return{type:T,edit:L,size:j,children:H,_modify:re}},q=function(L){return L===A||L.type===g||L.type===y},G=function(L,j,H,K,ee){for(var ue=[],ce=K,ae=0,ge=0;ce;++ge)ce&1&&(ue[ge]=ee[ae++]),ce>>>=1;return ue[j]=H,F(L,ae+1,ue)},W=function(L,j,H,K){for(var ee=new Array(j-1),ue=0,ce=0,ae=0,ge=K.length;ae<ge;++ae)if(ae!==H){var Ne=K[ae];Ne&&!R(Ne)&&(ee[ue++]=Ne,ce|=1<<ae)}return N(L,ce,ee)},xe=function k(L,j,H,K,ee,ue){if(H===ee)return D(L,H,[ue,K]);var ce=f(j,H),ae=f(j,ee);return N(L,h(ce)|h(ae),ce===ae?[k(L,j+r,H,K,ee,ue)]:ce<ae?[K,ue]:[ue,K])},de=function(L,j,H,K,ee,ue,ce,ae){for(var ge=ee.length,Ne=0;Ne<ge;++Ne){var vt=ee[Ne];if(H(ce,vt.key)){var et=vt.value,kt=ue(et);return kt===et?ee:kt===l?(--ae.value,E(L,Ne,ee)):m(L,Ne,I(j,K,ce,kt),ee)}}var $t=ue();return $t===l?ee:(++ae.value,m(L,ge,I(j,K,ce,$t),ee))},Pe=function(L,j){return L===j.edit},z=function(L,j,H,K,ee,ue,ce){if(j(ue,this.key)){var ae=K(this.value);return ae===this.value?this:ae===l?(--ce.value,A):Pe(L,this)?(this.value=ae,this):I(L,ee,ue,ae)}var ge=K();return ge===l?this:(++ce.value,xe(L,H,this.hash,this,ee,I(L,ee,ue,ge)))},ne=function(L,j,H,K,ee,ue,ce){if(ee===this.hash){var ae=Pe(L,this),ge=de(ae,L,j,this.hash,this.children,K,ue,ce);return ge===this.children?this:ge.length>1?D(L,this.hash,ge):ge[0]}var Ne=K();return Ne===l?this:(++ce.value,xe(L,H,this.hash,this,ee,I(L,ee,ue,Ne)))},Y=function(L,j,H,K,ee,ue,ce){var ae=this.mask,ge=this.children,Ne=f(H,ee),vt=h(Ne),et=p(ae,vt),kt=ae&vt,$t=kt?ge[et]:A,Tr=$t._modify(L,j,H+r,K,ee,ue,ce);if($t===Tr)return this;var Kn=Pe(L,this),fi=ae,di=void 0;if(kt&&R(Tr)){if(fi&=~vt,!fi)return A;if(ge.length<=2&&q(ge[et^1]))return ge[et^1];di=E(Kn,et,ge)}else if(!kt&&!R(Tr)){if(ge.length>=o)return G(L,Ne,Tr,ae,ge);fi|=vt,di=v(Kn,et,Tr,ge)}else di=m(Kn,et,Tr,ge);return Kn?(this.mask=fi,this.children=di,this):N(L,fi,di)},re=function(L,j,H,K,ee,ue,ce){var ae=this.size,ge=this.children,Ne=f(H,ee),vt=ge[Ne],et=(vt||A)._modify(L,j,H+r,K,ee,ue,ce);if(vt===et)return this;var kt=Pe(L,this),$t=void 0;if(R(vt)&&!R(et))++ae,$t=m(kt,Ne,et,ge);else if(!R(vt)&&R(et)){if(--ae,ae<=a)return W(L,ae,Ne,ge);$t=m(kt,Ne,A,ge)}else $t=m(kt,Ne,et,ge);return kt?(this.size=ae,this.children=$t,this):F(L,ae,$t)};A._modify=function(k,L,j,H,K,ee,ue){var ce=H();return ce===l?A:(++ue.value,I(k,K,ee,ce))};function M(k,L,j,H,K){this._editable=k,this._edit=L,this._config=j,this._root=H,this._size=K}M.prototype.setTree=function(k,L){return this._editable?(this._root=k,this._size=L,this):k===this._root?this:new M(this._editable,this._edit,this._config,k,L)};var V=n.tryGetHash=function(k,L,j,H){for(var K=H._root,ee=0,ue=H._config.keyEq;;)switch(K.type){case g:return ue(j,K.key)?K.value:k;case y:{if(L===K.hash)for(var ce=K.children,ae=0,ge=ce.length;ae<ge;++ae){var Ne=ce[ae];if(ue(j,Ne.key))return Ne.value}return k}case b:{var vt=f(ee,L),et=h(vt);if(K.mask&et){K=K.children[p(K.mask,et)],ee+=r;break}return k}case T:{if(K=K.children[f(ee,L)],K){ee+=r;break}return k}default:return k}};M.prototype.tryGetHash=function(k,L,j){return V(k,L,j,this)};var U=n.tryGet=function(k,L,j){return V(k,j._config.hash(L),L,j)};M.prototype.tryGet=function(k,L){return U(k,L,this)};var oe=n.getHash=function(k,L,j){return V(void 0,k,L,j)};M.prototype.getHash=function(k,L){return oe(k,L,this)},n.get=function(k,L){return V(void 0,L._config.hash(k),k,L)},M.prototype.get=function(k,L){return U(L,k,this)};var Q=n.has=function(k,L,j){return V(l,k,L,j)!==l};M.prototype.hasHash=function(k,L){return Q(k,L,this)};var ie=n.has=function(k,L){return Q(L._config.hash(k),k,L)};M.prototype.has=function(k){return ie(k,this)};var fe=function(L,j){return L===j};n.make=function(k){return new M(0,0,{keyEq:k&&k.keyEq||fe,hash:k&&k.hash||u},A,0)},n.empty=n.make();var X=n.isEmpty=function(k){return k&&!!R(k._root)};M.prototype.isEmpty=function(){return X(this)};var he=n.modifyHash=function(k,L,j,H){var K={value:H._size},ee=H._root._modify(H._editable?H._edit:NaN,H._config.keyEq,0,k,L,j,K);return H.setTree(ee,K.value)};M.prototype.modifyHash=function(k,L,j){return he(j,k,L,this)};var Ie=n.modify=function(k,L,j){return he(k,j._config.hash(L),L,j)};M.prototype.modify=function(k,L){return Ie(L,k,this)};var _e=n.setHash=function(k,L,j,H){return he(c(j),k,L,H)};M.prototype.setHash=function(k,L,j){return _e(k,L,j,this)};var Te=n.set=function(k,L,j){return _e(j._config.hash(k),k,L,j)};M.prototype.set=function(k,L){return Te(k,L,this)};var Ze=c(l),Se=n.removeHash=function(k,L,j){return he(Ze,k,L,j)};M.prototype.removeHash=M.prototype.deleteHash=function(k,L){return Se(k,L,this)};var Oe=n.remove=function(k,L){return Se(L._config.hash(k),k,L)};M.prototype.remove=M.prototype.delete=function(k){return Oe(k,this)};var Be=n.beginMutation=function(k){return new M(k._editable+1,k._edit+1,k._config,k._root,k._size)};M.prototype.beginMutation=function(){return Be(this)};var So=n.endMutation=function(k){return k._editable=k._editable&&k._editable-1,k};M.prototype.endMutation=function(){return So(this)};var Ml=n.mutate=function(k,L){var j=Be(L);return k(j),So(j)};M.prototype.mutate=function(k){return Ml(k,this)};var Sr=function(L){return L&&Tt(L[0],L[1],L[2],L[3],L[4])},Tt=function(L,j,H,K,ee){for(;H<L;){var ue=j[H++];if(ue&&!R(ue))return kl(ue,K,[L,j,H,K,ee])}return Sr(ee)},kl=function(L,j,H){switch(L.type){case g:return{value:j(L),rest:H};case y:case T:case b:var K=L.children;return Tt(K.length,K,0,j,H);default:return Sr(H)}},hd={done:!0};function To(k){this.v=k}To.prototype.next=function(){if(!this.v)return hd;var k=this.v;return this.v=Sr(k.rest),k},To.prototype[Symbol.iterator]=function(){return this};var Ao=function(L,j){return new To(kl(L._root,j))},pd=function(L){return[L.key,L.value]},Il=n.entries=function(k){return Ao(k,pd)};M.prototype.entries=M.prototype[Symbol.iterator]=function(){return Il(this)};var Ol=function(L){return L.key},Nl=n.keys=function(k){return Ao(k,Ol)};M.prototype.keys=function(){return Nl(this)};var Dl=function(L){return L.value},Ji=n.values=M.prototype.values=function(k){return Ao(k,Dl)};M.prototype.values=function(){return Ji(this)};var es=n.fold=function(k,L,j){var H=j._root;if(H.type===g)return k(L,H.value,H.key);for(var K=[H.children],ee=void 0;ee=K.pop();)for(var ue=0,ce=ee.length;ue<ce;){var ae=ee[ue++];ae&&ae.type&&(ae.type===g?L=k(L,ae.value,ae.key):K.push(ae.children))}return L};M.prototype.fold=function(k,L){return es(k,L,this)};var gd=n.forEach=function(k,L){return es(function(j,H,K){return k(H,K,L)},null,L)};M.prototype.forEach=function(k){return gd(k,this)};var md=n.count=function(k){return k._size};M.prototype.count=function(){return md(this)},Object.defineProperty(M.prototype,"size",{get:M.prototype.count}),t.exports?t.exports=n:(void 0).hamt=n});class mM{constructor(e){pe(this,"_map",void 0),this._map=new Map(e==null?void 0:e.entries())}keys(){return this._map.keys()}entries(){return this._map.entries()}get(e){return this._map.get(e)}has(e){return this._map.has(e)}set(e,n){return this._map.set(e,n),this}delete(e){return this._map.delete(e),this}clone(){return n0(this)}toMap(){return new Map(this._map)}}class t0{constructor(e){if(pe(this,"_hamt",gM.empty.beginMutation()),e instanceof t0){const n=e._hamt.endMutation();e._hamt=n.beginMutation(),this._hamt=n.beginMutation()}else if(e)for(const[n,r]of e.entries())this._hamt.set(n,r)}keys(){return this._hamt.keys()}entries(){return this._hamt.entries()}get(e){return this._hamt.get(e)}has(e){return this._hamt.has(e)}set(e,n){return this._hamt.set(e,n),this}delete(e){return this._hamt.delete(e),this}clone(){return n0(this)}toMap(){return new Map(this._hamt)}}function n0(t){return ke("recoil_hamt_2020")?new t0(t):new mM(t)}var vM={persistentMap:n0},yM=vM.persistentMap,_M=Object.freeze({__proto__:null,persistentMap:yM});function EM(t,...e){const n=new Set;e:for(const r of t){for(const i of e)if(i.has(r))continue e;n.add(r)}return n}var va=EM;function wM(t,e){const n=new Map;return t.forEach((r,i)=>{n.set(i,e(r,i))}),n}var ku=wM;function bM(){return{nodeDeps:new Map,nodeToNodeSubscriptions:new Map}}function xM(t){return{nodeDeps:ku(t.nodeDeps,e=>new Set(e)),nodeToNodeSubscriptions:ku(t.nodeToNodeSubscriptions,e=>new Set(e))}}function eh(t,e,n,r){const{nodeDeps:i,nodeToNodeSubscriptions:s}=n,o=i.get(t);if(o&&r&&o!==r.nodeDeps.get(t))return;i.set(t,e);const a=o==null?e:va(e,o);for(const l of a)s.has(l)||s.set(l,new Set),We(s.get(l)).add(t);if(o){const l=va(o,e);for(const c of l){if(!s.has(c))return;const u=We(s.get(c));u.delete(t),u.size===0&&s.delete(c)}}}function SM(t,e,n,r){var i,s,o,a;const l=n.getState();r===l.currentTree.version||r===((i=l.nextTree)===null||i===void 0?void 0:i.version)||((s=l.previousTree)===null||s===void 0||s.version);const c=n.getGraph(r);if(eh(t,e,c),r===((o=l.previousTree)===null||o===void 0?void 0:o.version)){const d=n.getGraph(l.currentTree.version);eh(t,e,d,c)}if(r===((a=l.previousTree)===null||a===void 0?void 0:a.version)||r===l.currentTree.version){var u;const d=(u=l.nextTree)===null||u===void 0?void 0:u.version;if(d!==void 0){const f=n.getGraph(d);eh(t,e,f,c)}}}var cl={cloneGraph:xM,graph:bM,saveDepsToStore:SM};let TM=0;const AM=()=>TM++;let CM=0;const PM=()=>CM++;let RM=0;const LM=()=>RM++;var If={getNextTreeStateVersion:AM,getNextStoreID:PM,getNextComponentID:LM};const{persistentMap:Fy}=_M,{graph:MM}=cl,{getNextTreeStateVersion:Jx}=If;function eS(){const t=Jx();return{version:t,stateID:t,transactionMetadata:{},dirtyAtoms:new Set,atomValues:Fy(),nonvalidatedAtoms:Fy()}}function kM(){const t=eS();return{currentTree:t,nextTree:null,previousTree:null,commitDepth:0,knownAtoms:new Set,knownSelectors:new Set,transactionSubscriptions:new Map,nodeTransactionSubscriptions:new Map,nodeToComponentSubscriptions:new Map,queuedComponentCallbacks_DEPRECATED:[],suspendedComponentResolvers:new Set,graphsByVersion:new Map().set(t.version,MM()),retention:{referenceCounts:new Map,nodesRetainedByZone:new Map,retainablesToCheckForRelease:new Set},nodeCleanupFunctions:new Map}}var tS={makeEmptyTreeState:eS,makeEmptyStoreState:kM,getNextTreeStateVersion:Jx};class nS{}function IM(){return new nS}var Of={RetentionZone:nS,retentionZone:IM};function OM(t,e){const n=new Set(t);return n.add(e),n}function NM(t,e){const n=new Set(t);return n.delete(e),n}function DM(t,e,n){const r=new Map(t);return r.set(e,n),r}function FM(t,e,n){const r=new Map(t);return r.set(e,n(r.get(e))),r}function UM(t,e){const n=new Map(t);return n.delete(e),n}function BM(t,e){const n=new Map(t);return e.forEach(r=>n.delete(r)),n}var rS={setByAddingToSet:OM,setByDeletingFromSet:NM,mapBySettingInMap:DM,mapByUpdatingInMap:FM,mapByDeletingFromMap:UM,mapByDeletingMultipleFromMap:BM};function*zM(t,e){let n=0;for(const r of t)e(r,n++)&&(yield r)}var r0=zM;function jM(t,e){return new Proxy(t,{get:(r,i)=>(!(i in r)&&i in e&&(r[i]=e[i]()),r[i]),ownKeys:r=>Object.keys(r)})}var iS=jM;const{getNode:ul,getNodeMaybe:VM,recoilValuesForKeys:Uy}=jt,{RetentionZone:By}=Of,{setByAddingToSet:$M}=rS,GM=Object.freeze(new Set);class WM extends Error{}function HM(t,e,n){if(!ke("recoil_memory_managament_2020"))return()=>{};const{nodesRetainedByZone:r}=t.getState().retention;function i(s){let o=r.get(s);o||r.set(s,o=new Set),o.add(e)}if(n instanceof By)i(n);else if(Array.isArray(n))for(const s of n)i(s);return()=>{if(!ke("recoil_memory_managament_2020"))return;const{retention:s}=t.getState();function o(a){const l=s.nodesRetainedByZone.get(a);l==null||l.delete(e),l&&l.size===0&&s.nodesRetainedByZone.delete(a)}if(n instanceof By)o(n);else if(Array.isArray(n))for(const a of n)o(a)}}function i0(t,e,n,r){const i=t.getState();if(i.nodeCleanupFunctions.has(n))return;const s=ul(n),o=HM(t,n,s.retainedBy),a=s.init(t,e,r);i.nodeCleanupFunctions.set(n,()=>{a(),o()})}function YM(t,e,n){i0(t,t.getState().currentTree,e,n)}function XM(t,e){var n;const r=t.getState();(n=r.nodeCleanupFunctions.get(e))===null||n===void 0||n(),r.nodeCleanupFunctions.delete(e)}function KM(t,e,n){return i0(t,e,n,"get"),ul(n).get(t,e)}function sS(t,e,n){return ul(n).peek(t,e)}function qM(t,e,n){var r;const i=VM(e);return i==null||(r=i.invalidate)===null||r===void 0||r.call(i,t),{...t,atomValues:t.atomValues.clone().delete(e),nonvalidatedAtoms:t.nonvalidatedAtoms.clone().set(e,n),dirtyAtoms:$M(t.dirtyAtoms,e)}}function ZM(t,e,n,r){const i=ul(n);if(i.set==null)throw new WM(`Attempt to set read-only RecoilValue: ${n}`);const s=i.set;return i0(t,e,n,"set"),s(t,e,r)}function QM(t,e,n){const r=t.getState(),i=t.getGraph(e.version),s=ul(n).nodeType;return iS({type:s},{loadable:()=>sS(t,e,n),isActive:()=>r.knownAtoms.has(n)||r.knownSelectors.has(n),isSet:()=>s==="selector"?!1:e.atomValues.has(n),isModified:()=>e.dirtyAtoms.has(n),deps:()=>{var o;return Uy((o=i.nodeDeps.get(n))!==null&&o!==void 0?o:[])},subscribers:()=>{var o,a;return{nodes:Uy(r0(oS(t,e,new Set([n])),l=>l!==n)),components:kf((o=(a=r.nodeToComponentSubscriptions.get(n))===null||a===void 0?void 0:a.values())!==null&&o!==void 0?o:[],([l])=>({name:l}))}}})}function oS(t,e,n){const r=new Set,i=Array.from(n),s=t.getGraph(e.version);for(let a=i.pop();a;a=i.pop()){var o;r.add(a);const l=(o=s.nodeToNodeSubscriptions.get(a))!==null&&o!==void 0?o:GM;for(const c of l)r.has(c)||i.push(c)}return r}var ci={getNodeLoadable:KM,peekNodeLoadable:sS,setNodeValue:ZM,initializeNode:YM,cleanUpNode:XM,setUnvalidatedAtomValue_DEPRECATED:qM,peekNodeInfo:QM,getDownstreamNodes:oS};let aS=null;function JM(t){aS=t}function ek(){var t;(t=aS)===null||t===void 0||t()}var lS={setInvalidateMemoizedSnapshot:JM,invalidateMemoizedSnapshot:ek};const{getDownstreamNodes:tk,getNodeLoadable:cS,setNodeValue:nk}=ci,{getNextComponentID:rk}=If,{getNode:ik,getNodeMaybe:uS}=jt,{DefaultValue:s0}=jt,{reactMode:sk}=ll,{AbstractRecoilValue:ok,RecoilState:ak,RecoilValueReadOnly:lk,isRecoilValue:ck}=Zs,{invalidateMemoizedSnapshot:uk}=lS;function fk(t,{key:e},n=t.getState().currentTree){var r,i;const s=t.getState();n.version===s.currentTree.version||n.version===((r=s.nextTree)===null||r===void 0?void 0:r.version)||(n.version,(i=s.previousTree)===null||i===void 0||i.version);const o=cS(t,n,e);return o.state==="loading"&&o.contents.catch(()=>{}),o}function dk(t,e){const n=t.clone();return e.forEach((r,i)=>{r.state==="hasValue"&&r.contents instanceof s0?n.delete(i):n.set(i,r)}),n}function hk(t,e,{key:n},r){if(typeof r=="function"){const i=cS(t,e,n);if(i.state==="loading"){const s=`Tried to set atom or selector "${n}" using an updater function while the current state is pending, this is not currently supported.`;throw me(s)}else if(i.state==="hasError")throw i.contents;return r(i.contents)}else return r}function pk(t,e,n){if(n.type==="set"){const{recoilValue:i,valueOrUpdater:s}=n,o=hk(t,e,i,s),a=nk(t,e,i.key,o);for(const[l,c]of a.entries())Zp(e,l,c)}else if(n.type==="setLoadable"){const{recoilValue:{key:i},loadable:s}=n;Zp(e,i,s)}else if(n.type==="markModified"){const{recoilValue:{key:i}}=n;e.dirtyAtoms.add(i)}else if(n.type==="setUnvalidated"){var r;const{recoilValue:{key:i},unvalidatedValue:s}=n,o=uS(i);o==null||(r=o.invalidate)===null||r===void 0||r.call(o,e),e.atomValues.delete(i),e.nonvalidatedAtoms.set(i,s),e.dirtyAtoms.add(i)}else Qm(`Unknown action ${n.type}`)}function Zp(t,e,n){n.state==="hasValue"&&n.contents instanceof s0?t.atomValues.delete(e):t.atomValues.set(e,n),t.dirtyAtoms.add(e),t.nonvalidatedAtoms.delete(e)}function fS(t,e){t.replaceState(n=>{const r=dS(n);for(const i of e)pk(t,r,i);return hS(t,r),uk(),r})}function Nf(t,e){if(ya.length){const n=ya[ya.length-1];let r=n.get(t);r||n.set(t,r=[]),r.push(e)}else fS(t,[e])}const ya=[];function gk(){const t=new Map;return ya.push(t),()=>{for(const[e,n]of t)fS(e,n);ya.pop()}}function dS(t){return{...t,atomValues:t.atomValues.clone(),nonvalidatedAtoms:t.nonvalidatedAtoms.clone(),dirtyAtoms:new Set(t.dirtyAtoms)}}function hS(t,e){const n=tk(t,e,e.dirtyAtoms);for(const s of n){var r,i;(r=uS(s))===null||r===void 0||(i=r.invalidate)===null||i===void 0||i.call(r,e)}}function pS(t,e,n){Nf(t,{type:"set",recoilValue:e,valueOrUpdater:n})}function mk(t,e,n){if(n instanceof s0)return pS(t,e,n);Nf(t,{type:"setLoadable",recoilValue:e,loadable:n})}function vk(t,e){Nf(t,{type:"markModified",recoilValue:e})}function yk(t,e,n){Nf(t,{type:"setUnvalidated",recoilValue:e,unvalidatedValue:n})}function _k(t,{key:e},n,r=null){const i=rk(),s=t.getState();s.nodeToComponentSubscriptions.has(e)||s.nodeToComponentSubscriptions.set(e,new Map),We(s.nodeToComponentSubscriptions.get(e)).set(i,[r??"<not captured>",n]);const o=sk();if(o.early&&(o.mode==="LEGACY"||o.mode==="MUTABLE_SOURCE")){const a=t.getState().nextTree;a&&a.dirtyAtoms.has(e)&&n(a)}return{release:()=>{const a=t.getState(),l=a.nodeToComponentSubscriptions.get(e);l===void 0||!l.has(i)||(l.delete(i),l.size===0&&a.nodeToComponentSubscriptions.delete(e))}}}function Ek(t,e){var n;const{currentTree:r}=t.getState(),i=ik(e.key);(n=i.clearCache)===null||n===void 0||n.call(i,t,r)}var Hn={RecoilValueReadOnly:lk,AbstractRecoilValue:ok,RecoilState:ak,getRecoilValueAsLoadable:fk,setRecoilValue:pS,setRecoilValueLoadable:mk,markRecoilValueModified:vk,setUnvalidatedRecoilValue:yk,subscribeToRecoilValue:_k,isRecoilValue:ck,applyAtomValueWrites:dk,batchStart:gk,writeLoadableToTreeState:Zp,invalidateDownstreams:hS,copyTreeState:dS,refreshRecoilValue:Ek};function wk(t,e,n){const r=t.entries();let i=r.next();for(;!i.done;){const s=i.value;if(e.call(n,s[1],s[0],t))return!0;i=r.next()}return!1}var bk=wk;const{cleanUpNode:xk}=ci,{deleteNodeConfigIfPossible:Sk,getNode:gS}=jt,{RetentionZone:mS}=Of,Tk=12e4,vS=new Set;function yS(t,e){const n=t.getState(),r=n.currentTree;if(n.nextTree)return;const i=new Set;for(const o of e)if(o instanceof mS)for(const a of Rk(n,o))i.add(a);else i.add(o);const s=Ak(t,i);for(const o of s)Pk(t,r,o)}function Ak(t,e){const n=t.getState(),r=n.currentTree,i=t.getGraph(r.version),s=new Set,o=new Set;return a(e),s;function a(l){const c=new Set,u=Ck(t,r,l,s,o);for(const p of u){var d;if(gS(p).retainedBy==="recoilRoot"){o.add(p);continue}if(((d=n.retention.referenceCounts.get(p))!==null&&d!==void 0?d:0)>0){o.add(p);continue}if(_S(p).some(E=>n.retention.referenceCounts.get(E))){o.add(p);continue}const m=i.nodeToNodeSubscriptions.get(p);if(m&&bk(m,E=>o.has(E))){o.add(p);continue}s.add(p),c.add(p)}const f=new Set;for(const p of c)for(const m of(h=i.nodeDeps.get(p))!==null&&h!==void 0?h:vS){var h;s.has(m)||f.add(m)}f.size&&a(f)}}function Ck(t,e,n,r,i){const s=t.getGraph(e.version),o=[],a=new Set;for(;n.size>0;)l(We(n.values().next().value));return o;function l(c){if(r.has(c)||i.has(c)){n.delete(c);return}if(a.has(c))return;const u=s.nodeToNodeSubscriptions.get(c);if(u)for(const d of u)l(d);a.add(c),n.delete(c),o.push(c)}}function Pk(t,e,n){if(!ke("recoil_memory_managament_2020"))return;xk(t,n);const r=t.getState();r.knownAtoms.delete(n),r.knownSelectors.delete(n),r.nodeTransactionSubscriptions.delete(n),r.retention.referenceCounts.delete(n);const i=_S(n);for(const l of i){var s;(s=r.retention.nodesRetainedByZone.get(l))===null||s===void 0||s.delete(n)}e.atomValues.delete(n),e.dirtyAtoms.delete(n),e.nonvalidatedAtoms.delete(n);const o=r.graphsByVersion.get(e.version);if(o){const l=o.nodeDeps.get(n);if(l!==void 0){o.nodeDeps.delete(n);for(const c of l){var a;(a=o.nodeToNodeSubscriptions.get(c))===null||a===void 0||a.delete(n)}}o.nodeToNodeSubscriptions.delete(n)}Sk(n)}function Rk(t,e){var n;return(n=t.retention.nodesRetainedByZone.get(e))!==null&&n!==void 0?n:vS}function _S(t){const e=gS(t).retainedBy;return e===void 0||e==="components"||e==="recoilRoot"?[]:e instanceof mS?[e]:e}function Lk(t,e){const n=t.getState();n.nextTree?n.retention.retainablesToCheckForRelease.add(e):yS(t,new Set([e]))}function Mk(t,e,n){var r;if(!ke("recoil_memory_managament_2020"))return;const i=t.getState().retention.referenceCounts,s=((r=i.get(e))!==null&&r!==void 0?r:0)+n;s===0?ES(t,e):i.set(e,s)}function ES(t,e){if(!ke("recoil_memory_managament_2020"))return;t.getState().retention.referenceCounts.delete(e),Lk(t,e)}function kk(t){if(!ke("recoil_memory_managament_2020"))return;const e=t.getState();yS(t,e.retention.retainablesToCheckForRelease),e.retention.retainablesToCheckForRelease.clear()}function Ik(t){return t===void 0?"recoilRoot":t}var Xi={SUSPENSE_TIMEOUT_MS:Tk,updateRetainCount:Mk,updateRetainCountToZero:ES,releaseScheduledRetainablesNow:kk,retainedByOptionWithDefault:Ik};const{unstable_batchedUpdates:Ok}=Pi;var Nk={unstable_batchedUpdates:Ok};const{unstable_batchedUpdates:Dk}=Nk;var Fk={unstable_batchedUpdates:Dk};const{batchStart:Uk}=Hn,{unstable_batchedUpdates:Bk}=Fk;let o0=Bk||(t=>t());const zk=t=>{o0=t},jk=()=>o0,Vk=t=>{o0(()=>{let e=()=>{};try{e=Uk(),t()}finally{e()}})};var Df={getBatcher:jk,setBatcher:zk,batchUpdates:Vk};function*$k(t){for(const e of t)for(const n of e)yield n}var wS=$k;const bS=typeof Window>"u"||typeof window>"u",Gk=t=>!bS&&(t===window||t instanceof Window),Wk=typeof navigator<"u"&&navigator.product==="ReactNative";var Ff={isSSR:bS,isReactNative:Wk,isWindow:Gk};function Hk(t,e){let n;return(...r)=>{n||(n={});const i=e(...r);return Object.hasOwnProperty.call(n,i)||(n[i]=t(...r)),n[i]}}function Yk(t,e){let n,r;return(...i)=>{const s=e(...i);return n===s||(n=s,r=t(...i)),r}}function Xk(t,e){let n,r;return[(...o)=>{const a=e(...o);return n===a||(n=a,r=t(...o)),r},()=>{n=null}]}var Kk={memoizeWithArgsHash:Hk,memoizeOneWithArgsHash:Yk,memoizeOneWithArgsHashAndInvalidation:Xk};const{batchUpdates:Qp}=Df,{initializeNode:qk,peekNodeInfo:Zk}=ci,{graph:Qk}=cl,{getNextStoreID:Jk}=If,{DEFAULT_VALUE:eI,recoilValues:zy,recoilValuesForKeys:jy}=jt,{AbstractRecoilValue:tI,getRecoilValueAsLoadable:nI,setRecoilValue:Vy,setUnvalidatedRecoilValue:rI}=Hn,{updateRetainCount:Hc}=Xi,{setInvalidateMemoizedSnapshot:iI}=lS,{getNextTreeStateVersion:sI,makeEmptyStoreState:oI}=tS,{isSSR:aI}=Ff,{memoizeOneWithArgsHashAndInvalidation:lI}=Kk;class Uf{constructor(e,n){pe(this,"_store",void 0),pe(this,"_refCount",1),pe(this,"getLoadable",r=>(this.checkRefCount_INTERNAL(),nI(this._store,r))),pe(this,"getPromise",r=>(this.checkRefCount_INTERNAL(),this.getLoadable(r).toPromise())),pe(this,"getNodes_UNSTABLE",r=>{if(this.checkRefCount_INTERNAL(),(r==null?void 0:r.isModified)===!0){if((r==null?void 0:r.isInitialized)===!1)return[];const o=this._store.getState().currentTree;return jy(o.dirtyAtoms)}const i=this._store.getState().knownAtoms,s=this._store.getState().knownSelectors;return(r==null?void 0:r.isInitialized)==null?zy.values():r.isInitialized===!0?jy(wS([i,s])):r0(zy.values(),({key:o})=>!i.has(o)&&!s.has(o))}),pe(this,"getInfo_UNSTABLE",({key:r})=>(this.checkRefCount_INTERNAL(),Zk(this._store,this._store.getState().currentTree,r))),pe(this,"map",r=>{this.checkRefCount_INTERNAL();const i=new Jp(this,Qp);return r(i),i}),pe(this,"asyncMap",async r=>{this.checkRefCount_INTERNAL();const i=new Jp(this,Qp);return i.retain(),await r(i),i.autoRelease_INTERNAL(),i}),this._store={storeID:Jk(),parentStoreID:n,getState:()=>e,replaceState:r=>{e.currentTree=r(e.currentTree)},getGraph:r=>{const i=e.graphsByVersion;if(i.has(r))return We(i.get(r));const s=Qk();return i.set(r,s),s},subscribeToTransactions:()=>({release:()=>{}}),addTransactionMetadata:()=>{throw me("Cannot subscribe to Snapshots")}};for(const r of this._store.getState().knownAtoms)qk(this._store,r,"get"),Hc(this._store,r,1);this.autoRelease_INTERNAL()}retain(){this._refCount<=0,this._refCount++;let e=!1;return()=>{e||(e=!0,this._release())}}autoRelease_INTERNAL(){aI||window.setTimeout(()=>this._release(),10)}_release(){if(this._refCount--,this._refCount===0){if(this._store.getState().nodeCleanupFunctions.forEach(e=>e()),this._store.getState().nodeCleanupFunctions.clear(),!ke("recoil_memory_managament_2020"))return}else this._refCount<0}isRetained(){return this._refCount>0}checkRefCount_INTERNAL(){ke("recoil_memory_managament_2020")&&this._refCount<=0}getStore_INTERNAL(){return this.checkRefCount_INTERNAL(),this._store}getID(){return this.checkRefCount_INTERNAL(),this._store.getState().currentTree.stateID}getStoreID(){return this.checkRefCount_INTERNAL(),this._store.storeID}}function xS(t,e,n=!1){const r=t.getState(),i=n?sI():e.version;return{currentTree:{version:n?i:e.version,stateID:n?i:e.stateID,transactionMetadata:{...e.transactionMetadata},dirtyAtoms:new Set(e.dirtyAtoms),atomValues:e.atomValues.clone(),nonvalidatedAtoms:e.nonvalidatedAtoms.clone()},commitDepth:0,nextTree:null,previousTree:null,knownAtoms:new Set(r.knownAtoms),knownSelectors:new Set(r.knownSelectors),transactionSubscriptions:new Map,nodeTransactionSubscriptions:new Map,nodeToComponentSubscriptions:new Map,queuedComponentCallbacks_DEPRECATED:[],suspendedComponentResolvers:new Set,graphsByVersion:new Map().set(i,t.getGraph(e.version)),retention:{referenceCounts:new Map,nodesRetainedByZone:new Map,retainablesToCheckForRelease:new Set},nodeCleanupFunctions:new Map(kf(r.nodeCleanupFunctions.entries(),([s])=>[s,()=>{}]))}}function cI(t){const e=new Uf(oI());return t!=null?e.map(t):e}const[$y,SS]=lI((t,e)=>{var n;const r=t.getState(),i=e==="latest"?(n=r.nextTree)!==null&&n!==void 0?n:r.currentTree:We(r.previousTree);return new Uf(xS(t,i),t.storeID)},(t,e)=>{var n,r;return String(e)+String(t.storeID)+String((n=t.getState().nextTree)===null||n===void 0?void 0:n.version)+String(t.getState().currentTree.version)+String((r=t.getState().previousTree)===null||r===void 0?void 0:r.version)});iI(SS);function uI(t,e="latest"){const n=$y(t,e);return n.isRetained()?n:(SS(),$y(t,e))}class Jp extends Uf{constructor(e,n){super(xS(e.getStore_INTERNAL(),e.getStore_INTERNAL().getState().currentTree,!0),e.getStoreID()),pe(this,"_batch",void 0),pe(this,"set",(r,i)=>{this.checkRefCount_INTERNAL();const s=this.getStore_INTERNAL();this._batch(()=>{Hc(s,r.key,1),Vy(this.getStore_INTERNAL(),r,i)})}),pe(this,"reset",r=>{this.checkRefCount_INTERNAL();const i=this.getStore_INTERNAL();this._batch(()=>{Hc(i,r.key,1),Vy(this.getStore_INTERNAL(),r,eI)})}),pe(this,"setUnvalidatedAtomValues_DEPRECATED",r=>{this.checkRefCount_INTERNAL();const i=this.getStore_INTERNAL();Qp(()=>{for(const[s,o]of r.entries())Hc(i,s,1),rI(i,new tI(s),o)})}),this._batch=n}}var Bf={Snapshot:Uf,MutableSnapshot:Jp,freshSnapshot:cI,cloneSnapshot:uI},fI=Bf.Snapshot,dI=Bf.MutableSnapshot,hI=Bf.freshSnapshot,pI=Bf.cloneSnapshot,zf=Object.freeze({__proto__:null,Snapshot:fI,MutableSnapshot:dI,freshSnapshot:hI,cloneSnapshot:pI});function gI(...t){const e=new Set;for(const n of t)for(const r of n)e.add(r);return e}var mI=gI;const{useRef:vI}=ve;function yI(t){const e=vI(t);return e.current===t&&typeof t=="function"&&(e.current=t()),e}var Gy=yI;const{getNextTreeStateVersion:_I,makeEmptyStoreState:TS}=tS,{cleanUpNode:EI,getDownstreamNodes:wI,initializeNode:bI,setNodeValue:xI,setUnvalidatedAtomValue_DEPRECATED:SI}=ci,{graph:TI}=cl,{cloneGraph:AI}=cl,{getNextStoreID:AS}=If,{createMutableSource:th,reactMode:CS}=ll,{applyAtomValueWrites:CI}=Hn,{releaseScheduledRetainablesNow:PS}=Xi,{freshSnapshot:PI}=zf,{useCallback:RI,useContext:RS,useEffect:eg,useMemo:LI,useRef:MI,useState:kI}=ve;function Uo(){throw me("This component must be used inside a <RecoilRoot> component.")}const LS=Object.freeze({storeID:AS(),getState:Uo,replaceState:Uo,getGraph:Uo,subscribeToTransactions:Uo,addTransactionMetadata:Uo});let tg=!1;function Wy(t){if(tg)throw me("An atom update was triggered within the execution of a state updater function. State updater functions provided to Recoil must be pure functions.");const e=t.getState();if(e.nextTree===null){ke("recoil_memory_managament_2020")&&ke("recoil_release_on_cascading_update_killswitch_2021")&&e.commitDepth>0&&PS(t);const n=e.currentTree.version,r=_I();e.nextTree={...e.currentTree,version:r,stateID:r,dirtyAtoms:new Set,transactionMetadata:{}},e.graphsByVersion.set(r,AI(We(e.graphsByVersion.get(n))))}}const MS=ve.createContext({current:LS}),jf=()=>RS(MS),kS=ve.createContext(null);function II(){return RS(kS)}function a0(t,e,n){const r=wI(t,n,n.dirtyAtoms);for(const i of r){const s=e.nodeToComponentSubscriptions.get(i);if(s)for(const[o,[a,l]]of s)l(n)}}function IS(t){const e=t.getState(),n=e.currentTree,r=n.dirtyAtoms;if(r.size){for(const[i,s]of e.nodeTransactionSubscriptions)if(r.has(i))for(const[o,a]of s)a(t);for(const[i,s]of e.transactionSubscriptions)s(t);(!CS().early||e.suspendedComponentResolvers.size>0)&&(a0(t,e,n),e.suspendedComponentResolvers.forEach(i=>i()),e.suspendedComponentResolvers.clear())}e.queuedComponentCallbacks_DEPRECATED.forEach(i=>i(n)),e.queuedComponentCallbacks_DEPRECATED.splice(0,e.queuedComponentCallbacks_DEPRECATED.length)}function OI(t){const e=t.getState();e.commitDepth++;try{const{nextTree:n}=e;if(n==null)return;e.previousTree=e.currentTree,e.currentTree=n,e.nextTree=null,IS(t),e.previousTree!=null?e.graphsByVersion.delete(e.previousTree.version):Qm("Ended batch with no previous state, which is unexpected","recoil"),e.previousTree=null,ke("recoil_memory_managament_2020")&&n==null&&PS(t)}finally{e.commitDepth--}}function NI({setNotifyBatcherOfChange:t}){const e=jf(),[,n]=kI([]);return t(()=>n({})),eg(()=>(t(()=>n({})),()=>{t(()=>{})}),[t]),eg(()=>{hM.enqueueExecution("Batcher",()=>{OI(e.current)})}),null}function DI(t,e){const n=TS();return e({set:(r,i)=>{const s=n.currentTree,o=xI(t,s,r.key,i),a=new Set(o.keys()),l=s.nonvalidatedAtoms.clone();for(const c of a)l.delete(c);n.currentTree={...s,dirtyAtoms:mI(s.dirtyAtoms,a),atomValues:CI(s.atomValues,o),nonvalidatedAtoms:l}},setUnvalidatedAtomValues:r=>{r.forEach((i,s)=>{n.currentTree=SI(n.currentTree,s,i)})}}),n}function FI(t){const e=PI(t),n=e.getStore_INTERNAL().getState();return e.retain(),n.nodeCleanupFunctions.forEach(r=>r()),n.nodeCleanupFunctions.clear(),n}let Hy=0;function UI({initializeState_DEPRECATED:t,initializeState:e,store_INTERNAL:n,children:r}){let i;const s=h=>{const p=i.current.graphsByVersion;if(p.has(h))return We(p.get(h));const m=TI();return p.set(h,m),m},o=(h,p)=>{if(p==null){const{transactionSubscriptions:m}=d.current.getState(),E=Hy++;return m.set(E,h),{release:()=>{m.delete(E)}}}else{const{nodeTransactionSubscriptions:m}=d.current.getState();m.has(p)||m.set(p,new Map);const E=Hy++;return We(m.get(p)).set(E,h),{release:()=>{const v=m.get(p);v&&(v.delete(E),v.size===0&&m.delete(p))}}}},a=h=>{Wy(d.current);for(const p of Object.keys(h))We(d.current.getState().nextTree).transactionMetadata[p]=h[p]},l=h=>{Wy(d.current);const p=We(i.current.nextTree);let m;try{tg=!0,m=h(p)}finally{tg=!1}m!==p&&(i.current.nextTree=m,CS().early&&a0(d.current,i.current,m),We(c.current)())},c=MI(null),u=RI(h=>{c.current=h},[c]),d=Gy(()=>n??{storeID:AS(),getState:()=>i.current,replaceState:l,getGraph:s,subscribeToTransactions:o,addTransactionMetadata:a});n!=null&&(d.current=n),i=Gy(()=>t!=null?DI(d.current,t):e!=null?FI(e):TS());const f=LI(()=>th==null?void 0:th(i,()=>i.current.currentTree.version),[i]);return eg(()=>{const h=d.current;for(const p of new Set(h.getState().knownAtoms))bI(h,p,"get");return()=>{for(const p of h.getState().knownAtoms)EI(h,p)}},[d]),ve.createElement(MS.Provider,{value:d},ve.createElement(kS.Provider,{value:f},ve.createElement(NI,{setNotifyBatcherOfChange:u}),r))}function BI(t){const{override:e,...n}=t,r=jf();return e===!1&&r.current!==LS?t.children:ve.createElement(UI,n)}function zI(){return jf().current.storeID}var Er={RecoilRoot:BI,useStoreRef:jf,useRecoilMutableSource:II,useRecoilStoreID:zI,notifyComponents_FOR_TESTING:a0,sendEndOfBatchNotifications_FOR_TESTING:IS};function jI(t,e){if(t===e)return!0;if(t.length!==e.length)return!1;for(let n=0,r=t.length;n<r;n++)if(t[n]!==e[n])return!1;return!0}var VI=jI;const{useEffect:$I,useRef:GI}=ve;function WI(t){const e=GI();return $I(()=>{e.current=t}),e.current}var OS=WI;const{useStoreRef:HI}=Er,{SUSPENSE_TIMEOUT_MS:YI}=Xi,{updateRetainCount:Bo}=Xi,{RetentionZone:XI}=Of,{useEffect:KI,useRef:qI}=ve,{isSSR:Yy}=Ff;function ZI(t){if(ke("recoil_memory_managament_2020"))return QI(t)}function QI(t){const n=(Array.isArray(t)?t:[t]).map(o=>o instanceof XI?o:o.key),r=HI();KI(()=>{if(!ke("recoil_memory_managament_2020"))return;const o=r.current;if(i.current&&!Yy)window.clearTimeout(i.current),i.current=null;else for(const a of n)Bo(o,a,1);return()=>{for(const a of n)Bo(o,a,-1)}},[r,...n]);const i=qI(),s=OS(n);if(!Yy&&(s===void 0||!VI(s,n))){const o=r.current;for(const a of n)Bo(o,a,1);if(s)for(const a of s)Bo(o,a,-1);i.current&&window.clearTimeout(i.current),i.current=window.setTimeout(()=>{i.current=null;for(const a of n)Bo(o,a,-1)},YI)}}var l0=ZI;function JI(){return"<component name not available>"}var fl=JI;const{batchUpdates:eO}=Df,{DEFAULT_VALUE:NS}=jt,{currentRendererSupportsUseSyncExternalStore:tO,reactMode:_o,useMutableSource:nO,useSyncExternalStore:rO}=ll,{useRecoilMutableSource:iO,useStoreRef:Yn}=Er,{AbstractRecoilValue:ng,getRecoilValueAsLoadable:dl,setRecoilValue:Iu,setUnvalidatedRecoilValue:sO,subscribeToRecoilValue:Qs}=Hn,{useCallback:Bt,useEffect:Js,useMemo:DS,useRef:_a,useState:c0}=ve,{setByAddingToSet:oO}=rS,{isSSR:aO}=Ff;function u0(t,e,n){if(t.state==="hasValue")return t.contents;throw t.state==="loading"?new Promise(i=>{const s=n.current.getState().suspendedComponentResolvers;s.add(i),aO&&Ve(t.contents)&&t.contents.finally(()=>{s.delete(i)})}):t.state==="hasError"?t.contents:me(`Invalid value of loadable atom "${e.key}"`)}function lO(){const t=fl(),e=Yn(),[,n]=c0([]),r=_a(new Set);r.current=new Set;const i=_a(new Set),s=_a(new Map),o=Bt(l=>{const c=s.current.get(l);c&&(c.release(),s.current.delete(l))},[s]),a=Bt((l,c)=>{s.current.has(c)&&n([])},[]);return Js(()=>{const l=e.current;va(r.current,i.current).forEach(c=>{if(s.current.has(c))return;const u=Qs(l,new ng(c),f=>a(f,c),t);s.current.set(c,u),l.getState().nextTree?l.getState().queuedComponentCallbacks_DEPRECATED.push(()=>{a(l.getState(),c)}):a(l.getState(),c)}),va(i.current,r.current).forEach(c=>{o(c)}),i.current=r.current}),Js(()=>{const l=s.current;return va(r.current,new Set(l.keys())).forEach(c=>{const u=Qs(e.current,new ng(c),d=>a(d,c),t);l.set(c,u)}),()=>l.forEach((c,u)=>o(u))},[t,e,o,a]),DS(()=>{function l(p){return m=>{Iu(e.current,p,m)}}function c(p){return()=>Iu(e.current,p,NS)}function u(p){var m;r.current.has(p.key)||(r.current=oO(r.current,p.key));const E=e.current.getState();return dl(e.current,p,_o().early&&(m=E.nextTree)!==null&&m!==void 0?m:E.currentTree)}function d(p){const m=u(p);return u0(m,p,e)}function f(p){return[d(p),l(p)]}function h(p){return[u(p),l(p)]}return{getRecoilValue:d,getRecoilValueLoadable:u,getRecoilState:f,getRecoilStateLoadable:h,getSetRecoilState:l,getResetRecoilState:c}},[r,e])}const cO={current:0};function uO(t){const e=Yn(),n=fl(),r=Bt(()=>{var a;const l=e.current,c=l.getState(),u=_o().early&&(a=c.nextTree)!==null&&a!==void 0?a:c.currentTree;return{loadable:dl(l,t,u),key:t.key}},[e,t]),i=Bt(a=>{let l;return()=>{var c,u;const d=a();return(c=l)!==null&&c!==void 0&&c.loadable.is(d.loadable)&&((u=l)===null||u===void 0?void 0:u.key)===d.key?l:(l=d,d)}},[]),s=DS(()=>i(r),[r,i]),o=Bt(a=>{const l=e.current;return Qs(l,t,a,n).release},[e,t,n]);return rO(o,s,s).loadable}function fO(t){const e=Yn(),n=Bt(()=>{var c;const u=e.current,d=u.getState(),f=_o().early&&(c=d.nextTree)!==null&&c!==void 0?c:d.currentTree;return dl(u,t,f)},[e,t]),r=Bt(()=>n(),[n]),i=fl(),s=Bt((c,u)=>{const d=e.current;return Qs(d,t,()=>{if(!ke("recoil_suppress_rerender_in_callback"))return u();const h=n();l.current.is(h)||u(),l.current=h},i).release},[e,t,i,n]),o=iO();if(o==null)throw me("Recoil hooks must be used in components contained within a <RecoilRoot> component.");const a=nO(o,r,s),l=_a(a);return Js(()=>{l.current=a}),a}function rg(t){const e=Yn(),n=fl(),r=Bt(()=>{var l;const c=e.current,u=c.getState(),d=_o().early&&(l=u.nextTree)!==null&&l!==void 0?l:u.currentTree;return dl(c,t,d)},[e,t]),i=Bt(()=>({loadable:r(),key:t.key}),[r,t.key]),s=Bt(l=>{const c=i();return l.loadable.is(c.loadable)&&l.key===c.key?l:c},[i]);Js(()=>{const l=Qs(e.current,t,c=>{a(s)},n);return a(s),l.release},[n,t,e,s]);const[o,a]=c0(i);return o.key!==t.key?i().loadable:o.loadable}function dO(t){const e=Yn(),[,n]=c0([]),r=fl(),i=Bt(()=>{var a;const l=e.current,c=l.getState(),u=_o().early&&(a=c.nextTree)!==null&&a!==void 0?a:c.currentTree;return dl(l,t,u)},[e,t]),s=i(),o=_a(s);return Js(()=>{o.current=s}),Js(()=>{const a=e.current,l=a.getState(),c=Qs(a,t,d=>{var f;if(!ke("recoil_suppress_rerender_in_callback"))return n([]);const h=i();(f=o.current)!==null&&f!==void 0&&f.is(h)||n(h),o.current=h},r);if(l.nextTree)a.getState().queuedComponentCallbacks_DEPRECATED.push(()=>{o.current=null,n([])});else{var u;if(!ke("recoil_suppress_rerender_in_callback"))return n([]);const d=i();(u=o.current)!==null&&u!==void 0&&u.is(d)||n(d),o.current=d}return c.release},[r,i,t,e]),s}function f0(t){return ke("recoil_memory_managament_2020")&&l0(t),{TRANSITION_SUPPORT:rg,SYNC_EXTERNAL_STORE:tO()?uO:rg,MUTABLE_SOURCE:fO,LEGACY:dO}[_o().mode](t)}function FS(t){const e=Yn(),n=f0(t);return u0(n,t,e)}function Vf(t){const e=Yn();return Bt(n=>{Iu(e.current,t,n)},[e,t])}function hO(t){const e=Yn();return Bt(()=>{Iu(e.current,t,NS)},[e,t])}function pO(t){return[FS(t),Vf(t)]}function gO(t){return[f0(t),Vf(t)]}function mO(){const t=Yn();return(e,n={})=>{eO(()=>{t.current.addTransactionMetadata(n),e.forEach((r,i)=>sO(t.current,new ng(i),r))})}}function US(t){return ke("recoil_memory_managament_2020")&&l0(t),rg(t)}function BS(t){const e=Yn(),n=US(t);return u0(n,t,e)}function vO(t){return[BS(t),Vf(t)]}var yO={recoilComponentGetRecoilValueCount_FOR_TESTING:cO,useRecoilInterface:lO,useRecoilState:pO,useRecoilStateLoadable:gO,useRecoilValue:FS,useRecoilValueLoadable:f0,useResetRecoilState:hO,useSetRecoilState:Vf,useSetUnvalidatedAtomValues:mO,useRecoilValueLoadable_TRANSITION_SUPPORT_UNSTABLE:US,useRecoilValue_TRANSITION_SUPPORT_UNSTABLE:BS,useRecoilState_TRANSITION_SUPPORT_UNSTABLE:vO};function _O(t,e){const n=new Map;for(const[r,i]of t)e(i,r)&&n.set(r,i);return n}var EO=_O;function wO(t,e){const n=new Set;for(const r of t)e(r)&&n.add(r);return n}var bO=wO;function xO(...t){const e=new Map;for(let n=0;n<t.length;n++){const r=t[n].keys();let i;for(;!(i=r.next()).done;)e.set(i.value,t[n].get(i.value))}return e}var SO=xO;const{batchUpdates:TO}=Df,{DEFAULT_VALUE:AO,getNode:zS,nodes:CO}=jt,{useStoreRef:d0}=Er,{AbstractRecoilValue:PO,setRecoilValueLoadable:RO}=Hn,{SUSPENSE_TIMEOUT_MS:LO}=Xi,{cloneSnapshot:Ou}=zf,{useCallback:$f,useEffect:jS,useRef:Xy,useState:MO}=ve,{isSSR:Ky}=Ff;function Gf(t){const e=d0();jS(()=>e.current.subscribeToTransactions(t).release,[t,e])}function qy(t){const e=t.atomValues.toMap(),n=ku(EO(e,(r,i)=>{const o=zS(i).persistence_UNSTABLE;return o!=null&&o.type!=="none"&&r.state==="hasValue"}),r=>r.contents);return SO(t.nonvalidatedAtoms.toMap(),n)}function kO(t){Gf($f(e=>{let n=e.getState().previousTree;const r=e.getState().currentTree;n||(n=e.getState().currentTree);const i=qy(r),s=qy(n),o=ku(CO,l=>{var c,u,d,f;return{persistence_UNSTABLE:{type:(c=(u=l.persistence_UNSTABLE)===null||u===void 0?void 0:u.type)!==null&&c!==void 0?c:"none",backButton:(d=(f=l.persistence_UNSTABLE)===null||f===void 0?void 0:f.backButton)!==null&&d!==void 0?d:!1}}}),a=bO(r.dirtyAtoms,l=>i.has(l)||s.has(l));t({atomValues:i,previousAtomValues:s,atomInfo:o,modifiedAtoms:a,transactionMetadata:{...r.transactionMetadata}})},[t]))}function IO(t){Gf($f(e=>{const n=Ou(e,"latest"),r=Ou(e,"previous");t({snapshot:n,previousSnapshot:r})},[t]))}function OO(){const t=d0(),[e,n]=MO(()=>Ou(t.current)),r=OS(e),i=Xy(),s=Xy();if(Gf($f(a=>n(Ou(a)),[])),jS(()=>{const a=e.retain();if(i.current&&!Ky){var l;window.clearTimeout(i.current),i.current=null,(l=s.current)===null||l===void 0||l.call(s),s.current=null}return()=>{window.setTimeout(a,10)}},[e]),r!==e&&!Ky){if(i.current){var o;window.clearTimeout(i.current),i.current=null,(o=s.current)===null||o===void 0||o.call(s),s.current=null}s.current=e.retain(),i.current=window.setTimeout(()=>{var a;i.current=null,(a=s.current)===null||a===void 0||a.call(s),s.current=null},LO)}return e}function VS(t,e){var n;const r=t.getState(),i=(n=r.nextTree)!==null&&n!==void 0?n:r.currentTree,s=e.getStore_INTERNAL().getState().currentTree;TO(()=>{const o=new Set;for(const c of[i.atomValues.keys(),s.atomValues.keys()])for(const u of c){var a,l;((a=i.atomValues.get(u))===null||a===void 0?void 0:a.contents)!==((l=s.atomValues.get(u))===null||l===void 0?void 0:l.contents)&&zS(u).shouldRestoreFromSnapshots&&o.add(u)}o.forEach(c=>{RO(t,new PO(c),s.atomValues.has(c)?We(s.atomValues.get(c)):AO)}),t.replaceState(c=>({...c,stateID:e.getID()}))})}function NO(){const t=d0();return $f(e=>VS(t.current,e),[t])}var $S={useRecoilSnapshot:OO,gotoSnapshot:VS,useGotoRecoilSnapshot:NO,useRecoilTransactionObserver:IO,useTransactionObservation_DEPRECATED:kO,useTransactionSubscription_DEPRECATED:Gf};const{peekNodeInfo:DO}=ci,{useStoreRef:FO}=Er;function UO(){const t=FO();return({key:e})=>DO(t.current,t.current.getState().currentTree,e)}var BO=UO;const{reactMode:zO}=ll,{RecoilRoot:jO,useStoreRef:VO}=Er,{useMemo:$O}=ve;function GO(){zO().mode==="MUTABLE_SOURCE"&&console.warn("Warning: There are known issues using useRecoilBridgeAcrossReactRoots() in recoil_mutable_source rendering mode.  Please consider upgrading to recoil_sync_external_store mode.");const t=VO().current;return $O(()=>{function e({children:n}){return ve.createElement(jO,{store_INTERNAL:t},n)}return e},[t])}var WO=GO;const{loadableWithValue:HO}=al,{initializeNode:YO}=ci,{DEFAULT_VALUE:XO,getNode:KO}=jt,{copyTreeState:qO,getRecoilValueAsLoadable:ZO,invalidateDownstreams:QO,writeLoadableToTreeState:JO}=Hn;function Zy(t){return KO(t.key).nodeType==="atom"}class e3{constructor(e,n){pe(this,"_store",void 0),pe(this,"_treeState",void 0),pe(this,"_changes",void 0),pe(this,"get",r=>{if(this._changes.has(r.key))return this._changes.get(r.key);if(!Zy(r))throw me("Reading selectors within atomicUpdate is not supported");const i=ZO(this._store,r,this._treeState);if(i.state==="hasValue")return i.contents;throw i.state==="hasError"?i.contents:me(`Expected Recoil atom ${r.key} to have a value, but it is in a loading state.`)}),pe(this,"set",(r,i)=>{if(!Zy(r))throw me("Setting selectors within atomicUpdate is not supported");if(typeof i=="function"){const s=this.get(r);this._changes.set(r.key,i(s))}else YO(this._store,r.key,"set"),this._changes.set(r.key,i)}),pe(this,"reset",r=>{this.set(r,XO)}),this._store=e,this._treeState=n,this._changes=new Map}newTreeState_INTERNAL(){if(this._changes.size===0)return this._treeState;const e=qO(this._treeState);for(const[n,r]of this._changes)JO(e,n,HO(r));return QO(this._store,e),e}}function t3(t){return e=>{t.replaceState(n=>{const r=new e3(t,n);return e(r),r.newTreeState_INTERNAL()})}}var n3={atomicUpdater:t3},r3=n3.atomicUpdater,GS=Object.freeze({__proto__:null,atomicUpdater:r3});function i3(t,e){if(!t)throw new Error(e)}var s3=i3,na=s3;const{atomicUpdater:o3}=GS,{batchUpdates:a3}=Df,{DEFAULT_VALUE:l3}=jt,{useStoreRef:c3}=Er,{refreshRecoilValue:u3,setRecoilValue:Qy}=Hn,{cloneSnapshot:f3}=zf,{gotoSnapshot:d3}=$S,{useCallback:h3}=ve;class WS{}const p3=new WS;function HS(t,e,n,r){let i=p3,s;if(a3(()=>{const a="useRecoilCallback() expects a function that returns a function: it accepts a function of the type (RecoilInterface) => (Args) => ReturnType and returns a callback function (Args) => ReturnType, where RecoilInterface is an object {snapshot, set, ...} and Args and ReturnType are the argument and return types of the callback you want to create.  Please see the docs at recoiljs.org for details.";if(typeof e!="function")throw me(a);const l=iS({...r??{},set:(u,d)=>Qy(t,u,d),reset:u=>Qy(t,u,l3),refresh:u=>u3(t,u),gotoSnapshot:u=>d3(t,u),transact_UNSTABLE:u=>o3(t)(u)},{snapshot:()=>{const u=f3(t);return s=u.retain(),u}}),c=e(l);if(typeof c!="function")throw me(a);i=c(...n)}),i instanceof WS&&na(!1),Ve(i))i=i.finally(()=>{var a;(a=s)===null||a===void 0||a()});else{var o;(o=s)===null||o===void 0||o()}return i}function g3(t,e){const n=c3();return h3((...r)=>HS(n.current,t,r),e!=null?[...e,n]:void 0)}var YS={recoilCallback:HS,useRecoilCallback:g3};const{useStoreRef:m3}=Er,{refreshRecoilValue:v3}=Hn,{useCallback:y3}=ve;function _3(t){const e=m3();return y3(()=>{const n=e.current;v3(n,t)},[t,e])}var E3=_3;const{atomicUpdater:w3}=GS,{useStoreRef:b3}=Er,{useMemo:x3}=ve;function S3(t,e){const n=b3();return x3(()=>(...r)=>{w3(n.current)(s=>{t(s)(...r)})},e!=null?[...e,n]:void 0)}var T3=S3;class A3{constructor(e){pe(this,"value",void 0),this.value=e}}var C3={WrappedValue:A3},P3=C3.WrappedValue,XS=Object.freeze({__proto__:null,WrappedValue:P3});const{isFastRefreshEnabled:R3}=ll;class Jy extends Error{}class L3{constructor(e){var n,r,i;pe(this,"_name",void 0),pe(this,"_numLeafs",void 0),pe(this,"_root",void 0),pe(this,"_onHit",void 0),pe(this,"_onSet",void 0),pe(this,"_mapNodeValue",void 0),this._name=e==null?void 0:e.name,this._numLeafs=0,this._root=null,this._onHit=(n=e==null?void 0:e.onHit)!==null&&n!==void 0?n:()=>{},this._onSet=(r=e==null?void 0:e.onSet)!==null&&r!==void 0?r:()=>{},this._mapNodeValue=(i=e==null?void 0:e.mapNodeValue)!==null&&i!==void 0?i:s=>s}size(){return this._numLeafs}root(){return this._root}get(e,n){var r;return(r=this.getLeafNode(e,n))===null||r===void 0?void 0:r.value}getLeafNode(e,n){if(this._root==null)return;let r=this._root;for(;r;){if(n==null||n.onNodeVisit(r),r.type==="leaf")return this._onHit(r),r;const i=this._mapNodeValue(e(r.nodeKey));r=r.branches.get(i)}}set(e,n,r){const i=()=>{var s,o,a,l;let c,u;for(const[E,v]of e){var d,f,h;const g=this._root;if((g==null?void 0:g.type)==="leaf")throw this.invalidCacheError();const y=c;if(c=y?y.branches.get(u):g,c=(d=c)!==null&&d!==void 0?d:{type:"branch",nodeKey:E,parent:y,branches:new Map,branchKey:u},c.type!=="branch"||c.nodeKey!==E)throw this.invalidCacheError();y==null||y.branches.set(u,c),r==null||(f=r.onNodeVisit)===null||f===void 0||f.call(r,c),u=this._mapNodeValue(v),this._root=(h=this._root)!==null&&h!==void 0?h:c}const p=c?(s=c)===null||s===void 0?void 0:s.branches.get(u):this._root;if(p!=null&&(p.type!=="leaf"||p.branchKey!==u))throw this.invalidCacheError();const m={type:"leaf",value:n,parent:c,branchKey:u};(o=c)===null||o===void 0||o.branches.set(u,m),this._root=(a=this._root)!==null&&a!==void 0?a:m,this._numLeafs++,this._onSet(m),r==null||(l=r.onNodeVisit)===null||l===void 0||l.call(r,m)};try{i()}catch(s){if(s instanceof Jy)this.clear(),i();else throw s}}delete(e){const n=this.root();if(!n)return!1;if(e===n)return this._root=null,this._numLeafs=0,!0;let r=e.parent,i=e.branchKey;for(;r;){var s;if(r.branches.delete(i),r===n)return r.branches.size===0?(this._root=null,this._numLeafs=0):this._numLeafs--,!0;if(r.branches.size>0)break;i=(s=r)===null||s===void 0?void 0:s.branchKey,r=r.parent}for(;r!==n;r=r.parent)if(r==null)return!1;return this._numLeafs--,!0}clear(){this._numLeafs=0,this._root=null}invalidCacheError(){const e=R3()?"Possible Fast Refresh module reload detected.  This may also be caused by an selector returning inconsistent values. Resetting cache.":"Invalid cache values.  This happens when selectors do not return consistent values for the same input dependency values.  That may also be caused when using Fast Refresh to change a selector implementation.  Resetting cache.";throw Qm(e+(this._name!=null?` - ${this._name}`:"")),new Jy}}var M3={TreeCache:L3},k3=M3.TreeCache,KS=Object.freeze({__proto__:null,TreeCache:k3});let I3=class{constructor(e){var n;pe(this,"_maxSize",void 0),pe(this,"_size",void 0),pe(this,"_head",void 0),pe(this,"_tail",void 0),pe(this,"_map",void 0),pe(this,"_keyMapper",void 0),this._maxSize=e.maxSize,this._size=0,this._head=null,this._tail=null,this._map=new Map,this._keyMapper=(n=e.mapKey)!==null&&n!==void 0?n:r=>r}head(){return this._head}tail(){return this._tail}size(){return this._size}maxSize(){return this._maxSize}has(e){return this._map.has(this._keyMapper(e))}get(e){const n=this._keyMapper(e),r=this._map.get(n);if(r)return this.set(e,r.value),r.value}set(e,n){const r=this._keyMapper(e);this._map.get(r)&&this.delete(e);const s=this.head(),o={key:e,right:s,left:null,value:n};s?s.left=o:this._tail=o,this._map.set(r,o),this._head=o,this._size++,this._maybeDeleteLRU()}_maybeDeleteLRU(){this.size()>this.maxSize()&&this.deleteLru()}deleteLru(){const e=this.tail();e&&this.delete(e.key)}delete(e){const n=this._keyMapper(e);if(!this._size||!this._map.has(n))return;const r=We(this._map.get(n)),i=r.right,s=r.left;i&&(i.left=r.left),s&&(s.right=r.right),r===this.head()&&(this._head=i),r===this.tail()&&(this._tail=s),this._map.delete(n),this._size--}clear(){this._size=0,this._head=null,this._tail=null,this._map=new Map}};var O3={LRUCache:I3},N3=O3.LRUCache,qS=Object.freeze({__proto__:null,LRUCache:N3});const{LRUCache:D3}=qS,{TreeCache:F3}=KS;function U3({name:t,maxSize:e,mapNodeValue:n=r=>r}){const r=new D3({maxSize:e}),i=new F3({name:t,mapNodeValue:n,onHit:s=>{r.set(s,!0)},onSet:s=>{const o=r.tail();r.set(s,!0),o&&i.size()>e&&i.delete(o.key)}});return i}var e_=U3;function yn(t,e,n){if(typeof t=="string"&&!t.includes('"')&&!t.includes("\\"))return`"${t}"`;switch(typeof t){case"undefined":return"";case"boolean":return t?"true":"false";case"number":case"symbol":return String(t);case"string":return JSON.stringify(t);case"function":if((e==null?void 0:e.allowFunctions)!==!0)throw me("Attempt to serialize function in a Recoil cache key");return`__FUNCTION(${t.name})__`}if(t===null)return"null";if(typeof t!="object"){var r;return(r=JSON.stringify(t))!==null&&r!==void 0?r:""}if(Ve(t))return"__PROMISE__";if(Array.isArray(t))return`[${t.map((i,s)=>yn(i,e,s.toString()))}]`;if(typeof t.toJSON=="function")return yn(t.toJSON(n),e,n);if(t instanceof Map){const i={};for(const[s,o]of t)i[typeof s=="string"?s:yn(s,e)]=o;return yn(i,e,n)}return t instanceof Set?yn(Array.from(t).sort((i,s)=>yn(i,e).localeCompare(yn(s,e))),e,n):Symbol!==void 0&&t[Symbol.iterator]!=null&&typeof t[Symbol.iterator]=="function"?yn(Array.from(t),e,n):`{${Object.keys(t).filter(i=>t[i]!==void 0).sort().map(i=>`${yn(i,e)}:${yn(t[i],e,i)}`).join(",")}}`}function B3(t,e={allowFunctions:!1}){return yn(t,e)}var Wf=B3;const{TreeCache:z3}=KS,sc={equality:"reference",eviction:"keep-all",maxSize:1/0};function j3({equality:t=sc.equality,eviction:e=sc.eviction,maxSize:n=sc.maxSize}=sc,r){const i=V3(t);return $3(e,n,i,r)}function V3(t){switch(t){case"reference":return e=>e;case"value":return e=>Wf(e)}throw me(`Unrecognized equality policy ${t}`)}function $3(t,e,n,r){switch(t){case"keep-all":return new z3({name:r,mapNodeValue:n});case"lru":return e_({name:r,maxSize:We(e),mapNodeValue:n});case"most-recent":return e_({name:r,maxSize:1,mapNodeValue:n})}throw me(`Unrecognized eviction policy ${t}`)}var G3=j3;function W3(t){return()=>null}var H3={startPerfBlock:W3};const{isLoadable:Y3,loadableWithError:oc,loadableWithPromise:X3,loadableWithValue:nh}=al,{WrappedValue:ZS}=XS,{getNodeLoadable:ac,peekNodeLoadable:K3,setNodeValue:q3}=ci,{saveDepsToStore:Z3}=cl,{DEFAULT_VALUE:Q3,getConfigDeletionHandler:J3,getNode:eN,registerNode:t_}=jt,{isRecoilValue:tN}=Zs,{markRecoilValueModified:n_}=Hn,{retainedByOptionWithDefault:nN}=Xi,{recoilCallback:rN}=YS,{startPerfBlock:iN}=H3;class QS{}const zo=new QS,jo=[],lc=new Map,sN=(()=>{let t=0;return()=>t++})();function JS(t){let e=null;const{key:n,get:r,cachePolicy_UNSTABLE:i}=t,s=t.set!=null?t.set:void 0,o=new Set,a=G3(i??{equality:"reference",eviction:"keep-all"},n),l=nN(t.retainedBy_UNSTABLE),c=new Map;let u=0;function d(){return!ke("recoil_memory_managament_2020")||u>0}function f(M){return M.getState().knownSelectors.add(n),u++,()=>{u--}}function h(){return J3(n)!==void 0&&!d()}function p(M,V,U,oe,Q){de(V,oe,Q),m(M,U)}function m(M,V){W(M,V)&&G(M),v(V,!0)}function E(M,V){W(M,V)&&(We(N(M)).stateVersions.clear(),v(V,!1))}function v(M,V){const U=lc.get(M);if(U!=null){for(const oe of U)n_(oe,We(e));V&&lc.delete(M)}}function g(M,V){let U=lc.get(V);U==null&&lc.set(V,U=new Set),U.add(M)}function y(M,V,U,oe,Q,ie){return V.then(fe=>{if(!d())throw G(M),zo;const X=nh(fe);return p(M,U,Q,X,oe),fe}).catch(fe=>{if(!d())throw G(M),zo;if(Ve(fe))return b(M,fe,U,oe,Q,ie);const X=oc(fe);throw p(M,U,Q,X,oe),fe})}function b(M,V,U,oe,Q,ie){return V.then(fe=>{if(!d())throw G(M),zo;ie.loadingDepKey!=null&&ie.loadingDepPromise===V?U.atomValues.set(ie.loadingDepKey,nh(fe)):M.getState().knownSelectors.forEach(_e=>{U.atomValues.delete(_e)});const X=R(M,U);if(X&&X.state!=="loading"){if((W(M,Q)||N(M)==null)&&m(M,Q),X.state==="hasValue")return X.contents;throw X.contents}if(!W(M,Q)){const _e=D(M,U);if(_e!=null)return _e.loadingLoadable.contents}const[he,Ie]=A(M,U,Q);if(he.state!=="loading"&&p(M,U,Q,he,Ie),he.state==="hasError")throw he.contents;return he.contents}).catch(fe=>{if(fe instanceof QS)throw zo;if(!d())throw G(M),zo;const X=oc(fe);throw p(M,U,Q,X,oe),fe})}function T(M,V,U,oe){var Q,ie,fe,X;if(W(M,oe)||V.version===((Q=M.getState())===null||Q===void 0||(ie=Q.currentTree)===null||ie===void 0?void 0:ie.version)||V.version===((fe=M.getState())===null||fe===void 0||(X=fe.nextTree)===null||X===void 0?void 0:X.version)){var he,Ie,_e;Z3(n,U,M,(he=(Ie=M.getState())===null||Ie===void 0||(_e=Ie.nextTree)===null||_e===void 0?void 0:_e.version)!==null&&he!==void 0?he:M.getState().currentTree.version)}for(const Te of U)o.add(Te)}function A(M,V,U){const oe=iN(n);let Q=!0,ie=!0;const fe=()=>{oe(),ie=!1};let X,he=!1,Ie;const _e={loadingDepKey:null,loadingDepPromise:null},Te=new Map;function Ze({key:Oe}){const Be=ac(M,V,Oe);switch(Te.set(Oe,Be),Q||(T(M,V,new Set(Te.keys()),U),E(M,U)),Be.state){case"hasValue":return Be.contents;case"hasError":throw Be.contents;case"loading":throw _e.loadingDepKey=Oe,_e.loadingDepPromise=Be.contents,Be.contents}throw me("Invalid Loadable state")}const Se=Oe=>(...Be)=>{if(ie)throw me("Callbacks from getCallback() should only be called asynchronously after the selector is evalutated.  It can be used for selectors to return objects with callbacks that can work with Recoil state without a subscription.");return e==null&&na(!1),rN(M,Oe,Be,{node:e})};try{X=r({get:Ze,getCallback:Se}),X=tN(X)?Ze(X):X,Y3(X)&&(X.state==="hasError"&&(he=!0),X=X.contents),Ve(X)?X=y(M,X,V,Te,U,_e).finally(fe):fe(),X=X instanceof ZS?X.value:X}catch(Oe){X=Oe,Ve(X)?X=b(M,X,V,Te,U,_e).finally(fe):(he=!0,fe())}return he?Ie=oc(X):Ve(X)?Ie=X3(X):Ie=nh(X),Q=!1,q(M,U,Te),T(M,V,new Set(Te.keys()),U),[Ie,Te]}function R(M,V){let U=V.atomValues.get(n);if(U!=null)return U;const oe=new Set;try{U=a.get(ie=>(typeof ie!="string"&&na(!1),ac(M,V,ie).contents),{onNodeVisit:ie=>{ie.type==="branch"&&ie.nodeKey!==n&&oe.add(ie.nodeKey)}})}catch(ie){throw me(`Problem with cache lookup for selector "${n}": ${ie.message}`)}if(U){var Q;V.atomValues.set(n,U),T(M,V,oe,(Q=N(M))===null||Q===void 0?void 0:Q.executionID)}return U}function I(M,V){const U=R(M,V);if(U!=null)return G(M),U;const oe=D(M,V);if(oe!=null){var Q;return((Q=oe.loadingLoadable)===null||Q===void 0?void 0:Q.state)==="loading"&&g(M,oe.executionID),oe.loadingLoadable}const ie=sN(),[fe,X]=A(M,V,ie);return fe.state==="loading"?(F(M,ie,fe,X,V),g(M,ie)):(G(M),de(V,fe,X)),fe}function D(M,V){const U=wS([c.has(M)?[We(c.get(M))]:[],kf(r0(c,([Q])=>Q!==M),([,Q])=>Q)]);function oe(Q){for(const[ie,fe]of Q)if(!ac(M,V,ie).is(fe))return!0;return!1}for(const Q of U){if(Q.stateVersions.get(V.version)||!oe(Q.depValuesDiscoveredSoFarDuringAsyncWork))return Q.stateVersions.set(V.version,!0),Q;Q.stateVersions.set(V.version,!1)}}function N(M){return c.get(M)}function F(M,V,U,oe,Q){c.set(M,{depValuesDiscoveredSoFarDuringAsyncWork:oe,executionID:V,loadingLoadable:U,stateVersions:new Map([[Q.version,!0]])})}function q(M,V,U){if(W(M,V)){const oe=N(M);oe!=null&&(oe.depValuesDiscoveredSoFarDuringAsyncWork=U)}}function G(M){c.delete(M)}function W(M,V){var U;return V===((U=N(M))===null||U===void 0?void 0:U.executionID)}function xe(M){return Array.from(M.entries()).map(([V,U])=>[V,U.contents])}function de(M,V,U){M.atomValues.set(n,V);try{a.set(xe(U),V)}catch(oe){throw me(`Problem with setting cache for selector "${n}": ${oe.message}`)}}function Pe(M){if(jo.includes(n)){const V=`Recoil selector has circular dependencies: ${jo.slice(jo.indexOf(n)).join(" → ")}`;return oc(me(V))}jo.push(n);try{return M()}finally{jo.pop()}}function z(M,V){const U=V.atomValues.get(n);return U??a.get(oe=>{var Q;return typeof oe!="string"&&na(!1),(Q=K3(M,V,oe))===null||Q===void 0?void 0:Q.contents})}function ne(M,V){return Pe(()=>I(M,V))}function Y(M){M.atomValues.delete(n)}function re(M,V){e==null&&na(!1);for(const oe of o){var U;const Q=eN(oe);(U=Q.clearCache)===null||U===void 0||U.call(Q,M,V)}o.clear(),Y(V),a.clear(),n_(M,e)}return s!=null?e=t_({key:n,nodeType:"selector",peek:z,get:ne,set:(V,U,oe)=>{let Q=!1;const ie=new Map;function fe({key:_e}){if(Q)throw me("Recoil: Async selector sets are not currently supported.");const Te=ac(V,U,_e);if(Te.state==="hasValue")return Te.contents;if(Te.state==="loading"){const Ze=`Getting value of asynchronous atom or selector "${_e}" in a pending state while setting selector "${n}" is not yet supported.`;throw me(Ze)}else throw Te.contents}function X(_e,Te){if(Q)throw me("Recoil: Async selector sets are not currently supported.");const Ze=typeof Te=="function"?Te(fe(_e)):Te;q3(V,U,_e.key,Ze).forEach((Oe,Be)=>ie.set(Be,Oe))}function he(_e){X(_e,Q3)}const Ie=s({set:X,get:fe,reset:he},oe);if(Ie!==void 0)throw Ve(Ie)?me("Recoil: Async selector sets are not currently supported."):me("Recoil: selector set should be a void function.");return Q=!0,ie},init:f,invalidate:Y,clearCache:re,shouldDeleteConfigOnRelease:h,dangerouslyAllowMutability:t.dangerouslyAllowMutability,shouldRestoreFromSnapshots:!1,retainedBy:l}):e=t_({key:n,nodeType:"selector",peek:z,get:ne,init:f,invalidate:Y,clearCache:re,shouldDeleteConfigOnRelease:h,dangerouslyAllowMutability:t.dangerouslyAllowMutability,shouldRestoreFromSnapshots:!1,retainedBy:l})}JS.value=t=>new ZS(t);var eo=JS;const{isLoadable:oN,loadableWithError:rh,loadableWithPromise:ih,loadableWithValue:rs}=al,{WrappedValue:eT}=XS,{peekNodeInfo:aN}=ci,{DEFAULT_VALUE:xi,DefaultValue:Fr,getConfigDeletionHandler:tT,registerNode:lN,setConfigDeletionHandler:cN}=jt,{isRecoilValue:uN}=Zs,{getRecoilValueAsLoadable:fN,markRecoilValueModified:dN,setRecoilValue:r_,setRecoilValueLoadable:hN}=Hn,{retainedByOptionWithDefault:pN}=Xi,Vo=t=>t instanceof eT?t.value:t;function gN(t){const{key:e,persistence_UNSTABLE:n}=t,r=pN(t.retainedBy_UNSTABLE);let i=0;function s(g){return ih(g.then(y=>(o=rs(y),y)).catch(y=>{throw o=rh(y),y}))}let o=Ve(t.default)?s(t.default):oN(t.default)?t.default.state==="loading"?s(t.default.contents):t.default:rs(Vo(t.default));o.contents;let a;const l=new Map;function c(g){return g}function u(g,y){const b=y.then(T=>{var A,R;return((R=((A=g.getState().nextTree)!==null&&A!==void 0?A:g.getState().currentTree).atomValues.get(e))===null||R===void 0?void 0:R.contents)===b&&r_(g,v,T),T}).catch(T=>{var A,R;throw((R=((A=g.getState().nextTree)!==null&&A!==void 0?A:g.getState().currentTree).atomValues.get(e))===null||R===void 0?void 0:R.contents)===b&&hN(g,v,rh(T)),T});return b}function d(g,y,b){var T;i++;const A=()=>{var N;i--,(N=l.get(g))===null||N===void 0||N.forEach(F=>F()),l.delete(g)};if(g.getState().knownAtoms.add(e),o.state==="loading"){const N=()=>{var F;((F=g.getState().nextTree)!==null&&F!==void 0?F:g.getState().currentTree).atomValues.has(e)||dN(g,v)};o.contents.finally(N)}const R=(T=t.effects)!==null&&T!==void 0?T:t.effects_UNSTABLE;if(R!=null){let W=function(Y){if(F&&Y.key===e){const re=N;return re instanceof Fr?f(g,y):Ve(re)?ih(re.then(M=>M instanceof Fr?o.toPromise():M)):rs(re)}return fN(g,Y)},xe=function(Y){return W(Y).toPromise()},de=function(Y){var re;const M=aN(g,(re=g.getState().nextTree)!==null&&re!==void 0?re:g.getState().currentTree,Y.key);return F&&Y.key===e&&!(N instanceof Fr)?{...M,isSet:!0,loadable:W(Y)}:M},N=xi,F=!0,q=!1,G=null;const Pe=Y=>re=>{if(F){const M=W(v),V=M.state==="hasValue"?M.contents:xi;N=typeof re=="function"?re(V):re,Ve(N)&&(N=N.then(U=>(G={effect:Y,value:U},U)))}else{if(Ve(re))throw me("Setting atoms to async values is not implemented.");typeof re!="function"&&(G={effect:Y,value:Vo(re)}),r_(g,v,typeof re=="function"?M=>{const V=Vo(re(M));return G={effect:Y,value:V},V}:Vo(re))}},z=Y=>()=>Pe(Y)(xi),ne=Y=>re=>{var M;const{release:V}=g.subscribeToTransactions(U=>{var oe;let{currentTree:Q,previousTree:ie}=U.getState();ie||(ie=Q);const fe=(oe=Q.atomValues.get(e))!==null&&oe!==void 0?oe:o;if(fe.state==="hasValue"){var X,he,Ie,_e;const Te=fe.contents,Ze=(X=ie.atomValues.get(e))!==null&&X!==void 0?X:o,Se=Ze.state==="hasValue"?Ze.contents:xi;((he=G)===null||he===void 0?void 0:he.effect)!==Y||((Ie=G)===null||Ie===void 0?void 0:Ie.value)!==Te?re(Te,Se,!Q.atomValues.has(e)):((_e=G)===null||_e===void 0?void 0:_e.effect)===Y&&(G=null)}},e);l.set(g,[...(M=l.get(g))!==null&&M!==void 0?M:[],V])};for(const Y of R)try{const re=Y({node:v,storeID:g.storeID,parentStoreID_UNSTABLE:g.parentStoreID,trigger:b,setSelf:Pe(Y),resetSelf:z(Y),onSet:ne(Y),getPromise:xe,getLoadable:W,getInfo_UNSTABLE:de});if(re!=null){var I;l.set(g,[...(I=l.get(g))!==null&&I!==void 0?I:[],re])}}catch(re){N=re,q=!0}if(F=!1,!(N instanceof Fr)){var D;const Y=q?rh(N):Ve(N)?ih(u(g,N)):rs(Vo(N));Y.contents,y.atomValues.set(e,Y),(D=g.getState().nextTree)===null||D===void 0||D.atomValues.set(e,Y)}}return A}function f(g,y){var b,T;return(b=(T=y.atomValues.get(e))!==null&&T!==void 0?T:a)!==null&&b!==void 0?b:o}function h(g,y){if(y.atomValues.has(e))return We(y.atomValues.get(e));if(y.nonvalidatedAtoms.has(e)){if(a!=null)return a;if(n==null)return o;const b=y.nonvalidatedAtoms.get(e),T=n.validator(b,xi);return a=T instanceof Fr?o:rs(T),a}else return o}function p(){a=void 0}function m(g,y,b){if(y.atomValues.has(e)){const T=We(y.atomValues.get(e));if(T.state==="hasValue"&&b===T.contents)return new Map}else if(!y.nonvalidatedAtoms.has(e)&&b instanceof Fr)return new Map;return a=void 0,new Map().set(e,rs(b))}function E(){return tT(e)!==void 0&&i<=0}const v=lN({key:e,nodeType:"atom",peek:f,get:h,set:m,init:d,invalidate:p,shouldDeleteConfigOnRelease:E,dangerouslyAllowMutability:t.dangerouslyAllowMutability,persistence_UNSTABLE:t.persistence_UNSTABLE?{type:t.persistence_UNSTABLE.type,backButton:t.persistence_UNSTABLE.backButton}:void 0,shouldRestoreFromSnapshots:!0,retainedBy:r});return v}function h0(t){const{...e}=t,n="default"in t?t.default:new Promise(()=>{});return uN(n)?mN({...e,default:n}):gN({...e,default:n})}function mN(t){const e=h0({...t,default:xi,persistence_UNSTABLE:t.persistence_UNSTABLE===void 0?void 0:{...t.persistence_UNSTABLE,validator:r=>r instanceof Fr?r:We(t.persistence_UNSTABLE).validator(r,xi)},effects:t.effects,effects_UNSTABLE:t.effects_UNSTABLE}),n=eo({key:`${t.key}__withFallback`,get:({get:r})=>{const i=r(e);return i instanceof Fr?t.default:i},set:({set:r},i)=>r(e,i),cachePolicy_UNSTABLE:{eviction:"most-recent"},dangerouslyAllowMutability:t.dangerouslyAllowMutability});return cN(n.key,tT(t.key)),n}h0.value=t=>new eT(t);var nT=h0;class vN{constructor(e){var n;pe(this,"_map",void 0),pe(this,"_keyMapper",void 0),this._map=new Map,this._keyMapper=(n=e==null?void 0:e.mapKey)!==null&&n!==void 0?n:r=>r}size(){return this._map.size}has(e){return this._map.has(this._keyMapper(e))}get(e){return this._map.get(this._keyMapper(e))}set(e,n){this._map.set(this._keyMapper(e),n)}delete(e){this._map.delete(this._keyMapper(e))}clear(){this._map.clear()}}var yN={MapCache:vN},_N=yN.MapCache,EN=Object.freeze({__proto__:null,MapCache:_N});const{LRUCache:i_}=qS,{MapCache:wN}=EN,cc={equality:"reference",eviction:"none",maxSize:1/0};function bN({equality:t=cc.equality,eviction:e=cc.eviction,maxSize:n=cc.maxSize}=cc){const r=xN(t);return SN(e,n,r)}function xN(t){switch(t){case"reference":return e=>e;case"value":return e=>Wf(e)}throw me(`Unrecognized equality policy ${t}`)}function SN(t,e,n){switch(t){case"keep-all":return new wN({mapKey:n});case"lru":return new i_({mapKey:n,maxSize:We(e)});case"most-recent":return new i_({mapKey:n,maxSize:1})}throw me(`Unrecognized eviction policy ${t}`)}var rT=bN;const{setConfigDeletionHandler:TN}=jt;function AN(t){var e,n;const r=rT({equality:(e=(n=t.cachePolicyForParams_UNSTABLE)===null||n===void 0?void 0:n.equality)!==null&&e!==void 0?e:"value",eviction:"keep-all"});return i=>{var s,o;const a=r.get(i);if(a!=null)return a;const{cachePolicyForParams_UNSTABLE:l,...c}=t,u="default"in t?t.default:new Promise(()=>{}),d=nT({...c,key:`${t.key}__${(s=Wf(i))!==null&&s!==void 0?s:"void"}`,default:typeof u=="function"?u(i):u,retainedBy_UNSTABLE:typeof t.retainedBy_UNSTABLE=="function"?t.retainedBy_UNSTABLE(i):t.retainedBy_UNSTABLE,effects:typeof t.effects=="function"?t.effects(i):typeof t.effects_UNSTABLE=="function"?t.effects_UNSTABLE(i):(o=t.effects)!==null&&o!==void 0?o:t.effects_UNSTABLE});return r.set(i,d),TN(d.key,()=>{r.delete(i)}),d}}var CN=AN;const{setConfigDeletionHandler:PN}=jt;let RN=0;function LN(t){var e,n;const r=rT({equality:(e=(n=t.cachePolicyForParams_UNSTABLE)===null||n===void 0?void 0:n.equality)!==null&&e!==void 0?e:"value",eviction:"keep-all"});return i=>{var s;let o;try{o=r.get(i)}catch(f){throw me(`Problem with cache lookup for selector ${t.key}: ${f.message}`)}if(o!=null)return o;const a=`${t.key}__selectorFamily/${(s=Wf(i,{allowFunctions:!0}))!==null&&s!==void 0?s:"void"}/${RN++}`,l=f=>t.get(i)(f),c=t.cachePolicy_UNSTABLE,u=typeof t.retainedBy_UNSTABLE=="function"?t.retainedBy_UNSTABLE(i):t.retainedBy_UNSTABLE;let d;if(t.set!=null){const f=t.set;d=eo({key:a,get:l,set:(p,m)=>f(i)(p,m),cachePolicy_UNSTABLE:c,dangerouslyAllowMutability:t.dangerouslyAllowMutability,retainedBy_UNSTABLE:u})}else d=eo({key:a,get:l,cachePolicy_UNSTABLE:c,dangerouslyAllowMutability:t.dangerouslyAllowMutability,retainedBy_UNSTABLE:u});return r.set(i,d),PN(d.key,()=>{r.delete(i)}),d}}var ui=LN;const MN=ui({key:"__constant",get:t=>()=>t,cachePolicyForParams_UNSTABLE:{equality:"reference"}});function kN(t){return MN(t)}var IN=kN;const ON=ui({key:"__error",get:t=>()=>{throw me(t)},cachePolicyForParams_UNSTABLE:{equality:"reference"}});function NN(t){return ON(t)}var DN=NN;function FN(t){return t}var UN=FN;const{loadableWithError:iT,loadableWithPromise:sT,loadableWithValue:oT}=al;function Hf(t,e){const n=Array(e.length).fill(void 0),r=Array(e.length).fill(void 0);for(const[i,s]of e.entries())try{n[i]=t(s)}catch(o){r[i]=o}return[n,r]}function BN(t){return t!=null&&!Ve(t)}function Yf(t){return Array.isArray(t)?t:Object.getOwnPropertyNames(t).map(e=>t[e])}function ig(t,e){return Array.isArray(t)?e:Object.getOwnPropertyNames(t).reduce((n,r,i)=>({...n,[r]:e[i]}),{})}function Fs(t,e,n){const r=n.map((i,s)=>i==null?oT(e[s]):Ve(i)?sT(i):iT(i));return ig(t,r)}function zN(t,e){return e.map((n,r)=>n===void 0?t[r]:n)}const jN=ui({key:"__waitForNone",get:t=>({get:e})=>{const n=Yf(t),[r,i]=Hf(e,n);return Fs(t,r,i)},dangerouslyAllowMutability:!0}),VN=ui({key:"__waitForAny",get:t=>({get:e})=>{const n=Yf(t),[r,i]=Hf(e,n);return i.some(s=>!Ve(s))?Fs(t,r,i):new Promise(s=>{for(const[o,a]of i.entries())Ve(a)&&a.then(l=>{r[o]=l,i[o]=void 0,s(Fs(t,r,i))}).catch(l=>{i[o]=l,s(Fs(t,r,i))})})},dangerouslyAllowMutability:!0}),$N=ui({key:"__waitForAll",get:t=>({get:e})=>{const n=Yf(t),[r,i]=Hf(e,n);if(i.every(o=>o==null))return ig(t,r);const s=i.find(BN);if(s!=null)throw s;return Promise.all(i).then(o=>ig(t,zN(r,o)))},dangerouslyAllowMutability:!0}),GN=ui({key:"__waitForAllSettled",get:t=>({get:e})=>{const n=Yf(t),[r,i]=Hf(e,n);return i.every(s=>!Ve(s))?Fs(t,r,i):Promise.all(i.map((s,o)=>Ve(s)?s.then(a=>{r[o]=a,i[o]=void 0}).catch(a=>{r[o]=void 0,i[o]=a}):null)).then(()=>Fs(t,r,i))},dangerouslyAllowMutability:!0}),WN=ui({key:"__noWait",get:t=>({get:e})=>{try{return eo.value(oT(e(t)))}catch(n){return eo.value(Ve(n)?sT(n):iT(n))}},dangerouslyAllowMutability:!0});var HN={waitForNone:jN,waitForAny:VN,waitForAll:$N,waitForAllSettled:GN,noWait:WN};const{RecoilLoadable:YN}=al,{DefaultValue:XN}=jt,{RecoilRoot:KN,useRecoilStoreID:qN}=Er,{isRecoilValue:ZN}=Zs,{retentionZone:QN}=Of,{freshSnapshot:JN}=zf,{useRecoilState:eD,useRecoilState_TRANSITION_SUPPORT_UNSTABLE:tD,useRecoilStateLoadable:nD,useRecoilValue:rD,useRecoilValue_TRANSITION_SUPPORT_UNSTABLE:iD,useRecoilValueLoadable:sD,useRecoilValueLoadable_TRANSITION_SUPPORT_UNSTABLE:oD,useResetRecoilState:aD,useSetRecoilState:lD}=yO,{useGotoRecoilSnapshot:cD,useRecoilSnapshot:uD,useRecoilTransactionObserver:fD}=$S,{useRecoilCallback:dD}=YS,{noWait:hD,waitForAll:pD,waitForAllSettled:gD,waitForAny:mD,waitForNone:vD}=HN;var hl={DefaultValue:XN,isRecoilValue:ZN,RecoilLoadable:YN,RecoilEnv:yo,RecoilRoot:KN,useRecoilStoreID:qN,useRecoilBridgeAcrossReactRoots_UNSTABLE:WO,atom:nT,selector:eo,atomFamily:CN,selectorFamily:ui,constSelector:IN,errorSelector:DN,readOnlySelector:UN,noWait:hD,waitForNone:vD,waitForAny:mD,waitForAll:pD,waitForAllSettled:gD,useRecoilValue:rD,useRecoilValueLoadable:sD,useRecoilState:eD,useRecoilStateLoadable:nD,useSetRecoilState:lD,useResetRecoilState:aD,useGetRecoilValueInfo_UNSTABLE:BO,useRecoilRefresher_UNSTABLE:E3,useRecoilValueLoadable_TRANSITION_SUPPORT_UNSTABLE:oD,useRecoilValue_TRANSITION_SUPPORT_UNSTABLE:iD,useRecoilState_TRANSITION_SUPPORT_UNSTABLE:tD,useRecoilCallback:dD,useRecoilTransaction_UNSTABLE:T3,useGotoRecoilSnapshot:cD,useRecoilSnapshot:uD,useRecoilTransactionObserver_UNSTABLE:fD,snapshot_UNSTABLE:JN,useRetain:l0,retentionZone:QN},yD=hl.RecoilRoot,qe=hl.atom,pl=hl.selector,gn=hl.useRecoilValue,Le=hl.useRecoilState;function Yc(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function _D(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function p0(t){let e,n,r;t.length!==2?(e=Yc,n=(a,l)=>Yc(t(a),l),r=(a,l)=>t(a)-l):(e=t===Yc||t===_D?t:ED,n=t,r=t);function i(a,l,c=0,u=a.length){if(c<u){if(e(l,l)!==0)return u;do{const d=c+u>>>1;n(a[d],l)<0?c=d+1:u=d}while(c<u)}return c}function s(a,l,c=0,u=a.length){if(c<u){if(e(l,l)!==0)return u;do{const d=c+u>>>1;n(a[d],l)<=0?c=d+1:u=d}while(c<u)}return c}function o(a,l,c=0,u=a.length){const d=i(a,l,c,u-1);return d>c&&r(a[d-1],l)>-r(a[d],l)?d-1:d}return{left:i,center:o,right:s}}function ED(){return 0}function wD(t){return t===null?NaN:+t}const bD=p0(Yc),xD=bD.right;p0(wD).center;const SD=xD;function s_(t,e){let n,r;if(e===void 0)for(const i of t)i!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let s of t)(s=e(s,++i,t))!=null&&(n===void 0?s>=s&&(n=r=s):(n>s&&(n=s),r<s&&(r=s)))}return[n,r]}class TD extends Map{constructor(e,n=PD){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[r,i]of e)this.set(r,i)}get(e){return super.get(o_(this,e))}has(e){return super.has(o_(this,e))}set(e,n){return super.set(AD(this,e),n)}delete(e){return super.delete(CD(this,e))}}function o_({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function AD({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function CD({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function PD(t){return t!==null&&typeof t=="object"?t.valueOf():t}function a_(t){return t}function RD(t,...e){return LD(t,a_,a_,e)}function LD(t,e,n,r){return function i(s,o){if(o>=r.length)return n(s);const a=new TD,l=r[o++];let c=-1;for(const u of s){const d=l(u,++c,s),f=a.get(d);f?f.push(u):a.set(d,[u])}for(const[u,d]of a)a.set(u,i(d,o));return e(a)}(t,0)}const MD=Math.sqrt(50),kD=Math.sqrt(10),ID=Math.sqrt(2);function Nu(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),o=s>=MD?10:s>=kD?5:s>=ID?2:1;let a,l,c;return i<0?(c=Math.pow(10,-i)/o,a=Math.round(t*c),l=Math.round(e*c),a/c<t&&++a,l/c>e&&--l,c=-c):(c=Math.pow(10,i)*o,a=Math.round(t/c),l=Math.round(e/c),a*c<t&&++a,l*c>e&&--l),l<a&&.5<=n&&n<2?Nu(t,e,n*2):[a,l,c]}function OD(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,s,o]=r?Nu(e,t,n):Nu(t,e,n);if(!(s>=i))return[];const a=s-i+1,l=new Array(a);if(r)if(o<0)for(let c=0;c<a;++c)l[c]=(s-c)/-o;else for(let c=0;c<a;++c)l[c]=(s-c)*o;else if(o<0)for(let c=0;c<a;++c)l[c]=(i+c)/-o;else for(let c=0;c<a;++c)l[c]=(i+c)*o;return l}function sg(t,e,n){return e=+e,t=+t,n=+n,Nu(t,e,n)[2]}function ND(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?sg(e,t,n):sg(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function DD(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function FD(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function Du(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const g0=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),l_=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);l_&&parseFloat(l_[1]);const UD="3.4.15";function pr(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const Xc=typeof process!="object"||String(process)!=="[object process]"||process.browser,BD=typeof window<"u"&&typeof window.orientation<"u",c_=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);c_&&parseFloat(c_[1]);function ja(t){"@babel/helpers - typeof";return ja=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ja(t)}function zD(t,e){if(ja(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(ja(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jD(t){var e=zD(t,"string");return ja(e)=="symbol"?e:e+""}function _(t,e,n){return(e=jD(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class VD{constructor(e,n){_(this,"name",void 0),_(this,"workerThread",void 0),_(this,"isRunning",!0),_(this,"result",void 0),_(this,"_resolve",()=>{}),_(this,"_reject",()=>{}),this.name=e,this.workerThread=n,this.result=new Promise((r,i)=>{this._resolve=r,this._reject=i})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){pr(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){pr(this.isRunning),this.isRunning=!1,this._reject(e)}}let sh=class{terminate(){}};const oh=new Map;function $D(t){pr(t.source&&!t.url||!t.source&&t.url);let e=oh.get(t.source||t.url);return e||(t.url&&(e=GD(t.url),oh.set(t.url,e)),t.source&&(e=aT(t.source),oh.set(t.source,e))),pr(e),e}function GD(t){if(!t.startsWith("http"))return t;const e=WD(t);return aT(e)}function aT(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function WD(t){return`try {
  importScripts('`.concat(t,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function lT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2?arguments[2]:void 0;const r=n||new Set;if(t){if(u_(t))r.add(t);else if(u_(t.buffer))r.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const i in t)lT(t[i],e,r)}}return n===void 0?Array.from(r):[]}function u_(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const ah=()=>{};class og{static isSupported(){return typeof Worker<"u"&&Xc||typeof sh<"u"&&!Xc}constructor(e){_(this,"name",void 0),_(this,"source",void 0),_(this,"url",void 0),_(this,"terminated",!1),_(this,"worker",void 0),_(this,"onMessage",void 0),_(this,"onError",void 0),_(this,"_loadableURL","");const{name:n,source:r,url:i}=e;pr(r||i),this.name=n,this.source=r,this.url=i,this.onMessage=ah,this.onError=s=>console.log(s),this.worker=Xc?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=ah,this.onError=ah,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||lT(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(n+="".concat(e.message," in ")),e.lineno&&(n+=":".concat(e.lineno,":").concat(e.colno)),new Error(n)}_createBrowserWorker(){this._loadableURL=$D({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new sh(r,{eval:!1})}else if(this.source)e=new sh(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class HD{static isSupported(){return og.isSupported()}constructor(e){_(this,"name","unnamed"),_(this,"source",void 0),_(this,"url",void 0),_(this,"maxConcurrency",1),_(this,"maxMobileConcurrency",1),_(this,"onDebug",()=>{}),_(this,"reuseWorkers",!0),_(this,"props",{}),_(this,"jobQueue",[]),_(this,"idleQueue",[]),_(this,"count",0),_(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(s,o,a)=>s.done(a),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(s,o)=>s.error(o);const i=new Promise(s=>(this.jobQueue.push({name:e,onMessage:n,onError:r,onStart:s}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const r=new VD(n.name,e);e.onMessage=i=>n.onMessage(r,i.type,i.payload),e.onError=i=>n.onError(r,i),n.onStart(r);try{await r.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new og({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return BD?this.maxMobileConcurrency:this.maxConcurrency}}const YD={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class rr{static isSupported(){return og.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return rr._workerFarm=rr._workerFarm||new rr({}),rr._workerFarm.setProps(e),rr._workerFarm}constructor(e){_(this,"props",void 0),_(this,"workerPools",new Map),this.props={...YD},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:r,url:i}=e;let s=this.workerPools.get(n);return s||(s=new HD({name:n,source:r,url:i}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}_(rr,"_workerFarm",void 0);const XD="latest";function KD(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e[t.id]||{},r="".concat(t.id,"-worker.js");let i=n.workerUrl;if(!i&&t.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&(i="modules/".concat(t.module,"/dist/").concat(r)),!i){let s=t.version;s==="latest"&&(s=XD);const o=s?"@".concat(s):"";i="https://unpkg.com/@loaders.gl/".concat(t.module).concat(o,"/dist/").concat(r)}return pr(i),i}function qD(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:UD;pr(t,"no worker provided");const n=t.version;return!(!e||!n)}function ZD(t,e){return!rr.isSupported()||!Xc&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&(e==null?void 0:e.worker)}async function QD(t,e,n,r,i){const s=t.id,o=KD(t,n),l=rr.getWorkerFarm(n).getWorkerPool({name:s,url:o});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const c=await l.startJob("process-on-worker",JD.bind(null,i));return c.postMessage("process",{input:e,options:n,context:r}),await(await c.result).result}async function JD(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:i,input:s,options:o}=r;try{const a=await t(s,o);e.postMessage("done",{id:i,result:a})}catch(a){const l=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:i,error:l})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function eF(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}function tF(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const r=e.map(a=>a instanceof ArrayBuffer?new Uint8Array(a):a),i=r.reduce((a,l)=>a+l.byteLength,0),s=new Uint8Array(i);let o=0;for(const a of r)s.set(a,o),o+=a.byteLength;return s.buffer}async function nF(t){const e=[];for await(const n of t)e.push(n);return tF(...e)}function f_(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class d_{constructor(e,n){_(this,"name",void 0),_(this,"type",void 0),_(this,"sampleSize",1),_(this,"time",void 0),_(this,"count",void 0),_(this,"samples",void 0),_(this,"lastTiming",void 0),_(this,"lastSampleTime",void 0),_(this,"lastSampleCount",void 0),_(this,"_count",0),_(this,"_time",0),_(this,"_samples",0),_(this,"_startTime",0),_(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=f_(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(f_()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class m0{constructor(e){_(this,"id",void 0),_(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:r}=e;return this.stats[n]||(e instanceof d_?this.stats[n]=e:this.stats[n]=new d_(n,r)),this.stats[n]}}let rF="";const h_={};function iF(t){for(const e in h_)if(t.startsWith(e)){const n=h_[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t="".concat(rF).concat(t)),t}function sF(t){return t&&typeof t=="object"&&t.isBuffer}function cT(t){if(sF(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function uT(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function oF(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}const aF=t=>typeof t=="boolean",Ea=t=>typeof t=="function",gl=t=>t!==null&&typeof t=="object",p_=t=>gl(t)&&t.constructor==={}.constructor,lF=t=>t&&typeof t[Symbol.iterator]=="function",cF=t=>t&&typeof t[Symbol.asyncIterator]=="function",Ki=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,qi=t=>typeof Blob<"u"&&t instanceof Blob,uF=t=>t&&typeof t=="object"&&t.isBuffer,fF=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||gl(t)&&Ea(t.tee)&&Ea(t.cancel)&&Ea(t.getReader),dF=t=>gl(t)&&Ea(t.read)&&Ea(t.pipe)&&aF(t.readable),fT=t=>fF(t)||dF(t),hF=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,pF=/^([-\w.]+\/[-\w.+]+)/;function gF(t){const e=pF.exec(t);return e?e[1]:t}function g_(t){const e=hF.exec(t);return e?e[1]:""}const dT=/\?.*/;function mF(t){const e=t.match(dT);return e&&e[0]}function v0(t){return t.replace(dT,"")}function Xf(t){return Ki(t)?t.url:qi(t)?t.name||"":typeof t=="string"?t:""}function y0(t){if(Ki(t)){const e=t,n=e.headers.get("content-type")||"",r=v0(e.url);return gF(n)||g_(r)}return qi(t)?t.type||"":typeof t=="string"?g_(t):""}function vF(t){return Ki(t)?t.headers["content-length"]||-1:qi(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function hT(t){if(Ki(t))return t;const e={},n=vF(t);n>=0&&(e["content-length"]=String(n));const r=Xf(t),i=y0(t);i&&(e["content-type"]=i);const s=await EF(t);s&&(e["x-first-bytes"]=s),typeof t=="string"&&(t=new TextEncoder().encode(t));const o=new Response(t,{headers:e});return Object.defineProperty(o,"url",{value:r}),o}async function yF(t){if(!t.ok){const e=await _F(t);throw new Error(e)}}async function _F(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let r=t.statusText;n.includes("application/json")&&(r+=" ".concat(await t.text())),e+=r,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}async function EF(t){if(typeof t=="string")return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(r=>{const i=new FileReader;i.onload=s=>{var o;return r(s==null||(o=s.target)===null||o===void 0?void 0:o.result)},i.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5),r=wF(n);return"data:base64,".concat(r)}return null}function wF(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}async function m_(t,e){if(typeof t=="string"){t=iF(t);let n=e;return e!=null&&e.fetch&&typeof(e==null?void 0:e.fetch)!="function"&&(n=e.fetch),await fetch(t,n)}return await hT(t)}function pT(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function wr(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||pT()}const Kc={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},uc=Kc.window||Kc.self||Kc.global,$o=Kc.process||{},gT=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";wr();const lh=globalThis;function mT(t){if(!t&&!wr())return"Node";if(pT(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i?"IE":lh.chrome?"Chrome":lh.safari?"Safari":lh.mozInnerScreenX?"Firefox":"Unknown"}function bF(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class xF{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";_(this,"storage",void 0),_(this,"id",void 0),_(this,"config",void 0),this.storage=bF(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function SF(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function TF(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function ch(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const s=t.width*n,o=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let Fu;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Fu||(Fu={}));function v_(t){return typeof t=="string"?Fu[t.toUpperCase()]||Fu.WHITE:t}function AF(t,e,n){return!wr&&typeof t=="string"&&(e&&(e=v_(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=v_(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function CF(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)typeof t[i]=="function"&&(e.find(s=>i===s)||(t[i]=t[i].bind(t)))}function Uu(t,e){if(!t)throw new Error(e||"Assertion failed")}function is(){let t;if(wr&&"performance"in uc){var e,n;t=uc==null||(e=uc.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in $o){var r;const i=$o==null||(r=$o.hrtime)===null||r===void 0?void 0:r.call($o);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const ss={debug:wr&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},PF={enabled:!0,level:0};function an(){}const y_={},__={once:!0};class ml{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};_(this,"id",void 0),_(this,"VERSION",gT),_(this,"_startTs",is()),_(this,"_deltaTs",is()),_(this,"_storage",void 0),_(this,"userData",{}),_(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new xF("__probe-".concat(this.id,"__"),PF),this.timeStamp("".concat(this.id," started")),CF(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((is()-this._startTs).toPrecision(10))}getDelta(){return Number((is()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){Uu(e,n)}warn(e){return this._getLogFunction(0,e,ss.warn,arguments,__)}error(e){return this._getLogFunction(0,e,ss.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,ss.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,ss.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return this._getLogFunction(e,n,ss.debug||ss.info,arguments,__)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||an,r&&[r],{tag:kF(n)}):an}image(e){let{logLevel:n,priority:r,image:i,message:s="",scale:o=1}=e;return this._shouldLog(n||r)?wr?MF({image:i,message:s,scale:o}):LF():an}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||an)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=E_({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||an)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=vT(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=E_({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,Uu(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=is();const o=s.tag||s.message;if(s.once)if(!y_[o])y_[o]=is();else return an;return n=RF(this.id,s.message,s),r.bind(console,n,...s.args)}return an}}_(ml,"VERSION",gT);function vT(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return Uu(Number.isFinite(e)&&e>=0),e}function E_(t){const{logLevel:e,message:n}=t;t.logLevel=vT(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return Uu(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function RF(t,e,n){if(typeof e=="string"){const r=n.time?TF(SF(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=AF(e,n.color,n.background)}return e}function LF(t){return console.warn("removed"),an}function MF(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const o=ch(s,n,r);console.log(...o)},s.src=e,an}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...ch(e,n,r)),an;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...ch(s,n,r)),s.src=e.toDataURL(),an}return an}function kF(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const w_=new ml({id:"loaders.gl"});class IF{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class OF{constructor(){_(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.log.bind(this.console,...n)}info(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.info.bind(this.console,...n)}warn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.warn.bind(this.console,...n)}error(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.error.bind(this.console,...n)}}const yT={fetch:null,mimeType:void 0,nothrow:!1,log:new OF,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:g0,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},NF={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function _T(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const ET=()=>{const t=_T();return t.globalOptions=t.globalOptions||{...yT},t.globalOptions};function DF(t,e,n,r){return n=n||[],n=Array.isArray(n)?n:[n],FF(t,n),BF(e,t,r)}function FF(t,e){b_(t,null,yT,NF,e);for(const n of e){const r=t&&t[n.id]||{},i=n.options&&n.options[n.id]||{},s=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};b_(r,n.id,i,s,e)}}function b_(t,e,n,r,i){const s=e||"Top level",o=e?"".concat(e,"."):"";for(const a in t){const l=!e&&gl(t[a]),c=a==="baseUri"&&!e,u=a==="workerUrl"&&e;if(!(a in n)&&!c&&!u){if(a in r)w_.warn("".concat(s," loader option '").concat(o).concat(a,"' no longer supported, use '").concat(r[a],"'"))();else if(!l){const d=UF(a,i);w_.warn("".concat(s," loader option '").concat(o).concat(a,"' not recognized. ").concat(d))()}}}}function UF(t,e){const n=t.toLowerCase();let r="";for(const i of e)for(const s in i.options){if(t===s)return"Did you mean '".concat(i.id,".").concat(s,"'?");const o=s.toLowerCase();(n.startsWith(o)||o.startsWith(n))&&(r=r||"Did you mean '".concat(i.id,".").concat(s,"'?"))}return r}function BF(t,e,n){const i={...t.options||{}};return zF(i,n),i.log===null&&(i.log=new IF),x_(i,ET()),x_(i,e),i}function x_(t,e){for(const n in e)if(n in e){const r=e[n];p_(r)&&p_(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function zF(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function _0(t){var e;return t?(Array.isArray(t)&&(t=t[0]),Array.isArray((e=t)===null||e===void 0?void 0:e.extensions)):!1}function E0(t){var e,n;Du(t,"null loader"),Du(_0(t),"invalid loader");let r;return Array.isArray(t)&&(r=t[1],t=t[0],t={...t,options:{...t.options,...r}}),((e=t)!==null&&e!==void 0&&e.parseTextSync||(n=t)!==null&&n!==void 0&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const wT=()=>{const t=_T();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function jF(t){const e=wT();t=Array.isArray(t)?t:[t];for(const n of t){const r=E0(n);e.find(i=>r===i)||e.unshift(r)}}function VF(){return wT()}const $F=new ml({id:"loaders.gl"}),GF=/\.([^.]+)$/;async function WF(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!bT(t))return null;let i=S_(t,e,{...n,nothrow:!0},r);if(i)return i;if(qi(t)&&(t=await t.slice(0,10).arrayBuffer(),i=S_(t,e,n,r)),!i&&!(n!=null&&n.nothrow))throw new Error(xT(t));return i}function S_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!bT(t))return null;if(e&&!Array.isArray(e))return E0(e);let i=[];e&&(i=i.concat(e)),n!=null&&n.ignoreRegisteredLoaders||i.push(...VF()),YF(i);const s=HF(t,i,n,r);if(!s&&!(n!=null&&n.nothrow))throw new Error(xT(t));return s}function HF(t,e,n,r){const i=Xf(t),s=y0(t),o=v0(i)||(r==null?void 0:r.url);let a=null,l="";if(n!=null&&n.mimeType&&(a=uh(e,n==null?void 0:n.mimeType),l="match forced by supplied MIME type ".concat(n==null?void 0:n.mimeType)),a=a||XF(e,o),l=l||(a?"matched url ".concat(o):""),a=a||uh(e,s),l=l||(a?"matched MIME type ".concat(s):""),a=a||qF(e,t),l=l||(a?"matched initial data ".concat(ST(t)):""),a=a||uh(e,n==null?void 0:n.fallbackMimeType),l=l||(a?"matched fallback MIME type ".concat(s):""),l){var c;$F.log(1,"selectLoader selected ".concat((c=a)===null||c===void 0?void 0:c.name,": ").concat(l,"."))}return a}function bT(t){return!(t instanceof Response&&t.status===204)}function xT(t){const e=Xf(t),n=y0(t);let r="No valid loader found (";r+=e?"".concat(uT(e),", "):"no url provided, ",r+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const i=t?ST(t):"";return r+=i?' first bytes: "'.concat(i,'"'):"first bytes: not available",r+=")",r}function YF(t){for(const e of t)E0(e)}function XF(t,e){const n=e&&GF.exec(e),r=n&&n[1];return r?KF(t,r):null}function KF(t,e){e=e.toLowerCase();for(const n of t)for(const r of n.extensions)if(r.toLowerCase()===e)return n;return null}function uh(t,e){for(const n of t)if(n.mimeTypes&&n.mimeTypes.includes(e)||e==="application/x.".concat(n.id))return n;return null}function qF(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(ZF(e,n))return n}else if(ArrayBuffer.isView(e)){if(T_(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&T_(e,0,n))return n;return null}function ZF(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>t.startsWith(r))}function T_(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(i=>QF(t,e,n,i))}function QF(t,e,n,r){if(r instanceof ArrayBuffer)return eF(r,t,r.byteLength);switch(typeof r){case"function":return r(t,n);case"string":const i=ag(t,e,r.length);return r===i;default:return!1}}function ST(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?ag(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?ag(t,0,e):""}function ag(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let i="";for(let s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(e+s));return i}const JF=256*1024;function*eU(t,e){const n=(e==null?void 0:e.chunkSize)||JF;let r=0;const i=new TextEncoder;for(;r<t.length;){const s=Math.min(t.length-r,n),o=t.slice(r,r+s);r+=s,yield i.encode(o)}}const tU=256*1024;function nU(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const{chunkSize:n=tU}=e;let r=0;for(;r<t.byteLength;){const i=Math.min(t.byteLength-r,n),s=new ArrayBuffer(i),o=new Uint8Array(t,r,i);new Uint8Array(s).set(o),r+=i,yield s}}()}const rU=1024*1024;async function*iU(t,e){const n=(e==null?void 0:e.chunkSize)||rU;let r=0;for(;r<t.size;){const i=r+n,s=await t.slice(r,i).arrayBuffer();r=i,yield s}}function A_(t,e){return g0?sU(t,e):oU(t)}async function*sU(t,e){const n=t.getReader();let r;try{for(;;){const i=r||n.read();e!=null&&e._streamReadAhead&&(r=n.read());const{done:s,value:o}=await i;if(s)return;yield cT(o)}}catch{n.releaseLock()}}async function*oU(t,e){for await(const n of t)yield cT(n)}function aU(t,e){if(typeof t=="string")return eU(t,e);if(t instanceof ArrayBuffer)return nU(t,e);if(qi(t))return iU(t,e);if(fT(t))return A_(t,e);if(Ki(t))return A_(t.body,e);throw new Error("makeIterator")}const TT="Cannot convert supplied data type";function lU(t,e,n){if(e.text&&typeof t=="string")return t;if(uF(t)&&(t=t.buffer),t instanceof ArrayBuffer){const r=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let r=t.buffer;const i=t.byteLength||t.length;return(t.byteOffset!==0||i!==r.byteLength)&&(r=r.slice(t.byteOffset,t.byteOffset+i)),r}throw new Error(TT)}async function cU(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||r)return lU(t,e);if(qi(t)&&(t=await hT(t)),Ki(t)){const i=t;return await yF(i),e.binary?await i.arrayBuffer():await i.text()}if(fT(t)&&(t=aU(t,n)),lF(t)||cF(t))return nF(t);throw new Error(TT)}function AT(t,e){const n=ET(),r=t||n;return typeof r.fetch=="function"?r.fetch:gl(r.fetch)?i=>m_(i,r):e!=null&&e.fetch?e==null?void 0:e.fetch:m_}function uU(t,e,n){if(n)return n;const r={fetch:AT(e,t),...t};if(r.url){const i=v0(r.url);r.baseUrl=i,r.queryString=mF(r.url),r.filename=uT(i),r.baseUrl=oF(i)}return Array.isArray(r.loaders)||(r.loaders=null),r}function fU(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...r]:r}return n&&n.length?n:null}async function w0(t,e,n,r){pr(!r||typeof r=="object"),e&&!Array.isArray(e)&&!_0(e)&&(r=void 0,n=e,e=void 0),t=await t,n=n||{};const i=Xf(t),o=fU(e,r),a=await WF(t,o,n);return a?(n=DF(n,a,o,i),r=uU({url:i,parse:w0,loaders:o},n,r||null),await dU(a,t,n,r)):null}async function dU(t,e,n,r){if(qD(t),Ki(e)){const i=e,{ok:s,redirected:o,status:a,statusText:l,type:c,url:u}=i,d=Object.fromEntries(i.headers.entries());r.response={headers:d,ok:s,redirected:o,status:a,statusText:l,type:c,url:u}}if(e=await cU(e,t,n),t.parseTextSync&&typeof e=="string")return n.dataType="text",t.parseTextSync(e,n,r,t);if(ZD(t,n))return await QD(t,e,n,r,w0);if(t.parseText&&typeof e=="string")return await t.parseText(e,n,r,t);if(t.parse)return await t.parse(e,n,r,t);throw pr(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}async function Bu(t,e,n,r){!Array.isArray(e)&&!_0(e)&&(n=e,e=void 0);const i=AT(n);let s=t;return typeof t=="string"&&(s=await i(t)),qi(t)&&(s=await i(t)),await w0(s,e,n)}const hU="3.4.15",{_parseImageNode:pU}=globalThis,lg=typeof Image<"u",cg=typeof ImageBitmap<"u",gU=!!pU,ug=g0?!0:gU;function mU(t){switch(t){case"auto":return cg||lg||ug;case"imagebitmap":return cg;case"image":return lg;case"data":return ug;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}function vU(){if(cg)return"imagebitmap";if(lg)return"image";if(ug)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function yU(t){const e=EU(t);if(!e)throw new Error("Not an image");return e}function _U(t){switch(yU(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function EU(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const wU=/^data:image\/svg\+xml/,bU=/\.svg((\?|#).*)?$/;function b0(t){return t&&(wU.test(t)||bU.test(t))}function xU(t,e){if(b0(e)){let r=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(s){throw new Error(s.message)}return"data:image/svg+xml;base64,".concat(btoa(r))}return CT(t,e)}function CT(t,e){if(b0(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function PT(t,e,n){const r=xU(t,n),i=self.URL||self.webkitURL,s=typeof r!="string"&&i.createObjectURL(r);try{return await SU(s||r,e)}finally{s&&i.revokeObjectURL(s)}}async function SU(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((r,i)=>{try{n.onload=()=>r(n),n.onerror=s=>i(new Error("Could not load image ".concat(t,": ").concat(s)))}catch(s){i(s)}})}const TU={};let C_=!0;async function AU(t,e,n){let r;b0(n)?r=await PT(t,e,n):r=CT(t,n);const i=e&&e.imagebitmap;return await CU(r,i)}async function CU(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if((PU(e)||!C_)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),C_=!1}return await createImageBitmap(t)}function PU(t){for(const e in t||TU)return!1;return!0}function RU(t){return!IU(t,"ftyp",4)||!(t[8]&96)?null:LU(t)}function LU(t){switch(MU(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function MU(t,e,n){return String.fromCharCode(...t.slice(e,n))}function kU(t){return[...t].map(e=>e.charCodeAt(0))}function IU(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=kU(e);for(let i=0;i<r.length;++i)if(r[i]!==t[i+n])return!1;return!0}const Un=!1,wa=!0;function RT(t){const e=vl(t);return NU(e)||UU(e)||DU(e)||FU(e)||OU(e)}function OU(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),n=RU(e);return n?{mimeType:n.mimeType,width:0,height:0}:null}function NU(t){const e=vl(t);return e.byteLength>=24&&e.getUint32(0,Un)===2303741511?{mimeType:"image/png",width:e.getUint32(16,Un),height:e.getUint32(20,Un)}:null}function DU(t){const e=vl(t);return e.byteLength>=10&&e.getUint32(0,Un)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,wa),height:e.getUint16(8,wa)}:null}function FU(t){const e=vl(t);return e.byteLength>=14&&e.getUint16(0,Un)===16973&&e.getUint32(2,wa)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,wa),height:e.getUint32(22,wa)}:null}function UU(t){const e=vl(t);if(!(e.byteLength>=3&&e.getUint16(0,Un)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:i}=BU();let s=2;for(;s+9<e.byteLength;){const o=e.getUint16(s,Un);if(i.has(o))return{mimeType:"image/jpeg",height:e.getUint16(s+5,Un),width:e.getUint16(s+7,Un)};if(!r.has(o))return null;s+=2,s+=e.getUint16(s,Un)}return null}function BU(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function vl(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function zU(t,e){const{mimeType:n}=RT(t)||{},r=globalThis._parseImageNode;return Du(r),await r(t,n)}async function jU(t,e,n){e=e||{};const i=(e.image||{}).type||"auto",{url:s}=n||{},o=VU(i);let a;switch(o){case"imagebitmap":a=await AU(t,e,s);break;case"image":a=await PT(t,e,s);break;case"data":a=await zU(t);break;default:Du(!1)}return i==="data"&&(a=_U(a)),a}function VU(t){switch(t){case"auto":case"data":return vU();default:return mU(t),t}}const $U=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],GU=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],WU={image:{type:"auto",decode:!0}},HU={id:"image",module:"images",name:"Images",version:hU,mimeTypes:GU,extensions:$U,parse:jU,tests:[t=>!!RT(new DataView(t))],options:WU},ye=new ml({id:"deck"});let fg={};function YU(t){fg=t}function wt(t,e,n,r){ye.level>0&&fg[t]&&fg[t].call(null,e,n,r)}function XU(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const KU={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:XU,parseTextSync:JSON.parse};function qU(){const t="8.9.36",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error("deck.gl - multiple versions detected: ".concat(e," vs ").concat(t));return e||(ye.log(1,"deck.gl ".concat(t))(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:ye,_registerLoggers:YU},jF([KU,[HU,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const ZU=qU(),Ce={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Ce,"IDENTITY",{get:()=>(ye.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const Bn={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},gr={common:0,meters:1,pixels:2},P_={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},se=new ml({id:"luma.gl"});function Pt(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const QU="Invalid WebGLRenderingContext",JU="Requires WebGL2";function Kf(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}function we(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function eB(t){return we(t)?t:null}function qf(t){return Pt(Kf(t),QU),t}function xt(t){return Pt(we(t),JU),t}const ra={};function tB(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function nB(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function rB(t,e){ra[t]=!0,e!==void 0&&tB(e)}function iB(t){const e=t.getError;t.getError=function(){let r;do r=e.apply(t),r!==0&&(ra[r]=!0);while(r!==0);for(r in ra)if(ra[r])return delete ra[r],parseInt(r,10);return 0}}const yl=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let r=0;r<this.attribs.length;r++){const i=new t.VertexAttrib(n);this.attribs[r]=i}this.maxAttrib=0};yl.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};yl.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const Zi=function(e){const n=this;this.gl=e,iB(e);const r=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:r.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const o=n.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!0,r.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const o=n.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!1,r.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,o){switch(s){case 34962:n.currentArrayBuffer=o;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=o;break}return r.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,o){const l=n.currentVertexArrayObject.attribs[s];switch(o){case 34975:return l.buffer;case 34338:return l.enabled;case 34339:return l.size;case 34340:return l.stride;case 34341:return l.type;case 34922:return l.normalized;default:return r.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,o,a,l,c,u){const d=n.currentVertexArrayObject;d.maxAttrib=Math.max(d.maxAttrib,s);const f=d.attribs[s];return f.buffer=n.currentArrayBuffer,f.size=o,f.type=a,f.normalized=l,f.stride=c,f.offset=u,f.recache(),r.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{nB("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};Zi.prototype.VERTEX_ARRAY_BINDING_OES=34229;Zi.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let r=0;r<this.vertexArrayObjects.length;++r)this.vertexArrayObjects.isAlive=!1;const n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new yl(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};Zi.prototype.createVertexArrayOES=function(){const e=new yl(this);return this.vertexArrayObjects.push(e),e};Zi.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)};Zi.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof yl&&e.hasBeenBound&&e.ext===this)};Zi.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive){rB(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const r=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(i===s)return;(!i||s.elementArrayBuffer!==i.elementArrayBuffer)&&r.bindBuffer.call(n,34963,s.elementArrayBuffer);let o=this.currentArrayBuffer;const a=Math.max(i?i.maxAttrib:0,s.maxAttrib);for(let l=0;l<=a;l++){const c=s.attribs[l],u=i?i.attribs[l]:null;if((!i||c.enabled!==u.enabled)&&(c.enabled?r.enableVertexAttribArray.call(n,l):r.disableVertexAttribArray.call(n,l)),c.enabled){let d=!1;(!i||c.buffer!==u.buffer)&&(o!==c.buffer&&(r.bindBuffer.call(n,34962,c.buffer),o=c.buffer),d=!0),(d||c.cached!==u.cached)&&r.vertexAttribPointer.call(n,l,c.size,c.type,c.normalized,c.stride,c.offset)}}this.currentArrayBuffer!==o&&r.bindBuffer.call(n,34962,this.currentArrayBuffer)};function sB(t){if(typeof t.createVertexArray=="function")return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const i=e.call(this)||[];return i.indexOf("OES_vertex_array_object")<0&&i.push("OES_vertex_array_object"),i};const n=t.getExtension;t.getExtension=function(i){const s=n.call(this,i);return s||(i!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new Zi(this)),this.__OESVertexArrayObject))}}const R_="OES_element_index",L_="WEBGL_draw_buffers",oB="EXT_disjoint_timer_query",aB="EXT_disjoint_timer_query_webgl2",lB="EXT_texture_filter_anisotropic",M_="WEBGL_debug_renderer_info",cB=35723,uB=4352,fB=36795,dB=34047,hB=37445,pB=37446,De=t=>we(t)?void 0:0,gB={3074:t=>we(t)?void 0:36064,[cB]:t=>we(t)?void 0:uB,35977:De,32937:De,[fB]:(t,e)=>{const n=we(t)?t.getExtension(aB):t.getExtension(oB);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[hB]:(t,e)=>{const n=t.getExtension(M_);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[pB]:(t,e)=>{const n=t.getExtension(M_);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[dB]:(t,e)=>{const n=t.luma.extensions[lB];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:De,35071:De,37447:De,36063:(t,e)=>{if(!we(t)){const n=t.getExtension(L_);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:De,35374:De,35377:De,34852:t=>{if(!we(t)){const e=t.getExtension(L_);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:t=>t.getExtension(R_)?2147483647:65535,33001:t=>t.getExtension(R_)?16777216:65535,33e3:t=>16777216,37157:De,35373:De,35657:De,36183:De,37137:De,34045:De,35978:De,35979:De,35968:De,35376:De,35375:De,35659:De,37154:De,35371:De,35658:De,35076:De,35077:De,35380:De};function mB(t,e,n){const r=gB[n],i=typeof r=="function"?r(t,e,n):r;return i!==void 0?i:e(n)}const vB="OES_vertex_array_object",LT="ANGLE_instanced_arrays",yB="WEBGL_draw_buffers",_B="EXT_disjoint_timer_query",EB="EXT_texture_filter_anisotropic",wB="VertexArray requires WebGL2 or OES_vertex_array_object extension";function bB(t,e){return{webgl2:we(t),ext:t.getExtension(e)}}const MT={[vB]:{meta:{suffix:"OES"},createVertexArray:()=>{Pt(!1,wB)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[LT]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){Pt(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[yB]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Pt(!1)}},[_B]:{meta:{suffix:"EXT"},createQuery:()=>{Pt(!1)},deleteQuery:()=>{Pt(!1)},beginQuery:()=>{Pt(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},fh={readBuffer:(t,e,n)=>{we(t)&&e(n)},getVertexAttrib:(t,e,n,r)=>{const{webgl2:i,ext:s}=bB(t,LT);let o;switch(r){case 35069:o=i?void 0:!1;break;case 35070:o=!i&&!s?0:void 0;break}return o!==void 0?o:e(n,r)},getProgramParameter:(t,e,n,r)=>{if(!we(t))switch(r){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(n,r)},getInternalformatParameter:(t,e,n,r,i)=>{if(!we(t))switch(i){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,r,i)},getTexParameter(t,e,n,r){switch(r){case 34046:const{extensions:i}=t.luma,s=i[EB];r=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(n,r)},getParameter:mB,hint(t,e,n,r){return e(n,r)}};function xB(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(sB(t),SB(t),AB(t,MT),TB(t,{target:e,target2:t}),e.polyfilled=!0),t}globalThis.polyfillContext=xB;function SB(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function TB(t,e){let{target:n,target2:r}=e;Object.keys(fh).forEach(i=>{if(typeof fh[i]=="function"){const s=t[i]?t[i].bind(t):()=>{},o=fh[i].bind(null,t,s);n[i]=o,r[i]=o}})}function AB(t,e){for(const n of Object.getOwnPropertyNames(e))n!=="overrides"&&CB(t,{extension:n,target:t.luma,target2:t})}function CB(t,e){let{extension:n,target:r,target2:i}=e;const s=MT[n];Pt(s);const{meta:o={}}=s,{suffix:a=""}=o,l=t.getExtension(n);for(const c of Object.keys(s)){const u="".concat(c).concat(a);let d=null;c==="meta"||typeof t[c]=="function"||(l&&typeof l[u]=="function"?d=function(){return l[u](...arguments)}:typeof s[c]=="function"&&(d=s[c].bind(r))),d&&(r[c]=d,i[c]=d)}}const x0={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},Pr=(t,e,n)=>e?t.enable(n):t.disable(n),k_=(t,e,n)=>t.hint(n,e),Gt=(t,e,n)=>t.pixelStorei(n,e),PB=(t,e)=>{const n=we(t)?36009:36160;return t.bindFramebuffer(n,e)},RB=(t,e)=>t.bindFramebuffer(36008,e);function Go(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const LB={3042:Pr,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:Pr,2885:(t,e)=>t.cullFace(e),2929:Pr,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:Pr,35723:k_,36006:PB,2886:(t,e)=>t.frontFace(e),33170:k_,2849:(t,e)=>t.lineWidth(e),32823:Pr,32824:"polygonOffset",10752:"polygonOffset",35977:Pr,32938:"sampleCoverage",32939:"sampleCoverage",3089:Pr,3088:(t,e)=>t.scissor(...e),2960:Pr,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),3333:Gt,3317:Gt,37440:Gt,37441:Gt,37443:Gt,3330:Gt,3332:Gt,3331:Gt,36010:RB,3314:Gt,32878:Gt,3316:Gt,3315:Gt,32877:Gt,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=Go(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=Go(e)&&e.length===2?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=Go(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=Go(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,o,a]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,s,o,a)},stencilOp:(t,e)=>{e=Go(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,o,a]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,s,o,a)},viewport:(t,e)=>t.viewport(...e)};function Qe(t,e,n){return e[t]!==void 0?e[t]:n[t]}const MB={blendEquation:(t,e,n)=>t.blendEquationSeparate(Qe(32777,e,n),Qe(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(Qe(32969,e,n),Qe(32968,e,n),Qe(32971,e,n),Qe(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(Qe(32824,e,n),Qe(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(Qe(32938,e,n),Qe(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,Qe(2962,e,n),Qe(2967,e,n),Qe(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,Qe(34816,e,n),Qe(36003,e,n),Qe(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,Qe(2964,e,n),Qe(2965,e,n),Qe(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,Qe(34817,e,n),Qe(34818,e,n),Qe(34819,e,n))},I_={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},blendColor:(t,e,n,r,i)=>t({32773:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,r,i)=>t({32969:e,32968:n,32971:r,32970:i}),clearColor:(t,e,n,r,i)=>t({3106:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,r,i)=>t({3107:[e,n,r,i]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,r,i)=>t({3088:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({2962:e,2967:n,2963:r,34816:e,36003:n,36004:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:r,[e===1028?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({2964:e,2965:n,2966:r,34817:e,34818:n,34819:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:r,[e===1028?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({2978:[e,n,r,i]})},In=(t,e)=>t.isEnabled(e),O_={3042:In,2884:In,2929:In,3024:In,32823:In,32926:In,32928:In,3089:In,2960:In,35977:In};function kT(t){for(const e in t)return!1;return!0}function kB(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return!1}function N_(t,e){const n=t[e].bind(t);t[e]=function(){const i=arguments.length<=0?void 0:arguments[0];return i in t.state.cache?t.state.enable?t.state.cache[i]:n(...arguments):n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function IB(t,e,n){const r=t[e].bind(t);t[e]=function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const{valueChanged:l,oldValue:c}=n(t.state._updateCache,...o);return l&&r(...o),c},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function OB(t){const e=t.useProgram.bind(t);t.useProgram=function(r){t.state.program!==r&&(e(r),t.state.program=r)}}class NB{constructor(e){let{copyState:n=!1,log:r=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?FB(e):Object.assign({},x0),this.log=r,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){Pt(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];mr(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,r;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){Pt(s!==void 0);const o=e[s],a=this.cache[s];kB(o,a)||(n=!0,r=a,i&&!(s in i)&&(i[s]=a),this.cache[s]=o)}return{valueChanged:n,oldValue:r}}}function IT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:n=!0,copyState:r}=e;if(Pt(r!==void 0),!t.state){const{polyfillContext:i}=globalThis;i&&i(t),t.state=new NB(t,{copyState:r}),OB(t);for(const s in I_){const o=I_[s];IB(t,s,o)}N_(t,"getParameter"),N_(t,"isEnabled")}return t.state.enable=n,t}function DB(t){t.state||IT(t,{copyState:!1}),t.state.push()}function D_(t){Pt(t.state),t.state.pop()}function mr(t,e){if(Pt(Kf(t),"setParameters requires a WebGL context"),kT(e))return;const n={};for(const i in e){const s=Number(i),o=LB[i];o&&(typeof o=="string"?n[o]=!0:o(t,e[i],s))}const r=t.state&&t.state.cache;if(r)for(const i in n){const s=MB[i];s(t,e,r)}}function FB(t,e){if(e=e||x0,typeof e=="number"){const i=e,s=O_[i];return s?s(t,i):t.getParameter(i)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const i of n){const s=O_[i];r[i]=s?s(t,Number(i)):t.getParameter(Number(i))}return r}function UB(t){mr(t,x0)}function Pn(t,e,n){if(kT(e))return n(t);const{nocatch:r=!0}=e;DB(t),mr(t,e);let i;if(r)i=n(t),D_(t);else try{i=n(t)}finally{D_(t)}return i}function to(t){const{luma:e}=t;if(t.canvas&&e){const n=e.canvasSizeInfo,r="clientWidth"in n?n.clientWidth:t.canvas.clientWidth;return r?t.drawingBufferWidth/r:1}return 1}function dh(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=to(t),i=t.drawingBufferWidth,s=t.drawingBufferHeight;return zB(e,r,i,s,n)}function BB(t){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function zB(t,e,n,r,i){const s=F_(t[0],e,n);let o=U_(t[1],e,r,i),a=F_(t[0]+1,e,n);const l=a===n-1?a:a-1;a=U_(t[1]+1,e,r,i);let c;return i?(a=a===0?a:a+1,c=o,o=a):c=a===r-1?a:a-1,{x:s,y:o,width:Math.max(l-s+1,1),height:Math.max(c-o+1,1)}}function F_(t,e,n){return Math.min(Math.round(t*e),n-1)}function U_(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const S0=wr(),jB=S0&&typeof document<"u",OT={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function NT(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Pt(S0,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),t=Object.assign({},OT,t);const{width:e,height:n}=t;function r(a){if(t.throwOnError)throw new Error(a);return console.error(a),null}t.onError=r;let i;const{canvas:s}=t,o=WB({canvas:s,width:e,height:n,onError:r});return i=GB(o,t),i?(i=T0(i,t),HB(i),i):null}function T0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||YB(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},OT,e);const{manageState:n,debug:r}=e;return n&&IT(t,{copyState:!1,log:function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return se.log(1,...s)()}}),S0&&r&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),se.level=Math.max(se.level,1)):se.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function VB(t){const e=t.getParameter(7936),n=t.getParameter(7937),r=t.getExtension("WEBGL_debug_renderer_info"),i=r&&t.getParameter(r.UNMASKED_VENDOR_WEBGL||7936),s=r&&t.getParameter(r.UNMASKED_RENDERER_WEBGL||7937);return{vendor:i||e,renderer:s||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}function $B(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t.canvas){const r=BB(e.useDevicePixels);XB(t,r,e);return}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function GB(t,e){const{onError:n}=e;let r=null;const i=l=>r=l.statusMessage||r;t.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:s=!0,webgl2:o=!0}=e;let a=null;return o&&(a=a||t.getContext("webgl2",e),a=a||t.getContext("experimental-webgl2",e)),s&&(a=a||t.getContext("webgl",e),a=a||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",i,!1),a?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):n("Failed to create ".concat(o&&!s?"WebGL2":"WebGL"," context: ").concat(r||"Unknown error"))}function WB(t){let{canvas:e,width:n=800,height:r=600,onError:i}=t,s;return typeof e=="string"?(jB&&document.readyState==="complete"||i("createGLContext called on canvas '".concat(e,"' before page was loaded")),s=document.getElementById(e)):e?s=e:(s=document.createElement("canvas"),s.id="lumagl-canvas",s.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",s.style.height=Number.isFinite(r)?"".concat(r,"px"):"100%",document.body.insertBefore(s,document.body.firstChild)),s}function HB(t){const e=we(t)?"WebGL2":"WebGL1",n=VB(t),r=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",i=t.debug?" debug":"";se.info(1,"".concat(e).concat(i," context ").concat(r))()}function YB(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?2:1}function XB(t,e,n){let r="width"in n?n.width:t.canvas.clientWidth,i="height"in n?n.height:t.canvas.clientHeight;(!r||!i)&&(se.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=t.canvas.width||1,i=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const s=t.luma.canvasSizeInfo;if(s.clientWidth!==r||s.clientHeight!==i||s.devicePixelRatio!==e){let o=e;const a=Math.floor(r*o),l=Math.floor(i*o);t.canvas.width=a,t.canvas.height=l,(t.drawingBufferWidth!==a||t.drawingBufferHeight!==l)&&(se.warn("Device pixel ratio clamped")(),o=Math.min(t.drawingBufferWidth/r,t.drawingBufferHeight/i),t.canvas.width=Math.floor(r*o),t.canvas.height=Math.floor(i*o)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:r,clientHeight:i,devicePixelRatio:e})}}const ba="8.5.21",KB="set luma.log.level=1 (or higher) to trace rendering";class qB{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new m0({id:e})),this.stats.get(e)}}const Ri=new qB;if(globalThis.luma&&globalThis.luma.VERSION!==ba)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(ba));globalThis.luma||(wr()&&se.log(1,"luma.gl ".concat(ba," - ").concat(KB))(),globalThis.luma=globalThis.luma||{VERSION:ba,version:ba,log:se,stats:Ri,globals:{modules:{},nodeIO:{}}});function ZB(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function QB(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}function Z(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function hh(t,e){if(typeof e!="string")return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const r=t[e];return Z(r!==void 0,"Accessing undefined constant GL.".concat(e)),r}function ti(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const ph={};function vr(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";ph[t]=ph[t]||1;const e=ph[t]++;return"".concat(t,"-").concat(e)}function B_(t){return Z(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function no(t){let e=!0;for(const n in t){e=!1;break}return e}function DT(t,e,n,r){const i="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),s=Object.getPrototypeOf(t);r.forEach(o=>{s.methodName||(s[o]=()=>{throw se.removed("Calling removed method ".concat(e,".").concat(o,": "),i)(),new Error(o)})})}const os="Resource subclass must define virtual methods";let br=class{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};qf(e);const{id:r,userData:i={}}=n;this.gl=e,this.gl2=e,this.id=r||vr(this[Symbol.toStringTag]),this.userData=i,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(r=>r.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let n;return this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=hh(this.gl,e),Z(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=we(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension)))){const a=i.webgl1,l="webgl2"in i?i.webgl2:i.webgl1;return s?l:a}}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:n,keys:r}=e,i=this.constructor.PARAMETERS||{},s=we(this.gl),o={},a=n||Object.keys(i);for(const l of a){const c=i[l];if(c&&(!("webgl2"in c)||s)&&(!("extension"in c)||this.gl.getExtension(c.extension))){const d=r?ti(this.gl,l):l;o[d]=this.getParameter(l,e),r&&c.type==="GLenum"&&(o[d]=ti(this.gl,o[d]))}}return o}setParameter(e,n){e=hh(this.gl,e),Z(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=we(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension))))throw new Error("Parameter not available on this platform");i.type==="GLenum"&&(n=hh(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,r){return DT(this,e,n,r)}initialize(e){}_createHandle(){throw new Error(os)}_deleteHandle(){throw new Error(os)}_bindHandle(e){throw new Error(os)}_getOptsFromHandle(){throw new Error(os)}_getParameter(e,n){throw new Error(os)}_setParameter(e,n){throw new Error(os)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],n=Ri.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];Ri.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,n),this._trackAllocatedMemoryForContext(e,n,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const i=Ri.get("Memory Usage".concat(r));i.get("GPU Memory").addCount(e),i.get("".concat(n," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=Ri.get("Memory Usage".concat(n));r.get("GPU Memory").subtractCount(this.byteLength),r.get("".concat(e," Memory")).subtractCount(this.byteLength)}};const JB="Failed to deduce GL constant from typed array";function dg(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(JB)}}function Va(t){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function ez(t){let{data:e,width:n,height:r,bytesPerPixel:i=4,temp:s}=t;const o=n*i;s=s||new Uint8Array(o);for(let a=0;a<r/2;++a){const l=a*o,c=(r-a-1)*o;s.set(e.subarray(l,l+o)),e.copyWithin(l,c,c+o),e.set(s,c)}}function tz(t){let{data:e,width:n,height:r}=t;const i=Math.round(n/2),s=Math.round(r/2),o=new Uint8Array(i*s*4);for(let a=0;a<s;a++)for(let l=0;l<i;l++)for(let c=0;c<4;c++)o[(a*i+l)*4+c]=e[(a*2*n+l*2)*4+c];return{data:o,width:i,height:s}}function hg(t,e,n){const{removedProps:r={},deprecatedProps:i={},replacedProps:s={}}=n;for(const a in r)if(a in e){const c=r[a]?"".concat(t,".").concat(r[a]):"N/A";se.removed("".concat(t,".").concat(a),c)()}for(const a in i)if(a in e){const l=i[a];se.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(l))()}let o=null;for(const a in s)if(a in e){const l=s[a];se.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(l))(),o=o||Object.assign({},e),o[l]=e[a],delete o[a]}return o||e}const nz={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},rz={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class Kt{static getBytesPerElement(e){return Va(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return Z(e.size),Va(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new Kt(nz,...n)}constructor(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(i=>this._assign(i)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return Kt.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return Kt.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=hg("Accessor",e,rz),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}}const z_=10,FT={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},iz={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:FT},sz={removedProps:FT};class Me extends br{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/Kt.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/Kt.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=hg("Buffer",e,iz),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=hg("Buffer",e,sz),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new Kt(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:r=0,srcOffset:i=0}=e,s=e.byteLength||e.length;Z(n);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),i!==0||s!==void 0?(xt(this.gl),this.gl.bufferSubData(this.target,r,n,i,s)):this.gl.bufferSubData(o,r,n),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:r=0,writeOffset:i=0,size:s}=e;const{gl:o}=this;return xt(o),o.bindBuffer(36662,n.handle),o.bindBuffer(36663,this.handle),o.copyBufferSubData(36662,36663,r,i,s),o.bindBuffer(36662,null),o.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:r=0,length:i=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};xt(this.gl);const s=Va(this.accessor.type||5126,{clamped:!1}),o=this._getAvailableElementCount(n),a=r;let l,c;e?(c=e.length,l=c-a):(l=Math.min(o,i||o),c=a+l);const u=Math.min(o,l);return i=i||u,Z(i<=u),e=e||new s(c),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,r,i),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:r=0,size:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?i!==void 0?this.gl.bindBufferRange(e,n,this.handle,r,i):(Z(r===0),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(z_,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+n;Z(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.usage),this.gl.bufferSubData(i,n,e),this.gl.bindBuffer(i,null),this.debugData=e.slice(0,z_),this.bytesUsed=r,this._trackAllocatedMemory(r);const s=dg(e);return Z(s),this.setAccessor(new Kt(this.accessor,{type:s})),this}_setByteLength(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;Z(e>=0),this._trackDeallocatedMemory();let r=e;e===0&&(r=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,n),this.gl.bindBuffer(i,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const n=Va(this.accessor.type||5126,{clamped:!1}),r=e/n.BYTES_PER_ELEMENT;return this.getElementCount()-r}_inferType(e){this.accessor.type||this.setAccessor(new Kt(this.accessor,{type:dg(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return se.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return se.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return se.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return se.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new Kt(this.accessor,e),this}}const A0={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},UT={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},BT={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function oz(t,e){const n=A0[e];if(!n)return!1;if(n.gl1===void 0&&n.gl2===void 0)return!0;const r=we(t)&&n.gl2||n.gl1;return typeof r=="string"?t.getExtension(r):r}function az(t,e){const n=A0[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const lz=[9729,9728],j_=globalThis.WebGLBuffer||function(){};class Vi extends br{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:r,linearFiltering:i}=n;let s=!0;return r&&(s=s&&oz(e,r),s=s&&(!i||az(e,r))),s}constructor(e,n){const{id:r=vr("texture"),handle:i,target:s}=n;super(e,{id:r,handle:i}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then(g=>this.initialize(Object.assign({},e,{pixels:g,data:g}))),this;const r=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(r&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:i=null,format:s=6408,border:o=0,recreate:a=!1,parameters:l={},pixelStore:c={},textureUnit:u=void 0}=e;n||(n=i);let{width:d,height:f,dataFormat:h,type:p,compressed:m=!1,mipmaps:E=!0}=e;const{depth:v=0}=e;return{width:d,height:f,compressed:m,dataFormat:h,type:p}=this._deduceParameters({format:s,type:p,dataFormat:h,compressed:m,data:n,width:d,height:f}),this.width=d,this.height=f,this.depth=v,this.format=s,this.type=p,this.dataFormat=h,this.border=o,this.textureUnit=u,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),E&&this._isNPOT()&&(se.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),E=!1,this._updateForNPOT(l)),this.mipmaps=E,this.setImageData({data:n,width:d,height:f,depth:v,format:s,type:p,dataFormat:h,border:o,mipmaps:E,parameters:c,compressed:m}),E&&this.generateMipmap(),this.setParameters(l),a&&(this.data=n),r&&(this._video={video:n,parameters:l,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:r}=this._video;if(r===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:r,mipmaps:i=!1}=e;return r!==this.width||n!==this.height?this.initialize({width:r,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(se.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Pn(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:r=null,level:i=0,format:s=this.format,border:o=this.border,offset:a=0,parameters:l={}}=e;let{data:c=null,type:u=this.type,width:d=this.width,height:f=this.height,dataFormat:h=this.dataFormat,compressed:p=!1}=e;c||(c=r),{type:u,dataFormat:h,compressed:p,width:d,height:f}=this._deduceParameters({format:s,type:u,dataFormat:h,compressed:p,data:c,width:d,height:f});const{gl:m}=this;m.bindTexture(this.target,this.handle);let E=null;({data:c,dataType:E}=this._getDataType({data:c,compressed:p}));let v,g=0;if(Pn(this.gl,l,()=>{switch(E){case"null":m.texImage2D(n,i,s,d,f,o,h,u,c);break;case"typed-array":m.texImage2D(n,i,s,d,f,o,h,u,c,a);break;case"buffer":v=xt(m),v.bindBuffer(35052,c.handle||c),v.texImage2D(n,i,s,d,f,o,h,u,a),v.bindBuffer(35052,null);break;case"browser-object":we(m)?m.texImage2D(n,i,s,d,f,o,h,u,c):m.texImage2D(n,i,s,h,u,c);break;case"compressed":for(const[y,b]of c.entries())m.compressedTexImage2D(n,y,b.format,b.width,b.height,o,b.data),g+=b.levelSize;break;default:Z(!1,"Unknown image data type")}}),E==="compressed")this._trackAllocatedMemory(g,"Texture");else if(c&&c.byteLength)this._trackAllocatedMemory(c.byteLength,"Texture");else{const y=UT[this.dataFormat]||4,b=BT[this.type]||1;this._trackAllocatedMemory(this.width*this.height*y*b,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:r=null,data:i=null,x:s=0,y:o=0,width:a=this.width,height:l=this.height,level:c=0,format:u=this.format,type:d=this.type,dataFormat:f=this.dataFormat,compressed:h=!1,offset:p=0,border:m=this.border,parameters:E={}}=e;if({type:d,dataFormat:f,compressed:h,width:a,height:l}=this._deduceParameters({format:u,type:d,dataFormat:f,compressed:h,data:i,width:a,height:l}),Z(this.depth===0,"texSubImage not supported for 3D textures"),i||(i=r),i&&i.data){const v=i;i=v.data,a=v.shape[0],l=v.shape[1]}i instanceof Me&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),Pn(this.gl,E,()=>{if(h)this.gl.compressedTexSubImage2D(n,c,s,o,a,l,u,i);else if(i===null)this.gl.texSubImage2D(n,c,s,o,a,l,f,d,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(n,c,s,o,a,l,f,d,i,p);else if(i instanceof j_){const v=xt(this.gl);v.bindBuffer(35052,i),v.texSubImage2D(n,c,s,o,a,l,f,d,p),v.bindBuffer(35052,null)}else we(this.gl)?xt(this.gl).texSubImage2D(n,c,s,o,a,l,f,d,i):this.gl.texSubImage2D(n,c,s,o,f,d,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return se.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:r=!1}=e;return r?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof Me?{data:n.handle,dataType:"buffer"}:n instanceof j_?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:r}=e;let{width:i,height:s,dataFormat:o,type:a,compressed:l}=e;const c=A0[n];return o=o||c&&c.dataFormat,a=a||c&&c.types[0],l=l||c&&c.compressed,{width:i,height:s}=this._deduceImageSize(r,i,s),{dataFormat:o,type:a,compressed:l,width:i,height:s,format:n,data:r}}_deduceImageSize(e,n,r){let i;return typeof ImageData<"u"&&e instanceof ImageData?i={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?i={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?i={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?i={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?i={width:e.videoWidth,height:e.videoHeight}:e?i={width:n,height:r}:i={width:n>=0?n:1,height:r>=0?r:1},Z(i,"Could not deduced texture size"),Z(n===void 0||i.width===n,"Deduced texture width does not match supplied width"),Z(r===void 0||i.height===r,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:Z(!1);break;default:this.gl.texParameteri(this.target,e,n);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return we(this.gl)||!this.width||!this.height?!1:!B_(this.width)||!B_(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:lz.indexOf(n)===-1&&(n=9729);break;case 10242:case 10243:n!==33071&&(n=33071);break}return n}}let cz="";function uz(t,e){return Z(typeof t=="string"),t=cz+t,new Promise((n,r)=>{try{const i=new Image;i.onload=()=>n(i),i.onerror=()=>r(new Error("Could not load image ".concat(t,"."))),i.crossOrigin=e&&e.crossOrigin||"anonymous",i.src=t}catch(i){r(i)}})}class nn extends Vi{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return Vi.isSupported(e,n)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};qf(e),(n instanceof Promise||typeof n=="string")&&(n={data:n}),typeof n.data=="string"&&(n=Object.assign({},n,{data:uz(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}}const pg=[34069,34070,34071,34072,34073,34074];class zT extends Vi{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};qf(e),super(e,Object.assign({},n,{target:34067})),this.initialize(n),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:n=!0,parameters:r={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,n&&this.generateMipmap(e),this.setParameters(r)}),this}subImage(e){let{face:n,data:r,x:i=0,y:s=0,mipmapLevel:o=0}=e;return this._subImage({target:n,data:r,x:i,y:s,mipmapLevel:o})}async setCubeMapImageData(e){let{width:n,height:r,pixels:i,data:s,border:o=0,format:a=6408,type:l=5121}=e;const{gl:c}=this,u=i||s,d=await Promise.all(pg.map(f=>{const h=u[f];return Promise.all(Array.isArray(h)?h:[h])}));this.bind(),pg.forEach((f,h)=>{d[h].length>1&&this.opts.mipmaps!==!1&&se.warn("".concat(this.id," has mipmap and multiple LODs."))(),d[h].forEach((p,m)=>{n&&r?c.texImage2D(f,m,a,n,r,o,a,l,p):c.texImage2D(f,m,a,a,l,p)})}),this.unbind()}setImageDataForFace(e){const{face:n,width:r,height:i,pixels:s,data:o,border:a=0,format:l=6408,type:c=5121}=e,{gl:u}=this,d=s||o;return this.bind(),d instanceof Promise?d.then(f=>this.setImageDataForFace(Object.assign({},e,{face:n,data:f,pixels:f}))):this.width||this.height?u.texImage2D(n,0,l,r,i,a,l,c,d):u.texImage2D(n,0,l,l,c,d),this}}zT.FACES=pg;class fz extends Vi{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return we(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};xt(e),n=Object.assign({depth:1},n,{target:32879,unpackFlipY:!1}),super(e,n),this.initialize(n),Object.seal(this)}setImageData(e){let{level:n=0,dataFormat:r=6408,width:i,height:s,depth:o=1,border:a=0,format:l,type:c=5121,offset:u=0,data:d,parameters:f={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),Pn(this.gl,f,()=>{ArrayBuffer.isView(d)&&this.gl.texImage3D(this.target,n,r,i,s,o,a,l,c,d),d instanceof Me&&(this.gl.bindBuffer(35052,d.handle),this.gl.texImage3D(this.target,n,r,i,s,o,a,l,c,u))}),d&&d.byteLength)this._trackAllocatedMemory(d.byteLength,"Texture");else{const h=UT[this.dataFormat]||4,p=BT[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*h*p,"Texture")}return this.loaded=!0,this}}const pi="EXT_color_buffer_float",V_={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:pi,bpp:2},33327:{gl2:pi,bpp:4},34842:{gl2:pi,bpp:8},33326:{gl2:pi,bpp:4},33328:{gl2:pi,bpp:8},34836:{gl2:pi,bpp:16},35898:{gl2:pi,bpp:4}};function dz(t,e,n){const r=n[e];if(!r)return!1;const i=we(t)&&r.gl2||r.gl1;return typeof i=="string"?t.getExtension(i):i}class Cs extends br{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!n||dz(e,n,V_)}static getSamplesForFormat(e,n){let{format:r}=n;return e.getInternalformatParameter(36161,r,32937)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:r=1,height:i=1,samples:s=0}=e;return Z(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),s!==0&&we(this.gl)?this.gl.renderbufferStorageMultisample(36161,s,n,r,i):this.gl.renderbufferStorage(36161,n,r,i),this.format=n,this.width=r,this.height=i,this.samples=s,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*V_[this.format].bpp),this}resize(e){let{width:n,height:r}=e;return n!==this.width||r!==this.height?this.initialize({width:n,height:r,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const hz=256,pz=1024,gz=16384,$_=6144,G_=6145,W_=6146,H_=34041,jT="clear: bad arguments";function C0(t){let{framebuffer:e=null,color:n=null,depth:r=null,stencil:i=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s={};e&&(s.framebuffer=e);let o=0;n&&(o|=gz,n!==!0&&(s.clearColor=n)),r&&(o|=hz,r!==!0&&(s.clearDepth=r)),i&&(o|=pz,r!==!0&&(s.clearStencil=r)),Z(o!==0,jT),Pn(t,s,()=>{t.clear(o)})}function mz(t){let{framebuffer:e=null,buffer:n=$_,drawBuffer:r=0,value:i=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};xt(t),Pn(t,{framebuffer:e},()=>{switch(n){case $_:switch(i.constructor){case Int32Array:t.clearBufferiv(n,r,i);break;case Uint32Array:t.clearBufferuiv(n,r,i);break;case Float32Array:default:t.clearBufferfv(n,r,i)}break;case G_:t.clearBufferfv(G_,0,[i]);break;case W_:t.clearBufferiv(W_,0,[i]);break;case H_:const[s,o]=i;t.clearBufferfi(H_,0,s,o);break;default:Z(!1,jT)}})}function vz(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return Z(!1),0}}function Zf(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408}=e;let{sourceAttachment:s=36064,target:o=null,sourceWidth:a,sourceHeight:l,sourceType:c}=e;const{framebuffer:u,deleteFramebuffer:d}=VT(t);Z(u);const{gl:f,handle:h,attachments:p}=u;a=a||u.width,l=l||u.height,s===36064&&h===null&&(s=1028),Z(p[s]),c=c||p[s].type,o=_z(o,c,i,a,l),c=c||dg(o);const m=f.bindFramebuffer(36160,h);return f.readPixels(n,r,a,l,i,c,o),f.bindFramebuffer(36160,m||null),d&&u.delete(),o}function Y_(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=Zf(t,{sourceAttachment:e}),{width:i,height:s}=t;for(;s>n;)({data:r,width:i,height:s}=tz({data:r,width:i,height:s}));ez({data:r,width:i,height:s});const o=document.createElement("canvas");o.width=i,o.height=s;const a=o.getContext("2d"),l=a.createImageData(i,s);return l.data.set(r),a.putImageData(l,0,0),o.toDataURL()}function yz(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{sourceX:r=0,sourceY:i=0,targetMipmaplevel:s=0,targetInternalFormat:o=6408}=n;let{targetX:a,targetY:l,targetZ:c,width:u,height:d}=n;const{framebuffer:f,deleteFramebuffer:h}=VT(t);Z(f);const{gl:p,handle:m}=f,E=typeof a<"u"||typeof l<"u"||typeof c<"u";a=a||0,l=l||0,c=c||0;const v=p.bindFramebuffer(36160,m);Z(e);let g=null;if(e instanceof Vi&&(g=e,u=Number.isFinite(u)?u:g.width,d=Number.isFinite(d)?d:g.height,g.bind(0),e=g.target),!E)p.copyTexImage2D(e,s,o,r,i,u,d,0);else switch(e){case 3553:case 34067:p.copyTexSubImage2D(e,s,a,l,r,i,u,d);break;case 35866:case 32879:xt(p).copyTexSubImage3D(e,s,a,l,c,r,i,u,d);break}return g&&g.unbind(),p.bindFramebuffer(36160,v||null),h&&f.delete(),g}function VT(t){return t instanceof ot?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:Pz(t),deleteFramebuffer:!0}}function _z(t,e,n,r,i){if(t)return t;e=e||5121;const s=Va(e,{clamped:!1}),o=vz(n);return new s(r*i*o)}const Fe={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function Ez(t){const e=new nn(t,{format:6408,type:5126,dataFormat:6408}),n=new ot(t,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),r=n.getStatus();return e.delete(),n.delete(),r===36053}const $T={[Fe.WEBGL2]:[!1,!0],[Fe.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[Fe.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[Fe.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[Fe.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[Fe.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[Fe.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[Fe.FLOAT_BLEND]:["EXT_float_blend"],[Fe.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[Fe.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[Fe.TEXTURE_FLOAT]:["OES_texture_float",!0],[Fe.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[Fe.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[Fe.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[Fe.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[Fe.COLOR_ATTACHMENT_RGBA32F]:[Ez,"EXT_color_buffer_float"],[Fe.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[Fe.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[Fe.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[Fe.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[Fe.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[Fe.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},wz=2;function GT(t,e){return P0(t,e)}function P0(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>WT(t,n))}function bz(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in $T)t.luma.caps[e]===void 0&&(t.luma.caps[e]=WT(t,e));return t.luma.caps}function WT(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[e]===void 0&&(t.luma.caps[e]=xz(t,e)),t.luma.caps[e]||se.log(wz,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}function xz(t,e){const n=$T[e];Z(n,e);let r;const i=we(t)&&n[1]||n[0];if(typeof i=="function")r=i(t);else if(Array.isArray(i)){r=!0;for(const s of i)r=r&&!!t.getExtension(s)}else typeof i=="string"?r=!!t.getExtension(i):typeof i=="boolean"?r=i:Z(!1);return r}const X_="Multiple render targets not supported";class ot extends br{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:r,colorBufferHalfFloat:i}=n;let s=!0;return r&&(s=!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),i&&(s=s&&!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new ot(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=xt(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=xt(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:r=1,attachments:i=null,color:s=!0,depth:o=!0,stencil:a=!1,check:l=!0,readBuffer:c=void 0,drawBuffers:u=void 0}=e;if(Z(n>=0&&r>=0,"Width and height need to be integers"),this.width=n,this.height=r,i)for(const d in i){const f=i[d];(Array.isArray(f)?f[0]:f).resize({width:n,height:r})}else i=this._createDefaultAttachments(s,o,a,n,r);this.update({clearAttachments:!0,attachments:i,readBuffer:c,drawBuffers:u}),i&&l&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:r,drawBuffers:i,clearAttachments:s=!1,resizeAttachments:o=!0}=e;this.attach(n,{clearAttachments:s,resizeAttachments:o});const{gl:a}=this,l=a.bindFramebuffer(36160,this.handle);return r&&this._setReadBuffer(r),i&&this._setDrawBuffers(i),a.bindFramebuffer(36160,l||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:n,height:r}=e;if(this.handle===null)return Z(n===void 0&&r===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),r===void 0&&(r=this.gl.drawingBufferHeight),n!==this.width&&r!==this.height&&se.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(r))();for(const i in this.attachments)this.attachments[i].resize({width:n,height:r});return this.width=n,this.height=r,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:r=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i={};n&&Object.keys(this.attachments).forEach(o=>{i[o]=null}),Object.assign(i,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const o in i){Z(o!==void 0,"Misspelled framebuffer binding point?");const a=Number(o),l=i[a];let c=l;if(!c)this._unattach(a);else if(c instanceof Cs)this._attachRenderbuffer({attachment:a,renderbuffer:c});else if(Array.isArray(l)){const[u,d=0,f=0]=l;c=u,this._attachTexture({attachment:a,texture:u,layer:d,level:f})}else this._attachTexture({attachment:a,texture:c,layer:0,level:0});r&&c&&c.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(o=>!this.attachments[o]).forEach(o=>{delete this.attachments[o]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error(Tz(e));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),r=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),r}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:n,depth:r,stencil:i,drawBuffers:s=[]}=e,o=this.gl.bindFramebuffer(36160,this.handle);return(n||r||i)&&C0(this.gl,{color:n,depth:r,stencil:i}),s.forEach((a,l)=>{mz(this.gl,{drawBuffer:l,value:a})}),this.gl.bindFramebuffer(36160,o||null),this}readPixels(){return se.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return se.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return se.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return se.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return se.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return se.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:r=0,y:i=0,width:s,height:o}=e;const a=xt(this.gl),l=a.bindFramebuffer(36008,this.handle);return r===0&&i===0&&s===void 0&&o===void 0?a.invalidateFramebuffer(36008,n):a.invalidateFramebuffer(36008,n,r,i,s,o),a.bindFramebuffer(36008,l),this}getAttachmentParameter(e,n,r){let i=this._getAttachmentParameterFallback(n);return i===null&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),r&&i>1e3&&(i=ti(this.gl,i)),i}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const s of r){const o=n?ti(this.gl,s):s;i[o]=this.getAttachmentParameter(e,s,n)}return i}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=Object.keys(this.attachments),r={};for(const i of n){const s=Number(i),o=e?ti(this.gl,s):s;r[o]=this.getAttachmentParameters(s,e)}return r}show(){return typeof window<"u"&&window.open(Y_(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>se.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const r=Y_(this,{targetMaxHeight:100});return se.image({logLevel:e,message:n,image:r},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,r,i,s){let o=null;return e&&(o=o||{},o[36064]=new nn(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:s,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(o[36064])),n&&r?(o=o||{},o[33306]=new Cs(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(o[33306])):n?(o=o||{},o[36096]=new Cs(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:s}),this.ownResources.push(o[36096])):r&&Z(!1),o}_unattach(e){const n=this.attachments[e];n&&(n instanceof Cs?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:r}=e;const{gl:i}=this;i.framebufferRenderbuffer(36160,n,36161,r.handle),this.attachments[n]=r}_attachTexture(e){let{attachment:n=36064,texture:r,layer:i,level:s}=e;const{gl:o}=this;switch(o.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:xt(o).framebufferTextureLayer(36160,n,r.target,s,i);break;case 34067:const l=Sz(i);o.framebufferTexture2D(36160,n,l,r.handle,s);break;case 3553:o.framebufferTexture2D(36160,n,3553,r.handle,s);break;default:Z(!1,"Illegal texture type")}o.bindTexture(r.target,null),this.attachments[n]=r}_setReadBuffer(e){const n=eB(this.gl);n?n.readBuffer(e):Z(e===36064||e===1029,X_),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,r=xt(n);if(r)r.drawBuffers(e);else{const i=n.getExtension("WEBGL_draw_buffers");i?i.drawBuffersWEBGL(e):Z(e.length===1&&(e[0]===36064||e[0]===1029),X_)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=bz(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return!n.WEBGL2&&!n.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}function Sz(t){return t<34069?t+34069:t}function Tz(t){return(ot.STATUS||{})[t]||"Framebuffer error ".concat(t)}const Az=[36049,36048,33296,33298,33299,33300,33301,33302,33303];ot.ATTACHMENT_PARAMETERS=Az;function Cz(t,e){Z(t instanceof nn||t instanceof zT||t instanceof fz);const n=t.constructor,{gl:r,width:i,height:s,format:o,type:a,dataFormat:l,border:c,mipmaps:u}=t,d=Object.assign({width:i,height:s,format:o,type:a,dataFormat:l,border:c,mipmaps:u},e);return new n(r,d)}function Pz(t,e){const{gl:n,width:r,height:i,id:s}=t;return new ot(n,Object.assign({},e,{id:"framebuffer-for-".concat(s),width:r,height:i,attachments:{36064:t}}))}function qc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,r=t.match(n);return r?r[1]:e}const Rz=35632,Lz=35633;function Mz(t){switch(t){case Rz:return"fragment";case Lz:return"vertex";default:return"unknown type"}}function kz(t,e,n,r){const i=t.split(/\r?\n/),s={},o={},a=r||qc(e)||"(unnamed)",l="".concat(Mz(n)," shader ").concat(a);for(let u=0;u<i.length;u++){const d=i[u];if(d.length<=1)continue;const f=d.split(":"),h=f[0],p=parseInt(f[2],10);if(isNaN(p))throw new Error("GLSL compilation error in ".concat(l,": ").concat(t));h!=="WARNING"?s[p]=d:o[p]=d}const c=Iz(e);return{shaderName:l,errors:K_(s,c),warnings:K_(o,c)}}function K_(t,e){let n="";for(let r=0;r<e.length;r++){const i=e[r];if(!(!t[r+3]&&!t[r+2]&&!t[r+1])&&(n+="".concat(i,`
`),t[r+1])){const s=t[r+1],o=s.split(":",3),a=o[0],l=parseInt(o[1],10)||0,c=s.substring(o.join(":").length+1).trim();n+=HT("^^^ ".concat(a,": ").concat(c,`

`),l)}}return n}function Iz(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const r=t.split(/\r?\n/),i=String(r.length+e-1).length;return r.map((s,o)=>{const a=String(o+e),l=a.length;return HT(a,i-l)+n+s})}function HT(t,e){let n="";for(let r=0;r<e;++r)n+=" ";return"".concat(n).concat(t)}function YT(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&n[0]==="#version"){const r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}return e}const Oz="Shader: GLSL source code must be a JavaScript string";class $a extends br{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return Z(!1),"unknown"}}constructor(e,n){qf(e),Z(typeof n.source=="string",Oz);const r=qc(n.source,null)||n.id||vr("unnamed ".concat($a.getTypeName(n.shaderType)));super(e,{id:r}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const r=qc(n,null);r&&(this.id=vr(r)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat($a.getTypeName(this.shaderType),":").concat(this.id)}getName(){return qc(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const r=this.gl.getShaderInfoLog(this.handle),{shaderName:i,errors:s,warnings:o}=kz(r,this.source,this.shaderType,this.id);throw se.error("GLSL compilation errors in ".concat(i,`
`).concat(s))(),se.warn("GLSL compilation warnings in ".concat(i,`
`).concat(o))(),new Error("GLSL compilation errors in ".concat(i))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class gh extends $a{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class mh extends $a{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const Nz={5126:ze.bind(null,"uniform1fv",Wt,1,Et),35664:ze.bind(null,"uniform2fv",Wt,2,Et),35665:ze.bind(null,"uniform3fv",Wt,3,Et),35666:ze.bind(null,"uniform4fv",Wt,4,Et),5124:ze.bind(null,"uniform1iv",Rr,1,Et),35667:ze.bind(null,"uniform2iv",Rr,2,Et),35668:ze.bind(null,"uniform3iv",Rr,3,Et),35669:ze.bind(null,"uniform4iv",Rr,4,Et),35670:ze.bind(null,"uniform1iv",Rr,1,Et),35671:ze.bind(null,"uniform2iv",Rr,2,Et),35672:ze.bind(null,"uniform3iv",Rr,3,Et),35673:ze.bind(null,"uniform4iv",Rr,4,Et),35674:ze.bind(null,"uniformMatrix2fv",Wt,4,Jn),35675:ze.bind(null,"uniformMatrix3fv",Wt,9,Jn),35676:ze.bind(null,"uniformMatrix4fv",Wt,16,Jn),35678:ht,35680:ht,5125:ze.bind(null,"uniform1uiv",fc,1,Et),36294:ze.bind(null,"uniform2uiv",fc,2,Et),36295:ze.bind(null,"uniform3uiv",fc,3,Et),36296:ze.bind(null,"uniform4uiv",fc,4,Et),35685:ze.bind(null,"uniformMatrix2x3fv",Wt,6,Jn),35686:ze.bind(null,"uniformMatrix2x4fv",Wt,8,Jn),35687:ze.bind(null,"uniformMatrix3x2fv",Wt,6,Jn),35688:ze.bind(null,"uniformMatrix3x4fv",Wt,12,Jn),35689:ze.bind(null,"uniformMatrix4x2fv",Wt,8,Jn),35690:ze.bind(null,"uniformMatrix4x3fv",Wt,12,Jn),35678:ht,35680:ht,35679:ht,35682:ht,36289:ht,36292:ht,36293:ht,36298:ht,36299:ht,36300:ht,36303:ht,36306:ht,36307:ht,36308:ht,36311:ht},Dz={},Fz={},Uz={},q_=[0];function R0(t,e,n,r){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(q_[0]=t,t=q_);const i=t.length;if(i%e&&se.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let s=r[i];s||(s=new n(i),r[i]=s);for(let o=0;o<i;o++)s[o]=t[o];return s}function Wt(t,e){return R0(t,e,Float32Array,Dz)}function Rr(t,e){return R0(t,e,Int32Array,Fz)}function fc(t,e){return R0(t,e,Uint32Array,Uz)}function Z_(t,e,n){const r=Nz[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r().bind(null,t,e)}function Bz(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:!!n[2]}}function zz(t,e,n){for(const r in t){const i=t[r];if((!n||!!n[r])&&!jz(i))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(r),i),new Error("".concat(e," Bad uniform ").concat(r))}return!0}function jz(t){return Array.isArray(t)||ArrayBuffer.isView(t)?$z(t):isFinite(t)||t===!0||t===!1||t instanceof Vi||t instanceof Cs?!0:t instanceof ot?!!t.texture:!1}function Vz(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const r=t[e];for(let i=0,s=n.length;i<s;++i)r[i]=n[i]}else t[e]=n.slice();else t[e]=n}function $z(t){if(t.length===0)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function ht(){let t=null;return(e,n,r)=>{const i=t!==r;return i&&(e.uniform1i(n,r),t=r),i}}function ze(t,e,n,r){let i=null,s=null;return(o,a,l)=>{const c=e(l,n),u=c.length;let d=!1;if(i===null)i=new Float32Array(u),s=u,d=!0;else{Z(s===u,"Uniform length cannot change.");for(let f=0;f<u;++f)if(c[f]!==i[f]){d=!0;break}}return d&&(r(o,t,a,c),i.set(c)),d}}function Et(t,e,n,r){t[e](n,r)}function Jn(t,e,n,r){t[e](n,!1,r)}const Gz=5120,Wz=5121,Hz=5122,Yz=5123,Q_=0,dc=1,Xz=2,Kz=3,hc=4,qz=5,Zz=6,rt=5126,Qz=35664,Jz=35665,ej=35666,Wo=5124,tj=35667,nj=35668,rj=35669,Ho=5125,ij=36294,sj=36295,oj=36296,aj=35670,lj=35671,cj=35672,uj=35673,fj=35674,dj=35675,hj=35676,pj=35685,gj=35686,mj=35687,vj=35688,yj=35689,_j=35690,gg={[rt]:[rt,1,"float"],[Qz]:[rt,2,"vec2"],[Jz]:[rt,3,"vec3"],[ej]:[rt,4,"vec4"],[Wo]:[Wo,1,"int"],[tj]:[Wo,2,"ivec2"],[nj]:[Wo,3,"ivec3"],[rj]:[Wo,4,"ivec4"],[Ho]:[Ho,1,"uint"],[ij]:[Ho,2,"uvec2"],[sj]:[Ho,3,"uvec3"],[oj]:[Ho,4,"uvec4"],[aj]:[rt,1,"bool"],[lj]:[rt,2,"bvec2"],[cj]:[rt,3,"bvec3"],[uj]:[rt,4,"bvec4"],[fj]:[rt,8,"mat2"],[pj]:[rt,8,"mat2x3"],[gj]:[rt,8,"mat2x4"],[dj]:[rt,12,"mat3"],[mj]:[rt,12,"mat3x2"],[vj]:[rt,12,"mat3x4"],[hj]:[rt,16,"mat4"],[yj]:[rt,16,"mat4x2"],[_j]:[rt,16,"mat4x3"]};function Ej(t){switch(t){case Q_:return Q_;case dc:return dc;case Kz:return dc;case Xz:return dc;case hc:return hc;case qz:return hc;case Zz:return hc;default:return Z(!1),0}}function J_(t){const e=gg[t];if(!e)return null;const[n,r]=e;return{type:n,components:r}}function XT(t,e){switch(t){case Gz:case Wz:case Hz:case Yz:t=rt;break}for(const n in gg){const[r,i,s]=gg[n];if(r===t&&i===e)return{glType:n,name:s}}return null}class wj{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,r=n.getProgramParameter(e.handle,35721);for(let i=0;i<r;i++){const{name:s,type:o,size:a}=n.getActiveAttrib(e.handle,i),l=n.getAttribLocation(e.handle,s);l>=0&&this._addAttribute(l,s,o,a)}this.attributeInfos.sort((i,s)=>i.location-s.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!we(n))return;const r=n.getProgramParameter(e.handle,35971);for(let i=0;i<r;i++){const{name:s,type:o,size:a}=n.getTransformFeedbackVarying(e.handle,i);this._addVarying(i,s,o,a)}this.varyingInfos.sort((i,s)=>i.location-s.location)}_addAttribute(e,n,r,i){const{type:s,components:o}=J_(r),a={type:s,size:i*o};this._inferProperties(e,n,a);const l={location:e,name:n,accessor:new Kt(a)};this.attributeInfos.push(l),this.attributeInfosByLocation[e]=l,this.attributeInfosByName[l.name]=l}_inferProperties(e,n,r){/instance/i.test(n)&&(r.divisor=1)}_addVarying(e,n,r,i){const{type:s,components:o}=J_(r),a=new Kt({type:s,size:i*o}),l={location:e,name:n,accessor:a};this.varyingInfos.push(l),this.varyingInfosByName[l.name]=l}}const e1=4,bj=35981,xj=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class KT extends br{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",xj),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:n,vs:r,fs:i,varyings:s,bufferMode:o=bj}=e;return this.hash=n||"",this.vs=typeof r=="string"?new gh(this.gl,{id:"".concat(e.id,"-vs"),source:r}):r,this.fs=typeof i=="string"?new mh(this.gl,{id:"".concat(e.id,"-fs"),source:i}):i,Z(this.vs instanceof gh),Z(this.fs instanceof mh),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(xt(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new wj(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:r=4,vertexCount:i,offset:s=0,start:o,end:a,isIndexed:l=!1,indexType:c=5123,instanceCount:u=0,isInstanced:d=u>0,vertexArray:f=null,transformFeedback:h,framebuffer:p,parameters:m={},uniforms:E,samplers:v}=e;if((E||v)&&(se.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(E||{})),se.priority>=n){const g=p?p.id:"default",y="mode=".concat(ti(this.gl,r)," verts=").concat(i," ")+"instances=".concat(u," indexType=").concat(ti(this.gl,c)," ")+"isInstanced=".concat(d," isIndexed=").concat(l," ")+"Framebuffer=".concat(g);se.log(n,y)()}return Z(f),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||i===0||d&&u===0?!1:(f.bindForDraw(i,u,()=>{if(p!==void 0&&(m=Object.assign({},m,{framebuffer:p})),h){const g=Ej(r);h.begin(g)}this._bindTextures(),Pn(this.gl,m,()=>{l&&d?this.gl2.drawElementsInstanced(r,i,c,s,u):l&&we(this.gl)&&!isNaN(o)&&!isNaN(a)?this.gl2.drawRangeElements(r,o,a,i,c,s):l?this.gl.drawElements(r,i,c,s):d?this.gl2.drawArraysInstanced(r,s,i,u):this.gl.drawArrays(r,s,i)}),h&&h.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};se.priority>=2&&zz(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const r=e[n],i=this._uniformSetters[n];if(i){let s=r,o=!1;if(s instanceof ot&&(s=s.texture),s instanceof Vi)if(o=this.uniforms[n]!==r,o){i.textureIndex===void 0&&(i.textureIndex=this._textureIndexCounter++);const a=s,{textureIndex:l}=i;a.bind(l),s=l,this._textureUniforms[n]=a}else s=i.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(i(s)||o)&&Vz(this.uniforms,n,r)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const r=this._textureUniforms[n];r.update(),e=e&&r.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const n=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(n)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),r={};for(const i of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:r.vs=new gh({handle:i});break;case 35632:r.fs=new mh({handle:i});break}return r}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=vr(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),se.time(e1,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),se.timeEnd(e1,"linkProgram for ".concat(this._getName()))(),e.debug||se.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const r=this.gl.getActiveUniform(this.handle,n),{name:i}=Bz(r.name);let s=e.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=Z_(e,s,r),r.size>1)for(let o=0;o<r.size;o++)s=e.getUniformLocation(this.handle,"".concat(i,"[").concat(o,"]")),this._uniformSetters["".concat(i,"[").concat(o,"]")]=Z_(e,s,r)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}}const Sj=34918,Tj=34919,Aj=35007,Cj=36795,Pj=35976,Rj=35887,Lj=36202;class zu extends br{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=we(e),i=P0(e,Fe.TIMER_QUERY);let s=r||i;for(const o of n)switch(o){case"queries":s=s&&r;break;case"timers":s=s&&i;break;default:Z(!1)}return s}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(Aj)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(e?Lj:Rj)}beginTransformFeedbackQuery(){return this.begin(Pj)}begin(e){return this._queryPending?this:(this.target=e,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,Tj);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(Cj)}getResult(){return this.gl2.getQueryParameter(this.handle,Sj)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((r,i)=>{const s=()=>{this.isResultAvailable()?(r(this.getResult()),this._pollingPromise=null):n++>e?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return zu.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class qT extends br{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return we(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};xt(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,no(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const r=this._getVaryingIndex(e),{buffer:i,byteSize:s,byteOffset:o}=this._getBufferParams(n);return r<0?(this.unused[e]=i,se.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[r]=n,this.bindOnUse||this._bindBuffer(r,i,o,s),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,r,i;return e instanceof Me?i=e:(i=e.buffer,r=e.byteSize,n=e.byteOffset),(n!==void 0||r!==void 0)&&(n=n||0,r=r||i.byteLength-n),{buffer:i,byteOffset:n,byteSize:r}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:r,byteOffset:i}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,i,r)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const s=n&&n.handle;return!s||i===void 0?this.gl.bindBufferBase(35982,e,s):this.gl.bindBufferRange(35982,e,s,r,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}let pc=null;function Mj(t){return(!pc||pc.byteLength<t)&&(pc=new ArrayBuffer(t)),pc}function kj(t,e){const n=Mj(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function Ij(t){let{target:e,source:n,start:r=0,count:i=1}=t;const s=n.length,o=i*s;let a=0;for(let l=r;a<s;a++)e[l++]=n[a];for(;a<o;)a<o-a?(e.copyWithin(r+a,r,r+a),a*=2):(e.copyWithin(r+a,r,r+o-a),a=o);return e}const Oj="elements must be GL.ELEMENT_ARRAY_BUFFER";class Ht extends br{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?we(e)||mT()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new Ht(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return Ht.MAX_ATTRIBUTES=Ht.MAX_ATTRIBUTES||e.getParameter(34921),Ht.MAX_ATTRIBUTES}static setConstant(e,n,r){switch(r.constructor){case Float32Array:Ht._setConstantFloatArray(e,n,r);break;case Int32Array:Ht._setConstantIntArray(e,n,r);break;case Uint32Array:Ht._setConstantUintArray(e,n,r);break;default:Z(!1)}}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;super(e,Object.assign({},n,{id:r})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Ht.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Z(!e||e.target===34963,Oj),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,r){if(n.target===34963)return this.setElementBuffer(n,r);const{size:i,type:s,stride:o,offset:a,normalized:l,integer:c,divisor:u}=r,{gl:d,gl2:f}=this;return e=Number(e),this.bind(()=>{d.bindBuffer(34962,n.handle),c?(Z(we(d)),f.vertexAttribIPointer(e,i,s,o,a)):d.vertexAttribPointer(e,i,s,l,o,a),d.enableVertexAttribArray(e),f.vertexAttribDivisor(e,u||0)}),this}enable(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!n&&e===0&&!Ht.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const r=this._normalizeConstantArrayValue(n),i=r.byteLength*e,s=r.length*e;let o=!this.buffer;if(this.buffer=this.buffer||new Me(this.gl,i),o=o||this.buffer.reallocate(i),o=o||!this._compareConstantArrayValues(r,this.bufferValue),o){const a=kj(n.constructor,s);Ij({target:a,source:r,start:0,count:s}),this.buffer.subData(a),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==n[r])return!1;return!0}static _setConstantFloatArray(e,n,r){switch(r.length){case 1:e.vertexAttrib1fv(n,r);break;case 2:e.vertexAttrib2fv(n,r);break;case 3:e.vertexAttrib3fv(n,r);break;case 4:e.vertexAttrib4fv(n,r);break;default:Z(!1)}}static _setConstantIntArray(e,n,r){switch(Z(we(e)),r.length){case 1:e.vertexAttribI1iv(n,r);break;case 2:e.vertexAttribI2iv(n,r);break;case 3:e.vertexAttribI3iv(n,r);break;case 4:e.vertexAttribI4iv(n,r);break;default:Z(!1)}}static _setConstantUintArray(e,n,r){switch(Z(we(e)),r.length){case 1:e.vertexAttribI1uiv(n,r);break;case 2:e.vertexAttribI2uiv(n,r);break;case 3:e.vertexAttribI3uiv(n,r);break;case 4:e.vertexAttribI4uiv(n,r);break;default:Z(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:r}=n;return Z(Number.isFinite(r)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(r,e);default:return this.gl.getVertexAttrib(r,e)}})}}const Nj="VertexArray: attributes must be Buffers or constants (i.e. typed array)",Dj=/^(.+)__LOCATION_([0-9]+)$/,Fj=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class Uj{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;this.id=r,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Ht(e),DT(this,"VertexArray","v6.0",Fj),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e){const r=e[n];this._setAttribute(n,r)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,r);const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,n.accessor,r);return i>=0&&(this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,n,s)),this}setConstant(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},r));return i>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new Me(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof Me&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof Me&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,r){let i;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),i=r()}),i}_resolveLocationAndAccessor(e,n,r,i){const s={location:-1,accessor:null},{location:o,name:a}=this._getAttributeIndex(e);if(!Number.isFinite(o)||o<0)return this.unused[e]=n,se.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),s;const l=this._getAttributeInfo(a||o);if(!l)return s;const c=this.accessors[o]||{},u=Kt.resolve(l.accessor,c,r,i),{size:d,type:f}=u;return Z(Number.isFinite(d)&&Number.isFinite(f)),{location:o,accessor:u}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const r=Dj.exec(e),i=r?r[1]:e,s=r?Number(r[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+s,name:i}:{location:-1}}_setAttribute(e,n){if(n instanceof Me)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof Me){const r=n[0],i=n[1];this.setBuffer(e,r,i)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){const r=n;this.setConstant(e,r)}else if(n.buffer instanceof Me){const r=n;this.setBuffer(e,r.buffer,r)}else throw new Error(Nj)}_setConstantAttributes(e,n){const r=Math.max(e|0,n|0);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,r);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)i=this.values[s],ArrayBuffer.isView(i)&&this._setConstantAttribute(s,i)}_setConstantAttributeZero(e,n){if(Ht.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const r=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,r,this.accessors[0])}_setConstantAttribute(e,n){Ht.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const r=this.values[n],i=this.accessors[n];if(!r)return;const{divisor:s}=i,o=s>0;if(e.isInstanced=e.isInstanced||o,r instanceof Me){const a=r;if(o){const l=a.getVertexCount(i);e.instanceCount=Math.min(e.instanceCount,l)}else{const l=a.getVertexCount(i);e.vertexCount=Math.min(e.vertexCount,l)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return se.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}}function Bj(t,e){const{maxElts:n=16,size:r=1}=e;let i="[";for(let o=0;o<t.length&&o<n;++o)o>0&&(i+=",".concat(o%r===0?" ":"")),i+=Ga(t[o],e);const s=t.length>n?"...":"]";return"".concat(i).concat(s)}function Ga(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=1e-16,{isInteger:r=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return Bj(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return r?"0":"0.";if(r||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const i=t.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function t1(t){let{header:e="Uniforms",program:n,uniforms:r,undefinedOnly:i=!1}=t;Z(n);const s=".*_.*",o=".*Matrix",a=n._uniformSetters,l={},c=Object.keys(a).sort();let u=0;for(const h of c)!h.match(s)&&!h.match(o)&&vh({table:l,header:e,uniforms:r,uniformName:h,undefinedOnly:i})&&u++;for(const h of c)h.match(o)&&vh({table:l,header:e,uniforms:r,uniformName:h,undefinedOnly:i})&&u++;for(const h of c)l[h]||vh({table:l,header:e,uniforms:r,uniformName:h,undefinedOnly:i})&&u++;let d=0;const f={};if(!i)for(const h in r){const p=r[h];l[h]||(d++,f[h]={Type:"NOT USED: ".concat(p),[e]:Ga(p)})}return{table:l,count:u,unusedTable:f,unusedCount:d}}function vh(t){let{table:e,header:n,uniforms:r,uniformName:i,undefinedOnly:s}=t;const o=r[i],a=zj(o);return!s||!a?(e[i]={[n]:a?Ga(o):"N/A","Uniform Type":a?o:"NOT PROVIDED"},!0):!1}function zj(t){return t!=null}function jj(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const r={};e.elements&&(r.ELEMENT_ARRAY_BUFFER=n1(e,e.elements,null,n));const i=e.values;for(const s in i){const o=e._getAttributeInfo(s);if(o){let a="".concat(s,": ").concat(o.name);const l=e.accessors[o.location];l&&(a="".concat(s,": ").concat(Vj(o.name,l))),r[a]=n1(e,i[s],l,n)}}return r}function n1(t,e,n,r){const{gl:i}=t;if(!e)return{[r]:"null","Format ":"N/A"};let s="NOT PROVIDED",o=1,a=0,l=0,c,u,d;if(n&&(s=n.type,o=n.size,s=String(s).replace("Array",""),c=s.indexOf("nt")!==-1),e instanceof Me){const f=e,{data:h,changed:p}=f.getDebugData();u=p?"*":"",d=h,l=f.byteLength,a=l/h.BYTES_PER_ELEMENT/o;let m;if(n){const E=n.divisor>0;m="".concat(E?"I ":"P "," ").concat(a," (x").concat(o,"=").concat(l," bytes ").concat(ti(i,s),")")}else c=!0,m="".concat(l," bytes");return{[r]:"".concat(u).concat(Ga(d,{size:o,isInteger:c})),"Format ":m}}return d=e,o=e.length,s=String(e.constructor.name).replace("Array",""),c=s.indexOf("nt")!==-1,{[r]:"".concat(Ga(d,{size:o,isInteger:c})," (constant)"),"Format ":"".concat(o,"x").concat(s," (constant)")}}function Vj(t,e){const{type:n,size:r}=e,i=XT(n,r);return i?"".concat(t," (").concat(i.name,")"):t}function $j(t){const e={},n="Accessors for ".concat(t.id);for(const r of t.attributeInfos)if(r){const i=r1(r);e["in ".concat(i)]={[n]:JSON.stringify(r.accessor)}}for(const r of t.varyingInfos)if(r){const i=r1(r);e["out ".concat(i)]={[n]:JSON.stringify(r.accessor)}}return e}function r1(t){const{type:e,size:n}=t.accessor,r=XT(e,n);return r?"".concat(r.name," ").concat(t.name):t.name}const i1=wr()&&typeof document<"u";let Gj=0;class Wj{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:n=E=>NT(E),onAddHTML:r=null,onInitialize:i=()=>{},onRender:s=()=>{},onFinalize:o=()=>{},onError:a,gl:l=null,glOptions:c={},debug:u=!1,createFramebuffer:d=!1,autoResizeViewport:f=!0,autoResizeDrawingBuffer:h=!0,stats:p=Ri.get("animation-loop-".concat(Gj++))}=e;let{useDevicePixels:m=!0}=e;"useDevicePixelRatio"in e&&(se.deprecated("useDevicePixelRatio","useDevicePixels")(),m=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:r,onInitialize:i,onRender:s,onFinalize:o,onError:a,gl:l,glOptions:c,debug:u,createFramebuffer:d},this.gl=l,this.needsRedraw=null,this.timeline=null,this.stats=p,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:f,autoResizeDrawingBuffer:h,useDevicePixels:m}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return Z(typeof e=="string"),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const n=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=zu.isSupported(this.gl,["timers"])?new zu(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(r=>{this._running&&(this._addCallbackData(r||{}),r!==!1&&this._startLoop())});return this.props.onError&&n.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const r=document.getElementById(e);return r?Number(r.value):n}setViewParameters(){return se.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=i1?new Promise((e,n)=>{if(i1&&document.readyState==="complete"){e(document);return}window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):QB(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):ZB(e)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:n,aspect:r}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){typeof e=="object"&&e!==null&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?T0(this.props.gl,e):this.onCreateContext(e),!Kf(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");UB(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(n);const r=this.props.onAddHTML(n);r&&(n.innerHTML=r)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,n=this.gl.drawingBufferHeight;let r=1;const{canvas:i}=this.gl;return i&&i.clientHeight?r=i.clientWidth/i.clientHeight:e>0&&n>0&&(r=e/n),{width:e,height:n,aspect:r}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&$B(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new ot(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}const _l="vs",L0="fs";function en(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const yh={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function Hj(t){const e={};for(const n in t){const r=t[n],i=Yj(r);e[n]=i}return e}function Yj(t){let e=s1(t);return e==="object"?t?"type"in t?Object.assign({},t,yh[t.type]):"value"in t?(e=s1(t.value),Object.assign({type:e},t,yh[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},yh[e])}function s1(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const Xj="vs",Kj="fs";class o1{constructor(e){let{name:n,vs:r,fs:i,dependencies:s=[],uniforms:o,getUniforms:a,deprecations:l=[],defines:c={},inject:u={},vertexShader:d,fragmentShader:f}=e;en(typeof n=="string"),this.name=n,this.vs=r||d,this.fs=i||f,this.getModuleUniforms=a,this.dependencies=s,this.deprecations=this._parseDeprecationDefinitions(l),this.defines=c,this.injections=qj(u),o&&(this.uniforms=Hj(o))}getModuleSource(e){let n;switch(e){case Xj:n=this.vs||"";break;case Kj:n=this.fs||"";break;default:en(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(r=>{r.regex.test(e)&&(r.deprecated?n.deprecated(r.old,r.new)():n.removed(r.old,r.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={},r=this.uniforms;for(const i in r){const s=r[i];i in e&&!s.private?(s.validate&&en(s.validate(e[i],s),"".concat(this.name,": invalid ").concat(i)),n[i]=e[i]):n[i]=s.value}return n}}function qj(t){const e={vs:{},fs:{}};for(const n in t){let r=t[n];const i=n.slice(0,2);typeof r=="string"&&(r={order:0,injection:r}),e[i][n]=r}return e}function Zj(t){return Qj(QT(t))}function Qj(t){const e={},n={};return ZT({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((r,i)=>n[i]-n[r]).map(r=>e[r])}function ZT(t){let{modules:e,level:n,moduleMap:r,moduleDepth:i}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)r[s.name]=s,(i[s.name]===void 0||i[s.name]<n)&&(i[s.name]=n);for(const s of e)s.dependencies&&ZT({modules:s.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}function QT(t,e){return t.map(n=>(n instanceof o1||(en(typeof n!="string","Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),en(n.name,"shader module has no name"),n=new o1(n),n.dependencies=QT(n.dependencies)),n))}function Jj(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},n=t.userAgent||e.userAgent||"",r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i}const e4=7936,t4=7937,n4=7938,r4=35724,M0={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},_i={};Object.keys(M0).forEach(t=>{_i[t]=t});function i4(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function s4(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||e4),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||t4);return{gpuVendor:o4(n,r),vendor:n,renderer:r,version:t.getParameter(n4),shadingLanguageVersion:t.getParameter(r4)}}function o4(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const _h={};function a1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=M0[e];if(en(r,e),!Jj(n))return!0;if(e in _h)return _h[e];const i=r[0],s=n.behavior||"enable",o="#extension GL_".concat(i," : ").concat(s,`
void main(void) {}`),a=t.createShader(35633);t.shaderSource(a,o),t.compileShader(a);const l=t.getShaderParameter(a,35713);return t.deleteShader(a),_h[e]=l,l}function a4(t,e){const n=M0[e];en(n,e);const r=i4(t)&&n[1]||n[0],i=typeof r=="string"?!!t.getExtension(r):r;return en(i===!1||i===!0),i}function gc(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>a4(t,n))}function l4(t){switch(s4(t).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function c4(t,e,n){let r=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return gc(t,_i.GLSL_FRAG_DEPTH)&&(r+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),gc(t,_i.GLSL_DERIVATIVES)&&a1(t,_i.GLSL_DERIVATIVES)&&(r+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),gc(t,_i.GLSL_FRAG_DATA)&&a1(t,_i.GLSL_FRAG_DATA,{behavior:"require"})&&(r+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),gc(t,_i.GLSL_TEXTURE_LOD)&&(r+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),r}const u4=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,f4=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,d4={[_l]:u4,[L0]:f4},Zc="__LUMA_INJECT_DECLARATIONS__",l1=/void\s+main\s*\([^)]*\)\s*\{\n?/,c1=/}\n?[^{}]*$/,Eh=[];function u1(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=e===_l;for(const s in n){const o=n[s];o.sort((l,c)=>l.order-c.order),Eh.length=o.length;for(let l=0,c=o.length;l<c;++l)Eh[l]=o[l].injection;const a="".concat(Eh.join(`
`),`
`);switch(s){case"vs:#decl":i&&(t=t.replace(Zc,a));break;case"vs:#main-start":i&&(t=t.replace(l1,l=>l+a));break;case"vs:#main-end":i&&(t=t.replace(c1,l=>a+l));break;case"fs:#decl":i||(t=t.replace(Zc,a));break;case"fs:#main-start":i||(t=t.replace(l1,l=>l+a));break;case"fs:#main-end":i||(t=t.replace(c1,l=>a+l));break;default:t=t.replace(s,l=>l+a)}}return t=t.replace(Zc,""),r&&(t=t.replace(/\}\s*$/,s=>s+d4[e])),t}function mg(t){const e={};return en(Array.isArray(t)&&t.length>1),t.forEach(n=>{for(const r in n)e[r]=e[r]?"".concat(e[r],`
`).concat(n[r]):n[r]}),e}function ro(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const JT=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],h4=[...JT,[ro("attribute"),"in $1"],[ro("varying"),"out $1"]],p4=[...JT,[ro("varying"),"in $1"]],eA=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],g4=[...eA,[ro("in"),"attribute $1"],[ro("out"),"varying $1"]],m4=[...eA,[ro("in"),"varying $1"]],vg="gl_FragColor",yg=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,v4=/void\s+main\s*\([^)]*\)\s*\{\n?/;function y4(t,e,n){switch(e){case 300:return n?ju(t,h4):_4(t);case 100:return n?ju(t,g4):E4(t);default:throw new Error("unknown GLSL version ".concat(e))}}function ju(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}function _4(t){t=ju(t,p4);const e=t.match(yg);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(vg,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace(v4,r=>"out vec4 ".concat(n,`;
`).concat(r)).replace(new RegExp("\\b".concat(vg,"\\b"),"g"),n)}return t}function E4(t){t=ju(t,m4);const e=t.match(yg);if(e){const n=e[1];t=t.replace(yg,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),vg)}return t}const w4=`

`.concat(Zc,`

`),tA={[_l]:"vertex",[L0]:"fragment"},b4=`precision highp float;

`;function x4(t,e){const{vs:n,fs:r}=e,i=Zj(e.modules||[]);return{gl:t,vs:f1(t,Object.assign({},e,{source:n,type:_l,modules:i})),fs:f1(t,Object.assign({},e,{source:r,type:L0,modules:i})),getUniforms:S4(i)}}function f1(t,e){let{id:n,source:r,type:i,modules:s,defines:o={},hookFunctions:a=[],inject:l={},transpileToGLSL100:c=!1,prologue:u=!0,log:d}=e;en(typeof r=="string","shader source must be a string");const f=i===_l,h=r.split(`
`);let p=100,m="",E=r;h[0].indexOf("#version ")===0?(p=300,m=h[0],E=h.slice(1).join(`
`)):m="#version ".concat(p);const v={};s.forEach(R=>{Object.assign(v,R.getDefines())}),Object.assign(v,o);let g=u?"".concat(m,`
`).concat(A4({id:n,source:r,type:i}),`
`).concat(T4({type:i}),`
`).concat(l4(t),`
`).concat(c4(t),`
`).concat(C4(v),`
`).concat(f?"":b4,`
`):"".concat(m,`
`);const y=R4(a),b={},T={},A={};for(const R in l){const I=typeof l[R]=="string"?{injection:l[R],order:0}:l[R],D=R.match(/^(v|f)s:(#)?([\w-]+)$/);if(D){const N=D[2],F=D[3];N?F==="decl"?T[R]=[I]:A[R]=[I]:b[R]=[I]}else A[R]=[I]}for(const R of s){d&&R.checkDeprecations(E,d);const I=R.getModuleSource(i,p);g+=I;const D=R.injections[i];for(const N in D){const F=N.match(/^(v|f)s:#([\w-]+)$/);if(F){const G=F[2]==="decl"?T:A;G[N]=G[N]||[],G[N].push(D[N])}else b[N]=b[N]||[],b[N].push(D[N])}}return g+=w4,g=u1(g,i,T),g+=P4(y[i],b),g+=E,g=u1(g,i,A),g=y4(g,c?100:p,f),g}function S4(t){return function(n){const r={};for(const i of t){const s=i.getUniforms(n,r);Object.assign(r,s)}return r}}function T4(t){let{type:e}=t;return`
#define SHADER_TYPE_`.concat(tA[e].toUpperCase(),`
`)}function A4(t){let{id:e,source:n,type:r}=t;return e&&typeof e=="string"&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(tA[r],`

`):""}function C4(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,n="";for(const r in t){e===0&&(n+=`
// APPLICATION DEFINES
`),e++;const i=t[r];(i||Number.isFinite(i))&&(n+="#define ".concat(r.toUpperCase()," ").concat(t[r],`
`))}return e===0&&(n+=`
`),n}function P4(t,e){let n="";for(const r in t){const i=t[r];if(n+="void ".concat(i.signature,` {
`),i.header&&(n+="  ".concat(i.header)),e[r]){const s=e[r];s.sort((o,a)=>o.order-a.order);for(const o of s)n+="  ".concat(o.injection,`
`)}i.footer&&(n+="  ".concat(i.footer)),n+=`}
`}return n}function R4(t){const e={vs:{},fs:{}};return t.forEach(n=>{let r;typeof n!="string"?(r=n,n=r.hook):r={},n=n.trim();const[i,s]=n.split(":"),o=n.replace(/\(.+/,"");e[i][o]=Object.assign(r,{signature:s})}),e}const L4="void main() {gl_FragColor = vec4(0);}",nA=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,M4=`#version 300 es
`.concat(nA);function rA(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[r,i,s]=n;if(!e.includes(r)||!i||!s)return null;const o=s.split(";")[0];return{qualifier:r,type:i,name:o}}function iA(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:e=100,input:n,inputType:r,output:i}=t;if(!n)return e===300?M4:e>300?"#version ".concat(e,`
`).concat(nA):L4;const s=O4(n,r);return e>=300?"#version ".concat(e," ").concat(e===300?"es":"",`
in `).concat(r," ").concat(n,`;
out vec4 `).concat(i,`;
void main() {
  `).concat(i," = ").concat(s,`;
}`):"varying ".concat(r," ").concat(n,`;
void main() {
  gl_FragColor = `).concat(s,`;
}`)}function k4(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return en(!1),null}}function I4(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return en(!1),null}}function O4(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return en(!1),null}}const N4=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,D4={name:"fp32",vs:N4,fs:null};function d1(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}const Qt={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function F4(t,{precision:e=Qt.precision}={}){return t=U4(t),"".concat(parseFloat(t.toPrecision(e)))}function io(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function $r(t,e,n){return z4(t,r=>Math.max(e,Math.min(n,r)))}function Vu(t,e,n){return io(t)?t.map((r,i)=>Vu(r,e[i],n)):n*e+(1-n)*t}function Wa(t,e,n){const r=Qt.EPSILON;n&&(Qt.EPSILON=n);try{if(t===e)return!0;if(io(t)&&io(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!Wa(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=Qt.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{Qt.EPSILON=r}}function U4(t){return Math.round(t/Qt.EPSILON)*Qt.EPSILON}function B4(t){return t.clone?t.clone():new Array(t.length)}function z4(t,e,n){if(io(t)){const r=t;n=n||B4(r);for(let i=0;i<n.length&&i<r.length;++i)n[i]=e(t[i],i,n);return n}return e(t)}function j4(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class sA extends j4(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:io(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Qt)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+F4(this[r],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!Wa(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let i=0;i<this.ELEMENTS;++i){const s=e[i];this[i]=s+r*(n[i]-s)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(Qt.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}}function V4(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Xt(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function wh(t,e,n=""){if(Qt.debug&&!V4(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}class $4 extends sA{get x(){return this[0]}set x(e){this[0]=Xt(e)}get y(){return this[1]}set y(e){this[1]=Xt(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const i=this[r]-e[r];n+=i*i}return Xt(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return Xt(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return d1(e>=0&&e<this.ELEMENTS,"index is out of range"),Xt(this[e])}setComponent(e,n){return d1(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}var Qc=1e-6,so=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function G4(){var t=new so(2);return so!=Float32Array&&(t[0]=0,t[1]=0),t}function h1(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function W4(t,e){return t[0]=-e[0],t[1]=-e[1],t}function oA(t,e,n,r){var i=e[0],s=e[1];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t}function H4(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}(function(){var t=G4();return function(e,n,r,i,s,o){var a,l;for(n||(n=2),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],s(t,t,o),e[a]=t[0],e[a+1]=t[1];return e}})();function Y4(t,e,n){const r=e[0],i=e[1],s=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/s,t[1]=(n[1]*r+n[5]*i)/s,t}function aA(t,e,n){const r=e[0],i=e[1],s=e[2],o=n[3]*r+n[7]*i+n[11]*s||1;return t[0]=(n[0]*r+n[4]*i+n[8]*s)/o,t[1]=(n[1]*r+n[5]*i+n[9]*s)/o,t[2]=(n[2]*r+n[6]*i+n[10]*s)/o,t}function X4(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}function K4(){var t=new so(3);return so!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function q4(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Z4(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Q4(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function J4(t,e,n){var r=e[0],i=e[1],s=e[2],o=n[0],a=n[1],l=n[2];return t[0]=i*l-s*a,t[1]=s*o-r*l,t[2]=r*a-i*o,t}function lA(t,e,n){var r=e[0],i=e[1],s=e[2],o=n[3]*r+n[7]*i+n[11]*s+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/o,t[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/o,t[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/o,t}function eV(t,e,n){var r=e[0],i=e[1],s=e[2];return t[0]=r*n[0]+i*n[3]+s*n[6],t[1]=r*n[1]+i*n[4]+s*n[7],t[2]=r*n[2]+i*n[5]+s*n[8],t}function tV(t,e,n){var r=n[0],i=n[1],s=n[2],o=n[3],a=e[0],l=e[1],c=e[2],u=i*c-s*l,d=s*a-r*c,f=r*l-i*a,h=i*f-s*d,p=s*u-r*f,m=r*d-i*u,E=o*2;return u*=E,d*=E,f*=E,h*=2,p*=2,m*=2,t[0]=a+u+h,t[1]=l+d+p,t[2]=c+f+m,t}function nV(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function rV(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function iV(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function sV(t,e){var n=t[0],r=t[1],i=t[2],s=e[0],o=e[1],a=e[2],l=Math.sqrt(n*n+r*r+i*i),c=Math.sqrt(s*s+o*o+a*a),u=l*c,d=u&&Q4(t,e)/u;return Math.acos(Math.min(Math.max(d,-1),1))}var oV=q4;(function(){var t=K4();return function(e,n,r,i,s,o){var a,l;for(n||(n=3),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}})();const bh=[0,0,0];let mc;class Gn extends $4{static get ZERO(){return mc||(mc=new Gn(0,0,0),Object.freeze(mc)),mc}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&io(e)?this.copy(e):(Qt.debug&&(Xt(e),Xt(n),Xt(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Qt.debug&&(Xt(e.x),Xt(e.y),Xt(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=Xt(e)}angle(e){return sV(this,e)}cross(e){return J4(this,this,e),this.check()}rotateX({radians:e,origin:n=bh}){return nV(this,this,n,e),this.check()}rotateY({radians:e,origin:n=bh}){return rV(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=bh}){return iV(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return lA(this,this,e),this.check()}transformAsVector(e){return aA(this,this,e),this.check()}transformByMatrix3(e){return eV(this,this,e),this.check()}transformByMatrix2(e){return X4(this,this,e),this.check()}transformByQuaternion(e){return tV(this,this,e),this.check()}}class aV extends sA{toString(){let e="[";if(Qt.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=" ".concat(this[r*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=Xt(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[r+i];return n}setColumn(e,n){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)this[r+i]=n[i];return this}}function lV(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function cV(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],s=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=s,t[11]=e[14],t[12]=i,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function _g(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=e[9],f=e[10],h=e[11],p=e[12],m=e[13],E=e[14],v=e[15],g=n*a-r*o,y=n*l-i*o,b=n*c-s*o,T=r*l-i*a,A=r*c-s*a,R=i*c-s*l,I=u*m-d*p,D=u*E-f*p,N=u*v-h*p,F=d*E-f*m,q=d*v-h*m,G=f*v-h*E,W=g*G-y*q+b*F+T*N-A*D+R*I;return W?(W=1/W,t[0]=(a*G-l*q+c*F)*W,t[1]=(i*q-r*G-s*F)*W,t[2]=(m*R-E*A+v*T)*W,t[3]=(f*A-d*R-h*T)*W,t[4]=(l*N-o*G-c*D)*W,t[5]=(n*G-i*N+s*D)*W,t[6]=(E*b-p*R-v*y)*W,t[7]=(u*R-f*b+h*y)*W,t[8]=(o*q-a*N+c*I)*W,t[9]=(r*N-n*q-s*I)*W,t[10]=(p*A-m*b+v*g)*W,t[11]=(d*b-u*A-h*g)*W,t[12]=(a*D-o*F-l*I)*W,t[13]=(n*F-r*D+i*I)*W,t[14]=(m*y-p*T-E*g)*W,t[15]=(u*T-d*y+f*g)*W,t):null}function uV(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8],u=t[9],d=t[10],f=t[11],h=t[12],p=t[13],m=t[14],E=t[15],v=e*o-n*s,g=e*a-r*s,y=e*l-i*s,b=n*a-r*o,T=n*l-i*o,A=r*l-i*a,R=c*p-u*h,I=c*m-d*h,D=c*E-f*h,N=u*m-d*p,F=u*E-f*p,q=d*E-f*m;return v*q-g*F+y*N+b*D-T*I+A*R}function Ii(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],d=e[8],f=e[9],h=e[10],p=e[11],m=e[12],E=e[13],v=e[14],g=e[15],y=n[0],b=n[1],T=n[2],A=n[3];return t[0]=y*r+b*a+T*d+A*m,t[1]=y*i+b*l+T*f+A*E,t[2]=y*s+b*c+T*h+A*v,t[3]=y*o+b*u+T*p+A*g,y=n[4],b=n[5],T=n[6],A=n[7],t[4]=y*r+b*a+T*d+A*m,t[5]=y*i+b*l+T*f+A*E,t[6]=y*s+b*c+T*h+A*v,t[7]=y*o+b*u+T*p+A*g,y=n[8],b=n[9],T=n[10],A=n[11],t[8]=y*r+b*a+T*d+A*m,t[9]=y*i+b*l+T*f+A*E,t[10]=y*s+b*c+T*h+A*v,t[11]=y*o+b*u+T*p+A*g,y=n[12],b=n[13],T=n[14],A=n[15],t[12]=y*r+b*a+T*d+A*m,t[13]=y*i+b*l+T*f+A*E,t[14]=y*s+b*c+T*h+A*v,t[15]=y*o+b*u+T*p+A*g,t}function $u(t,e,n){var r=n[0],i=n[1],s=n[2],o,a,l,c,u,d,f,h,p,m,E,v;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*s+e[12],t[13]=e[1]*r+e[5]*i+e[9]*s+e[13],t[14]=e[2]*r+e[6]*i+e[10]*s+e[14],t[15]=e[3]*r+e[7]*i+e[11]*s+e[15]):(o=e[0],a=e[1],l=e[2],c=e[3],u=e[4],d=e[5],f=e[6],h=e[7],p=e[8],m=e[9],E=e[10],v=e[11],t[0]=o,t[1]=a,t[2]=l,t[3]=c,t[4]=u,t[5]=d,t[6]=f,t[7]=h,t[8]=p,t[9]=m,t[10]=E,t[11]=v,t[12]=o*r+u*i+p*s+e[12],t[13]=a*r+d*i+m*s+e[13],t[14]=l*r+f*i+E*s+e[14],t[15]=c*r+h*i+v*s+e[15]),t}function k0(t,e,n){var r=n[0],i=n[1],s=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function fV(t,e,n,r){var i=r[0],s=r[1],o=r[2],a=Math.hypot(i,s,o),l,c,u,d,f,h,p,m,E,v,g,y,b,T,A,R,I,D,N,F,q,G,W,xe;return a<Qc?null:(a=1/a,i*=a,s*=a,o*=a,l=Math.sin(n),c=Math.cos(n),u=1-c,d=e[0],f=e[1],h=e[2],p=e[3],m=e[4],E=e[5],v=e[6],g=e[7],y=e[8],b=e[9],T=e[10],A=e[11],R=i*i*u+c,I=s*i*u+o*l,D=o*i*u-s*l,N=i*s*u-o*l,F=s*s*u+c,q=o*s*u+i*l,G=i*o*u+s*l,W=s*o*u-i*l,xe=o*o*u+c,t[0]=d*R+m*I+y*D,t[1]=f*R+E*I+b*D,t[2]=h*R+v*I+T*D,t[3]=p*R+g*I+A*D,t[4]=d*N+m*F+y*q,t[5]=f*N+E*F+b*q,t[6]=h*N+v*F+T*q,t[7]=p*N+g*F+A*q,t[8]=d*G+m*W+y*xe,t[9]=f*G+E*W+b*xe,t[10]=h*G+v*W+T*xe,t[11]=p*G+g*W+A*xe,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function cA(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],d=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+c*r,t[5]=o*i+u*r,t[6]=a*i+d*r,t[7]=l*i+f*r,t[8]=c*i-s*r,t[9]=u*i-o*r,t[10]=d*i-a*r,t[11]=f*i-l*r,t}function dV(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],l=e[3],c=e[8],u=e[9],d=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-c*r,t[1]=o*i-u*r,t[2]=a*i-d*r,t[3]=l*i-f*r,t[8]=s*r+c*i,t[9]=o*r+u*i,t[10]=a*r+d*i,t[11]=l*r+f*i,t}function uA(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],l=e[3],c=e[4],u=e[5],d=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+c*r,t[1]=o*i+u*r,t[2]=a*i+d*r,t[3]=l*i+f*r,t[4]=c*i-s*r,t[5]=u*i-o*r,t[6]=d*i-a*r,t[7]=f*i-l*r,t}function hV(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,a=r+r,l=i+i,c=n*o,u=r*o,d=r*a,f=i*o,h=i*a,p=i*l,m=s*o,E=s*a,v=s*l;return t[0]=1-d-p,t[1]=u+v,t[2]=f-E,t[3]=0,t[4]=u-v,t[5]=1-c-p,t[6]=h+m,t[7]=0,t[8]=f+E,t[9]=h-m,t[10]=1-c-d,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function pV(t,e,n,r,i,s,o){var a=1/(n-e),l=1/(i-r),c=1/(s-o);return t[0]=s*2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s*2*l,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(i+r)*l,t[10]=(o+s)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*s*2*c,t[15]=0,t}function gV(t,e,n,r,i){var s=1/Math.tan(e/2),o;return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}var mV=gV;function vV(t,e,n,r,i,s,o){var a=1/(e-n),l=1/(r-i),c=1/(s-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*a,t[13]=(i+r)*l,t[14]=(o+s)*c,t[15]=1,t}var yV=vV;function _V(t,e,n,r){var i,s,o,a,l,c,u,d,f,h,p=e[0],m=e[1],E=e[2],v=r[0],g=r[1],y=r[2],b=n[0],T=n[1],A=n[2];return Math.abs(p-b)<Qc&&Math.abs(m-T)<Qc&&Math.abs(E-A)<Qc?lV(t):(u=p-b,d=m-T,f=E-A,h=1/Math.hypot(u,d,f),u*=h,d*=h,f*=h,i=g*f-y*d,s=y*u-v*f,o=v*d-g*u,h=Math.hypot(i,s,o),h?(h=1/h,i*=h,s*=h,o*=h):(i=0,s=0,o=0),a=d*o-f*s,l=f*i-u*o,c=u*s-d*i,h=Math.hypot(a,l,c),h?(h=1/h,a*=h,l*=h,c*=h):(a=0,l=0,c=0),t[0]=i,t[1]=a,t[2]=u,t[3]=0,t[4]=s,t[5]=l,t[6]=d,t[7]=0,t[8]=o,t[9]=c,t[10]=f,t[11]=0,t[12]=-(i*p+s*m+o*E),t[13]=-(a*p+l*m+c*E),t[14]=-(u*p+d*m+f*E),t[15]=1,t)}function EV(){var t=new so(4);return so!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function wV(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function El(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*s+n[12]*o,t[1]=n[1]*r+n[5]*i+n[9]*s+n[13]*o,t[2]=n[2]*r+n[6]*i+n[10]*s+n[14]*o,t[3]=n[3]*r+n[7]*i+n[11]*s+n[15]*o,t}(function(){var t=EV();return function(e,n,r,i,s,o){var a,l;for(n||(n=4),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}})();var Eg;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(Eg||(Eg={}));const bV=45*Math.PI/180,xV=1,xh=.1,Sh=500,SV=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class Wn extends aV{static get IDENTITY(){return AV()}static get ZERO(){return TV()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return Eg}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,i,s,o,a,l,c,u,d,f,h,p,m,E){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=s,this[5]=o,this[6]=a,this[7]=l,this[8]=c,this[9]=u,this[10]=d,this[11]=f,this[12]=h,this[13]=p,this[14]=m,this[15]=E,this.check()}setRowMajor(e,n,r,i,s,o,a,l,c,u,d,f,h,p,m,E){return this[0]=e,this[1]=s,this[2]=c,this[3]=h,this[4]=n,this[5]=o,this[6]=u,this[7]=p,this[8]=r,this[9]=a,this[10]=d,this[11]=m,this[12]=i,this[13]=l,this[14]=f,this[15]=E,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(SV)}fromObject(e){return this.check()}fromQuaternion(e){return hV(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:i,top:s,near:o=xh,far:a=Sh}=e;return a===1/0?CV(this,n,r,i,s,o):pV(this,n,r,i,s,o,a),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:i=[0,1,0]}=e;return _V(this,n,r,i),this.check()}ortho(e){const{left:n,right:r,bottom:i,top:s,near:o=xh,far:a=Sh}=e;return yV(this,n,r,i,s,o,a),this.check()}orthographic(e){const{fovy:n=bV,aspect:r=xV,focalDistance:i=1,near:s=xh,far:o=Sh}=e;p1(n);const a=n/2,l=i*Math.tan(a),c=l*r;return this.ortho({left:-c,right:c,bottom:-l,top:l,near:s,far:o})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:i=.1,far:s=500}=e;return p1(n),mV(this,n,r,i,s),this.check()}determinant(){return uV(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],o=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*s,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*s,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],o=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=this[4]*i,e[4]=this[5]*s,e[5]=this[6]*o,e[6]=this[8]*i,e[7]=this[9]*s,e[8]=this[10]*o,e}transpose(){return cV(this,this),this.check()}invert(){return _g(this,this),this.check()}multiplyLeft(e){return Ii(this,e,this),this.check()}multiplyRight(e){return Ii(this,this,e),this.check()}rotateX(e){return cA(this,this,e),this.check()}rotateY(e){return dV(this,this,e),this.check()}rotateZ(e){return uA(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return fV(this,this,e,n),this.check()}scale(e){return k0(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return $u(this,this,e),this.check()}transform(e,n){return e.length===4?(n=El(n||[-0,-0,-0,-0],e,this),wh(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let i;switch(r){case 2:i=H4(n||[-0,-0],e,this);break;case 3:i=lA(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return wh(i,e.length),i}transformAsVector(e,n){let r;switch(e.length){case 2:r=Y4(n||[-0,-0],e,this);break;case 3:r=aA(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return wh(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}}let vc,yc;function TV(){return vc||(vc=new Wn([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(vc)),vc}function AV(){return yc||(yc=new Wn,Object.freeze(yc)),yc}function p1(t){if(t>Math.PI*2)throw Error("expected radians")}function CV(t,e,n,r,i,s){const o=2*s/(n-e),a=2*s/(i-r),l=(n+e)/(n-e),c=(i+r)/(i-r),u=-1,d=-1,f=-2*s;return t[0]=o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=l,t[9]=c,t[10]=u,t[11]=d,t[12]=0,t[13]=0,t[14]=f,t[15]=0,t}const g1=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`,PV={lightSources:{}};function Th(){let{color:t=[0,0,0],intensity:e=1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.map(n=>n*e/255)}function RV(t){let{ambientLight:e,pointLights:n=[],directionalLights:r=[]}=t;const i={};return e?i["lighting_uAmbientLight.color"]=Th(e):i["lighting_uAmbientLight.color"]=[0,0,0],n.forEach((s,o)=>{i["lighting_uPointLight[".concat(o,"].color")]=Th(s),i["lighting_uPointLight[".concat(o,"].position")]=s.position,i["lighting_uPointLight[".concat(o,"].attenuation")]=s.attenuation||[1,0,0]}),i.lighting_uPointLightCount=n.length,r.forEach((s,o)=>{i["lighting_uDirectionalLight[".concat(o,"].color")]=Th(s),i["lighting_uDirectionalLight[".concat(o,"].direction")]=s.direction}),i.lighting_uDirectionalLightCount=r.length,i}function fA(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:PV;if("lightSources"in t){const{ambientLight:e,pointLights:n,directionalLights:r}=t.lightSources||{};return e||n&&n.length>0||r&&r.length>0?Object.assign({},RV({ambientLight:e,pointLights:n,directionalLights:r}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const e={pointLights:[],directionalLights:[]};for(const n of t.lights||[])switch(n.type){case"ambient":e.ambientLight=n;break;case"directional":e.directionalLights.push(n);break;case"point":e.pointLights.push(n);break}return fA({lightSources:e})}return{}}const dA={name:"lights",vs:g1,fs:g1,getUniforms:fA,defines:{MAX_LIGHTS:3}},LV=new Uint8Array([0,255,255,255]),MV={pickingSelectedColor:null,pickingHighlightColor:LV,pickingActive:!1,pickingAttribute:!1};function kV(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:MV;const e={};if(t.pickingSelectedColor!==void 0)if(!t.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,r=>r/255);Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return t.pickingActive!==void 0&&(e.picking_uActive=!!t.pickingActive,e.picking_uAttribute=!!t.pickingAttribute),e}const IV=`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,OV=`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,NV={name:"picking",vs:IV,fs:OV,getUniforms:kV},hA=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`,DV={};function FV(t){const{ambient:e=.35,diffuse:n=.6,shininess:r=32,specularColor:i=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:r,lighting_uSpecularColor:i.map(s=>s/255)}}function pA(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:DV;if(!("material"in t))return{};const{material:e}=t;return e?FV(e):{lighting_uEnabled:!1}}const gA={name:"gouraud-lighting",dependencies:[dA],vs:hA,defines:{LIGHTING_VERTEX:1},getUniforms:pA},UV={name:"phong-lighting",dependencies:[dA],fs:hA,defines:{LIGHTING_FRAGMENT:1},getUniforms:pA},BV=`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,zV={name:"transform",vs:BV,fs:null};class wl{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new wl(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:n="",fs:r="",defines:i={},inject:s={},varyings:o=[],bufferMode:a=35981,transpileToGLSL100:l=!1}=e,c=this._getModuleList(e.modules),u=this._getHash(n),d=this._getHash(r),f=c.map(y=>this._getHash(y.name)).sort(),h=o.map(y=>this._getHash(y)),p=Object.keys(i).sort(),m=Object.keys(s).sort(),E=[],v=[];for(const y of p)E.push(this._getHash(y)),E.push(this._getHash(i[y]));for(const y of m)v.push(this._getHash(y)),v.push(this._getHash(s[y]));const g="".concat(u,"/").concat(d,"D").concat(E.join("/"),"M").concat(f.join("/"),"I").concat(v.join("/"),"V").concat(h.join("/"),"H").concat(this.stateHash,"B").concat(a).concat(l?"T":"");if(!this._programCache[g]){const y=x4(this.gl,{vs:n,fs:r,modules:c,inject:s,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:l});this._programCache[g]=new KT(this.gl,{hash:g,vs:y.vs,fs:y.fs,varyings:o,bufferMode:a}),this._getUniforms[g]=y.getUniforms||(b=>{}),this._useCounts[g]=0}return this._useCounts[g]++,this._programCache[g]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),r={};let i=0;for(let s=0,o=this._defaultModules.length;s<o;++s){const a=this._defaultModules[s],l=a.name;n[i++]=a,r[l]=!0}for(let s=0,o=e.length;s<o;++s){const a=e[s],l=a.name;r[l]||(n[i++]=a,r[l]=!0)}return n.length=i,n}}const jV={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function VV(t,e,n){const r={};let i=e.indices;for(const s in e.attributes){const o=e.attributes[s],a=$V(s,n);if(s==="indices")i=o;else if(o.constant)r[a]=o.value;else{const l=o.value,c={...o};delete c.value,r[a]=[new Me(t,l),c],GV(s,c)}}if(i){const s=i.value||i;Z(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const o={size:1,isIndexed:i.isIndexed===void 0?!0:i.isIndexed};r.indices=[new Me(t,{data:s,target:34963}),o]}return r}function $V(t,e){const{attributeMap:n=jV}=e||{};return n&&n[t]||t}function GV(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}Z(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const as=2,WV=1e4,HV="Model needs drawMode and vertexCount",m1=()=>{},YV={};class si{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:r=vr("model")}=n;Z(Kf(e)),this.id=r,this.gl=e,this.id=n.id||vr("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||wl.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},Z(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),HV)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return Z(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return Z(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=VV(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(no(e))return this;const n={};for(const r in e){const i=e[r];n[r]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(n),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return C0(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:r,uniforms:i={},attributes:s={},transformFeedback:o=this.transformFeedback,parameters:a={},vertexArray:l=this.vertexArray}=e;this.setAttributes(s),this.updateModuleSettings(n),this.setUniforms(i);let c;se.priority>=as&&(c=this._logDrawCallStart(as));const u=this.vertexArray.getDrawParams(),{isIndexed:d=u.isIndexed,indexType:f=u.indexType,indexOffset:h=u.indexOffset,vertexArrayInstanced:p=u.isInstanced}=this.props;p&&!this.isInstanced&&se.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:m,instanceCount:E}=this,{onBeforeRender:v=m1,onAfterRender:g=m1}=this.props;v(),this.program.setUniforms(this.uniforms);const y=this.program.draw(Object.assign(YV,e,{logPriority:c,uniforms:null,framebuffer:r,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:l,transformFeedback:o,isIndexed:d,indexType:f,isInstanced:m,instanceCount:E,offset:d?h:0}));return g(),se.priority>=as&&this._logDrawCallEnd(c,l,r),y}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:n=!0,feedbackBuffers:r,unbindModels:i=[]}=e;let{parameters:s}=e;r&&this._setFeedbackBuffers(r),n&&(s=Object.assign({},s,{35977:n})),i.forEach(o=>o.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{i.forEach(o=>o.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return se.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:r,fs:i,modules:s,inject:o,defines:a,varyings:l,bufferMode:c,transpileToGLSL100:u}=this.programProps;n=this.programManager.get({vs:r,fs:i,modules:s,inject:o,defines:a,varyings:l,bufferMode:c,transpileToGLSL100:u}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}Z(n instanceof KT,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new Uj(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof Me&&n.delete()}}_setAnimationProps(e){this.animated&&Z(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(no(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new qT(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:WV;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),se.group(as,">>> DRAWING MODEL ".concat(this.id),{collapsed:se.level<=2})(),e}_logDrawCallEnd(e,n,r,i){if(e===void 0)return;const s=jj({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:o,unusedTable:a,unusedCount:l}=t1({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r)}),{table:c,count:u}=t1({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r),undefinedOnly:!0});u>0&&se.log("MISSING UNIFORMS",Object.keys(c))(),l>0&&se.log("UNUSED UNIFORMS",Object.keys(a))();const d=$j(this.vertexArray.configuration);se.table(e,s)(),se.table(e,o)(),se.table(e+1,d)(),i&&i.log({logLevel:as,message:"Rendered to ".concat(i.id)}),se.groupEnd(as)()}}class XV{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}setupResources(e){for(const n of this.bindings)this._setupTransformFeedback(n,e)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:n}=this;return n.length>0&&(e=Object.assign({},e,{varyings:n})),e}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.bindings[this.currentIndex],{sourceBuffers:r,transformFeedback:i}=n;return{attributes:Object.assign({},r,e.attributes),transformFeedback:i}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:n}=this.bindings[this.currentIndex],r=e?n[e]:null;return r?r instanceof Me?r:r.buffer:null}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:n}=e,r=this.getBuffer(n);return r?r.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&Z(we(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:n={}}=e,r={};if(this.bindings[this.currentIndex]&&Object.assign(r,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const i in this.feedbackMap){const s=this.feedbackMap[i];i in n&&(r[s]=i)}Object.assign(r,e.feedbackBuffers);for(const i in r){const s=r[i];if(typeof s=="string"){const o=n[s],{byteLength:a,usage:l,accessor:c}=o;r[i]=this._createNewBuffer(i,{byteLength:a,usage:l,accessor:c})}}return r}_setupBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const r=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:n,feedbackBuffers:r})}_setupTransformFeedback(e,n){let{model:r}=n;const{program:i}=r;e.transformFeedback=new qT(this.gl,{program:i,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:n,feedbackBuffers:r}=this._swapBuffers(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceBuffers:n,feedbackBuffers:r})}}_updateBinding(e,n){return e?(Object.assign(e.sourceBuffers,n.sourceBuffers),Object.assign(e.feedbackBuffers,n.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},n.sourceBuffers),feedbackBuffers:Object.assign({},n.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const n=Object.assign({},e.sourceBuffers),r=Object.assign({},e.feedbackBuffers);for(const i in this.feedbackMap){const s=this.feedbackMap[i];n[i]=e.feedbackBuffers[s],r[s]=e.sourceBuffers[i],Z(r[s]instanceof Me)}return{sourceBuffers:n,feedbackBuffers:r}}_createNewBuffer(e,n){const r=new Me(this.gl,n);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=r,r}_getNextIndex(){return(this.currentIndex+1)%2}}const KV="transform_uSampler_",Gu="transform_uSize_",v1="transform_position";function qV(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:r,targetTexture:i}=t,o=Object.keys(n).length,a=null;const l={};let c=e,u={};if(o>0||r){const d=c.split(`
`),f=d.slice();if(d.forEach((h,p,m)=>{if(o>0){const E=t5(h,n);if(E){const{updatedLine:v,inject:g}=E;f[p]=v,u=mg([u,g]),Object.assign(l,E.samplerTextureMap),o--}}r&&!a&&(a=e5(h,r))}),r){Z(i);const h="".concat(Gu).concat(r),p="uniform vec2 ".concat(h,`;
`),m="     vec2 ".concat(v1," = transform_getPos(").concat(h,`);
     gl_Position = vec4(`).concat(v1,`, 0, 1.);
`);u=mg([u,{"vs:#decl":p,"vs:#main-start":m}])}c=f.join(`
`)}return{vs:c,targetTextureType:a,inject:u,samplerTextureMap:l}}function ZV(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:r}=t;const i={};let s,o;n&&({width:s,height:o}=r,i["".concat(Gu).concat(n)]=[s,o]);for(const a in e)({width:s,height:o}=e[a]),i["".concat(Gu).concat(a)]=[s,o];return i}function QV(t){return rA(t,["attribute","in"])}function JV(t){const e="".concat(KV).concat(t),n="".concat(Gu).concat(t),r="  uniform sampler2D ".concat(e,`;
  uniform vec2 `).concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:r}}function e5(t,e){const n=rA(t,["varying","out"]);return n&&n.name===e?n.type:null}function t5(t,e){const n={},r=QV(t);if(!r)return null;const{type:i,name:s}=r;if(s&&e[s]){const o="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:a,sizeName:l,uniformDeclerations:c}=JV(s),u=k4(i),d="  ".concat(i," ").concat(s," = transform_getInput(").concat(a,", ").concat(l,").").concat(u,`;
`);return n[a]=s,{updatedLine:o,inject:{"vs:#decl":c,"vs:#main-start":d},samplerTextureMap:n}}return null}const n5={10241:9728,10240:9728,10242:33071,10243:33071},r5="transform_output";class i5{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._processVertexShader(e);return Object.assign({},e,n)}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,sourceTextures:r,framebuffer:i,targetTexture:s}=this.bindings[this.currentIndex],o=Object.assign({},n,e.attributes),a=Object.assign({},e.uniforms),l=Object.assign({},e.parameters);let c=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const d in this.samplerTextureMap){const f=this.samplerTextureMap[d];a[d]=r[f]}this._setSourceTextureParameters();const u=ZV({sourceTextureMap:r,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(a,u)}return this.hasTargetTexture&&(c=!1,l.viewport=[0,0,i.width,i.height]),{attributes:o,framebuffer:i,uniforms:a,discard:c,parameters:l}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:n}=this.bindings[this.currentIndex],r=Zf(n);if(!e)return r;const i=r.constructor,s=I4(this.targetTextureType),o=new i(r.length*s/4);let a=0;for(let l=0;l<r.length;l+=4)for(let c=0;c<s;c++)o[a++]=r[l+c];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:n,_swapTexture:r}=e;this._swapTexture=r,this.targetTextureVarying=n,this.hasTargetTexture=n,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:n,textureOrReference:r}=e;if(r instanceof nn)return r;const i=n[r];return i?(this._targetRefTexName=r,this._createNewTexture(i)):null}_setupTextures(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,_sourceTextures:r={},_targetTexture:i}=e,s=this._createTargetTexture({sourceTextures:r,textureOrReference:i});this.hasSourceTextures=this.hasSourceTextures||r&&Object.keys(r).length>0,this._updateBindings({sourceBuffers:n,sourceTextures:r,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if(typeof e!="number"||this.elementCount>=e)return;const n=new Float32Array(e);n.forEach((r,i,s)=>{s[i]=i}),this.elementIDBuffer?this.elementIDBuffer.setData({data:n}):this.elementIDBuffer=new Me(this.gl,{data:n,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:n,targetTexture:r}=this._swapTextures(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceTextures:n,targetTexture:r})}}_updateBinding(e,n){const{sourceBuffers:r,sourceTextures:i,targetTexture:s}=n;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,i),Object.assign(e.sourceBuffers,r),s){e.targetTexture=s;const{width:o,height:a}=s,{framebuffer:l}=e;l?(l.update({attachments:{36064:s},resizeAttachments:!1}),l.resize({width:o,height:a})):e.framebuffer=new ot(this.gl,{id:"transform-framebuffer",width:o,height:a,attachments:{36064:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(const r in n)n[r].setParameters(n5)}_swapTextures(e){if(!this._swapTexture)return null;const n=Object.assign({},e.sourceTextures);n[this._swapTexture]=e.targetTexture;const r=e.sourceTextures[this._swapTexture];return{sourceTextures:n,targetTexture:r}}_createNewTexture(e){const n=Cz(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=n,n}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:n,targetTexture:r}=this.bindings[this.currentIndex],{vs:i,uniforms:s,targetTextureType:o,inject:a,samplerTextureMap:l}=qV({vs:e.vs,sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:r}),c=mg([e.inject||{},a]);this.targetTextureType=o,this.samplerTextureMap=l;const u=e._fs||iA({version:YT(i),input:this.targetTextureVarying,inputType:o,output:r5}),d=this.hasSourceTextures||this.targetTextureVarying?[zV].concat(e.modules||[]):e.modules;return{vs:i,fs:u,modules:d,uniforms:s,inject:c}}}let I0=class{static isSupported(e){return we(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}delete(){const{model:e,bufferTransform:n,textureTransform:r}=this;e&&e.delete(),n&&n.delete(),r&&r.delete()}run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:n=!0}=e,r=this._updateDrawOptions(e);n&&r.framebuffer&&r.framebuffer.clear({color:!0}),this.model.transform(r)}swap(){let e=!1;const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)e=e||r.swap();Z(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n){const i=r.getData(e);if(i)return i}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)r.update(e)}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:n}=this;this._buildResourceTransforms(n,e),e=this._updateModelProps(e),this.model=new si(n,Object.assign({},e,{fs:e.fs||iA({version:YT(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=i.updateModelProps(n);return n}_buildResourceTransforms(e,n){s5(n)&&(this.bufferTransform=new XV(e,n)),o5(n)&&(this.textureTransform=new i5(e,n)),Z(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=Object.assign(n,i.getDrawOptions(n));return n}};function s5(t){return!!(!no(t.feedbackBuffers)||!no(t.feedbackMap)||t.varyings&&t.varyings.length>0)}function o5(t){return!!(!no(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)}const y1={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class Eo{static get DRAW_MODE(){return y1}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=vr("geometry"),drawMode:r=y1.TRIANGLES,attributes:i={},indices:s=null,vertexCount:o=null}=e;this.id=n,this.drawMode=r|0,this.attributes={},this.userData={},this._setAttributes(i,s),this.vertexCount=o||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,n){n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n);for(const r in e){let i=e[r];i=ArrayBuffer.isView(i)?{value:i}:i,Z(ArrayBuffer.isView(i.value),"".concat(this._print(r),": must be typed array or object with value as typed array")),(r==="POSITION"||r==="positions")&&!i.size&&(i.size=3),r==="indices"?(Z(!this.indices),this.indices=i):this.attributes[r]=i}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,n){if(n)return n.value.length;let r=1/0;for(const i in e){const s=e[i],{value:o,size:a,constant:l}=s;!l&&o&&a>=1&&(r=Math.min(r,o.length/a))}return Z(Number.isFinite(r)),r}}let a5=1,l5=1;class mA{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:n=0,duration:r=Number.POSITIVE_INFINITY,rate:i=1,repeat:s=1}=e,o=a5++,a={time:0,delay:n,duration:r,rate:i,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[n,r]of this.animations)r.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const i of n)this._setChannelTime(i,this.time);const r=this.animations.values();for(const i of r){const{animation:s,channel:o}=i;s.setTime(this.getTime(o))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const r=l5++;return this.animations.set(r,{animation:e,channel:n}),e.setTime(this.getTime(n)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const r=n-e.delay,i=e.duration*e.repeat;r>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}const c5=[255,255,255],u5=1;let f5=0;class d5{constructor(e={}){_(this,"id",void 0),_(this,"color",void 0),_(this,"intensity",void 0),_(this,"type","ambient");const{color:n=c5}=e,{intensity:r=u5}=e;this.id=e.id||"ambient-".concat(f5++),this.color=n,this.intensity=r}}const h5=[255,255,255],p5=1,g5=[0,0,-1];let m5=0;class _1{constructor(e={}){_(this,"id",void 0),_(this,"color",void 0),_(this,"intensity",void 0),_(this,"type","directional"),_(this,"direction",void 0),_(this,"shadow",void 0);const{color:n=h5}=e,{intensity:r=p5}=e,{direction:i=g5}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(m5++),this.color=n,this.intensity=r,this.type="directional",this.direction=new Gn(i).normalize().toArray(),this.shadow=s}getProjectedLight(e){return this}}class v5{constructor(e,n={id:"pass"}){_(this,"id",void 0),_(this,"gl",void 0),_(this,"props",void 0);const{id:r}=n;this.id=r,this.gl=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class O0 extends v5{constructor(...e){super(...e),_(this,"_lastRenderIndex",-1)}render(e){const n=this.gl;return mr(n,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:n,moduleParameters:r,viewports:i,views:s,onViewportActive:o,clearStack:a=!0,clearCanvas:l=!0}=e;e.pass=e.pass||"unknown";const c=this.gl;l&&_5(c,n),a&&(this._lastRenderIndex=-1);const u=[];for(const d of i){const f=s&&s[d.id];o==null||o(d);const h=this._getDrawLayerParams(d,e),p=d.subViewports||[d];for(const m of p){const E=this._drawLayersInViewport(c,{target:n,moduleParameters:r,viewport:m,view:f,pass:e.pass,layers:e.layers},h);u.push(E)}}return u}_getDrawLayerParams(e,{layers:n,pass:r,isPicking:i=!1,layerFilter:s,cullRect:o,effects:a,moduleParameters:l},c=!1){const u=[],d=vA(this._lastRenderIndex+1),f={layer:n[0],viewport:e,isPicking:i,renderPass:r,cullRect:o},h={};for(let p=0;p<n.length;p++){const m=n[p],E=this._shouldDrawLayer(m,f,s,h),v={shouldDrawLayer:E};E&&!c&&(v.layerRenderIndex=d(m,E),v.moduleParameters=this._getModuleParameters(m,a,r,l),v.layerParameters=this.getLayerParameters(m,p,e)),u[p]=v}return u}_drawLayersInViewport(e,{layers:n,moduleParameters:r,pass:i,target:s,viewport:o,view:a},l){const c=y5(e,{moduleParameters:r,target:s,viewport:o});if(a&&a.props.clear){const d=a.props.clear===!0?{color:!0,depth:!0}:a.props.clear;Pn(e,{scissorTest:!0,scissor:c},()=>C0(e,d))}const u={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};mr(e,{viewport:c});for(let d=0;d<n.length;d++){const f=n[d],{shouldDrawLayer:h,layerRenderIndex:p,moduleParameters:m,layerParameters:E}=l[d];if(h&&f.props.pickable&&u.pickableCount++,f.isComposite)u.compositeCount++;else if(h){u.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,p),m.viewport=o;try{f._drawLayer({moduleParameters:m,uniforms:{layerIndex:p},parameters:E})}catch(v){f.raiseError(v,"drawing ".concat(f," to ").concat(i))}}}return u}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,r){return e.props.parameters}_shouldDrawLayer(e,n,r,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let o=e.parent;for(;o;){if(!o.props.visible||!o.filterSubLayer(n))return!1;n.layer=o,o=o.parent}if(r){const a=n.layer.id;if(a in i||(i[a]=r(n)),!i[a])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,r,i){var s;const o=Object.assign(Object.create(((s=e.internalState)===null||s===void 0?void 0:s.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:to(this.gl)});if(n)for(const l of n){var a;Object.assign(o,(a=l.getModuleParameters)===null||a===void 0?void 0:a.call(l,e))}return Object.assign(o,this.getModuleParameters(e,n),i)}}function vA(t=0,e={}){const n={},r=(i,s)=>{const o=i.props._offset,a=i.id,l=i.parent&&i.parent.id;let c;if(l&&!(l in e)&&r(i.parent,!1),l in n){const u=n[l]=n[l]||vA(e[l],e);c=u(i,s),n[a]=u}else Number.isFinite(o)?(c=o+(e[l]||0),n[a]=null):c=t;return s&&c>=t&&(t=c+1),e[a]=c,c};return r}function y5(t,{moduleParameters:e,target:n,viewport:r}){const i=n&&n.id!=="default-framebuffer",s=e&&e.devicePixelRatio||to(t),o=i?n.height:t.drawingBufferHeight,a=r;return[a.x*s,o-(a.y+a.height)*s,a.width*s,a.height*s]}function _5(t,e){const n=e?e.width:t.drawingBufferWidth,r=e?e.height:t.drawingBufferHeight;mr(t,{viewport:[0,0,n,r]}),t.clear(16640)}class E5 extends O0{constructor(e,n){super(e,n),_(this,"shadowMap",void 0),_(this,"depthBuffer",void 0),_(this,"fbo",void 0),this.shadowMap=new nn(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new Cs(e,{format:33189,width:1,height:1}),this.fbo=new ot(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const n=this.fbo;Pn(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const r=e.viewports[0],i=to(this.gl),s=r.width*i,o=r.height*i;(s!==n.width||o!==n.height)&&n.resize({width:s,height:o}),super.render({...e,target:n,pass:"shadow"})})}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const yA="#define SMOOTH_EDGE_RADIUS 0.5",w5=`
`.concat(yA,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),b5=`
`.concat(yA,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),x5={name:"geometry",vs:w5,fs:b5},S5=Object.keys(Ce).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(Ce[t],";")).join(""),T5=Object.keys(Bn).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(Bn[t],";")).join(""),A5=Object.keys(gr).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(gr[t],";")).join(""),C5="".concat(S5,`
`).concat(T5,`
`).concat(A5,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
  float y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {
    
    if (geometry.position.w == 0.0) {
      return project_size_at_latitude(geometry.worldPosition.y);
    }
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

float project_size_at_latitude(float meters, float lat) {
  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}
vec3 project_normal(vec3 vector) {
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size_at_latitude(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world.xyz -= project_uCoordinateOrigin;
  }
  return project_offset_(position_world) + project_offset_(project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function P5(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function bl(t){let e={},n;return r=>{for(const i in r)if(!P5(r[i],e[i])){n=t(r),e=r;break}return n}}const E1=[0,0,0,0],R5=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],_A=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],L5=[0,0,0],EA=[0,0,0],M5=bl(O5);function wA(t,e,n=EA){n.length<3&&(n=[n[0],n[1],0]);let r=n,i,s=!0;switch(e===Ce.LNGLAT_OFFSETS||e===Ce.METER_OFFSETS?i=n:i=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case Bn.WEB_MERCATOR:(e===Ce.LNGLAT||e===Ce.CARTESIAN)&&(i=[0,0,0],s=!1);break;case Bn.WEB_MERCATOR_AUTO_OFFSET:e===Ce.LNGLAT?r=i:e===Ce.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case Bn.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case Bn.GLOBE:s=!1,i=null;break;default:s=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:s}}function k5(t,e,n){const{viewMatrixUncentered:r,projectionMatrix:i}=t;let{viewMatrix:s,viewProjectionMatrix:o}=t,a=E1,l=E1,c=t.cameraPosition;const{geospatialOrigin:u,shaderCoordinateOrigin:d,offsetMode:f}=wA(t,e,n);return f&&(l=t.projectPosition(u||d),c=[c[0]-l[0],c[1]-l[1],c[2]-l[2]],l[3]=1,a=El([],l,o),s=r||s,o=Ii([],i,s),o=Ii([],o,R5)),{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:l,cameraPosCommon:c,shaderCoordinateOrigin:d,geospatialOrigin:u}}function I5({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=Ce.DEFAULT,coordinateOrigin:i=EA,autoWrapLongitude:s=!1}){r===Ce.DEFAULT&&(r=t.isGeospatial?Ce.LNGLAT:Ce.CARTESIAN);const o=M5({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return o.project_uWrapLongitude=s,o.project_uModelMatrix=n||_A,o}function O5({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:r}){const{projectionCenter:i,viewProjectionMatrix:s,originCommon:o,cameraPosCommon:a,shaderCoordinateOrigin:l,geospatialOrigin:c}=k5(t,n,r),u=t.getDistanceScales(),d=[t.width*e,t.height*e],f=El([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,h={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:l,project_uCommonOrigin:o.slice(0,3),project_uCenter:i,project_uPseudoMeters:!!t._pseudoMeters,project_uViewportSize:d,project_uDevicePixelRatio:e,project_uFocalDistance:f,project_uCommonUnitsPerMeter:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:L5,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:s,project_uModelMatrix:_A,project_uCameraPosition:a};if(c){const p=t.getDistanceScales(c);switch(n){case Ce.METER_OFFSETS:h.project_uCommonUnitsPerWorldUnit=p.unitsPerMeter,h.project_uCommonUnitsPerWorldUnit2=p.unitsPerMeter2;break;case Ce.LNGLAT:case Ce.LNGLAT_OFFSETS:t._pseudoMeters||(h.project_uCommonUnitsPerMeter=p.unitsPerMeter),h.project_uCommonUnitsPerWorldUnit=p.unitsPerDegree,h.project_uCommonUnitsPerWorldUnit2=p.unitsPerDegree2;break;case Ce.CARTESIAN:h.project_uCommonUnitsPerWorldUnit=[1,1,p.unitsPerMeter[2]],h.project_uCommonUnitsPerWorldUnit2=[0,0,p.unitsPerMeter2[2]];break}}return h}const N5={};function D5(t=N5){return"viewport"in t?I5(t):{}}const N0={name:"project",dependencies:[D4,x5],vs:C5,getUniforms:D5};function F5(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Us(t,e){const n=El([],e,t);return wV(n,n,1/n[3]),n}function w1(t,e){const n=t%e;return n<0?e+n:n}function wg(t,e,n){return t<e?e:t>n?n:t}function U5(t){return Math.log(t)*Math.LOG2E}const D0=Math.log2||U5;function yr(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const Sn=Math.PI,bA=Sn/4,dn=Sn/180,bg=180/Sn,oo=512,Wu=4003e4,_c=85.051129,B5=1.5;function z5(t){return D0(t)}function Hu(t){const[e,n]=t;yr(Number.isFinite(e)),yr(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=e*dn,i=n*dn,s=oo*(r+Sn)/(2*Sn),o=oo*(Sn+Math.log(Math.tan(bA+i*.5)))/(2*Sn);return[s,o]}function ao(t){const[e,n]=t,r=e/oo*(2*Sn)-Sn,i=2*(Math.atan(Math.exp(n/oo*(2*Sn)-Sn))-bA);return[r*bg,i*bg]}function j5(t){const{latitude:e}=t;yr(Number.isFinite(e));const n=Math.cos(e*dn);return z5(Wu*n)-9}function Ah(t){const e=Math.cos(t*dn);return oo/Wu/e}function xg(t){const{latitude:e,longitude:n,highPrecision:r=!1}=t;yr(Number.isFinite(e)&&Number.isFinite(n));const i=oo,s=Math.cos(e*dn),o=i/360,a=o/s,l=i/Wu/s,c={unitsPerMeter:[l,l,l],metersPerUnit:[1/l,1/l,1/l],unitsPerDegree:[o,a,l],degreesPerUnit:[1/o,1/a,1/l]};if(r){const u=dn*Math.tan(e*dn)/s,d=o*u/2,f=i/Wu*u,h=f/a*l;c.unitsPerDegree2=[0,d,f],c.unitsPerMeter2=[h,0,h]}return c}function xA(t,e){const[n,r,i]=t,[s,o,a]=e,{unitsPerMeter:l,unitsPerMeter2:c}=xg({longitude:n,latitude:r,highPrecision:!0}),u=Hu(t);u[0]+=s*(l[0]+c[0]*o),u[1]+=o*(l[1]+c[1]*o);const d=ao(u),f=(i||0)+(a||0);return Number.isFinite(i)||Number.isFinite(a)?[d[0],d[1],f]:d}function V5(t){const{height:e,pitch:n,bearing:r,altitude:i,scale:s,center:o}=t,a=F5();$u(a,a,[0,0,-i]),cA(a,a,-n*dn),uA(a,a,r*dn);const l=s/e;return k0(a,a,[l,l,l]),o&&$u(a,a,Z4([],o)),a}function $5(t){const{width:e,height:n,altitude:r,pitch:i=0,offset:s,center:o,scale:a,nearZMultiplier:l=1,farZMultiplier:c=1}=t;let{fovy:u=Yu(B5)}=t;r!==void 0&&(u=Yu(r));const d=u*dn,f=i*dn,h=SA(u);let p=h;o&&(p+=o[2]*a/Math.cos(f)/n);const m=d*(.5+(s?s[1]:0)/n),E=Math.sin(m)*p/Math.sin(wg(Math.PI/2-f-m,.01,Math.PI-.01)),v=Math.sin(f)*E+p,g=p*10,y=Math.min(v*c,g);return{fov:d,aspect:e/n,focalDistance:h,near:l,far:y}}function Yu(t){return 2*Math.atan(.5/t)*bg}function SA(t){return .5/Math.tan(.5*t*dn)}function TA(t,e){const[n,r,i=0]=t;return yr(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),Us(e,[n,r,i,1])}function F0(t,e,n=0){const[r,i,s]=t;if(yr(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s))return Us(e,[r,i,s,1]);const o=Us(e,[r,i,0,1]),a=Us(e,[r,i,1,1]),l=o[2],c=a[2],u=l===c?0:((n||0)-l)/(c-l);return oA([],o,a,u)}function G5(t){const{width:e,height:n,bounds:r,minExtent:i=0,maxZoom:s=24,offset:o=[0,0]}=t,[[a,l],[c,u]]=r,d=W5(t.padding),f=Hu([a,wg(u,-_c,_c)]),h=Hu([c,wg(l,-_c,_c)]),p=[Math.max(Math.abs(h[0]-f[0]),i),Math.max(Math.abs(h[1]-f[1]),i)],m=[e-d.left-d.right-Math.abs(o[0])*2,n-d.top-d.bottom-Math.abs(o[1])*2];yr(m[0]>0&&m[1]>0);const E=m[0]/p[0],v=m[1]/p[1],g=(d.right-d.left)/2/E,y=(d.top-d.bottom)/2/v,b=[(h[0]+f[0])/2+g,(h[1]+f[1])/2+y],T=ao(b),A=Math.min(s,D0(Math.abs(Math.min(E,v))));return yr(Number.isFinite(A)),{longitude:T[0],latitude:T[1],zoom:A}}function W5(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(yr(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const b1=Math.PI/180;function H5(t,e=0){const{width:n,height:r,unproject:i}=t,s={targetZ:e},o=i([0,r],s),a=i([n,r],s);let l,c;const u=t.fovy?.5*t.fovy*b1:Math.atan(.5/t.altitude),d=(90-t.pitch)*b1;return u>d-.01?(l=x1(t,0,e),c=x1(t,n,e)):(l=i([0,0],s),c=i([n,0],s)),[o,a,c,l]}function x1(t,e,n){const{pixelUnprojectionMatrix:r}=t,i=Us(r,[e,0,1,1]),s=Us(r,[e,t.height,1,1]),a=(n*t.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2]),l=oA([],i,s,a),c=ao(l);return c.push(n),c}const S1=512;function Y5(t){const{width:e,height:n,pitch:r=0}=t;let{longitude:i,latitude:s,zoom:o,bearing:a=0}=t;(i<-180||i>180)&&(i=w1(i+180,360)-180),(a<-180||a>180)&&(a=w1(a+180,360)-180);const l=D0(n/S1);if(o<=l)o=l,s=0;else{const c=n/2/Math.pow(2,o),u=ao([0,c])[1];if(s<u)s=u;else{const d=ao([0,S1-c])[1];s>d&&(s=d)}}return{width:e,height:n,longitude:i,latitude:s,zoom:o,pitch:r,bearing:a}}const X5=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,K5=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,q5=bl(t6),Z5=bl(n6),Q5=[0,0,0,1],J5=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function e6(t,e){const[n,r,i]=t,s=F0([n,r,i],e);return Number.isFinite(i)?s:[s[0],s[1],0]}function t6({viewport:t,center:e}){return new Wn(t.viewProjectionMatrix).invert().transform(e)}function n6({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,s=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(o=>e6(o,r));for(const o of e){const a=o.clone().translate(new Gn(t.center).negate()),l=s.map(u=>a.transform(u)),c=new Wn().ortho({left:Math.min(...l.map(u=>u[0])),right:Math.max(...l.map(u=>u[0])),bottom:Math.min(...l.map(u=>u[1])),top:Math.max(...l.map(u=>u[1])),near:Math.min(...l.map(u=>-u[2])),far:Math.max(...l.map(u=>-u[2]))});n.push(c.multiplyRight(o))}return n}function r6(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const r={shadow_uDrawShadowMap:!!t.drawToShadowMap,shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||Q5,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},i=q5({viewport:t.viewport,center:e.project_uCenter}),s=[],o=Z5({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let a=0;a<t.shadowMatrices.length;a++){const l=o[a],c=l.clone().translate(new Gn(t.viewport.center).negate());e.project_uCoordinateSystem===Ce.LNGLAT&&e.project_uProjectionMode===Bn.WEB_MERCATOR?(o[a]=c,s[a]=i):(o[a]=l.clone().multiplyRight(J5),s[a]=c.transform(i))}for(let a=0;a<o.length;a++)r["shadow_uViewProjectionMatrices[".concat(a,"]")]=o[a],r["shadow_uProjectCenters[".concat(a,"]")]=s[a],t.shadowMaps&&t.shadowMaps.length>0?r["shadow_uShadowMap".concat(a)]=t.shadowMaps[a]:r["shadow_uShadowMap".concat(a)]=t.dummyShadowMap;return r}const Ch={name:"shadow",dependencies:[N0],vs:X5,fs:K5,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?r6(t,e):{}},i6={color:[255,255,255],intensity:1},T1=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],s6=[0,0,0,200/255];class AA{constructor(e={}){_(this,"id","lighting-effect"),_(this,"props",void 0),_(this,"shadowColor",s6),_(this,"shadow",void 0),_(this,"ambientLight",void 0),_(this,"directionalLights",void 0),_(this,"pointLights",void 0),_(this,"shadowPasses",[]),_(this,"shadowMaps",[]),_(this,"dummyShadowMap",null),_(this,"programManager",void 0),_(this,"shadowMatrices",void 0),this.setProps(e)}setProps(e){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const n in e){const r=e[n];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow),this.props=e}preRender(e,{layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:o}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(e),this.programManager||(this.programManager=wl.getDefaultProgramManager(e),Ch&&this.programManager.addDefaultModule(Ch)),this.dummyShadowMap||(this.dummyShadowMap=new nn(e,{width:1,height:1}));for(let a=0;a<this.shadowPasses.length;a++)this.shadowPasses[a].render({layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:o,moduleParameters:{shadowLightId:a,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(r=>r.getProjectedLight({layer:e})),pointLights:this.pointLights.map(r=>r.getProjectedLight({layer:e}))},n}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(Ch),this.programManager=null)}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const r=new Wn().lookAt({eye:new Gn(n.direction).negate()});e.push(r)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const r=new E5(e);this.shadowPasses[n]=r,this.shadowMaps[n]=r.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:r}=this;!e&&n.length===0&&r.length===0&&(this.ambientLight=new d5(i6),this.directionalLights.push(new _1(T1[0]),new _1(T1[1])))}}class o6{constructor(e={}){_(this,"_pool",[]),_(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:r=1,type:i,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:l}){const c=i||e&&e.constructor||Float32Array,u=n*r+s;if(ArrayBuffer.isView(e)){if(u<=e.length)return e;if(u*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new c(e.buffer,0,u)}let d=1/0;l&&(d=l*r+s);const f=this._allocate(c,u,a,d);return e&&o?f.set(e):a||f.fill(0,0,4),this._release(e),f}release(e){this._release(e)}_allocate(e,n,r,i){let s=Math.max(Math.ceil(n*this.opts.overAlloc),1);s>i&&(s=i);const o=this._pool,a=e.BYTES_PER_ELEMENT*s,l=o.findIndex(c=>c.byteLength>=a);if(l>=0){const c=new e(o.splice(l,1)[0],0,s);return r&&c.fill(0),c}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:r}=e,{byteLength:i}=r,s=n.findIndex(o=>o.byteLength>=i);s<0?n.push(r):(s>0||n.length<this.opts.poolSize)&&n.splice(s,0,r),n.length>this.opts.poolSize&&n.shift()}}const lo=new o6;function ia(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function a6(t){return[t[12],t[13],t[14]]}function l6(t){return{left:ls(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:ls(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:ls(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:ls(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:ls(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:ls(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const A1=new Gn;function ls(t,e,n,r){A1.set(t,e,n);const i=A1.len();return{distance:r/i,normal:new Gn(-t/i,-e/i,-n/i)}}function c6(t){return t-Math.fround(t)}let Yo;function Ph(t,e){const{size:n=1,startIndex:r=0}=e,i=e.endIndex!==void 0?e.endIndex:t.length,s=(i-r)/n;Yo=lo.allocate(Yo,s,{type:Float32Array,size:n*2});let o=r,a=0;for(;o<i;){for(let l=0;l<n;l++){const c=t[o++];Yo[a+l]=c,Yo[a+l+n]=c6(c)}a+=n*2}return Yo.subarray(0,s*n*2)}function u6(t){let e=null,n=!1;for(const r of t)r&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],r[0][0]),e[0][1]=Math.min(e[0][1],r[0][1]),e[1][0]=Math.max(e[1][0],r[1][0]),e[1][1]=Math.max(e[1][1],r[1][1])):e=r);return e}const f6=Math.PI/180,d6=ia(),C1=[0,0,0],h6={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function p6({width:t,height:e,orthographic:n,fovyRadians:r,focalDistance:i,padding:s,near:o,far:a}){const l=t/e,c=n?new Wn().orthographic({fovy:r,aspect:l,focalDistance:i,near:o,far:a}):new Wn().perspective({fovy:r,aspect:l,near:o,far:a});if(s){const{left:u=0,right:d=0,top:f=0,bottom:h=0}=s,p=$r((u+t-d)/2,0,t)-t/2,m=$r((f+e-h)/2,0,e)-e/2;c[8]-=p*2/t,c[9]+=m*2/e}return c}class wo{constructor(e={}){_(this,"id",void 0),_(this,"x",void 0),_(this,"y",void 0),_(this,"width",void 0),_(this,"height",void 0),_(this,"padding",void 0),_(this,"isGeospatial",void 0),_(this,"zoom",void 0),_(this,"focalDistance",void 0),_(this,"position",void 0),_(this,"modelMatrix",void 0),_(this,"distanceScales",void 0),_(this,"scale",void 0),_(this,"center",void 0),_(this,"cameraPosition",void 0),_(this,"projectionMatrix",void 0),_(this,"viewMatrix",void 0),_(this,"viewMatrixUncentered",void 0),_(this,"viewMatrixInverse",void 0),_(this,"viewProjectionMatrix",void 0),_(this,"pixelProjectionMatrix",void 0),_(this,"pixelUnprojectionMatrix",void 0),_(this,"resolution",void 0),_(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||h6,this.focalDistance=e.focalDistance||1,this.position=e.position||C1,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:r}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?Bn.WEB_MERCATOR:Bn.WEB_MERCATOR_AUTO_OFFSET:Bn.IDENTITY}equals(e){return e instanceof wo?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&Wa(e.projectionMatrix,this.projectionMatrix)&&Wa(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const r=this.projectPosition(e),i=TA(r,this.pixelProjectionMatrix),[s,o]=i,a=n?o:this.height-o;return e.length===2?[s,a]:[s,a,i[2]]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,s,o]=e,a=n?s:this.height-s,l=r&&r*this.distanceScales.unitsPerMeter[2],c=F0([i,a,o],this.pixelUnprojectionMatrix,l),[u,d,f]=this.unprojectPosition(c);return Number.isFinite(o)?[u,d,f]:Number.isFinite(r)?[u,d,r]:[u,d]}projectPosition(e){const[n,r]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,r,i]}unprojectPosition(e){const[n,r]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,r,i]}projectFlat(e){if(this.isGeospatial){const n=Hu(e);return n[1]=$r(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?ao(e):e}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,0],n),i=this.unproject([this.width,0],n),s=this.unproject([0,this.height],n),o=this.unproject([this.width,this.height],n);return[Math.min(r[0],i[0],s[0],o[0]),Math.min(r[1],i[1],s[1],o[1]),Math.max(r[0],i[0],s[0],o[0]),Math.max(r[1],i[1],s[1],o[1])]}getDistanceScales(e){return e?xg({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:r=1,height:i=1}){return e<this.x+this.width&&this.x<e+r&&n<this.y+this.height&&this.y<n+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,l6(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,r=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=j5({latitude:r})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||xg({latitude:r,longitude:n}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:s,modelMatrix:o}=e;let a=C1;if(s&&(a=o?new Wn(o).transformAsVector(s,[]):s),this.isGeospatial){const l=this.projectPosition([n,r,0]);this.center=new Gn(a).scale(this.distanceScales.unitsPerMeter).add(l)}else this.center=this.projectPosition(a)}_initMatrices(e){const{viewMatrix:n=d6,projectionMatrix:r=null,orthographic:i=!1,fovyRadians:s,fovy:o=75,near:a=.1,far:l=1e3,padding:c=null,focalDistance:u=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new Wn().multiplyRight(n).translate(new Gn(this.center).negate()),this.projectionMatrix=r||p6({width:this.width,height:this.height,orthographic:i,fovyRadians:s||o*f6,focalDistance:u,padding:c,near:a,far:l});const d=ia();Ii(d,d,this.projectionMatrix),Ii(d,d,this.viewMatrix),this.viewProjectionMatrix=d,this.viewMatrixInverse=_g([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=a6(this.viewMatrixInverse);const f=ia(),h=ia();k0(f,f,[this.width/2,-this.height/2,1]),$u(f,f,[1,-1,0]),Ii(h,f,this.viewProjectionMatrix),this.pixelProjectionMatrix=h,this.pixelUnprojectionMatrix=_g(ia(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||ye.warn("Pixel project matrix not invertible")()}}_(wo,"displayName","Viewport");class co extends wo{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,pitch:s=0,bearing:o=0,nearZMultiplier:a=.1,farZMultiplier:l=1.01,nearZ:c,farZ:u,orthographic:d=!1,projectionMatrix:f,repeat:h=!1,worldOffset:p=0,position:m,padding:E,legacyMeterSizes:v=!1}=e;let{width:g,height:y,altitude:b=1.5}=e;const T=Math.pow(2,i);g=g||1,y=y||1;let A,R=null;if(f)b=f[5]/2,A=Yu(b);else{e.fovy?(A=e.fovy,b=SA(A)):A=Yu(b);let D;if(E){const{top:N=0,bottom:F=0}=E;D=[0,$r((N+y-F)/2,0,y)-y/2]}R=$5({width:g,height:y,scale:T,center:m&&[0,0,m[2]*Ah(n)],offset:D,pitch:s,fovy:A,nearZMultiplier:a,farZMultiplier:l}),Number.isFinite(c)&&(R.near=c),Number.isFinite(u)&&(R.far=u)}let I=V5({height:y,pitch:s,bearing:o,scale:T,altitude:b});p&&(I=new Wn().translate([512*p,0,0]).multiplyLeft(I)),super({...e,width:g,height:y,viewMatrix:I,longitude:r,latitude:n,zoom:i,...R,fovy:A,focalDistance:b}),_(this,"longitude",void 0),_(this,"latitude",void 0),_(this,"pitch",void 0),_(this,"bearing",void 0),_(this,"altitude",void 0),_(this,"fovy",void 0),_(this,"orthographic",void 0),_(this,"_subViewports",void 0),_(this,"_pseudoMeters",void 0),this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=s,this.bearing=o,this.altitude=b,this.fovy=A,this.orthographic=d,this._subViewports=h?[]:null,this._pseudoMeters=v,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let i=n;i<=r;i++){const s=i?new co({...this,worldOffset:i}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,r]=this.projectFlat(e),i=(e[2]||0)*Ah(e[1]);return[n,r,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,r]=this.unprojectFlat(e),i=(e[2]||0)/Ah(r);return[n,r,i]}addMetersToLngLat(e,n){return xA(e,n)}panByPosition(e,n){const r=F0(n,this.pixelUnprojectionMatrix),i=this.projectFlat(e),s=h1([],i,W4([],r)),o=h1([],this.center,s),[a,l]=this.unprojectFlat(o);return{longitude:a,latitude:l}}getBounds(e={}){const n=H5(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:r,height:i}=this,{longitude:s,latitude:o,zoom:a}=G5({width:r,height:i,bounds:e,...n});return new co({width:r,height:i,longitude:s,latitude:o,zoom:a})}}_(co,"displayName","WebMercatorViewport");const P1=[0,0,0];function Rh(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof co){const[i,s,o=0]=t,a=e.getDistanceScales([i,s]);r[2]=o*a.unitsPerMeter[2]}return r}function g6(t){const{viewport:e,modelMatrix:n,coordinateOrigin:r}=t;let{coordinateSystem:i,fromCoordinateSystem:s,fromCoordinateOrigin:o}=t;return i===Ce.DEFAULT&&(i=e.isGeospatial?Ce.LNGLAT:Ce.CARTESIAN),s===void 0&&(s=i),o===void 0&&(o=r),{viewport:e,coordinateSystem:i,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:o}}function CA(t,{viewport:e,modelMatrix:n,coordinateSystem:r,coordinateOrigin:i,offsetMode:s}){let[o,a,l=0]=t;switch(n&&([o,a,l]=El([],[o,a,l,1],n)),r){case Ce.LNGLAT:return Rh([o,a,l],e,s);case Ce.LNGLAT_OFFSETS:return Rh([o+i[0],a+i[1],l+(i[2]||0)],e,s);case Ce.METER_OFFSETS:return Rh(xA(i,[o,a,l]),e,s);case Ce.CARTESIAN:default:return e.isGeospatial?[o+i[0],a+i[1],l+i[2]]:e.projectPosition([o,a,l])}}function m6(t,e){const{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=g6(e),{autoOffset:l=!0}=e,{geospatialOrigin:c=P1,shaderCoordinateOrigin:u=P1,offsetMode:d=!1}=l?wA(n,r,i):{},f=CA(t,{viewport:n,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:d});if(d){const h=n.projectPosition(c||u);oV(f,f,h)}return f}const R1={blendFunc:[1,0,32771,0],blendEquation:32774};class PA extends O0{constructor(...e){super(...e),_(this,"pickZ",void 0),_(this,"_colorEncoderState",null)}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:l,width:c,height:u},cullRect:d,effects:f,pass:h="picking",pickZ:p,moduleParameters:m}){const E=this.gl;this.pickZ=p;const v=this._resetColorEncoder(p),g=Pn(E,{scissorTest:!0,scissor:[a,l,c,u],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...R1,blend:!p},()=>super.render({target:o,layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,cullRect:d,effects:f==null?void 0:f.filter(b=>b.useInPicking),pass:h,isPicking:!0,moduleParameters:m}));return this._colorEncoderState=null,{decodePickingColor:v&&y6.bind(null,v),stats:g}}shouldDrawLayer(e){const{pickable:n,operation:r}=e.props;return n&&r.includes("draw")||r.includes("terrain")||r.includes("mask")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,n,r){const i={...e.props.parameters},{pickable:s,operation:o}=e.props;return this._colorEncoderState?s&&o.includes("draw")&&(Object.assign(i,R1),i.blend=!0,i.blendColor=v6(this._colorEncoderState,e,r)):i.blend=!1,o.includes("terrain")&&(i.blend=!1),i}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function v6(t,e,n){const{byLayer:r,byAlpha:i}=t;let s,o=r.get(e);return o?(o.viewports.push(n),s=o.a):(s=r.size+1,s<=255?(o={a:s,layer:e,viewports:[n]},r.set(e,o),i[s]=o):(ye.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}function y6(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const ps={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},Xu=Symbol.for("component"),ni=Symbol.for("propTypes"),Lh=Symbol.for("deprecatedProps"),Bs=Symbol.for("asyncPropDefaults"),$i=Symbol.for("asyncPropOriginal"),Gr=Symbol.for("asyncPropResolved");function U0(t,e=()=>!0){return Array.isArray(t)?RA(t,e,[]):e(t)?[t]:[]}function RA(t,e,n){let r=-1;for(;++r<t.length;){const i=t[r];Array.isArray(i)?RA(i,e,n):e(i)&&n.push(i)}return n}function _6({target:t,source:e,start:n=0,count:r=1}){const i=e.length,s=r*i;let o=0;for(let a=n;o<i;o++)t[a++]=e[o];for(;o<s;)o<s-o?(t.copyWithin(n+o,n,n+o),o*=2):(t.copyWithin(n+o,n,n+s-o),o=s);return t}class E6{constructor(e,n,r){_(this,"id",void 0),_(this,"context",void 0),_(this,"isLoaded",void 0),_(this,"persistent",void 0),_(this,"_loadCount",0),_(this,"_subscribers",new Set),_(this,"_data",void 0),_(this,"_loader",void 0),_(this,"_error",void 0),_(this,"_content",void 0),this.id=e,this.context=r,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const r=++this._loadCount;let i=e;typeof e=="string"&&(i=Bu(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class w6{constructor({gl:e,protocol:n}){_(this,"protocol",void 0),_(this,"_context",void 0),_(this,"_resources",void 0),_(this,"_consumers",void 0),_(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:r=!1,persistent:i=!0}){let s=this._resources[e];s?s.setData(n,r):(s=new E6(e,n,this._context),this._resources[e]=s),s.persistent=i}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const r in n){const i=n[r],s=this._resources[i.resourceId];s&&s.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:r,requestId:i="default"}){const{_resources:s,protocol:o}=this;e.startsWith(o)&&(e=e.replace(o,""),s[e]||this.add({resourceId:e,data:null,persistent:!1}));const a=s[e];if(this._track(r,i,a,n),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,r,i){const s=this._consumers,o=s[e]=s[e]||{},a=o[n]||{},l=a.resourceId&&this._resources[a.resourceId];l&&(l.unsubscribe(a),this.prune()),r&&(o[n]=a,a.onChange=i,a.resourceId=r.id,r.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const b6=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,bo={name:"project32",dependencies:[N0],vs:b6},xo={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:#decl":`
uniform bool picking_uAttribute;
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},...NV},x6=[N0],S6=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function T6(t){const e=wl.getDefaultProgramManager(t);for(const n of x6)e.addDefaultModule(n);for(const n of S6)e.addShaderHook(n);return e}const A6="layerManager.setLayers",C6="layerManager.activateViewport";class P6{constructor(e,{deck:n,stats:r,viewport:i,timeline:s}={}){_(this,"layers",void 0),_(this,"context",void 0),_(this,"resourceManager",void 0),_(this,"_lastRenderedLayers",[]),_(this,"_needsRedraw",!1),_(this,"_needsUpdate",!1),_(this,"_nextLayers",null),_(this,"_debug",!1),_(this,"activateViewport",o=>{wt(C6,this,o),o&&(this.context.viewport=o)}),this.layers=[],this.resourceManager=new w6({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:n,programManager:e&&T6(e),stats:r||new m0({id:"deck.gl"}),viewport:i||new wo({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new mA,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const i=r.getNeedsRedraw(e);n=n||i}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(r=>n.id.indexOf(r)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){wt(A6,this,n,e),this._lastRenderedLayers=e;const r=U0(e,Boolean);for(const i of r)i.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,n,r){r.raiseError(n,"".concat(e," of ").concat(r))}_updateLayers(e,n){const r={};for(const o of e)r[o.id]?ye.warn("Multiple old layers with same id ".concat(o.id))():r[o.id]=o;const i=[];this._updateSublayersRecursively(n,r,i),this._finalizeOldLayers(r);let s=!1;for(const o of i)if(o.hasUniformTransition()){s="Uniform transition in ".concat(o);break}this._needsUpdate=s,this.layers=i}_updateSublayersRecursively(e,n,r){for(const i of e){i.context=this.context;const s=n[i.id];s===null&&ye.warn("Multiple new layers with same id ".concat(i.id))(),n[i.id]=null;let o=null;try{this._debug&&s!==i&&i.validateProps(),s?(this._transferLayerState(s,i),this._updateLayer(i)):this._initializeLayer(i),r.push(i),o=i.isComposite?i.getSubLayers():null}catch(a){this._handleError("matching",a,i)}o&&this._updateSublayersRecursively(o,n,r)}}_finalizeOldLayers(e){for(const n in e){const r=e[n];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=ps.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=ps.MATCHED,n!==e&&(e.lifecycle=ps.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=ps.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=ps.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function zn(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!zn(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const s of r)if(!e.hasOwnProperty(s)||!zn(t[s],e[s],n-1))return!1;return!0}return!1}class R6{constructor(e){_(this,"width",void 0),_(this,"height",void 0),_(this,"views",void 0),_(this,"viewState",void 0),_(this,"controllers",void 0),_(this,"timeline",void 0),_(this,"_viewports",void 0),_(this,"_viewportMap",void 0),_(this,"_isUpdating",void 0),_(this,"_needsRedraw",void 0),_(this,"_needsUpdate",void 0),_(this,"_eventManager",void 0),_(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,r=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(r):r}getViewport(e){return this._viewportMap[e]}unproject(e,n){const r=this.getViewports(),i={x:e[0],y:e[1]};for(let s=r.length-1;s>=0;--s){const o=r[s];if(o.containsPixel(i)){const a=e.slice();return a[0]-=o.x,a[1]-=o.y,o.unproject(a,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=U0(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!zn(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):ye.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,n){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...n,viewId:e})}_createController(e,n){const r=n.type;return new r({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,n.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>{var o;return(o=this.getView(e.id))===null||o===void 0?void 0:o.makeViewport({viewState:s,width:this.width,height:this.height})}})}_updateController(e,n,r,i){const s=e.controller;if(s&&r){const o={...n,...s,id:e.id,x:r.x,y:r.y,width:r.width,height:r.height};return(!i||i.constructor!==s.type)&&(i=this._createController(e,o)),i&&i.setProps(o),i}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let i=e.length;i--;){const s=e[i],o=this.getViewState(s),a=s.makeViewport({viewState:o,width:this.width,height:this.height});let l=n[s.id];const c=!!s.controller;c&&!l&&(r=!0),(r||!c)&&l&&(l.finalize(),l=null),this.controllers[s.id]=this._updateController(s,o,a,l),a&&this._viewports.unshift(a)}for(const i in n){const s=n[i];s&&!this.controllers[i]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((r,i)=>!e[i].equals(n[i]))}}const L6=/([0-9]+\.?[0-9]*)(%|px)/;function Lr(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=L6.exec(t);if(e&&e.length>=3){const n=e[2]==="%",r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function Mr(t,e){return t.relative?Math.round(t.position*e):t.position}function ct(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class uo{constructor(e){_(this,"id",void 0),_(this,"viewportInstance",void 0),_(this,"_x",void 0),_(this,"_y",void 0),_(this,"_width",void 0),_(this,"_height",void 0),_(this,"_padding",void 0),_(this,"props",void 0);const{id:n,x:r=0,y:i=0,width:s="100%",height:o="100%",padding:a=null,viewportInstance:l}=e||{};ct(!l||l instanceof wo),this.viewportInstance=l,this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=Lr(r),this._y=Lr(i),this._width=Lr(s),this._height=Lr(o),this._padding=a&&{left:Lr(a.left||0),right:Lr(a.right||0),top:Lr(a.top||0),bottom:Lr(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.viewportInstance?e.viewportInstance?this.viewportInstance.equals(e.viewportInstance):!1:this.ViewportType===e.ViewportType&&zn(this.props,e.props,2)}makeViewport({width:e,height:n,viewState:r}){if(this.viewportInstance)return this.viewportInstance;r=this.filterViewState(r);const i=this.getDimensions({width:e,height:n});return!i.height||!i.width?null:new this.ViewportType({...r,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:(e==null?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const r in this.props.viewState)r!=="id"&&(n[r]=this.props.viewState[r]);return n}return e}getDimensions({width:e,height:n}){const r={x:Mr(this._x,e),y:Mr(this._y,n),width:Mr(this._width,e),height:Mr(this._height,n)};return this._padding&&(r.padding={left:Mr(this._padding.left,e),top:Mr(this._padding.top,n),right:Mr(this._padding.right,e),bottom:Mr(this._padding.bottom,n)}),r}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}let xl=class{constructor(e){_(this,"_inProgress",void 0),_(this,"_handle",void 0),_(this,"_timeline",void 0),_(this,"time",void 0),_(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var n,r;this.cancel(),this.settings=e,this._inProgress=!0,(n=(r=this.settings).onStart)===null||n===void 0||n.call(r,this)}end(){if(this._inProgress){var e,n;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(e=(n=this.settings).onEnd)===null||e===void 0||e.call(n,this)}}cancel(){if(this._inProgress){var e,n;(e=(n=this.settings).onInterrupt)===null||e===void 0||e.call(n,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:r,settings:i}=this;this._handle=r.addChannel({delay:r.getTime(),duration:i.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(e=(n=this.settings).onUpdate)===null||e===void 0||e.call(n,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}};const L1=()=>{},Sg={BREAK:1,SNAP_TO_END:2,IGNORE:3},M6=t=>t,k6=Sg.BREAK;class I6{constructor(e){_(this,"getControllerState",void 0),_(this,"props",void 0),_(this,"propsInTransition",void 0),_(this,"transition",void 0),_(this,"onViewStateChange",void 0),_(this,"onStateChange",void 0),_(this,"_onTransitionUpdate",n=>{const{time:r,settings:{interpolator:i,startProps:s,endProps:o,duration:a,easing:l}}=n,c=l(r/a),u=i.interpolateProps(s,o,c);this.propsInTransition=this.getControllerState({...this.props,...u}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new xl(e.timeline),this.onViewStateChange=e.onViewStateChange||L1,this.onStateChange=e.onStateChange||L1}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const r=this.props;if(this.props=e,!r||this._shouldIgnoreViewportChange(r,e))return!1;if(this._isTransitionEnabled(e)){let i=r;if(this.transition.inProgress){const{interruption:s,endProps:o}=this.transition.settings;i={...r,...s===Sg.SNAP_TO_END?o:this.propsInTransition||r}}this._triggerTransition(i,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:r}=e;return(n>0||n==="auto")&&!!r}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===Sg.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const r=this.getControllerState(e),i=this.getControllerState(n).shortestPathFrom(r),s=n.transitionInterpolator,o=s.getDuration?s.getDuration(e,n):n.transitionDuration;if(o===0)return;const a=s.initializeProps(e,i);this.propsInTransition={};const l={duration:o,easing:n.transitionEasing||M6,interpolator:s,interruption:n.transitionInterruption||k6,startProps:a.start,endProps:a.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(l),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e==null||e(n)}}}class O6{constructor(e){_(this,"_propsToCompare",void 0),_(this,"_propsToExtract",void 0),_(this,"_requiredProps",void 0);const{compare:n,extract:r,required:i}=e;this._propsToCompare=n,this._propsToExtract=r||n,this._requiredProps=i}arePropsEqual(e,n){for(const r of this._propsToCompare)if(!(r in e)||!(r in n)||!Wa(e[r],n[r]))return!1;return!0}initializeProps(e,n){const r={},i={};for(const s of this._propsToExtract)(s in e||s in n)&&(r[s]=e[s],i[s]=n[s]);return this._checkRequiredProps(r),this._checkRequiredProps(i),{start:r,end:i}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{const r=e[n];ct(Number.isFinite(r)||Array.isArray(r),"".concat(n," is required for transition"))})}}const N6=["longitude","latitude","zoom","bearing","pitch"],D6=["longitude","latitude","zoom"];class LA extends O6{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:N6,required:D6},super(r.transitionProps),_(this,"opts",void 0),this.opts=r}initializeProps(e,n){const r=super.initializeProps(e,n),{makeViewport:i,around:s}=this.opts;if(i&&s){const o=i(e),a=i(n),l=o.unproject(s);r.start.around=s,Object.assign(r.end,{around:a.project(l),aroundPosition:l,width:n.width,height:n.height})}return r}interpolateProps(e,n,r){const i={};for(const s of this._propsToExtract)i[s]=Vu(e[s]||0,n[s]||0,r);if(n.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...n,...i});Object.assign(i,s.panByPosition(n.aroundPosition,Vu(e.around,n.around,r)))}return i}}const kr={transitionDuration:0},F6=300,Ec=t=>1-(1-t)*(1-t),cs={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},gi={};class U6{constructor(e){_(this,"props",void 0),_(this,"state",{}),_(this,"transitionManager",void 0),_(this,"eventManager",void 0),_(this,"onViewStateChange",void 0),_(this,"onStateChange",void 0),_(this,"makeViewport",void 0),_(this,"_controllerState",void 0),_(this,"_events",{}),_(this,"_interactionState",{isDragging:!1}),_(this,"_customEvents",[]),_(this,"_eventStartBlocked",null),_(this,"_panMove",!1),_(this,"invertPan",!1),_(this,"dragMode","rotate"),_(this,"inertia",0),_(this,"scrollZoom",!0),_(this,"dragPan",!0),_(this,"dragRotate",!0),_(this,"doubleClickZoom",!0),_(this,"touchZoom",!0),_(this,"touchRotate",!1),_(this,"keyboard",!0),this.transitionManager=new I6({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const n in this._events)if(this._events[n]){var e;(e=this.eventManager)===null||e===void 0||e.off(n,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:r}=this.props,{offsetCenter:i}=e;return[i.x-n,i.y-r]}isPointInBounds(e,n){const{width:r,height:i}=this.props;if(n&&n.handled)return!1;const s=e[0]>=0&&e[0]<=r&&e[1]>=0&&e[1]<=i;return s&&n&&n.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:n}=e;return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?F6:0;const{scrollZoom:r=!0,dragPan:i=!0,dragRotate:s=!0,doubleClickZoom:o=!0,touchZoom:a=!0,touchRotate:l=!1,keyboard:c=!0}=e,u=!!this.onViewStateChange;this.toggleEvents(cs.WHEEL,u&&r),this.toggleEvents(cs.PAN,u),this.toggleEvents(cs.PINCH,u&&(a||l)),this.toggleEvents(cs.TRIPLE_PAN,u&&l),this.toggleEvents(cs.DOUBLE_TAP,u&&o),this.toggleEvents(cs.KEYBOARD,u&&c),this.scrollZoom=r,this.dragPan=i,this.dragRotate=s,this.doubleClickZoom=o,this.touchZoom=a,this.touchRotate=l,this.keyboard=c}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(r=>{this._events[r]!==n&&(this._events[r]=n,n?this.eventManager.on(r,this.handleEvent):this.eventManager.off(r,this.handleEvent))})}updateViewport(e,n=null,r={}){const i={...e.getViewportProps(),...n},s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(r),s){const o=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:o})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let r=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(r=!r);const i=this.controllerState[r?"panStart":"rotateStart"]({pos:n});return this._panMove=r,this.updateViewport(i,kr,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),r=this.controllerState.pan({pos:n});return this.updateViewport(r,kr,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Ec},{isDragging:!1,isPanning:!0})}else{const r=this.controllerState.panEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),r=this.controllerState.rotate({pos:n});return this.updateViewport(r,kr,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Ec},{isDragging:!1,isRotating:!0})}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;e.srcEvent.preventDefault();const{speed:r=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:s}=e;let o=2/(1+Math.exp(-Math.abs(s*r)));s<0&&o!==0&&(o=1/o);const a=this.controllerState.zoom({pos:n,scale:o});return this.updateViewport(a,{...this._getTransitionProps({around:n}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.rotateStart({pos:n});return this.updateViewport(r,kr,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const r=this.controllerState.rotate({pos:n});return this.updateViewport(r,kr,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const r=this.getCenter(e),i=[r[0],r[1]+=e.velocityY*n/2],s=this.controllerState.rotate({pos:i});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Ec},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return gi._startPinchRotation=e.rotation,gi._lastPinchEvent=e,this.updateViewport(r,kr,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:r}=e,i=this.getCenter(e);n=n.zoom({pos:i,scale:r})}if(this.touchRotate){const{rotation:r}=e;n=n.rotate({deltaAngleX:gi._startPinchRotation-r})}return this.updateViewport(n,kr,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),gi._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:r}=gi;if(this.touchZoom&&n&&r&&e.scale!==r.scale){const i=this.getCenter(e);let s=this.controllerState.rotateEnd();const o=Math.log2(e.scale),a=(o-Math.log2(r.scale))/(e.deltaTime-r.deltaTime),l=Math.pow(2,o+a*n/2);s=s.zoom({pos:i,scale:l}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:i}),transitionDuration:n,transitionEasing:Ec},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return gi._startPinchRotation=null,gi._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:n,scale:r?.5:2});return this.updateViewport(i,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:r,moveSpeed:i,rotateSpeedX:s,rotateSpeedY:o}=this.keyboard===!0?{}:this.keyboard,{controllerState:a}=this;let l;const c={};switch(e.srcEvent.code){case"Minus":l=n?a.zoomOut(r).zoomOut(r):a.zoomOut(r),c.isZooming=!0;break;case"Equal":l=n?a.zoomIn(r).zoomIn(r):a.zoomIn(r),c.isZooming=!0;break;case"ArrowLeft":n?(l=a.rotateLeft(s),c.isRotating=!0):(l=a.moveLeft(i),c.isPanning=!0);break;case"ArrowRight":n?(l=a.rotateRight(s),c.isRotating=!0):(l=a.moveRight(i),c.isPanning=!0);break;case"ArrowUp":n?(l=a.rotateUp(o),c.isRotating=!0):(l=a.moveUp(i),c.isPanning=!0);break;case"ArrowDown":n?(l=a.rotateDown(o),c.isRotating=!0):(l=a.moveDown(i),c.isPanning=!0);break;default:return!1}return this.updateViewport(l,this._getTransitionProps(),c),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?kr:e?{...n,transitionInterpolator:new LA({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class B6{constructor(e,n){_(this,"_viewportProps",void 0),_(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const M1=5,z6=1.2;class j6 extends B6{constructor(e){const{width:n,height:r,latitude:i,longitude:s,zoom:o,bearing:a=0,pitch:l=0,altitude:c=1.5,position:u=[0,0,0],maxZoom:d=20,minZoom:f=0,maxPitch:h=60,minPitch:p=0,startPanLngLat:m,startZoomLngLat:E,startRotatePos:v,startBearing:g,startPitch:y,startZoom:b,normalize:T=!0}=e;ct(Number.isFinite(s)),ct(Number.isFinite(i)),ct(Number.isFinite(o)),super({width:n,height:r,latitude:i,longitude:s,zoom:o,bearing:a,pitch:l,altitude:c,maxZoom:d,minZoom:f,maxPitch:h,minPitch:p,normalize:T,position:u},{startPanLngLat:m,startZoomLngLat:E,startRotatePos:v,startBearing:g,startPitch:y,startZoom:b}),_(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:i,startBearing:s,startPitch:o}=this.getState();if(!i||s===void 0||o===void 0)return this;let a;return e?a=this._getNewRotation(e,i,o,s):a={bearing:s+n,pitch:o+r},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:i,startZoomLngLat:s}=this.getState();if(s||(i=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(e)),!s)return this;const{maxZoom:o,minZoom:a}=this.getViewportProps();let l=i+Math.log2(r);l=$r(l,a,o);const c=this.makeViewport({...this.getViewportProps(),zoom:l});return this._getUpdatedState({zoom:l,...c.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{bearing:i,longitude:s}=r;return Math.abs(i-n.bearing)>180&&(r.bearing=i<0?i+360:i-360),Math.abs(s-n.longitude)>180&&(r.longitude=s<0?s+360:s-360),r}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:i}=e;e.zoom=$r(i,r,n);const{maxPitch:s,minPitch:o,pitch:a}=e;e.pitch=$r(a,o,s);const{normalize:l=!0}=e;return l&&Object.assign(e,Y5(e)),e}_zoomFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.zoom({pos:[n/2,r/2],scale:e})}_panFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.pan({startPos:[n/2,r/2],pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,r,i){const s=e[0]-n[0],o=e[1]-n[1],a=e[1],l=n[1],{width:c,height:u}=this.getViewportProps(),d=s/c;let f=0;o>0?Math.abs(u-l)>M1&&(f=o/(l-u)*z6):o<0&&l>M1&&(f=1-a/l),f=$r(f,-1,1);const{minPitch:h,maxPitch:p}=this.getViewportProps(),m=i+180*d;let E=r;return f>0?E=r+f*(p-r):f<0&&(E=r-f*(h-r)),{pitch:E,bearing:m}}}class V6 extends U6{constructor(...e){super(...e),_(this,"ControllerState",j6),_(this,"transition",{transitionDuration:300,transitionInterpolator:new LA({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),_(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class MA extends uo{get ViewportType(){return co}get ControllerType(){return V6}}_(MA,"displayName","MapView");const $6=new AA;function G6(t,e){var n,r;const i=(n=t.order)!==null&&n!==void 0?n:1/0,s=(r=e.order)!==null&&r!==void 0?r:1/0;return i-s}class W6{constructor(){_(this,"effects",void 0),_(this,"_resolvedEffects",[]),_(this,"_defaultEffects",[]),_(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const n=this._defaultEffects;if(!n.find(r=>r.id===e.id)){const r=n.findIndex(i=>G6(i,e)>0);r<0?n.push(e):n.splice(r,0,e),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(zn(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._resolvedEffects}_setEffects(e){const n={};for(const i of this.effects)n[i.id]=i;const r=[];for(const i of e){const s=n[i.id];s&&s!==i?s.setProps?(s.setProps(i.props),r.push(s)):(s.cleanup(),r.push(i)):r.push(i),delete n[i.id]}for(const i in n)n[i].cleanup();this.effects=r,this._resolvedEffects=r.concat(this._defaultEffects),e.some(i=>i instanceof AA)||this._resolvedEffects.push($6),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class H6 extends O0{shouldDrawLayer(e){const{operation:n}=e.props;return n.includes("draw")||n.includes("terrain")}}const Y6="deckRenderer.renderLayers";class X6{constructor(e){_(this,"gl",void 0),_(this,"layerFilter",void 0),_(this,"drawPickingColors",void 0),_(this,"drawLayersPass",void 0),_(this,"pickLayersPass",void 0),_(this,"renderCount",void 0),_(this,"_needsRedraw",void 0),_(this,"renderBuffers",void 0),_(this,"lastPostProcessEffect",void 0),this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new H6(e),this.pickLayersPass=new PA(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,r={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e,target:e.target||ot.getDefaultFramebuffer(this.gl)};r.effects&&this._preRender(r.effects,r);const i=this.lastPostProcessEffect?this.renderBuffers[0]:r.target,s=n.render({...r,target:i});r.effects&&this._postRender(r.effects,r),this.renderCount++,wt(Y6,this,s,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){this.lastPostProcessEffect=null,n.preRenderStats=n.preRenderStats||{};for(const r of e)n.preRenderStats[r.id]=r.preRender(this.gl,n),r.postRender&&(this.lastPostProcessEffect=r.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this;e.length===0&&e.push(new ot(this.gl),new ot(this.gl));for(const n of e)n.resize()}_postRender(e,n){const{renderBuffers:r}=this,i={...n,inputBuffer:r[0],swapBuffer:r[1],target:null};for(const s of e)if(s.postRender){if(s.id===this.lastPostProcessEffect){i.target=n.target,s.postRender(this.gl,i);break}const o=s.postRender(this.gl,i);i.inputBuffer=o,i.swapBuffer=o===r[0]?r[1]:r[0]}}}const K6={pickedColor:null,pickedObjectIndex:-1};function q6({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:s}){const{x:o,y:a,width:l,height:c}=s;let u=i*i,d=-1,f=0;for(let h=0;h<c;h++){const p=h+a-r,m=p*p;if(m>u)f+=4*l;else for(let E=0;E<l;E++){if(t[f+3]-1>=0){const g=E+o-n,y=g*g+m;y<=u&&(u=y,d=f)}f+=4}}if(d>=0){const h=t.slice(d,d+4),p=e(h);if(p){const m=Math.floor(d/4/l),E=d/4-m*l;return{...p,pickedColor:h,pickedX:o+E,pickedY:a+m}}ye.error("Picked non-existent layer. Is picking buffer corrupt?")()}return K6}function Z6({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let r=0;r<t.length;r+=4)if(t[r+3]-1>=0){const s=t.slice(r,r+4),o=s.join(",");if(!n.has(o)){const a=e(s);a?n.set(o,{...a,color:s}):ye.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function kA({pickInfo:t,viewports:e,pixelRatio:n,x:r,y:i,z:s}){let o=e[0];e.length>1&&(o=J6((t==null?void 0:t.pickedViewports)||e,{x:r,y:i}));let a;if(o){const l=[r-o.x,i-o.y];s!==void 0&&(l[2]=s),a=o.unproject(l)}return{color:null,layer:null,viewport:o,index:-1,picked:!1,x:r,y:i,pixel:[r,i],coordinate:a,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function Q6(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:i}=t,{pickedColor:s,pickedLayer:o,pickedObjectIndex:a}=e,l=o?[o]:[];if(r==="hover"){const d=n.index,f=n.layerId,h=o?o.props.id:null;if(h!==f||a!==d){if(h!==f){const p=i.find(m=>m.props.id===f);p&&l.unshift(p)}n.layerId=h,n.index=a,n.info=null}}const c=kA(t),u=new Map;return u.set(null,c),l.forEach(d=>{let f={...c};d===o&&(f.color=s,f.index=a,f.picked=!0),f=IA({layer:d,info:f,mode:r});const h=f.layer;d===o&&r==="hover"&&(n.info=f),u.set(h.id,f),r==="hover"&&h.updateAutoHighlight(f)}),u}function IA({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}function J6(t,e){for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.containsPixel(e))return r}return t[0]}class e8{constructor(e){_(this,"gl",void 0),_(this,"pickingFBO",void 0),_(this,"depthFBO",void 0),_(this,"pickLayersPass",void 0),_(this,"layerFilter",void 0),_(this,"lastPickedInfo",void 0),_(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new PA(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:r,viewports:i},s=this.lastPickedInfo.info){const o=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,l=o?r.find(f=>f.id===o):null,c=a&&i.find(f=>f.id===a)||i[0],u=c&&c.unproject([e-c.x,n-c.y]);return{...s,...{x:e,y:n,viewport:c,coordinate:u,layer:l}}}_resizeBuffer(){var e,n;const{gl:r}=this;if(!this.pickingFBO&&(this.pickingFBO=new ot(r),ot.isSupported(r,{colorBufferFloat:!0}))){const i=new ot(r);i.attach({36064:new nn(r,{format:we(r)?34836:6408,type:5126})}),this.depthFBO=i}(e=this.pickingFBO)===null||e===void 0||e.resize({width:r.canvas.width,height:r.canvas.height}),(n=this.depthFBO)===null||n===void 0||n.resize({width:r.canvas.width,height:r.canvas.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(r=>this.pickLayersPass.shouldDrawLayer(r)&&!r.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:r,x:i,y:s,radius:o=0,depth:a=1,mode:l="query",unproject3D:c,onViewportActive:u,effects:d}){const f=this._getPickable(e),h=to(this.gl);if(!f)return{result:[],emptyInfo:kA({viewports:r,x:i,y:s,pixelRatio:h})};this._resizeBuffer();const p=dh(this.gl,[i,s],!0),m=[p.x+Math.floor(p.width/2),p.y+Math.floor(p.height/2)],E=Math.round(o*h),{width:v,height:g}=this.pickingFBO,y=this._getPickingRect({deviceX:m[0],deviceY:m[1],deviceRadius:E,deviceWidth:v,deviceHeight:g}),b={x:i-o,y:s-o,width:o*2+1,height:o*2+1};let T;const A=[],R=new Set;for(let I=0;I<a;I++){let D;if(y){const F=this._drawAndSample({layers:f,views:n,viewports:r,onViewportActive:u,deviceRect:y,cullRect:b,effects:d,pass:"picking:".concat(l)});D=q6({...F,deviceX:m[0],deviceY:m[1],deviceRadius:E,deviceRect:y})}else D={pickedColor:null,pickedObjectIndex:-1};let N;if(D.pickedLayer&&c&&this.depthFBO){const{pickedColors:F}=this._drawAndSample({layers:[D.pickedLayer],views:n,viewports:r,onViewportActive:u,deviceRect:{x:D.pickedX,y:D.pickedY,width:1,height:1},cullRect:b,effects:d,pass:"picking:".concat(l,":z")},!0);F[3]&&(N=F[0])}D.pickedLayer&&I+1<a&&(R.add(D.pickedLayer),D.pickedLayer.disablePickingIndex(D.pickedObjectIndex)),T=Q6({pickInfo:D,lastPickedInfo:this.lastPickedInfo,mode:l,layers:f,viewports:r,x:i,y:s,z:N,pixelRatio:h});for(const F of T.values())F.layer&&A.push(F);if(!D.pickedColor)break}for(const I of R)I.restorePickingColors();return{result:A,emptyInfo:T.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:r,x:i,y:s,width:o=1,height:a=1,mode:l="query",maxObjects:c=null,onViewportActive:u,effects:d}){const f=this._getPickable(e);if(!f)return[];this._resizeBuffer();const h=to(this.gl),p=dh(this.gl,[i,s],!0),m=p.x,E=p.y+p.height,v=dh(this.gl,[i+o,s+a],!0),g=v.x+v.width,y=v.y,b={x:m,y,width:g-m,height:E-y},T=this._drawAndSample({layers:f,views:n,viewports:r,onViewportActive:u,deviceRect:b,cullRect:{x:i,y:s,width:o,height:a},effects:d,pass:"picking:".concat(l)}),A=Z6(T),R=new Map,I=Number.isFinite(c);for(let N=0;N<A.length;N++){var D;if(I&&c&&R.size>=c)break;const F=A[N];let q={color:F.pickedColor,layer:null,index:F.pickedObjectIndex,picked:!0,x:i,y:s,pixelRatio:h};q=IA({layer:F.pickedLayer,info:q,mode:l});const G=(D=q.object)!==null&&D!==void 0?D:"".concat(q.layer.id,"[").concat(q.index,"]");R.has(G)||R.set(G,q)}return Array.from(R.values())}_drawAndSample({layers:e,views:n,viewports:r,onViewportActive:i,deviceRect:s,cullRect:o,effects:a,pass:l},c=!1){const u=c?this.depthFBO:this.pickingFBO,d={layers:e,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:i,pickingFBO:u,deviceRect:s,cullRect:o,effects:a,pass:l,pickZ:c,preRenderStats:{}};for(const g of a)g.useInPicking&&(d.preRenderStats[g.id]=g.preRender(this.gl,d));const{decodePickingColor:f}=this.pickLayersPass.render(d),{x:h,y:p,width:m,height:E}=s,v=new(c?Float32Array:Uint8Array)(m*E*4);return Zf(u,{sourceX:h,sourceY:p,sourceWidth:m,sourceHeight:E,target:v}),{pickedColors:v,decodePickingColor:f}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:r,deviceWidth:i,deviceHeight:s}){const o=Math.max(0,e-r),a=Math.max(0,n-r),l=Math.min(i,e+r+1)-o,c=Math.min(s,n+r+1)-a;return l<=0||c<=0?null:{x:o,y:a,width:l,height:c}}}const t8={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class n8{constructor(e){_(this,"el",null),_(this,"isVisible",!1);const n=e.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,t8),n.appendChild(this.el))}setTooltip(e,n,r){const i=this.el;if(i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform="translate(".concat(n,"px, ").concat(r,"px)"),e&&typeof e=="object"&&"style"in e&&Object.assign(i.style,e.style)}}remove(){this.el&&(this.el.remove(),this.el=null)}}var OA={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,r,i){var s=["","webkit","Moz","MS","ms","o"],o=n.createElement("div"),a="function",l=Math.round,c=Math.abs,u=Date.now;function d(w,x,P){return setTimeout(y(w,P),x)}function f(w,x,P){return Array.isArray(w)?(h(w,P[x],P),!0):!1}function h(w,x,P){var O;if(w)if(w.forEach)w.forEach(x,P);else if(w.length!==i)for(O=0;O<w.length;)x.call(P,w[O],O,w),O++;else for(O in w)w.hasOwnProperty(O)&&x.call(P,w[O],O,w)}function p(w,x,P){var O="DEPRECATED METHOD: "+x+`
`+P+` AT 
`;return function(){var B=new Error("get-stack-trace"),J=B&&B.stack?B.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Ee=e.console&&(e.console.warn||e.console.log);return Ee&&Ee.call(e.console,O,J),w.apply(this,arguments)}}var m;typeof Object.assign!="function"?m=function(x){if(x===i||x===null)throw new TypeError("Cannot convert undefined or null to object");for(var P=Object(x),O=1;O<arguments.length;O++){var B=arguments[O];if(B!==i&&B!==null)for(var J in B)B.hasOwnProperty(J)&&(P[J]=B[J])}return P}:m=Object.assign;var E=p(function(x,P,O){for(var B=Object.keys(P),J=0;J<B.length;)(!O||O&&x[B[J]]===i)&&(x[B[J]]=P[B[J]]),J++;return x},"extend","Use `assign`."),v=p(function(x,P){return E(x,P,!0)},"merge","Use `assign`.");function g(w,x,P){var O=x.prototype,B;B=w.prototype=Object.create(O),B.constructor=w,B._super=O,P&&m(B,P)}function y(w,x){return function(){return w.apply(x,arguments)}}function b(w,x){return typeof w==a?w.apply(x&&x[0]||i,x):w}function T(w,x){return w===i?x:w}function A(w,x,P){h(N(x),function(O){w.addEventListener(O,P,!1)})}function R(w,x,P){h(N(x),function(O){w.removeEventListener(O,P,!1)})}function I(w,x){for(;w;){if(w==x)return!0;w=w.parentNode}return!1}function D(w,x){return w.indexOf(x)>-1}function N(w){return w.trim().split(/\s+/g)}function F(w,x,P){if(w.indexOf&&!P)return w.indexOf(x);for(var O=0;O<w.length;){if(P&&w[O][P]==x||!P&&w[O]===x)return O;O++}return-1}function q(w){return Array.prototype.slice.call(w,0)}function G(w,x,P){for(var O=[],B=[],J=0;J<w.length;){var Ee=x?w[J][x]:w[J];F(B,Ee)<0&&O.push(w[J]),B[J]=Ee,J++}return P&&(x?O=O.sort(function(dt,At){return dt[x]>At[x]}):O=O.sort()),O}function W(w,x){for(var P,O,B=x[0].toUpperCase()+x.slice(1),J=0;J<s.length;){if(P=s[J],O=P?P+B:x,O in w)return O;J++}return i}var xe=1;function de(){return xe++}function Pe(w){var x=w.ownerDocument||w;return x.defaultView||x.parentWindow||e}var z=/mobile|tablet|ip(ad|hone|od)|android/i,ne="ontouchstart"in e,Y=W(e,"PointerEvent")!==i,re=ne&&z.test(navigator.userAgent),M="touch",V="pen",U="mouse",oe="kinect",Q=25,ie=1,fe=2,X=4,he=8,Ie=1,_e=2,Te=4,Ze=8,Se=16,Oe=_e|Te,Be=Ze|Se,So=Oe|Be,Ml=["x","y"],Sr=["clientX","clientY"];function Tt(w,x){var P=this;this.manager=w,this.callback=x,this.element=w.element,this.target=w.options.inputTarget,this.domHandler=function(O){b(w.options.enable,[w])&&P.handler(O)},this.init()}Tt.prototype={handler:function(){},init:function(){this.evEl&&A(this.element,this.evEl,this.domHandler),this.evTarget&&A(this.target,this.evTarget,this.domHandler),this.evWin&&A(Pe(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&R(this.element,this.evEl,this.domHandler),this.evTarget&&R(this.target,this.evTarget,this.domHandler),this.evWin&&R(Pe(this.element),this.evWin,this.domHandler)}};function kl(w){var x,P=w.options.inputClass;return P?x=P:Y?x=ae:re?x=Kn:ne?x=vd:x=H,new x(w,hd)}function hd(w,x,P){var O=P.pointers.length,B=P.changedPointers.length,J=x&ie&&O-B===0,Ee=x&(X|he)&&O-B===0;P.isFirst=!!J,P.isFinal=!!Ee,J&&(w.session={}),P.eventType=x,To(w,P),w.emit("hammer.input",P),w.recognize(P),w.session.prevInput=P}function To(w,x){var P=w.session,O=x.pointers,B=O.length;P.firstInput||(P.firstInput=Il(x)),B>1&&!P.firstMultiple?P.firstMultiple=Il(x):B===1&&(P.firstMultiple=!1);var J=P.firstInput,Ee=P.firstMultiple,at=Ee?Ee.center:J.center,dt=x.center=Ol(O);x.timeStamp=u(),x.deltaTime=x.timeStamp-J.timeStamp,x.angle=es(at,dt),x.distance=Ji(at,dt),Ao(P,x),x.offsetDirection=Dl(x.deltaX,x.deltaY);var At=Nl(x.deltaTime,x.deltaX,x.deltaY);x.overallVelocityX=At.x,x.overallVelocityY=At.y,x.overallVelocity=c(At.x)>c(At.y)?At.x:At.y,x.scale=Ee?md(Ee.pointers,O):1,x.rotation=Ee?gd(Ee.pointers,O):0,x.maxPointers=P.prevInput?x.pointers.length>P.prevInput.maxPointers?x.pointers.length:P.prevInput.maxPointers:x.pointers.length,pd(P,x);var Mn=w.element;I(x.srcEvent.target,Mn)&&(Mn=x.srcEvent.target),x.target=Mn}function Ao(w,x){var P=x.center,O=w.offsetDelta||{},B=w.prevDelta||{},J=w.prevInput||{};(x.eventType===ie||J.eventType===X)&&(B=w.prevDelta={x:J.deltaX||0,y:J.deltaY||0},O=w.offsetDelta={x:P.x,y:P.y}),x.deltaX=B.x+(P.x-O.x),x.deltaY=B.y+(P.y-O.y)}function pd(w,x){var P=w.lastInterval||x,O=x.timeStamp-P.timeStamp,B,J,Ee,at;if(x.eventType!=he&&(O>Q||P.velocity===i)){var dt=x.deltaX-P.deltaX,At=x.deltaY-P.deltaY,Mn=Nl(O,dt,At);J=Mn.x,Ee=Mn.y,B=c(Mn.x)>c(Mn.y)?Mn.x:Mn.y,at=Dl(dt,At),w.lastInterval=x}else B=P.velocity,J=P.velocityX,Ee=P.velocityY,at=P.direction;x.velocity=B,x.velocityX=J,x.velocityY=Ee,x.direction=at}function Il(w){for(var x=[],P=0;P<w.pointers.length;)x[P]={clientX:l(w.pointers[P].clientX),clientY:l(w.pointers[P].clientY)},P++;return{timeStamp:u(),pointers:x,center:Ol(x),deltaX:w.deltaX,deltaY:w.deltaY}}function Ol(w){var x=w.length;if(x===1)return{x:l(w[0].clientX),y:l(w[0].clientY)};for(var P=0,O=0,B=0;B<x;)P+=w[B].clientX,O+=w[B].clientY,B++;return{x:l(P/x),y:l(O/x)}}function Nl(w,x,P){return{x:x/w||0,y:P/w||0}}function Dl(w,x){return w===x?Ie:c(w)>=c(x)?w<0?_e:Te:x<0?Ze:Se}function Ji(w,x,P){P||(P=Ml);var O=x[P[0]]-w[P[0]],B=x[P[1]]-w[P[1]];return Math.sqrt(O*O+B*B)}function es(w,x,P){P||(P=Ml);var O=x[P[0]]-w[P[0]],B=x[P[1]]-w[P[1]];return Math.atan2(B,O)*180/Math.PI}function gd(w,x){return es(x[1],x[0],Sr)+es(w[1],w[0],Sr)}function md(w,x){return Ji(x[0],x[1],Sr)/Ji(w[0],w[1],Sr)}var k={mousedown:ie,mousemove:fe,mouseup:X},L="mousedown",j="mousemove mouseup";function H(){this.evEl=L,this.evWin=j,this.pressed=!1,Tt.apply(this,arguments)}g(H,Tt,{handler:function(x){var P=k[x.type];P&ie&&x.button===0&&(this.pressed=!0),P&fe&&x.which!==1&&(P=X),this.pressed&&(P&X&&(this.pressed=!1),this.callback(this.manager,P,{pointers:[x],changedPointers:[x],pointerType:U,srcEvent:x}))}});var K={pointerdown:ie,pointermove:fe,pointerup:X,pointercancel:he,pointerout:he},ee={2:M,3:V,4:U,5:oe},ue="pointerdown",ce="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(ue="MSPointerDown",ce="MSPointerMove MSPointerUp MSPointerCancel");function ae(){this.evEl=ue,this.evWin=ce,Tt.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}g(ae,Tt,{handler:function(x){var P=this.store,O=!1,B=x.type.toLowerCase().replace("ms",""),J=K[B],Ee=ee[x.pointerType]||x.pointerType,at=Ee==M,dt=F(P,x.pointerId,"pointerId");J&ie&&(x.button===0||at)?dt<0&&(P.push(x),dt=P.length-1):J&(X|he)&&(O=!0),!(dt<0)&&(P[dt]=x,this.callback(this.manager,J,{pointers:P,changedPointers:[x],pointerType:Ee,srcEvent:x}),O&&P.splice(dt,1))}});var ge={touchstart:ie,touchmove:fe,touchend:X,touchcancel:he},Ne="touchstart",vt="touchstart touchmove touchend touchcancel";function et(){this.evTarget=Ne,this.evWin=vt,this.started=!1,Tt.apply(this,arguments)}g(et,Tt,{handler:function(x){var P=ge[x.type];if(P===ie&&(this.started=!0),!!this.started){var O=kt.call(this,x,P);P&(X|he)&&O[0].length-O[1].length===0&&(this.started=!1),this.callback(this.manager,P,{pointers:O[0],changedPointers:O[1],pointerType:M,srcEvent:x})}}});function kt(w,x){var P=q(w.touches),O=q(w.changedTouches);return x&(X|he)&&(P=G(P.concat(O),"identifier",!0)),[P,O]}var $t={touchstart:ie,touchmove:fe,touchend:X,touchcancel:he},Tr="touchstart touchmove touchend touchcancel";function Kn(){this.evTarget=Tr,this.targetIds={},Tt.apply(this,arguments)}g(Kn,Tt,{handler:function(x){var P=$t[x.type],O=fi.call(this,x,P);O&&this.callback(this.manager,P,{pointers:O[0],changedPointers:O[1],pointerType:M,srcEvent:x})}});function fi(w,x){var P=q(w.touches),O=this.targetIds;if(x&(ie|fe)&&P.length===1)return O[P[0].identifier]=!0,[P,P];var B,J,Ee=q(w.changedTouches),at=[],dt=this.target;if(J=P.filter(function(At){return I(At.target,dt)}),x===ie)for(B=0;B<J.length;)O[J[B].identifier]=!0,B++;for(B=0;B<Ee.length;)O[Ee[B].identifier]&&at.push(Ee[B]),x&(X|he)&&delete O[Ee[B].identifier],B++;if(at.length)return[G(J.concat(at),"identifier",!0),at]}var di=2500,yv=25;function vd(){Tt.apply(this,arguments);var w=y(this.handler,this);this.touch=new Kn(this.manager,w),this.mouse=new H(this.manager,w),this.primaryTouch=null,this.lastTouches=[]}g(vd,Tt,{handler:function(x,P,O){var B=O.pointerType==M,J=O.pointerType==U;if(!(J&&O.sourceCapabilities&&O.sourceCapabilities.firesTouchEvents)){if(B)KP.call(this,P,O);else if(J&&qP.call(this,O))return;this.callback(x,P,O)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function KP(w,x){w&ie?(this.primaryTouch=x.changedPointers[0].identifier,_v.call(this,x)):w&(X|he)&&_v.call(this,x)}function _v(w){var x=w.changedPointers[0];if(x.identifier===this.primaryTouch){var P={x:x.clientX,y:x.clientY};this.lastTouches.push(P);var O=this.lastTouches,B=function(){var J=O.indexOf(P);J>-1&&O.splice(J,1)};setTimeout(B,di)}}function qP(w){for(var x=w.srcEvent.clientX,P=w.srcEvent.clientY,O=0;O<this.lastTouches.length;O++){var B=this.lastTouches[O],J=Math.abs(x-B.x),Ee=Math.abs(P-B.y);if(J<=yv&&Ee<=yv)return!0}return!1}var Ev=W(o.style,"touchAction"),wv=Ev!==i,bv="compute",xv="auto",yd="manipulation",hi="none",Co="pan-x",Po="pan-y",Fl=QP();function _d(w,x){this.manager=w,this.set(x)}_d.prototype={set:function(w){w==bv&&(w=this.compute()),wv&&this.manager.element.style&&Fl[w]&&(this.manager.element.style[Ev]=w),this.actions=w.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var w=[];return h(this.manager.recognizers,function(x){b(x.options.enable,[x])&&(w=w.concat(x.getTouchAction()))}),ZP(w.join(" "))},preventDefaults:function(w){var x=w.srcEvent,P=w.offsetDirection;if(this.manager.session.prevented){x.preventDefault();return}var O=this.actions,B=D(O,hi)&&!Fl[hi],J=D(O,Po)&&!Fl[Po],Ee=D(O,Co)&&!Fl[Co];if(B){var at=w.pointers.length===1,dt=w.distance<2,At=w.deltaTime<250;if(at&&dt&&At)return}if(!(Ee&&J)&&(B||J&&P&Oe||Ee&&P&Be))return this.preventSrc(x)},preventSrc:function(w){this.manager.session.prevented=!0,w.preventDefault()}};function ZP(w){if(D(w,hi))return hi;var x=D(w,Co),P=D(w,Po);return x&&P?hi:x||P?x?Co:Po:D(w,yd)?yd:xv}function QP(){if(!wv)return!1;var w={},x=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(P){w[P]=x?e.CSS.supports("touch-action",P):!0}),w}var Ul=1,on=2,ts=4,Ar=8,qn=Ar,Ro=16,Ln=32;function Zn(w){this.options=m({},this.defaults,w||{}),this.id=de(),this.manager=null,this.options.enable=T(this.options.enable,!0),this.state=Ul,this.simultaneous={},this.requireFail=[]}Zn.prototype={defaults:{},set:function(w){return m(this.options,w),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(w){if(f(w,"recognizeWith",this))return this;var x=this.simultaneous;return w=Bl(w,this),x[w.id]||(x[w.id]=w,w.recognizeWith(this)),this},dropRecognizeWith:function(w){return f(w,"dropRecognizeWith",this)?this:(w=Bl(w,this),delete this.simultaneous[w.id],this)},requireFailure:function(w){if(f(w,"requireFailure",this))return this;var x=this.requireFail;return w=Bl(w,this),F(x,w)===-1&&(x.push(w),w.requireFailure(this)),this},dropRequireFailure:function(w){if(f(w,"dropRequireFailure",this))return this;w=Bl(w,this);var x=F(this.requireFail,w);return x>-1&&this.requireFail.splice(x,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(w){return!!this.simultaneous[w.id]},emit:function(w){var x=this,P=this.state;function O(B){x.manager.emit(B,w)}P<Ar&&O(x.options.event+Sv(P)),O(x.options.event),w.additionalEvent&&O(w.additionalEvent),P>=Ar&&O(x.options.event+Sv(P))},tryEmit:function(w){if(this.canEmit())return this.emit(w);this.state=Ln},canEmit:function(){for(var w=0;w<this.requireFail.length;){if(!(this.requireFail[w].state&(Ln|Ul)))return!1;w++}return!0},recognize:function(w){var x=m({},w);if(!b(this.options.enable,[this,x])){this.reset(),this.state=Ln;return}this.state&(qn|Ro|Ln)&&(this.state=Ul),this.state=this.process(x),this.state&(on|ts|Ar|Ro)&&this.tryEmit(x)},process:function(w){},getTouchAction:function(){},reset:function(){}};function Sv(w){return w&Ro?"cancel":w&Ar?"end":w&ts?"move":w&on?"start":""}function Tv(w){return w==Se?"down":w==Ze?"up":w==_e?"left":w==Te?"right":""}function Bl(w,x){var P=x.manager;return P?P.get(w):w}function mn(){Zn.apply(this,arguments)}g(mn,Zn,{defaults:{pointers:1},attrTest:function(w){var x=this.options.pointers;return x===0||w.pointers.length===x},process:function(w){var x=this.state,P=w.eventType,O=x&(on|ts),B=this.attrTest(w);return O&&(P&he||!B)?x|Ro:O||B?P&X?x|Ar:x&on?x|ts:on:Ln}});function zl(){mn.apply(this,arguments),this.pX=null,this.pY=null}g(zl,mn,{defaults:{event:"pan",threshold:10,pointers:1,direction:So},getTouchAction:function(){var w=this.options.direction,x=[];return w&Oe&&x.push(Po),w&Be&&x.push(Co),x},directionTest:function(w){var x=this.options,P=!0,O=w.distance,B=w.direction,J=w.deltaX,Ee=w.deltaY;return B&x.direction||(x.direction&Oe?(B=J===0?Ie:J<0?_e:Te,P=J!=this.pX,O=Math.abs(w.deltaX)):(B=Ee===0?Ie:Ee<0?Ze:Se,P=Ee!=this.pY,O=Math.abs(w.deltaY))),w.direction=B,P&&O>x.threshold&&B&x.direction},attrTest:function(w){return mn.prototype.attrTest.call(this,w)&&(this.state&on||!(this.state&on)&&this.directionTest(w))},emit:function(w){this.pX=w.deltaX,this.pY=w.deltaY;var x=Tv(w.direction);x&&(w.additionalEvent=this.options.event+x),this._super.emit.call(this,w)}});function Ed(){mn.apply(this,arguments)}g(Ed,mn,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[hi]},attrTest:function(w){return this._super.attrTest.call(this,w)&&(Math.abs(w.scale-1)>this.options.threshold||this.state&on)},emit:function(w){if(w.scale!==1){var x=w.scale<1?"in":"out";w.additionalEvent=this.options.event+x}this._super.emit.call(this,w)}});function wd(){Zn.apply(this,arguments),this._timer=null,this._input=null}g(wd,Zn,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[xv]},process:function(w){var x=this.options,P=w.pointers.length===x.pointers,O=w.distance<x.threshold,B=w.deltaTime>x.time;if(this._input=w,!O||!P||w.eventType&(X|he)&&!B)this.reset();else if(w.eventType&ie)this.reset(),this._timer=d(function(){this.state=qn,this.tryEmit()},x.time,this);else if(w.eventType&X)return qn;return Ln},reset:function(){clearTimeout(this._timer)},emit:function(w){this.state===qn&&(w&&w.eventType&X?this.manager.emit(this.options.event+"up",w):(this._input.timeStamp=u(),this.manager.emit(this.options.event,this._input)))}});function bd(){mn.apply(this,arguments)}g(bd,mn,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[hi]},attrTest:function(w){return this._super.attrTest.call(this,w)&&(Math.abs(w.rotation)>this.options.threshold||this.state&on)}});function xd(){mn.apply(this,arguments)}g(xd,mn,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Oe|Be,pointers:1},getTouchAction:function(){return zl.prototype.getTouchAction.call(this)},attrTest:function(w){var x=this.options.direction,P;return x&(Oe|Be)?P=w.overallVelocity:x&Oe?P=w.overallVelocityX:x&Be&&(P=w.overallVelocityY),this._super.attrTest.call(this,w)&&x&w.offsetDirection&&w.distance>this.options.threshold&&w.maxPointers==this.options.pointers&&c(P)>this.options.velocity&&w.eventType&X},emit:function(w){var x=Tv(w.offsetDirection);x&&this.manager.emit(this.options.event+x,w),this.manager.emit(this.options.event,w)}});function jl(){Zn.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}g(jl,Zn,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[yd]},process:function(w){var x=this.options,P=w.pointers.length===x.pointers,O=w.distance<x.threshold,B=w.deltaTime<x.time;if(this.reset(),w.eventType&ie&&this.count===0)return this.failTimeout();if(O&&B&&P){if(w.eventType!=X)return this.failTimeout();var J=this.pTime?w.timeStamp-this.pTime<x.interval:!0,Ee=!this.pCenter||Ji(this.pCenter,w.center)<x.posThreshold;this.pTime=w.timeStamp,this.pCenter=w.center,!Ee||!J?this.count=1:this.count+=1,this._input=w;var at=this.count%x.taps;if(at===0)return this.hasRequireFailures()?(this._timer=d(function(){this.state=qn,this.tryEmit()},x.interval,this),on):qn}return Ln},failTimeout:function(){return this._timer=d(function(){this.state=Ln},this.options.interval,this),Ln},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==qn&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Qn(w,x){return x=x||{},x.recognizers=T(x.recognizers,Qn.defaults.preset),new Sd(w,x)}Qn.VERSION="2.0.7",Qn.defaults={domEvents:!1,touchAction:bv,enable:!0,inputTarget:null,inputClass:null,preset:[[bd,{enable:!1}],[Ed,{enable:!1},["rotate"]],[xd,{direction:Oe}],[zl,{direction:Oe},["swipe"]],[jl],[jl,{event:"doubletap",taps:2},["tap"]],[wd]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var JP=1,Av=2;function Sd(w,x){this.options=m({},Qn.defaults,x||{}),this.options.inputTarget=this.options.inputTarget||w,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=w,this.input=kl(this),this.touchAction=new _d(this,this.options.touchAction),Cv(this,!0),h(this.options.recognizers,function(P){var O=this.add(new P[0](P[1]));P[2]&&O.recognizeWith(P[2]),P[3]&&O.requireFailure(P[3])},this)}Sd.prototype={set:function(w){return m(this.options,w),w.touchAction&&this.touchAction.update(),w.inputTarget&&(this.input.destroy(),this.input.target=w.inputTarget,this.input.init()),this},stop:function(w){this.session.stopped=w?Av:JP},recognize:function(w){var x=this.session;if(!x.stopped){this.touchAction.preventDefaults(w);var P,O=this.recognizers,B=x.curRecognizer;(!B||B&&B.state&qn)&&(B=x.curRecognizer=null);for(var J=0;J<O.length;)P=O[J],x.stopped!==Av&&(!B||P==B||P.canRecognizeWith(B))?P.recognize(w):P.reset(),!B&&P.state&(on|ts|Ar)&&(B=x.curRecognizer=P),J++}},get:function(w){if(w instanceof Zn)return w;for(var x=this.recognizers,P=0;P<x.length;P++)if(x[P].options.event==w)return x[P];return null},add:function(w){if(f(w,"add",this))return this;var x=this.get(w.options.event);return x&&this.remove(x),this.recognizers.push(w),w.manager=this,this.touchAction.update(),w},remove:function(w){if(f(w,"remove",this))return this;if(w=this.get(w),w){var x=this.recognizers,P=F(x,w);P!==-1&&(x.splice(P,1),this.touchAction.update())}return this},on:function(w,x){if(w!==i&&x!==i){var P=this.handlers;return h(N(w),function(O){P[O]=P[O]||[],P[O].push(x)}),this}},off:function(w,x){if(w!==i){var P=this.handlers;return h(N(w),function(O){x?P[O]&&P[O].splice(F(P[O],x),1):delete P[O]}),this}},emit:function(w,x){this.options.domEvents&&eR(w,x);var P=this.handlers[w]&&this.handlers[w].slice();if(!(!P||!P.length)){x.type=w,x.preventDefault=function(){x.srcEvent.preventDefault()};for(var O=0;O<P.length;)P[O](x),O++}},destroy:function(){this.element&&Cv(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Cv(w,x){var P=w.element;if(P.style){var O;h(w.options.cssProps,function(B,J){O=W(P.style,J),x?(w.oldCssProps[O]=P.style[O],P.style[O]=B):P.style[O]=w.oldCssProps[O]||""}),x||(w.oldCssProps={})}}function eR(w,x){var P=n.createEvent("Event");P.initEvent(w,!0,!0),P.gesture=x,x.target.dispatchEvent(P)}m(Qn,{INPUT_START:ie,INPUT_MOVE:fe,INPUT_END:X,INPUT_CANCEL:he,STATE_POSSIBLE:Ul,STATE_BEGAN:on,STATE_CHANGED:ts,STATE_ENDED:Ar,STATE_RECOGNIZED:qn,STATE_CANCELLED:Ro,STATE_FAILED:Ln,DIRECTION_NONE:Ie,DIRECTION_LEFT:_e,DIRECTION_RIGHT:Te,DIRECTION_UP:Ze,DIRECTION_DOWN:Se,DIRECTION_HORIZONTAL:Oe,DIRECTION_VERTICAL:Be,DIRECTION_ALL:So,Manager:Sd,Input:Tt,TouchAction:_d,TouchInput:Kn,MouseInput:H,PointerEventInput:ae,TouchMouseInput:vd,SingleTouchInput:et,Recognizer:Zn,AttrRecognizer:mn,Tap:jl,Pan:zl,Swipe:xd,Pinch:Ed,Rotate:bd,Press:wd,on:A,off:R,each:h,merge:v,extend:E,assign:m,inherit:g,bindFn:y,prefixed:W});var tR=typeof e<"u"?e:typeof self<"u"?self:{};tR.Hammer=Qn,typeof i=="function"&&i.amd?i(function(){return Qn}):t.exports?t.exports=Qn:e[r]=Qn})(window,document,"Hammer")})(OA);var Sl=OA.exports;const r8=po(Sl),On=Lw({__proto__:null,default:r8},[Sl]),NA=1,DA=2,Tg=4,i8={mousedown:NA,mousemove:DA,mouseup:Tg};function s8(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function o8(t){const e=t.prototype.handler;t.prototype.handler=function(r){const i=this.store;r.button>0&&r.type==="pointerdown"&&(s8(i,s=>s.pointerId===r.pointerId)||i.push(r)),e.call(this,r)}}function a8(t){t.prototype.handler=function(n){let r=i8[n.type];r&NA&&n.button>=0&&(this.pressed=!0),r&DA&&n.buttons===0&&(r=Tg),this.pressed&&(r&Tg&&(this.pressed=!1),this.callback(this.manager,r,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}o8(Sl.PointerEventInput);a8(Sl.MouseInput);const l8=Sl.Manager;class Qf{constructor(e,n,r){this.element=e,this.callback=n,this.options={enable:!0,...r}}}const c8=On?[[On.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[On.Rotate,{enable:!1}],[On.Pinch,{enable:!1}],[On.Swipe,{enable:!1}],[On.Pan,{threshold:0,enable:!1}],[On.Press,{enable:!1}],[On.Tap,{event:"doubletap",taps:2,enable:!1}],[On.Tap,{event:"anytap",enable:!1}],[On.Tap,{enable:!1}]]:null,k1={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},u8={doubletap:["tap"]},f8={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},B0={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},d8={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},I1={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},h8=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Ps=typeof window<"u"?window:global;let Ag=!1;try{const t={get passive(){return Ag=!0,!0}};Ps.addEventListener("test",null,t),Ps.removeEventListener("test",null)}catch{Ag=!1}const p8=h8.indexOf("firefox")!==-1,{WHEEL_EVENTS:g8}=B0,O1="wheel",N1=4.000244140625,m8=40,v8=.25;class y8 extends Qf{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{if(!this.options.enable)return;let s=i.deltaY;Ps.WheelEvent&&(p8&&i.deltaMode===Ps.WheelEvent.DOM_DELTA_PIXEL&&(s/=Ps.devicePixelRatio),i.deltaMode===Ps.WheelEvent.DOM_DELTA_LINE&&(s*=m8)),s!==0&&s%N1===0&&(s=Math.floor(s/N1)),i.shiftKey&&s&&(s=s*v8),this.callback({type:O1,center:{x:i.clientX,y:i.clientY},delta:-s,srcEvent:i,pointerType:"mouse",target:i.target})},this.events=(this.options.events||[]).concat(g8),this.events.forEach(i=>e.addEventListener(i,this.handleEvent,Ag?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===O1&&(this.options.enable=n)}}const{MOUSE_EVENTS:_8}=B0,D1="pointermove",F1="pointerover",U1="pointerout",B1="pointerenter",z1="pointerleave";class E8 extends Qf{constructor(e,n,r){super(e,n,r),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(_8),this.events.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===D1&&(this.enableMoveEvent=n),e===F1&&(this.enableOverEvent=n),e===U1&&(this.enableOutEvent=n),e===B1&&(this.enableEnterEvent=n),e===z1&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(F1,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(U1,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(B1,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(z1,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.buttons===0&&(this.pressed=!1),this.pressed||this._emit(D1,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:w8}=B0,j1="keydown",V1="keyup";class b8 extends Qf{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{const s=i.target||i.srcElement;s.tagName==="INPUT"&&s.type==="text"||s.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:j1,srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:V1,srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(w8),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===j1&&(this.enableDownEvent=n),e===V1&&(this.enableUpEvent=n)}}const $1="contextmenu";class x8 extends Qf{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{this.options.enable&&this.callback({type:$1,center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===$1&&(this.options.enable=n)}}const G1=1,Cg=2,W1=4,S8={pointerdown:G1,pointermove:Cg,pointerup:W1,mousedown:G1,mousemove:Cg,mouseup:W1},T8=0,A8=1,C8=2,P8=1,R8=2,L8=4;function M8(t){const e=S8[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r}=t.srcEvent;let i=!1,s=!1,o=!1;return e===Cg?(i=!!(n&P8),s=!!(n&L8),o=!!(n&R8)):(i=r===T8,s=r===A8,o=r===C8),{leftButton:i,middleButton:s,rightButton:o}}function k8(t,e){const n=t.center;if(!n)return null;const r=e.getBoundingClientRect(),i=r.width/e.offsetWidth||1,s=r.height/e.offsetHeight||1,o={x:(n.x-r.left-e.clientLeft)/i,y:(n.y-r.top-e.clientTop)/s};return{center:n,offsetCenter:o}}const Mh={srcElement:"root",priority:0};class I8{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const r=this._normalizeEvent(n);let i=n.srcEvent.target;for(;i&&i!==r.rootElement;){if(this._emit(r,i),r.handled)return;i=i.parentNode}this._emit(r,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,r,i=!1,s=!1){const{handlers:o,handlersByElement:a}=this;let l=Mh;typeof r=="string"||r&&r.addEventListener?l={...Mh,srcElement:r}:r&&(l={...Mh,...r});let c=a.get(l.srcElement);c||(c=[],a.set(l.srcElement,c));const u={type:e,handler:n,srcElement:l.srcElement,priority:l.priority};i&&(u.once=!0),s&&(u.passive=!0),o.push(u),this._active=this._active||!u.passive;let d=c.length-1;for(;d>=0&&!(c[d].priority>=u.priority);)d--;c.splice(d+1,0,u)}remove(e,n){const{handlers:r,handlersByElement:i}=this;for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.type===e&&o.handler===n){r.splice(s,1);const a=i.get(o.srcElement);a.splice(a.indexOf(o),1),a.length===0&&i.delete(o.srcElement)}}this._active=r.some(s=>!s.passive)}_emit(e,n){const r=this.handlersByElement.get(n);if(r){let i=!1;const s=()=>{e.handled=!0},o=()=>{e.handled=!0,i=!0},a=[];for(let l=0;l<r.length;l++){const{type:c,handler:u,once:d}=r[l];if(u({...e,type:c,stopPropagation:s,stopImmediatePropagation:o}),d&&a.push(r[l]),i)break}for(let l=0;l<a.length;l++){const{type:c,handler:u}=a[l];this.remove(c,u)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...M8(e),...k8(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const O8={events:null,recognizers:null,recognizerOptions:{},Manager:l8,touchAction:"none",tabIndex:0};class N8{constructor(e=null,n){this._onBasicInput=i=>{const{srcEvent:s}=i,o=f8[s.type];o&&this.manager.emit(o,i)},this._onOtherEvent=i=>{this.manager.emit(i.type,i)},this.options={...O8,...n},this.events=new Map,this.setElement(e);const{events:r}=this.options;r&&this.on(r)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,r=n.Manager;this.manager=new r(e,{touchAction:n.touchAction,recognizers:n.recognizers||c8}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(k1).forEach(i=>{const s=this.manager.get(i);s&&k1[i].forEach(o=>{s.recognizeWith(o)})});for(const i in n.recognizerOptions){const s=this.manager.get(i);if(s){const o=n.recognizerOptions[i];delete o.enable,s.set(o)}}this.wheelInput=new y8(e,this._onOtherEvent,{enable:!1}),this.moveInput=new E8(e,this._onOtherEvent,{enable:!1}),this.keyInput=new b8(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new x8(e,this._onOtherEvent,{enable:!1});for(const[i,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(i,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,r){this._addEventHandler(e,n,r,!1)}once(e,n,r){this._addEventHandler(e,n,r,!0)}watch(e,n,r){this._addEventHandler(e,n,r,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:r}=this;if(!r)return;const i=r.get(e);if(i&&i.options.enable!==n){i.set({enable:n});const s=u8[e];s&&!this.options.recognizers&&s.forEach(o=>{const a=r.get(o);n?(a.requireFailure(e),i.dropRequireFailure(o)):a.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,r,i,s){if(typeof e!="string"){r=n;for(const u in e)this._addEventHandler(u,e[u],r,i,s);return}const{manager:o,events:a}=this,l=I1[e]||e;let c=a.get(l);c||(c=new I8(this),a.set(l,c),c.recognizerName=d8[l]||l,o&&o.on(l,c.handleEvent)),c.add(e,n,r,i,s),c.isEmpty()||this._toggleRecognizer(c.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const o in e)this._removeEventHandler(o,e[o]);return}const{events:r}=this,i=I1[e]||e,s=r.get(i);if(s&&(s.remove(e,n),s.isEmpty())){const{recognizerName:o}=s;let a=!1;for(const l of r.values())if(l.recognizerName===o&&!l.isEmpty()){a=!0;break}a||this._toggleRecognizer(o,!1)}}}function mi(){}const D8=({isDragging:t})=>t?"grabbing":"grab",FA={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:mi,onResize:mi,onViewStateChange:mi,onInteractionStateChange:mi,onBeforeRender:mi,onAfterRender:mi,onLoad:mi,onError:t=>ye.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:D8,getTooltip:null,debug:!1,drawPickingColors:!1};class Jf{constructor(e){_(this,"props",void 0),_(this,"width",0),_(this,"height",0),_(this,"userData",{}),_(this,"canvas",null),_(this,"viewManager",null),_(this,"layerManager",null),_(this,"effectManager",null),_(this,"deckRenderer",null),_(this,"deckPicker",null),_(this,"eventManager",null),_(this,"tooltip",null),_(this,"metrics",void 0),_(this,"animationLoop",void 0),_(this,"stats",void 0),_(this,"viewState",void 0),_(this,"cursorState",void 0),_(this,"_needsRedraw",void 0),_(this,"_pickRequest",void 0),_(this,"_lastPointerDownInfo",null),_(this,"_metricsCounter",void 0),_(this,"_onPointerMove",n=>{const{_pickRequest:r}=this;if(n.type==="pointerleave")r.x=-1,r.y=-1,r.radius=0;else{if(n.leftButton||n.rightButton)return;{const i=n.offsetCenter;if(!i)return;r.x=i.x,r.y=i.y,r.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:r.x,y:r.y}),r.event=n}),_(this,"_onEvent",n=>{const r=P_[n.type],i=n.offsetCenter;if(!r||!i||!this.layerManager)return;const s=this.layerManager.getLayers(),o=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:s,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:a}=o,l=a&&(a[r.handler]||a.props[r.handler]),c=this.props[r.handler];let u=!1;l&&(u=l.call(a,o,n)),!u&&c&&c(o,n)}),_(this,"_onPointerDown",n=>{const r=n.offsetCenter,i=this._pick("pickObject","pickObject Time",{x:r.x,y:r.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=i.result[0]||i.emptyInfo}),this.props={...FA,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&ye.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),mT()==="IE"&&ye.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new m0({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&lo.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,r,i,s,o,a,l;if((e=this.animationLoop)===null||e===void 0||e.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(n=this.layerManager)===null||n===void 0||n.finalize(),this.layerManager=null,(r=this.viewManager)===null||r===void 0||r.finalize(),this.viewManager=null,(i=this.effectManager)===null||i===void 0||i.finalize(),this.effectManager=null,(s=this.deckRenderer)===null||s===void 0||s.finalize(),this.deckRenderer=null,(o=this.deckPicker)===null||o===void 0||o.finalize(),this.deckPicker=null,(a=this.eventManager)===null||a===void 0||a.destroy(),this.eventManager=null,(l=this.tooltip)===null||l===void 0||l.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var c;(c=this.canvas.parentElement)===null||c===void 0||c.removeChild(this.canvas),this.canvas=null}}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&ye.removed("onLayerHover","onHover")(),"onLayerClick"in e&&ye.removed("onLayerClick","onClick")(),e.initialViewState&&!zn(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const r=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return n=n||r||i||s||o,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return ct(this.viewManager),this.viewManager.views}getViewports(e){return ct(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const r in e)this.layerManager.resourceManager.add({resourceId:r,data:e[r],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_pick(e,n,r){ct(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(n).timeStart();const s=this.deckPicker[e]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...r});return i.get(n).timeEnd(),s}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),ct(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;const{width:n,height:r}=e;if(n||n===0){const s=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.width=s}if(r||r===0){var i;const s=Number.isFinite(r)?"".concat(r,"px"):r;this.canvas.style.position=((i=e.style)===null||i===void 0?void 0:i.position)||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){var e,n;const{canvas:r}=this;if(!r)return;const i=(e=r.clientWidth)!==null&&e!==void 0?e:r.width,s=(n=r.clientHeight)!==null&&n!==void 0?n:r.height;if(i!==this.width||s!==this.height){var o,a;this.width=i,this.height=s,(o=this.viewManager)===null||o===void 0||o.setProps({width:i,height:s}),(a=this.layerManager)===null||a===void 0||a.activateViewport(this.getViewports()[0]),this.props.onResize({width:i,height:s})}}_createAnimationLoop(e){const{width:n,height:r,gl:i,glOptions:s,debug:o,onError:a,onBeforeRender:l,onAfterRender:c,useDevicePixels:u}=e;return new Wj({width:n,height:r,useDevicePixels:u,autoResizeDrawingBuffer:!i,autoResizeViewport:!1,gl:i,onCreateContext:d=>NT({...s,...d,canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()}),onInitialize:d=>this._setGLContext(d.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:l,onAfterRender:c,onError:a})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new MA({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:r,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=r.length>0;let s=i,o=!1;for(const a of r){var n;s=a,o=((n=a.layer)===null||n===void 0?void 0:n.onHover(a,e.event))||o}if(!o&&this.props.onHover&&this.props.onHover(s,e.event),this.props.getTooltip&&this.tooltip){const a=this.props.getTooltip(s);this.tooltip.setTooltip(a,s.x,s.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,T0(e,{enable:!0,copyState:!0})),this.tooltip=new n8(this.canvas),mr(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const n=new mA;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new N8(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in P_)this.eventManager.on(i,this._onEvent);this.viewManager=new R6({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const r=this.viewManager.getViewports()[0];this.layerManager=new P6(e,{deck:this,stats:this.stats,viewport:r,timeline:n}),this.effectManager=new W6,this.deckRenderer=new X6(e),this.deckPicker=new e8(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){const{gl:r}=this.layerManager.context;mr(r,this.props.parameters),this.props.onBeforeRender({gl:r}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...n}),this.props.onAfterRender({gl:r})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),ye.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const r=Ri.get("Memory Usage");e.bufferMemory=r.get("Buffer Memory").count,e.textureMemory=r.get("Texture Memory").count,e.renderbufferMemory=r.get("Renderbuffer Memory").count,e.gpuMemory=r.get("GPU Memory").count}}_(Jf,"defaultProps",FA);_(Jf,"VERSION",ZU);class kh{constructor(e,n){_(this,"opts",void 0),_(this,"source",void 0),this.opts=n,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),n=this.getAccessor();if(e)return[e,n];const{value:r}=this.source,{size:i}=n;let s=r;if(r&&r.length!==i){s=new Float32Array(i);const o=n.elementOffset||0;for(let a=0;a<i;++a)s[a]=r[o+a]}return s}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function F8(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function Jc(t){return t.stride||t.size*t.bytesPerElement}function UA(t,e){e.offset&&ye.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=Jc(t),r=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,i=e.elementOffset||0,s=r*n+i*t.bytesPerElement+(t.offset||0);return{...e,offset:s,stride:n}}function U8(t,e){const n=UA(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class B8{constructor(e,n,r){_(this,"gl",void 0),_(this,"id",void 0),_(this,"size",void 0),_(this,"settings",void 0),_(this,"value",void 0),_(this,"doublePrecision",void 0),_(this,"_buffer",void 0),_(this,"state",void 0),this.gl=e,this.id=n.id||"",this.size=n.size||1;const i=n.logicalType||n.type,s=i===5130;let{defaultValue:o}=n;o=Number.isFinite(o)?[o]:o||new Array(this.size).fill(0);let a;s?a=5126:!i&&n.isIndexed?a=e&&GT(e,Fe.ELEMENT_INDEX_UINT32)?5125:5123:a=i||5126;let l=F8(i||a||5126);this.doublePrecision=s,s&&n.fp64===!1&&(l=Float32Array),this.value=null,this.settings={...n,defaultType:l,defaultValue:o,logicalType:i,type:a,size:this.size,bytesPerElement:l.BYTES_PER_ELEMENT},this.state={...r,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:n}=this.settings;this._buffer=new Me(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:n}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*Jc(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),lo.release(this.state.allocatedValue)}getShaderAttributes(e,n){if(this.doublePrecision){const r={},i=this.value instanceof Float64Array,s=U8(this.getAccessor(),n||{});return r[e]=new kh(this,s.high),r["".concat(e,"64Low")]=i?new kh(this,s.low):new Float32Array(this.size),r}if(n){const r=UA(this.getAccessor(),n);return{[e]:new kh(this,r)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:r,size:i}=this,s=r*i;if(n&&s&&n.length>=s){const o=new Array(i).fill(1/0),a=new Array(i).fill(-1/0);for(let l=0;l<s;)for(let c=0;c<i;c++){const u=n[l++];u<o[c]&&(o[c]=u),u>a[c]&&(a[c]=u)}e=[o,a]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let r;ArrayBuffer.isView(e)?r={value:e}:e instanceof Me?r={buffer:e}:r=e;const i={...this.settings,...r};if(n.bufferAccessor=i,n.bounds=null,r.constant){let s=r.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),!(!n.constant||!this._areValuesEqual(s,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=s}else if(r.buffer){const s=r.buffer;n.externalBuffer=s,n.constant=!1,this.value=r.value||null;const o=r.value instanceof Float64Array;i.type=r.type||s.accessor.type,i.bytesPerElement=s.accessor.BYTES_PER_ELEMENT*(o?2:1),i.stride=Jc(i)}else if(r.value){this._checkExternalBuffer(r);let s=r.value;n.externalBuffer=null,n.constant=!1,this.value=s,i.bytesPerElement=s.BYTES_PER_ELEMENT,i.stride=Jc(i);const{buffer:o,byteOffset:a}=this;this.doublePrecision&&s instanceof Float64Array&&(s=Ph(s,i));const l=s.byteLength+a+i.stride*2;o.byteLength<l&&o.reallocate(l),o.setAccessor(null),o.subData({data:s,offset:a}),i.type=r.type||o.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:r=0,endOffset:i}=e;this.buffer.subData({data:this.doublePrecision&&n instanceof Float64Array?Ph(n,{size:this.size,startIndex:r,endIndex:i}):n.subarray(r,i),offset:r*n.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,n=!1){const{state:r}=this,i=r.allocatedValue,s=lo.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=s;const{buffer:o,byteOffset:a}=this;return o.byteLength<s.byteLength+a&&(o.reallocate(s.byteLength+a),n&&i&&o.subData({data:i instanceof Float64Array?Ph(i,this):i,offset:a})),r.allocatedValue=s,r.constant=!1,r.externalBuffer=null,r.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const r=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=n.BYTES_PER_ELEMENT<4),i)throw new Error("Attribute ".concat(this.id," does not support ").concat(n.constructor.name));!(n instanceof r)&&this.settings.normalized&&!("normalized"in e)&&ye.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(n=>(n+128)/255*2-1);case 5122:return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case 5121:return new Float32Array(e).map(n=>n/255);case 5123:return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,r){const{defaultValue:i,size:s}=this.settings;if(Number.isFinite(e))return n[r]=e,n;if(!e){let o=s;for(;--o>=0;)n[r+o]=i[o];return n}switch(s){case 4:n[r+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:n[r+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:n[r+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:n[r+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let o=s;for(;--o>=0;)n[r+o]=Number.isFinite(e[o])?e[o]:i[o]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:r}=this;for(let i=0;i<r;i++)if(e[i]!==n[i])return!1;return!0}}const H1=[],Y1=[];function ed(t,e=0,n=1/0){let r=H1;const i={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?r=t:t.length>0&&(Y1.length=t.length,r=Y1):r=H1,(e>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,n),i.index=e-1),{iterable:r,objectInfo:i}}function BA(t){return t&&t[Symbol.asyncIterator]}function zA(t,e){const{size:n,stride:r,offset:i,startIndices:s,nested:o}=e,a=t.BYTES_PER_ELEMENT,l=r?r/a:n,c=i?i/a:0,u=Math.floor((t.length-c)/l);return(d,{index:f,target:h})=>{if(!s){const v=f*l+c;for(let g=0;g<n;g++)h[g]=t[v+g];return h}const p=s[f],m=s[f+1]||u;let E;if(o){E=new Array(m-p);for(let v=p;v<m;v++){const g=v*l+c;h=new Array(n);for(let y=0;y<n;y++)h[y]=t[g+y];E[v-p]=h}}else if(l===n)E=t.subarray(p*n+c,m*n+c);else{E=new t.constructor((m-p)*n);let v=0;for(let g=p;g<m;g++){const y=g*l+c;for(let b=0;b<n;b++)E[v++]=t[y+b]}}return E}}const z8=[],eu=[[0,1/0]];function j8(t,e){if(t===eu||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],r=t.length;let i=0;for(let s=0;s<r;s++){const o=t[s];o[1]<e[0]?(n.push(o),i=s+1):o[0]>e[1]?n.push(o):e=[Math.min(o[0],e[0]),Math.max(o[1],e[1])]}return n.splice(i,0,e),n}function Ih(t){const{source:e,target:n,start:r=0,size:i,getData:s}=t,o=t.end||n.length,a=e.length,l=o-r;if(a>l){n.set(e.subarray(0,l),r);return}if(n.set(e,r),!s)return;let c=a;for(;c<l;){const u=s(c,e);for(let d=0;d<i;d++)n[r+c]=u[d]||0,c++}}function V8({source:t,target:e,size:n,getData:r,sourceStartIndices:i,targetStartIndices:s}){if(!Array.isArray(s))return Ih({source:t,target:e,size:n,getData:r}),e;let o=0,a=0;const l=r&&((u,d)=>r(u+a,d)),c=Math.min(i.length,s.length);for(let u=1;u<c;u++){const d=i[u]*n,f=s[u]*n;Ih({source:t.subarray(o,d),target:e,start:a,end:f,size:n,getData:l}),o=d,a=f}return a<e.length&&Ih({source:[],target:e,start:a,size:n,getData:l}),e}const $8={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function jA(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...$8[n],...e,...t,type:n}}function VA(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function $A(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function GA(t){t.push(t.shift())}function z0(t,e){const{doublePrecision:n,settings:r,value:i,size:s}=t,o=n&&i instanceof Float64Array?2:1;return(r.noAlloc?i.length:e*s)*o}function WA({buffer:t,numInstances:e,attribute:n,fromLength:r,fromStartIndices:i,getData:s=o=>o}){const o=n.doublePrecision&&n.value instanceof Float64Array?2:1,a=n.size*o,l=n.byteOffset,c=n.startIndices,u=i&&c,d=z0(n,e),f=n.isConstant;if(!u&&r>=d)return;const h=f?n.value:n.getBuffer().getData({srcByteOffset:l});if(n.settings.normalized&&!f){const v=s;s=(g,y)=>n.normalizeConstant(v(g,y))}const p=f?(v,g)=>s(h,g):(v,g)=>s(h.subarray(v,v+a),g),m=t.getData({length:r}),E=new Float32Array(d);V8({source:m,target:E,sourceStartIndices:i,targetStartIndices:c,size:a,getData:p}),t.byteLength<E.byteLength+l&&t.reallocate(E.byteLength+l),t.subData({data:E,offset:l})}class j0 extends B8{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:eu}),_(this,"constant",!1),this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,r=this.settings.transition,i=Array.isArray(n)?e[n.find(s=>e[s])]:e[n];return jA(i,r)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:r=0,endRow:i=1/0}=n;this.state.updateRanges=j8(this.state.updateRanges,[r,i])}else this.state.updateRanges=eu}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=z8}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:r}=this;return r.noAlloc?!1:r.update?(super.allocate(e,n.updateRanges!==eu),!0):!1}updateBuffer({numInstances:e,data:n,props:r,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let l=!0;if(o){for(const[c,u]of s)o.call(i,this,{data:n,startRow:c,endRow:u,props:r,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[c,u]of s){const d=Number.isFinite(c)?this.getVertexOffset(c):0,f=Number.isFinite(u)?this.getVertexOffset(u):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:d,endOffset:f})}this._checkAttributeArray()}else l=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),l}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:r,settings:i}=this;if(!e)return r.binaryValue=null,r.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(r.binaryValue===e)return this.clearNeedsUpdate(),!0;if(r.binaryValue=e,this.setNeedsRedraw(),i.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const o=e;ct(ArrayBuffer.isView(o.value),"invalid ".concat(i.accessor));const a=!!o.size&&o.size!==this.size;return r.binaryAccessor=zA(o.value,{size:o.size||this.size,stride:o.stride,offset:o.offset,startIndices:n,nested:a}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?e<n.length?n[e]:this.numInstances:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},n={};for(const r in e)Object.assign(n,super.getShaderAttributes(r,e[r]));return n}_autoUpdater(e,{data:n,startRow:r,endRow:i,props:s,numInstances:o}){if(e.constant)return;const{settings:a,state:l,value:c,size:u,startIndices:d}=e,{accessor:f,transform:h}=a,p=l.binaryAccessor||(typeof f=="function"?f:s[f]);ct(typeof p=="function",'accessor "'.concat(f,'" is not a function'));let m=e.getVertexOffset(r);const{iterable:E,objectInfo:v}=ed(n,r,i);for(const g of E){v.index++;let y=p(g,v);if(h&&(y=h.call(this,y)),d){const b=(v.index<d.length-1?d[v.index+1]:o)-d[v.index];if(y&&Array.isArray(y[0])){let T=m;for(const A of y)e._normalizeValue(A,c,T),T+=u}else y&&y.length>u?c.set(y,m):(e._normalizeValue(y,v.target,0),_6({target:c,source:v.target,start:m,count:b}));m+=b*u}else e._normalizeValue(y,c,m),m+=u}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let r=!0;switch(n){case 4:r=r&&Number.isFinite(e[3]);case 3:r=r&&Number.isFinite(e[2]);case 2:r=r&&Number.isFinite(e[1]);case 1:r=r&&Number.isFinite(e[0]);break;default:r=!1}if(!r)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class G8{constructor({gl:e,attribute:n,timeline:r}){_(this,"gl",void 0),_(this,"type","interpolation"),_(this,"attributeInTransition",void 0),_(this,"settings",void 0),_(this,"attribute",void 0),_(this,"transition",void 0),_(this,"currentStartIndices",void 0),_(this,"currentLength",void 0),_(this,"transform",void 0),_(this,"buffers",void 0),this.gl=e,this.transition=new xl(r),this.attribute=n,this.attributeInTransition=new j0(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=H8(e,n);const i={byteLength:0,usage:35050};this.buffers=[new Me(e,i),new Me(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){if(e.duration<=0){this.transition.cancel();return}this.settings=e;const{gl:r,buffers:i,attribute:s}=this;GA(i);const o={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of i)WA({buffer:a,...o});this.currentStartIndices=s.startIndices,this.currentLength=z0(s,n),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:i[0],aTo:VA(r,s)},feedbackBuffers:{vCurrent:i[1]}})}update(){const e=this.transition.update();if(e){const{duration:n,easing:r}=this.settings,{time:i}=this.transition;let s=i/n;r&&(s=r(s)),this.transform.run({uniforms:{time:s}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}}const W8=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function H8(t,e){const n=$A(e.size);return new I0(t,{vs:W8,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}class Y8{constructor({gl:e,attribute:n,timeline:r}){_(this,"gl",void 0),_(this,"type","spring"),_(this,"attributeInTransition",void 0),_(this,"settings",void 0),_(this,"attribute",void 0),_(this,"transition",void 0),_(this,"currentStartIndices",void 0),_(this,"currentLength",void 0),_(this,"texture",void 0),_(this,"framebuffer",void 0),_(this,"transform",void 0),_(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new xl(r),this.attribute=n,this.attributeInTransition=new j0(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=K8(e),this.framebuffer=q8(e,this.texture),this.transform=X8(e,n,this.framebuffer);const i={byteLength:0,usage:35050};this.buffers=[new Me(e,i),new Me(e,i),new Me(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){const{gl:r,buffers:i,attribute:s}=this,o={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of i)WA({buffer:a,...o});this.settings=e,this.currentStartIndices=s.startIndices,this.currentLength=z0(s,n),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:VA(r,s)}})}update(){const{buffers:e,transform:n,framebuffer:r,transition:i}=this;if(!i.update())return!1;const o=this.settings;return n.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),n.run({framebuffer:r,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:o.stiffness,damping:o.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),GA(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),Zf(r)[0]>0||i.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function X8(t,e,n){const r=$A(e.size);return new I0(t,{framebuffer:n,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}function K8(t){return new nn(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function q8(t,e){return new ot(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}const Z8={interpolation:G8,spring:Y8};class Q8{constructor(e,{id:n,timeline:r}){_(this,"id",void 0),_(this,"isSupported",void 0),_(this,"gl",void 0),_(this,"timeline",void 0),_(this,"transitions",void 0),_(this,"needsRedraw",void 0),_(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=I0.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:r}){this.numInstances=r||1;for(const i in e){const s=e[i],o=s.getTransitionSetting(n);o&&this._updateAttribute(i,s,o)}for(const i in this.transitions){const s=e[i];(!s||!s.getTransitionSetting(n))&&this._removeTransition(i)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const r=this.transitions[n];r.inProgress&&(e[n]=r.attributeInTransition)}return e}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,n,r){const i=this.transitions[e];let s=!i||i.type!==r.type;if(s){if(!this.isSupported){ye.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();return}i&&this._removeTransition(e);const o=Z8[r.type];o?this.transitions[e]=new o({attribute:n,timeline:this.timeline,gl:this.gl}):(ye.error("unsupported transition type '".concat(r.type,"'"))(),s=!1)}(s||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(r,this.numInstances))}}const X1="attributeManager.invalidate",J8="attributeManager.updateStart",e$="attributeManager.updateEnd",t$="attribute.updateStart",n$="attribute.allocate",r$="attribute.updateEnd";class i${constructor(e,{id:n="attribute-manager",stats:r,timeline:i}={}){_(this,"id",void 0),_(this,"gl",void 0),_(this,"attributes",void 0),_(this,"updateTriggers",void 0),_(this,"needsRedraw",void 0),_(this,"userData",void 0),_(this,"stats",void 0),_(this,"attributeTransitionManager",void 0),_(this,"mergeBoundsMemoized",bl(u6)),this.id=n,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new Q8(e,{id:"".concat(n,"-transitions"),timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const r=this._invalidateTrigger(e,n);wt(X1,this,e,r)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);wt(X1,this,"all")}update({data:e,numInstances:n,startIndices:r=null,transitions:i,props:s={},buffers:o={},context:a={}}){let l=!1;wt(J8,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const c in this.attributes){const u=this.attributes[c],d=u.settings.accessor;u.startIndices=r,u.numInstances=n,s[c]&&ye.removed("props.".concat(c),"data.attributes.".concat(c))(),u.setExternalBuffer(o[c])||u.setBinaryValue(typeof d=="string"?o[d]:void 0,e.startIndices)||typeof d=="string"&&!o[d]&&u.setConstantValue(s[d])||u.needsUpdate()&&(l=!0,this._updateAttribute({attribute:u,numInstances:n,data:e,props:s,context:a})),this.needsRedraw=this.needsRedraw||u.needsRedraw()}l&&wt(e$,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return this.attributes}getBounds(e){const n=e.map(r=>{var i;return(i=this.attributes[r])===null||i===void 0?void 0:i.getBounds()});return this.mergeBoundsMemoized(n)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:r}=this,i={...r.getAttributes()};for(const s in n){const o=n[s];o.needsRedraw(e)&&!r.hasAttribute(s)&&(i[s]=o)}return i}getShaderAttributes(e,n={}){e||(e=this.getAttributes());const r={};for(const i in e)n[i]||Object.assign(r,e[i].getShaderAttributes());return r}_add(e,n={}){for(const r in e){const i=e[r];this.attributes[r]=this._createAttribute(r,i,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,n,r){const i={...n,id:e,size:n.isIndexed&&1||n.size||1,divisor:r.instanced?1:n.divisor||0};return new j0(this.gl,i)}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:r,updateTriggers:i}=this,s=i[e];return s&&s.forEach(o=>{const a=r[o];a&&a.setNeedsUpdate(a.id,n)}),s}_updateAttribute(e){const{attribute:n,numInstances:r}=e;if(wt(t$,n),n.constant){n.setConstantValue(n.value);return}n.allocate(r)&&wt(n$,n,r),n.updateBuffer(e)&&(this.needsRedraw=!0,wt(r$,n,r))}}class s$ extends xl{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:r,duration:i,easing:s}}=this,o=s(e/i);this._value=Vu(n,r,o)}}const K1=1e-5;function q1(t,e,n,r,i){const s=e-t,a=(n-e)*i,l=-s*r;return a+l+s+e}function o$(t,e,n,r,i){if(Array.isArray(n)){const s=[];for(let o=0;o<n.length;o++)s[o]=q1(t[o],e[o],n[o],r,i);return s}return q1(t,e,n,r,i)}function Z1(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}class a$ extends xl{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:r,stiffness:i}=this.settings,{_prevValue:s=e,_currValue:o=e}=this;let a=o$(s,o,n,r,i);const l=Z1(a,n),c=Z1(a,o);l<K1&&c<K1&&(a=n,this.end()),this._prevValue=o,this._currValue=a}}const l$={interpolation:s$,spring:a$};class c${constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,r,i){const{transitions:s}=this;if(s.has(e)){const l=s.get(e),{value:c=l.settings.fromValue}=l;n=c,this.remove(e)}if(i=jA(i),!i)return;const o=l$[i.type];if(!o){ye.error("unsupported transition type '".concat(i.type,"'"))();return}const a=new o(this.timeline);a.start({...i,fromValue:n,toValue:r}),s.set(e,a)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,r]of this.transitions)r.update(),e[n]=r.value,r.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function u$(t){const e=t[ni];for(const n in e){const r=e[n],{validate:i}=r;if(i&&!i(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function f$(t,e){const n=HA({newProps:t,oldProps:e,propTypes:t[ni],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=h$(t,e);let i=!1;return r||(i=p$(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:g$(t,e),transitionsChanged:d$(t,e)}}function d$(t,e){if(!t.transitions)return!1;const n={},r=t[ni];let i=!1;for(const s in t.transitions){const o=r[s],a=o&&o.type;(a==="number"||a==="color"||a==="array")&&Pg(t[s],e[s],o)&&(n[s]=!0,i=!0)}return i?n:!1}function HA({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:i="props"}){if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(i," changed shallowly");for(const s of Object.keys(t))if(!(s in n)){if(!(s in e))return"".concat(i,".").concat(s," added");const o=Pg(t[s],e[s],r[s]);if(o)return"".concat(i,".").concat(s," ").concat(o)}for(const s of Object.keys(e))if(!(s in n)){if(!(s in t))return"".concat(i,".").concat(s," dropped");if(!Object.hasOwnProperty.call(t,s)){const o=Pg(t[s],e[s],r[s]);if(o)return"".concat(i,".").concat(s," ").concat(o)}}return!1}function Pg(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)||!r&&(r=t&&e&&t.equals,r&&!r.call(t,e))?"changed deeply":!r&&e!==t?"changed shallowly":null}function h$(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:i}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&i&&(n=i(t.data,e.data)||n),n}function p$(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&Q1(t,e,"all"))return{all:!0};const n={};let r=!1;for(const i in t.updateTriggers)i!=="all"&&Q1(t,e,i)&&(n[i]=!0,r=!0);return r?n:!1}function g$(t,e){if(e===null)return!0;const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(!n||!r||r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function Q1(t,e,n){let r=t.updateTriggers[n];r=r??{};let i=e.updateTriggers[n];return i=i??{},HA({oldProps:i,newProps:r,triggerName:n})}const m$="count(): argument not an object",v$="count(): argument not a container";function y$(t){if(!E$(t))throw new Error(m$);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(_$(t))return Object.keys(t).length;throw new Error(v$)}function _$(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function E$(t){return t!==null&&typeof t=="object"}function w$(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(r=>r.name==="project64"))){const r=n.modules.findIndex(i=>i.name==="project32");r>=0&&n.modules.splice(r,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const r={...t.inject};for(const i in e.inject)r[i]=(r[i]||"")+e.inject[i];n.inject=r}return n}const b$={10241:9987,10240:9729,10242:33071,10243:33071},Rg={};function x$(t,e,n,r){if(n instanceof nn)return n;n.constructor&&n.constructor.name!=="Object"&&(n={data:n});let i=null;n.compressed&&(i={10241:n.data.length>1?9985:9729});const s=new nn(e,{...n,parameters:{...b$,...i,...r}});return Rg[s.id]=t,s}function S$(t,e){!e||!(e instanceof nn)||Rg[e.id]===t&&(e.delete(),delete Rg[e.id])}const T$={boolean:{validate(t,e){return!0},equal(t,e,n){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||Lg(t)&&(t.length===3||t.length===4)},equal(t,e,n){return zn(t,e,1)}},accessor:{validate(t,e){const n=Ku(t);return n==="function"||n===Ku(e.value)},equal(t,e,n){return typeof e=="function"?!0:zn(t,e,1)}},array:{validate(t,e){return e.optional&&!t||Lg(t)},equal(t,e,n){const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?zn(t,e,i):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?zn(t,e,i):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare&&n.ignore!==!1||t===e}},data:{transform:(t,e,n)=>{const{dataTransform:r}=n.props;return r&&t?r(t):t}},image:{transform:(t,e,n)=>{const r=n.context;return!r||!r.gl?null:x$(n.id,r.gl,t,{...e.parameters,...n.props.textureParameters})},release:(t,e,n)=>{S$(n.id,t)}}};function A$(t){const e={},n={},r={};for(const[i,s]of Object.entries(t)){const o=s==null?void 0:s.deprecatedFor;if(o)r[i]=Array.isArray(o)?o:[o];else{const a=C$(i,s);e[i]=a,n[i]=a.value}}return{propTypes:e,defaultProps:n,deprecatedProps:r}}function C$(t,e){switch(Ku(e)){case"object":return Xo(t,e);case"array":return Xo(t,{type:"array",value:e,compare:!1});case"boolean":return Xo(t,{type:"boolean",value:e});case"number":return Xo(t,{type:"number",value:e});case"function":return Xo(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function Xo(t,e){return"type"in e?{name:t,...T$[e.type],...e}:"value"in e?{name:t,type:Ku(e.value),...e}:{name:t,type:"object",value:e}}function Lg(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function Ku(t){return Lg(t)?"array":t===null?"null":typeof t}function P$(t,e){let n;for(let s=e.length-1;s>=0;s--){const o=e[s];"extensions"in o&&(n=o.extensions)}const r=Mg(t.constructor,n),i=Object.create(r);i[Xu]=t,i[$i]={},i[Gr]={};for(let s=0;s<e.length;++s){const o=e[s];for(const a in o)i[a]=o[a]}return Object.freeze(i),i}const R$="_mergedDefaultProps";function Mg(t,e){let n=R$;if(e)for(const i of e){const s=i.constructor;s&&(n+=":".concat(s.extensionName||s.name))}const r=YA(t,n);return r||(t[n]=L$(t,e||[]))}function L$(t,e){if(!t.prototype)return null;const r=Object.getPrototypeOf(t),i=Mg(r),s=YA(t,"defaultProps")||{},o=A$(s),a=Object.assign(Object.create(null),i,o.defaultProps),l=Object.assign(Object.create(null),i==null?void 0:i[ni],o.propTypes),c=Object.assign(Object.create(null),i==null?void 0:i[Lh],o.deprecatedProps);for(const u of e){const d=Mg(u.constructor);d&&(Object.assign(a,d),Object.assign(l,d[ni]),Object.assign(c,d[Lh]))}return M$(a,t),I$(a,l),k$(a,c),a[ni]=l,a[Lh]=c,e.length===0&&!V0(t,"_propTypes")&&(t._propTypes=l),a}function M$(t,e){const n=N$(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}function k$(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(r){const i="".concat(this.id,": ").concat(n);for(const s of e[n])V0(this,s)||(this[s]=r);ye.deprecated(i,e[n].join("/"))()}})}function I$(t,e){const n={},r={};for(const i in e){const s=e[i],{name:o,value:a}=s;s.async&&(n[o]=a,r[o]=O$(o))}t[Bs]=n,t[$i]={},Object.defineProperties(t,r)}function O$(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||BA(e)?this[$i][t]=e:this[Gr][t]=e},get(){if(this[Gr]){if(t in this[Gr])return this[Gr][t]||this[Bs][t];if(t in this[$i]){const e=this[Xu]&&this[Xu].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[Bs][t]}}return this[Bs][t]}}}function V0(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function YA(t,e){return V0(t,e)&&t[e]}function N$(t){const e=t.componentName;return e||ye.warn("".concat(t.name,".componentName not specified"))(),e||t.name}let D$=0;class $0{constructor(...e){_(this,"id",void 0),_(this,"props",void 0),_(this,"count",void 0),this.props=P$(this,e),this.id=this.props.id,this.count=D$++}clone(e){const{props:n}=this,r={};for(const i in n[Bs])i in n[Gr]?r[i]=n[Gr][i]:i in n[$i]&&(r[i]=n[$i][i]);return new this.constructor({...n,...r,...e})}}_($0,"componentName","Component");_($0,"defaultProps",{});const F$=Object.freeze({});class U${constructor(e){_(this,"component",void 0),_(this,"onAsyncPropUpdated",void 0),_(this,"asyncProps",void 0),_(this,"oldProps",void 0),_(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||F$}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return!!(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){this.component=e[Xu]||this.component;const n=e[Gr]||{},r=e[$i]||e,i=e[Bs]||{};for(const s in n){const o=n[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,o),n[s]=this.getAsyncProp(s)}for(const s in r){const o=r[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,o)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(BA(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const r=this.asyncProps[e];return n===r.resolvedValue||n===r.lastValue?!1:(r.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const r=this.asyncProps[e];r&&(n=this._postProcessValue(r,n),r.resolvedValue=n,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount)}_setAsyncPropValue(e,n,r){const i=this.asyncProps[e];i&&r>=i.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=n,i.resolvedLoadCount=r,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const r=this.asyncProps[e];if(r){r.pendingLoadCount++;const i=r.pendingLoadCount;n.then(s=>{this.component&&(s=this._postProcessValue(r,s),this._setAsyncPropValue(e,s,i),this._onResolve(e,s))}).catch(s=>{this._onError(e,s)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const r=this.asyncProps[e];if(!r)return;r.pendingLoadCount++;const i=r.pendingLoadCount;let s=[],o=0;for await(const a of n){if(!this.component)return;const{dataTransform:l}=this.component.props;l?s=l(a,s):s=s.concat(a),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:o,endRow:s.length}]}),o=s.length,this._setAsyncPropValue(e,s,i)}this._onResolve(e,s)}_postProcessValue(e,n){const r=e.type;return r&&this.component&&(r.release&&r.release(e.resolvedValue,r,this.component),r.transform)?r.transform(n,r,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const i=this.component&&this.component.props[ni];this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class B$ extends U${constructor({attributeManager:e,layer:n}){super(n),_(this,"attributeManager",void 0),_(this,"needsRedraw",void 0),_(this,"needsUpdate",void 0),_(this,"subLayers",void 0),_(this,"usesPickingColorCache",void 0),_(this,"hasPickingBuffer",void 0),_(this,"changeFlags",void 0),_(this,"viewport",void 0),_(this,"uniformTransitions",void 0),_(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,n){const r=this.layer,i=r==null?void 0:r.props.fetch;return i?i(n,{propName:e,layer:r}):super._fetch(e,n)}_onResolve(e,n){const r=this.layer;if(r){const i=r.props.onDataLoad;e==="data"&&i&&i(n,{propName:e,layer:r})}}_onError(e,n){const r=this.layer;r&&r.raiseError(n,"loading ".concat(e," of ").concat(this.layer))}}const z$="layer.changeFlag",j$="layer.initialize",V$="layer.update",$$="layer.finalize",G$="layer.matched",J1=2**24-1,W$=Object.freeze([]),H$=bl(({oldViewport:t,viewport:e})=>t.equals(e));let Nn=new Uint8ClampedArray(0);const Y$={data:{type:"data",value:W$,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:i,signal:s})=>{const{resourceManager:o}=n.context;if(i=i||n.getLoadOptions(),r=r||n.props.loaders,s){var a;i={...i,fetch:{...(a=i)===null||a===void 0?void 0:a.fetch,signal:s}}}let l=o.contains(t);return!l&&!i&&(o.add({resourceId:t,data:Bu(t,r),persistent:!1}),l=!0),l?o.subscribe({resourceId:t,onChange:c=>{var u;return(u=n.internalState)===null||u===void 0?void 0:u.reloadAsyncProp(e,c)},consumerId:n.id,requestId:e}):Bu(t,r,i)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:Ce.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class Xn extends $0{constructor(...e){super(...e),_(this,"internalState",null),_(this,"lifecycle",ps.NO_STATE),_(this,"context",void 0),_(this,"state",void 0),_(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){ct(this.internalState);const n=this.internalState.viewport||this.context.viewport,r=CA(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,s,o]=TA(r,n.pixelProjectionMatrix);return e.length===2?[i,s]:[i,s,o]}unproject(e){return ct(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){ct(this.internalState);const r=this.internalState.viewport||this.context.viewport;return m6(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===Ce.DEFAULT||e===Ce.LNGLAT||e===Ce.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){ct(e instanceof Uint8Array);const[n,r,i]=e;return n+r*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:y$(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return(e=this.getAttributeManager())===null||e===void 0?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){for(const n of this.props.extensions)e=w$(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:r}=e.changeFlags;if(r&&n)if(Array.isArray(r))for(const i of r)n.invalidateAll(i);else n.invalidateAll();if(n){const{props:i}=e,s=this.internalState.hasPickingBuffer,o=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(a=>a.getNeedsPickingBuffer.call(this,a));if(s!==o){this.internalState.hasPickingBuffer=o;const{pickingColors:a,instancePickingColors:l}=n.attributes,c=a||l;c&&(o&&c.constant&&(c.constant=!1,n.invalidate(c.id)),!c.value&&!o&&(c.constant=!0,c.value=[0,0,0]))}}}finalizeState(e){for(const r of this.getModels())r.delete();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:r}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,n){var r,i;if(n&&(e=new Error("".concat(n,": ").concat(e.message),{cause:e})),!((r=(i=this.props).onError)!==null&&r!==void 0&&r.call(i,e))){var s,o;(s=this.context)===null||s===void 0||(o=s.onError)===null||o===void 0||o.call(s,e,this)}}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)===null||e===void 0?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!H$({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();n&&(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){for(const n of this.getModels())this._setModelAttributes(n,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,r=this.getNumInstances(),i=this.getStartIndices();e.update({data:n.data,numInstances:r,startIndices:i,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const s=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),r=Object.create(this.props);for(const i in n)Object.defineProperty(r,i,{value:n[i]});return r}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const r=Math.floor(Nn.length/3);if(this.internalState.usesPickingColorCache=!0,r<n){n>J1&&ye.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Nn=lo.allocate(Nn,n,{size:3,copy:!0,maxCount:Math.max(n,J1)});const i=Math.floor(Nn.length/3),s=[];for(let o=r;o<i;o++)this.encodePickingColor(o,s),Nn[o*3+0]=s[0],Nn[o*3+1]=s[1],Nn[o*3+2]=s[2]}e.value=Nn.subarray(0,n*3)}_setModelAttributes(e,n){const r=this.getAttributeManager(),i=e.userData.excludeAttributes||{},s=r.getShaderAttributes(n,i);e.setAttributes(s)}disablePickingIndex(e){const n=this.props.data;if(!("attributes"in n)){this._disablePickingIndex(e);return}const{pickingColors:r,instancePickingColors:i}=this.getAttributeManager().attributes,s=r||i,o=s&&n.attributes&&n.attributes[s.id];if(o&&o.value){const a=o.value,l=this.encodePickingColor(e);for(let c=0;c<n.length;c++){const u=s.getVertexOffset(c);a[u]===l[0]&&a[u+1]===l[1]&&a[u+2]===l[2]&&this._disablePickingIndex(c)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,i=n||r;if(!i)return;const s=i.getVertexOffset(e),o=i.getVertexOffset(e+1);i.buffer.subData({data:new Uint8Array(o-s),offset:s})}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n;r&&(this.internalState.usesPickingColorCache&&r.value.buffer!==Nn.buffer&&(r.value=Nn.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}_initialize(){ct(!this.internalState),ct(Number.isFinite(this.props.coordinateSystem)),wt(j$,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new B$({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(ye.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new c$(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){wt(G$,this,this===e);const{state:n,internalState:r}=e;this!==e&&(this.internalState=r,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(wt(V$,this,e),!e)return;const n=this.props,r=this.context,i=this.internalState,s=r.viewport,o=this._updateUniformTransition();i.propsInTransition=o,r.viewport=i.viewport||s,this.props=o;try{const a=this._getUpdateParams(),l=this.getModels();if(r.gl)this.updateState(a);else try{this.updateState(a)}catch{}for(const u of this.props.extensions)u.updateState.call(this,a,u);const c=this.getModels()[0]!==l[0];this._postUpdate(a,c)}finally{r.viewport=s,this.props=n,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){wt($$,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({moduleParameters:e=null,uniforms:n={},parameters:r={}}){this._updateAttributeTransition();const i=this.props,s=this.context;this.props=this.internalState.propsInTransition||i;const o=this.props.opacity;n.opacity=Math.pow(o,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:a}=this.props,l=a&&a(n)||[0,0];mr(s.gl,{polygonOffset:l}),Pn(s.gl,r,()=>{const c={moduleParameters:e,uniforms:n,parameters:r,context:s};for(const u of this.props.extensions)u.draw.call(this,c,u);this.draw(c)})}finally{this.props=i}}getChangeFlags(){var e;return(e=this.internalState)===null||e===void 0?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const i in e)if(e[i]){let s=!1;switch(i){case"dataChanged":const o=e[i],a=n[i];o&&Array.isArray(a)&&(n.dataChanged=Array.isArray(o)?a.concat(o):o,s=!0);default:n[i]||(n[i]=e[i],s=!0)}s&&wt(z$,this,i,e)}const r=!!(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=r,n.somethingChanged=r||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){const r=f$(e,n);if(r.updateTriggersChanged)for(const s in r.updateTriggersChanged)r.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(r.transitionsChanged)for(const s in r.transitionsChanged){var i;this.internalState.uniformTransitions.add(s,n[s],e[s],(i=e.transitions)===null||i===void 0?void 0:i[s])}return this.setChangeFlags(r)}validateProps(){u$(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={pickingSelectedColor:e.picked?e.color:null},{highlightColor:r}=this.props;e.picked&&typeof r=="function"&&(n.pickingHighlightColor=r(e)),this.setModuleParameters(n),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new i$(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:r,oldProps:i}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:s}=this.state;s==null||s.setInstanceCount(this.getNumInstances());const{autoHighlight:o,highlightedObjectIndex:a,highlightColor:l}=r;if(n||i.autoHighlight!==o||i.highlightedObjectIndex!==a||i.highlightColor!==l){const c={};o||(c.pickingSelectedColor=null),Array.isArray(l)&&(c.pickingHighlightColor=l),(n||a!==i.highlightedObjectIndex)&&(c.pickingSelectedColor=Number.isFinite(a)&&a>=0?this.encodePickingColor(a):null),this.setModuleParameters(c)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id;const r=this.getAttributeManager(),i=r?r.getNeedsRedraw(e):!1;if(n=n||i,n)for(const s of this.props.extensions)s.onNeedsRedraw.call(this,s);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}_(Xn,"defaultProps",Y$);_(Xn,"layerName","Layer");const X$="compositeLayer.renderLayers";class G0 extends Xn{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:r}=this.props;return r&&r[e]&&r[e].type||n}getSubLayerRow(e,n,r){return e.__source={parent:this,object:n,index:r},e}getSubLayerAccessor(e){if(typeof e=="function"){const n={index:-1,data:this.props.data,target:[]};return(r,i)=>r&&r.__source?(n.index=r.__source.index,e(r.__source.object,n)):e(r,i)}return e}getSubLayerProps(e={}){var n;const{opacity:r,pickable:i,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:c,highlightColor:u,coordinateSystem:d,coordinateOrigin:f,wrapLongitude:h,positionFormat:p,modelMatrix:m,extensions:E,fetch:v,operation:g,_subLayerProps:y}=this.props,b={id:"",updateTriggers:{},opacity:r,pickable:i,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:c,highlightColor:u,coordinateSystem:d,coordinateOrigin:f,wrapLongitude:h,positionFormat:p,modelMatrix:m,extensions:E,fetch:v,operation:g},T=y&&e.id&&y[e.id],A=T&&T.updateTriggers,R=e.id||"sublayer";if(T){const I=this.props[ni],D=e.type?e.type._propTypes:{};for(const N in T){const F=D[N]||I[N];F&&F.type==="accessor"&&(T[N]=this.getSubLayerAccessor(T[N]))}}Object.assign(b,e,T),b.id="".concat(this.props.id,"-").concat(R),b.updateTriggers={all:(n=this.props.updateTriggers)===null||n===void 0?void 0:n.all,...e.updateTriggers,...A};for(const I of E){const D=I.getSubLayerProps.call(this,I);D&&Object.assign(b,D,{updateTriggers:Object.assign(b.updateTriggers,D.updateTriggers)})}return b}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let r=this.internalState.subLayers;const i=!r||this.needsUpdate();if(i){const s=this.renderLayers();r=U0(s,Boolean),this.internalState.subLayers=r}wt(X$,this,i,r);for(const s of r)s.parent=this}}_(G0,"layerName","CompositeLayer");class XA{constructor(e){_(this,"opts",void 0),_(this,"typedArrayManager",void 0),_(this,"indexStarts",[0]),_(this,"vertexStarts",[0]),_(this,"vertexCount",0),_(this,"instanceCount",0),_(this,"attributes",void 0),_(this,"_attributeDefs",void 0),_(this,"data",void 0),_(this,"getGeometry",void 0),_(this,"geometryBuffer",void 0),_(this,"buffers",void 0),_(this,"positionSize",void 0),_(this,"normalize",void 0);const{attributes:n={}}=e;this.typedArrayManager=lo,this.attributes={},this._attributeDefs=n,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:n,buffers:r={},getGeometry:i,geometryBuffer:s,positionFormat:o,dataChanged:a,normalize:l=!0}=this.opts;if(this.data=n,this.getGeometry=i,this.positionSize=s&&s.size||(o==="XY"?2:3),this.buffers=r,this.normalize=l,s&&(ct(n.startIndices),this.getGeometry=this.getGeometryFromBuffer(s),l||(r.positions=s)),this.geometryBuffer=r.positions,Array.isArray(a))for(const c of a)this._rebuildGeometry(c);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:n}){this._rebuildGeometry({startRow:e,endRow:n})}getGeometryFromBuffer(e){const n=e.value||e;return ArrayBuffer.isView(n)?zA(n,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,n){const{attributes:r,buffers:i,_attributeDefs:s,typedArrayManager:o}=this;for(const a in s)if(a in i)o.release(r[a]),r[a]=null;else{const l=s[a];l.copy=n,r[a]=o.allocate(r[a],e,l)}}_forEachGeometry(e,n,r){const{data:i,getGeometry:s}=this,{iterable:o,objectInfo:a}=ed(i,n,r);for(const l of o){a.index++;const c=s?s(l,a):null;e(c,a.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:n,vertexStarts:r,instanceCount:i}=this;const{data:s,geometryBuffer:o}=this,{startRow:a=0,endRow:l=1/0}=e||{},c={};if(e||(n=[0],r=[0]),this.normalize||!o)this._forEachGeometry((d,f)=>{const h=d&&this.normalizeGeometry(d);c[f]=h,r[f+1]=r[f]+(h?this.getGeometrySize(h):0)},a,l),i=r[r.length-1];else if(r=s.startIndices,i=r[s.length]||0,ArrayBuffer.isView(o))i=i||o.length/this.positionSize;else if(o instanceof Me){const d=o.accessor.stride||this.positionSize*4;i=i||o.byteLength/d}else if(o.buffer){const d=o.stride||this.positionSize*4;i=i||o.buffer.byteLength/d}else if(o.value){const d=o.value,f=o.stride/d.BYTES_PER_ELEMENT||this.positionSize;i=i||d.length/f}this._allocate(i,!!e),this.indexStarts=n,this.vertexStarts=r,this.instanceCount=i;const u={};this._forEachGeometry((d,f)=>{const h=c[f]||d;u.vertexStart=r[f],u.indexStart=n[f];const p=f<r.length-1?r[f+1]:i;u.geometrySize=p-r[f],u.geometryIndex=f,this.updateGeometryAttributes(h,u)},a,l),this.vertexCount=n[n.length-1]}}const K$=`#define SHADER_NAME icon-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;
attribute vec4 instanceIconFrames;
attribute float instanceColorModes;
attribute vec2 instanceOffsets;
attribute vec2 instancePixelOffset;

uniform float sizeScale;
uniform vec2 iconsTextureDim;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform bool billboard;
uniform int sizeUnits;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = angle * PI / 180.0;
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;

  vec2 iconSize = instanceIconFrames.zw;
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), 
    sizeMinPixels, sizeMaxPixels
  );
  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;
  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;
  pixelOffset += instancePixelOffset;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);

  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); 
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }

  vTextureCoords = mix(
    instanceIconFrames.xy,
    instanceIconFrames.xy + iconSize,
    (positions.xy + 1.0) / 2.0
  ) / iconsTextureDim;

  vColor = instanceColors;
  DECKGL_FILTER_COLOR(vColor, geometry);

  vColorMode = instanceColorModes;
}
`,q$=`#define SHADER_NAME icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float alphaCutoff;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  vec4 texColor = texture2D(iconsTexture, vTextureCoords);
  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);
  float a = texColor.a * opacity * vColor.a;

  if (a < alphaCutoff) {
    discard;
  }

  gl_FragColor = vec4(color, a);
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Z$=1024,Q$=4,eE=()=>{},tE={10241:9987,10240:9729,10242:33071,10243:33071};function J$(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function eG(t,e,n,r){const i=Math.min(n/e.width,r/e.height),s=Math.floor(e.width*i),o=Math.floor(e.height*i);return i===1?{data:e,width:s,height:o}:(t.canvas.height=o,t.canvas.width=s,t.clearRect(0,0,s,o),t.drawImage(e,0,0,e.width,e.height,0,0,s,o),{data:t.canvas,width:s,height:o})}function Ha(t){return t&&(t.id||t.url)}function tG(t,e,n,r){const i=t.width,s=t.height,o=new nn(t.gl,{width:e,height:n,parameters:r});return yz(t,o,{targetY:0,width:i,height:s}),t.delete(),o}function nE(t,e,n){for(let r=0;r<e.length;r++){const{icon:i,xOffset:s}=e[r],o=Ha(i);t[o]={...i,x:s,y:n}}}function nG({icons:t,buffer:e,mapping:n={},xOffset:r=0,yOffset:i=0,rowHeight:s=0,canvasWidth:o}){let a=[];for(let l=0;l<t.length;l++){const c=t[l],u=Ha(c);if(!n[u]){const{height:d,width:f}=c;r+f+e>o&&(nE(n,a,i),r=0,i=s+i+e,s=0,a=[]),a.push({icon:c,xOffset:r}),r=r+f+e,s=Math.max(s,d)}}return a.length>0&&nE(n,a,i),{mapping:n,rowHeight:s,xOffset:r,yOffset:i,canvasWidth:o,canvasHeight:J$(s+i+e)}}function rG(t,e,n){if(!t||!e)return null;n=n||{};const r={},{iterable:i,objectInfo:s}=ed(t);for(const o of i){s.index++;const a=e(o,s),l=Ha(a);if(!a)throw new Error("Icon is missing.");if(!a.url)throw new Error("Icon url is missing.");!r[l]&&(!n[l]||a.url!==n[l].url)&&(r[l]={...a,source:o,sourceIndex:s.index})}return r}class iG{constructor(e,{onUpdate:n=eE,onError:r=eE}){_(this,"gl",void 0),_(this,"onUpdate",void 0),_(this,"onError",void 0),_(this,"_loadOptions",null),_(this,"_texture",null),_(this,"_externalTexture",null),_(this,"_mapping",{}),_(this,"_textureParameters",null),_(this,"_pendingCount",0),_(this,"_autoPacking",!1),_(this,"_xOffset",0),_(this,"_yOffset",0),_(this,"_rowHeight",0),_(this,"_buffer",Q$),_(this,"_canvasWidth",Z$),_(this,"_canvasHeight",0),_(this,"_canvas",null),this.gl=e,this.onUpdate=n,this.onError=r}finalize(){var e;(e=this._texture)===null||e===void 0||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const n=this._autoPacking?Ha(e):e;return this._mapping[n]||{}}setProps({loadOptions:e,autoPacking:n,iconAtlas:r,iconMapping:i,textureParameters:s}){if(e&&(this._loadOptions=e),n!==void 0&&(this._autoPacking=n),i&&(this._mapping=i),r){var o;(o=this._texture)===null||o===void 0||o.delete(),this._texture=null,this._externalTexture=r}s&&(this._textureParameters=s)}get isLoaded(){return this._pendingCount===0}packIcons(e,n){if(!this._autoPacking||typeof document>"u")return;const r=Object.values(rG(e,n,this._mapping)||{});if(r.length>0){const{mapping:i,xOffset:s,yOffset:o,rowHeight:a,canvasHeight:l}=nG({icons:r,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=a,this._mapping=i,this._xOffset=s,this._yOffset=o,this._canvasHeight=l,this._texture||(this._texture=new nn(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||tE})),this._texture.height!==this._canvasHeight&&(this._texture=tG(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||tE)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(r)}}_loadIcons(e){const n=this._canvas.getContext("2d",{willReadFrequently:!0});for(const r of e)this._pendingCount++,Bu(r.url,this._loadOptions).then(i=>{const s=Ha(r),o=this._mapping[s],{x:a,y:l,width:c,height:u}=o,{data:d,width:f,height:h}=eG(n,i,c,u);this._texture.setSubImageData({data:d,x:a+(c-f)/2,y:l+(u-h)/2,width:f,height:h}),o.width=f,o.height=h,this._texture.generateMipmap(),this.onUpdate()}).catch(i=>{this.onError({url:r.url,source:r.source,sourceIndex:r.sourceIndex,loadOptions:this._loadOptions,error:i})}).finally(()=>{this._pendingCount--})}}const KA=[0,0,0,255],sG={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:KA},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0}};class Tl extends Xn{constructor(...e){super(...e),_(this,"state",void 0)}getShaders(){return super.getShaders({vs:K$,fs:q$,modules:[bo,xo]})}initializeState(){this.state={iconManager:new iG(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:KA},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e,s=this.getAttributeManager(),{iconAtlas:o,iconMapping:a,data:l,getIcon:c,textureParameters:u}=n,{iconManager:d}=this.state,f=o||this.internalState.isAsyncPropLoading("iconAtlas");if(d.setProps({loadOptions:n.loadOptions,autoPacking:!f,iconAtlas:o,iconMapping:f?a:null,textureParameters:u}),f?r.iconMapping!==n.iconMapping&&s.invalidate("getIcon"):(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&d.packIcons(l,c),i.extensionsChanged){var h;const{gl:p}=this.context;(h=this.state.model)===null||h===void 0||h.delete(),this.state.model=this._getModel(p),s.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,sizeUnits:s,billboard:o,alphaCutoff:a}=this.props,{iconManager:l}=this.state,c=l.getTexture();c&&this.state.model.setUniforms(e).setUniforms({iconsTexture:c,iconsTextureDim:[c.width,c.height],sizeUnits:gr[s],sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,billboard:o,alphaCutoff:a}).draw()}_getModel(e){const n=[-1,-1,-1,1,1,1,1,-1];return new si(e,{...this.getShaders(),id:this.props.id,geometry:new Eo({drawMode:6,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){var n;const r=(n=this.getCurrentLayer())===null||n===void 0?void 0:n.props.onIconError;r?r(e):ye.error(e.error.message)()}getInstanceOffset(e){const{width:n,height:r,anchorX:i=n/2,anchorY:s=r/2}=this.state.iconManager.getIconMapping(e);return[n/2-i,r/2-s]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:n,y:r,width:i,height:s}=this.state.iconManager.getIconMapping(e);return[n,r,i,s]}}_(Tl,"defaultProps",sG);_(Tl,"layerName","IconLayer");const oG=`#define SHADER_NAME scatterplot-layer-vertex-shader

attribute vec3 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceRadius;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform float opacity;
uniform float radiusScale;
uniform float radiusMinPixels;
uniform float radiusMaxPixels;
uniform float lineWidthScale;
uniform float lineWidthMinPixels;
uniform float lineWidthMaxPixels;
uniform float stroked;
uniform bool filled;
uniform bool antialiasing;
uniform bool billboard;
uniform int radiusUnits;
uniform int lineWidthUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;


void main(void) {
  geometry.worldPosition = instancePositions;
  outerRadiusPixels = clamp(
    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),
    radiusMinPixels, radiusMaxPixels
  );
  float lineWidthPixels = clamp(
    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),
    lineWidthMinPixels, lineWidthMaxPixels
  );
  outerRadiusPixels += stroked * lineWidthPixels / 2.0;
  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;
  unitPosition = edgePadding * positions.xy;
  geometry.uv = unitPosition;
  geometry.pickingColor = instancePickingColors;

  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;
  
  if (billboard) {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = edgePadding * positions * outerRadiusPixels;
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,aG=`#define SHADER_NAME scatterplot-layer-fragment-shader

precision highp float;

uniform bool filled;
uniform float stroked;
uniform bool antialiasing;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;

void main(void) {
  geometry.uv = unitPosition;

  float distToCenter = length(unitPosition) * outerRadiusPixels;
  float inCircle = antialiasing ? 
    smoothedge(distToCenter, outerRadiusPixels) : 
    step(distToCenter, outerRadiusPixels);

  if (inCircle == 0.0) {
    discard;
  }

  if (stroked > 0.5) {
    float isLine = antialiasing ? 
      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
      step(innerUnitRadius * outerRadiusPixels, distToCenter);

    if (filled) {
      gl_FragColor = mix(vFillColor, vLineColor, isLine);
    } else {
      if (isLine == 0.0) {
        discard;
      }
      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
    }
  } else if (!filled) {
    discard;
  } else {
    gl_FragColor = vFillColor;
  }

  gl_FragColor.a *= inCircle;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,rE=[0,0,0,255],lG={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:rE},getLineColor:{type:"accessor",value:rE},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class W0 extends Xn{getShaders(){return super.getShaders({vs:oG,fs:aG,modules:[bo,xo]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var n;const{gl:r}=this.context;(n=this.state.model)===null||n===void 0||n.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{radiusUnits:n,radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,stroked:o,filled:a,billboard:l,antialiasing:c,lineWidthUnits:u,lineWidthScale:d,lineWidthMinPixels:f,lineWidthMaxPixels:h}=this.props;this.state.model.setUniforms(e).setUniforms({stroked:o?1:0,filled:a,billboard:l,antialiasing:c,radiusUnits:gr[n],radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,lineWidthUnits:gr[u],lineWidthScale:d,lineWidthMinPixels:f,lineWidthMaxPixels:h}).draw()}_getModel(e){const n=[-1,-1,0,1,-1,0,1,1,0,-1,1,0];return new si(e,{...this.getShaders(),id:this.props.id,geometry:new Eo({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array(n)}}}),isInstanced:!0})}}_(W0,"defaultProps",lG);_(W0,"layerName","ScatterplotLayer");const H0={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function Y0(t,e,n={}){return cG(t,n)!==e?(fG(t,n),!0):!1}function cG(t,e={}){return Math.sign(uG(t,e))}function uG(t,e={}){const{start:n=0,end:r=t.length}=e,i=e.size||2;let s=0;for(let o=n,a=r-i;o<r;o+=i)s+=(t[o]-t[a])*(t[o+1]+t[a+1]),a=o;return s/2}function fG(t,e){const{start:n=0,end:r=t.length,size:i=2}=e,s=(r-n)/i,o=Math.floor(s/2);for(let a=0;a<o;++a){const l=n+a*i,c=n+(s-1-a)*i;for(let u=0;u<i;++u){const d=t[l+u];t[l+u]=t[c+u],t[c+u]=d}}}function Tn(t,e){const n=e.length,r=t.length;if(r>0){let i=!0;for(let s=0;s<n;s++)if(t[r-n+s]!==e[s]){i=!1;break}if(i)return!1}for(let i=0;i<n;i++)t[r+i]=e[i];return!0}function kg(t,e){const n=e.length;for(let r=0;r<n;r++)t[r]=e[r]}function Ya(t,e,n,r,i=[]){const s=r+e*n;for(let o=0;o<n;o++)i[o]=t[s+o];return i}function Ig(t,e,n,r,i=[]){let s,o;if(n&8)s=(r[3]-t[1])/(e[1]-t[1]),o=3;else if(n&4)s=(r[1]-t[1])/(e[1]-t[1]),o=1;else if(n&2)s=(r[2]-t[0])/(e[0]-t[0]),o=2;else if(n&1)s=(r[0]-t[0])/(e[0]-t[0]),o=0;else return null;for(let a=0;a<t.length;a++)i[a]=(o&1)===a?r[o]:s*(e[a]-t[a])+t[a];return i}function tu(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function qA(t,e){const{size:n=2,broken:r=!1,gridResolution:i=10,gridOffset:s=[0,0],startIndex:o=0,endIndex:a=t.length}=e||{},l=(a-o)/n;let c=[];const u=[c],d=Ya(t,0,n,o);let f,h;const p=QA(d,i,s,[]),m=[];Tn(c,d);for(let E=1;E<l;E++){for(f=Ya(t,E,n,o,f),h=tu(f,p);h;){Ig(d,f,h,p,m);const v=tu(m,p);v&&(Ig(d,m,v,p,m),h=v),Tn(c,m),kg(d,m),hG(p,i,h),r&&c.length>n&&(c=[],u.push(c),Tn(c,d)),h=tu(f,p)}Tn(c,f),kg(d,f)}return r?u:u[0]}const iE=0,dG=1;function wc(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function ZA(t,e=null,n){if(!t.length)return[];const{size:r=2,gridResolution:i=10,gridOffset:s=[0,0],edgeTypes:o=!1}=n||{},a=[],l=[{pos:t,types:o?new Array(t.length/r).fill(dG):null,holes:e||[]}],c=[[],[]];let u=[];for(;l.length;){const{pos:d,types:f,holes:h}=l.shift();pG(d,r,h[0]||d.length,c),u=QA(c[0],i,s,u);const p=tu(c[1],u);if(p){let m=sE(d,f,r,0,h[0]||d.length,u,p);const E={pos:m[0].pos,types:m[0].types,holes:[]},v={pos:m[1].pos,types:m[1].types,holes:[]};l.push(E,v);for(let g=0;g<h.length;g++)m=sE(d,f,r,h[g],h[g+1]||d.length,u,p),m[0]&&(E.holes.push(E.pos.length),E.pos=wc(E.pos,m[0].pos),o&&(E.types=wc(E.types,m[0].types))),m[1]&&(v.holes.push(v.pos.length),v.pos=wc(v.pos,m[1].pos),o&&(v.types=wc(v.types,m[1].types)))}else{const m={positions:d};o&&(m.edgeTypes=f),h.length&&(m.holeIndices=h),a.push(m)}}return a}function sE(t,e,n,r,i,s,o){const a=(i-r)/n,l=[],c=[],u=[],d=[],f=[];let h,p,m;const E=Ya(t,a-1,n,r);let v=Math.sign(o&8?E[1]-s[3]:E[0]-s[2]),g=e&&e[a-1],y=0,b=0;for(let T=0;T<a;T++)h=Ya(t,T,n,r,h),p=Math.sign(o&8?h[1]-s[3]:h[0]-s[2]),m=e&&e[r/n+T],p&&v&&v!==p&&(Ig(E,h,o,s,f),Tn(l,f)&&u.push(g),Tn(c,f)&&d.push(g)),p<=0?(Tn(l,h)&&u.push(m),y-=p):u.length&&(u[u.length-1]=iE),p>=0?(Tn(c,h)&&d.push(m),b+=p):d.length&&(d[d.length-1]=iE),kg(E,h),v=p,g=m;return[y?{pos:l,types:e&&u}:null,b?{pos:c,types:e&&d}:null]}function QA(t,e,n,r){const i=Math.floor((t[0]-n[0])/e)*e+n[0],s=Math.floor((t[1]-n[1])/e)*e+n[1];return r[0]=i,r[1]=s,r[2]=i+e,r[3]=s+e,r}function hG(t,e,n){n&8?(t[1]+=e,t[3]+=e):n&4?(t[1]-=e,t[3]-=e):n&2?(t[0]+=e,t[2]+=e):n&1&&(t[0]-=e,t[2]-=e)}function pG(t,e,n,r){let i=1/0,s=-1/0,o=1/0,a=-1/0;for(let l=0;l<n;l+=e){const c=t[l],u=t[l+1];i=c<i?c:i,s=c>s?c:s,o=u<o?u:o,a=u>a?u:a}return r[0][0]=i,r[0][1]=o,r[1][0]=s,r[1][1]=a,r}const gG=85.051129;function mG(t,e){const{size:n=2,startIndex:r=0,endIndex:i=t.length,normalize:s=!0}=e||{},o=t.slice(r,i);JA(o,n,0,i-r);const a=qA(o,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(s)for(const l of a)eC(l,n);return a}function vG(t,e=null,n){const{size:r=2,normalize:i=!0,edgeTypes:s=!1}=n||{};e=e||[];const o=[],a=[];let l=0,c=0;for(let d=0;d<=e.length;d++){const f=e[d]||t.length,h=c,p=yG(t,r,l,f);for(let m=p;m<f;m++)o[c++]=t[m];for(let m=l;m<p;m++)o[c++]=t[m];JA(o,r,h,c),_G(o,r,h,c,n==null?void 0:n.maxLatitude),l=f,a[d]=c}a.pop();const u=ZA(o,a,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:s});if(i)for(const d of u)eC(d.positions,r);return u}function yG(t,e,n,r){let i=-1,s=-1;for(let o=n+1;o<r;o+=e){const a=Math.abs(t[o]);a>i&&(i=a,s=o-1)}return s}function _G(t,e,n,r,i=gG){const s=t[n],o=t[r-e];if(Math.abs(s-o)>180){const a=Ya(t,0,e,n);a[0]+=Math.round((o-s)/360)*360,Tn(t,a),a[1]=Math.sign(a[1])*i,Tn(t,a),a[0]=s,Tn(t,a)}}function JA(t,e,n,r){let i=t[0],s;for(let o=n;o<r;o+=e){s=t[o];const a=s-i;(a>180||a<-180)&&(s-=Math.round(a/360)*360),t[o]=i=s}}function eC(t,e){let n;const r=t.length/e;for(let s=0;s<r&&(n=t[s*e],(n+180)%360===0);s++);const i=-Math.round(n/360)*360;if(i!==0)for(let s=0;s<r;s++)t[s*e]+=i}class EG extends Eo{constructor(e){const{id:n=vr("column-geometry")}=e,{indices:r,attributes:i}=wG(e);super({...e,id:n,indices:r,attributes:i})}}function wG(t){const{radius:e,height:n=1,nradial:r=10}=t;let{vertices:i}=t;i&&(ye.assert(i.length>=r),i=i.flatMap(h=>[h[0],h[1]]),Y0(i,H0.COUNTER_CLOCKWISE));const s=n>0,o=r+1,a=s?o*3+1:r,l=Math.PI*2/r,c=new Uint16Array(s?r*3*2:0),u=new Float32Array(a*3),d=new Float32Array(a*3);let f=0;if(s){for(let h=0;h<o;h++){const p=h*l,m=h%r,E=Math.sin(p),v=Math.cos(p);for(let g=0;g<2;g++)u[f+0]=i?i[m*2]:v*e,u[f+1]=i?i[m*2+1]:E*e,u[f+2]=(1/2-g)*n,d[f+0]=i?i[m*2]:v,d[f+1]=i?i[m*2+1]:E,f+=3}u[f+0]=u[f-3],u[f+1]=u[f-2],u[f+2]=u[f-1],f+=3}for(let h=s?0:1;h<o;h++){const p=Math.floor(h/2)*Math.sign(.5-h%2),m=p*l,E=(p+r)%r,v=Math.sin(m),g=Math.cos(m);u[f+0]=i?i[E*2]:g*e,u[f+1]=i?i[E*2+1]:v*e,u[f+2]=n/2,d[f+2]=1,f+=3}if(s){let h=0;for(let p=0;p<r;p++)c[h++]=p*2+0,c[h++]=p*2+2,c[h++]=p*2+0,c[h++]=p*2+1,c[h++]=p*2+1,c[h++]=p*2+3}return{indices:c,attributes:{POSITION:{size:3,value:u},NORMAL:{size:3,value:d}}}}const bG=`#version 300 es

#define SHADER_NAME column-layer-vertex-shader

in vec3 positions;
in vec3 normals;

in vec3 instancePositions;
in float instanceElevations;
in vec3 instancePositions64Low;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in float instanceStrokeWidths;

in vec3 instancePickingColors;
uniform float opacity;
uniform float radius;
uniform float angle;
uniform vec2 offset;
uniform bool extruded;
uniform bool stroked;
uniform bool isStroke;
uniform float coverage;
uniform float elevationScale;
uniform float edgeDistance;
uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform int radiusUnits;
uniform int widthUnits;
out vec4 vColor;
#ifdef FLAT_SHADING
out vec4 position_commonspace;
#endif

void main(void) {
  geometry.worldPosition = instancePositions;

  vec4 color = isStroke ? instanceLineColors : instanceFillColors;
  mat2 rotationMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));
  float elevation = 0.0;
  float strokeOffsetRatio = 1.0;

  if (extruded) {
    elevation = instanceElevations * (positions.z + 1.0) / 2.0 * elevationScale;
  } else if (stroked) {
    float widthPixels = clamp(
      project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
      widthMinPixels, widthMaxPixels) / 2.0;
    float halfOffset = project_pixel_size(widthPixels) / project_size(edgeDistance * coverage * radius);
    if (isStroke) {
      strokeOffsetRatio -= sign(positions.z) * halfOffset;
    } else {
      strokeOffsetRatio -= halfOffset;
    }
  }
  float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);
  float dotRadius = radius * coverage * shouldRender;

  geometry.pickingColor = instancePickingColors;
  vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);
  vec3 centroidPosition64Low = instancePositions64Low;
  vec2 offset = (rotationMatrix * positions.xy * strokeOffsetRatio + offset) * dotRadius;
  if (radiusUnits == UNIT_METERS) {
    offset = project_size(offset);
  }
  vec3 pos = vec3(offset, 0.);
  DECKGL_FILTER_SIZE(pos, geometry);

  gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);
  geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  if (extruded && !isStroke) {
#ifdef FLAT_SHADING
    position_commonspace = geometry.position;
    vColor = vec4(color.rgb, color.a * opacity);
#else
    vec3 lightColor = lighting_getLightColor(color.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);
    vColor = vec4(lightColor, color.a * opacity);
#endif
  } else {
    vColor = vec4(color.rgb, color.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,xG=`#version 300 es
#define SHADER_NAME column-layer-fragment-shader

precision highp float;

uniform vec3 project_uCameraPosition;
uniform bool extruded;
uniform bool isStroke;

out vec4 fragColor;

in vec4 vColor;
#ifdef FLAT_SHADING
in vec4 position_commonspace;
#endif

void main(void) {
  fragColor = vColor;
#ifdef FLAT_SHADING
  if (extruded && !isStroke && !picking_uActive) {
    vec3 normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
    fragColor.rgb = lighting_getLightColor(vColor.rgb, project_uCameraPosition, position_commonspace.xyz, normal);
  }
#endif
  DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,qu=[0,0,0,255],SG={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},radiusUnits:"meters",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,getPosition:{type:"accessor",value:t=>t.position},getFillColor:{type:"accessor",value:qu},getLineColor:{type:"accessor",value:qu},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class X0 extends Xn{getShaders(){const{gl:e}=this.context,n=!we(e),r={},i=this.props.flatShading&&GT(e,Fe.GLSL_DERIVATIVES);return i&&(r.FLAT_SHADING=1),super.getShaders({vs:bG,fs:xG,defines:r,transpileToGLSL100:n,modules:[bo,i?UV:gA,xo]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getFillColor",defaultValue:qu},instanceLineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getLineColor",defaultValue:qu},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}updateState(e){super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e,s=i.extensionsChanged||n.flatShading!==r.flatShading;if(s){var o;const{gl:a}=this.context;(o=this.state.model)===null||o===void 0||o.delete(),this.state.model=this._getModel(a),this.getAttributeManager().invalidateAll()}(s||n.diskResolution!==r.diskResolution||n.vertices!==r.vertices||(n.extruded||n.stroked)!==(r.extruded||r.stroked))&&this._updateGeometry(n)}getGeometry(e,n,r){const i=new EG({radius:1,height:r?2:0,vertices:n,nradial:e});let s=0;if(n)for(let o=0;o<e;o++){const a=n[o],l=Math.sqrt(a[0]*a[0]+a[1]*a[1]);s+=l/e}else s=1;return this.setState({edgeDistance:Math.cos(Math.PI/e)*s}),i}_getModel(e){return new si(e,{...this.getShaders(),id:this.props.id,isInstanced:!0})}_updateGeometry({diskResolution:e,vertices:n,extruded:r,stroked:i}){const s=this.getGeometry(e,n,r||i);this.setState({fillVertexCount:s.attributes.POSITION.value.length/3,wireframeVertexCount:s.indices.value.length}),this.state.model.setProps({geometry:s})}draw({uniforms:e}){const{lineWidthUnits:n,lineWidthScale:r,lineWidthMinPixels:i,lineWidthMaxPixels:s,radiusUnits:o,elevationScale:a,extruded:l,filled:c,stroked:u,wireframe:d,offset:f,coverage:h,radius:p,angle:m}=this.props,{model:E,fillVertexCount:v,wireframeVertexCount:g,edgeDistance:y}=this.state;E.setUniforms(e).setUniforms({radius:p,angle:m/180*Math.PI,offset:f,extruded:l,stroked:u,coverage:h,elevationScale:a,edgeDistance:y,radiusUnits:gr[o],widthUnits:gr[n],widthScale:r,widthMinPixels:i,widthMaxPixels:s}),l&&d&&(E.setProps({isIndexed:!0}),E.setVertexCount(g).setDrawMode(1).setUniforms({isStroke:!0}).draw()),c&&(E.setProps({isIndexed:!1}),E.setVertexCount(v).setDrawMode(5).setUniforms({isStroke:!1}).draw()),!l&&u&&(E.setProps({isIndexed:!1}),E.setVertexCount(v*2/3).setDrawMode(5).setUniforms({isStroke:!0}).draw())}}_(X0,"layerName","ColumnLayer");_(X0,"defaultProps",SG);function TG(t,e,n,r){let i;if(Array.isArray(t[0])){const s=t.length*e;i=new Array(s);for(let o=0;o<t.length;o++)for(let a=0;a<e;a++)i[o*e+a]=t[o][a]||0}else i=t;return n?qA(i,{size:e,gridResolution:n}):r?mG(i,{size:e}):i}const AG=1,CG=2,Oh=4;class PG extends XA{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?TG(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(oE(e)){let r=0;for(const i of e)r+=this.getGeometrySize(i);return r}const n=this.getPathLength(e);return n<2?0:this.isClosed(e)?n<3?0:n+2:n}updateGeometryAttributes(e,n){if(n.geometrySize!==0)if(e&&oE(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i}else this._updateSegmentTypes(e,n),this._updatePositions(e,n)}_updateSegmentTypes(e,n){const r=this.attributes.segmentTypes,i=e?this.isClosed(e):!1,{vertexStart:s,geometrySize:o}=n;r.fill(0,s,s+o),i?(r[s]=Oh,r[s+o-2]=Oh):(r[s]+=AG,r[s+o-2]+=CG),r[s+o-1]=Oh}_updatePositions(e,n){const{positions:r}=this.attributes;if(!r||!e)return;const{vertexStart:i,geometrySize:s}=n,o=new Array(3);for(let a=i,l=0;l<s;a++,l++)this.getPointOnPath(e,l,o),r[a*3]=o[0],r[a*3+1]=o[1],r[a*3+2]=o[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,n,r=[]){const{positionSize:i}=this;n*i>=e.length&&(n+=1-e.length/i);const s=n*i;return r[0]=e[s],r[1]=e[s+1],r[2]=i===3&&e[s+2]||0,r}isClosed(e){if(!this.normalize)return!!this.opts.loop;const{positionSize:n}=this,r=e.length-n;return e[0]===e[r]&&e[1]===e[r+1]&&(n===2||e[2]===e[r+2])}}function oE(t){return Array.isArray(t[0])}const RG=`#define SHADER_NAME path-layer-vertex-shader

attribute vec2 positions;

attribute float instanceTypes;
attribute vec3 instanceStartPositions;
attribute vec3 instanceEndPositions;
attribute vec3 instanceLeftPositions;
attribute vec3 instanceRightPositions;
attribute vec3 instanceLeftPositions64Low;
attribute vec3 instanceStartPositions64Low;
attribute vec3 instanceEndPositions64Low;
attribute vec3 instanceRightPositions64Low;
attribute float instanceStrokeWidths;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;

uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float jointType;
uniform float capType;
uniform float miterLimit;
uniform bool billboard;
uniform int widthUnits;

uniform float opacity;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);

float flipIfTrue(bool flag) {
  return -(float(flag) * 2. - 1.);
}
vec3 getLineJoinOffset(
  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
  vec2 width
) {
  bool isEnd = positions.x > 0.0;
  float sideOfPath = positions.y;
  float isJoint = float(sideOfPath == 0.0);

  vec3 deltaA3 = (currPoint - prevPoint);
  vec3 deltaB3 = (nextPoint - currPoint);

  mat3 rotationMatrix;
  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);
  if (needsRotation) {
    deltaA3 = deltaA3 * rotationMatrix;
    deltaB3 = deltaB3 * rotationMatrix;
  }
  vec2 deltaA = deltaA3.xy / width;
  vec2 deltaB = deltaB3.xy / width;

  float lenA = length(deltaA);
  float lenB = length(deltaB);

  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);

  vec2 perpA = vec2(-dirA.y, dirA.x);
  vec2 perpB = vec2(-dirB.y, dirB.x);
  vec2 tangent = dirA + dirB;
  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
  vec2 miterVec = vec2(-tangent.y, tangent.x);
  vec2 dir = isEnd ? dirA : dirB;
  vec2 perp = isEnd ? perpA : perpB;
  float L = isEnd ? lenA : lenB;
  float sinHalfA = abs(dot(miterVec, perp));
  float cosHalfA = abs(dot(dirA, miterVec));
  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);
  float cornerPosition = sideOfPath * turnDirection;

  float miterSize = 1.0 / max(sinHalfA, EPSILON);
  miterSize = mix(
    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
    miterSize,
    step(0.0, cornerPosition)
  );

  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
    * (sideOfPath + isJoint * turnDirection);
  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
  bool isCap = isStartCap || isEndCap;
  if (isCap) {
    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);
    vJointType = capType;
  } else {
    vJointType = jointType;
  }
  vPathLength = L;
  vCornerOffset = offsetVec;
  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
  vMiterLength = isCap ? isJoint : vMiterLength;

  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
  vPathPosition = vec2(
    dot(offsetFromStartOfPath, perp),
    dot(offsetFromStartOfPath, dir)
  );
  geometry.uv = vPathPosition;

  float isValid = step(instanceTypes, 3.5);
  vec3 offset = vec3(offsetVec * width * isValid, 0.0);

  if (needsRotation) {
    offset = rotationMatrix * offset;
  }
  return offset;
}
void clipLine(inout vec4 position, vec4 refPosition) {
  if (position.w < EPSILON) {
    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
    position = refPosition + (position - refPosition) * r;
  }
}

void main() {
  geometry.pickingColor = instancePickingColors;

  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);

  float isEnd = positions.x;

  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);

  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);

  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);

  geometry.worldPosition = currPosition;
  vec2 widthPixels = vec2(clamp(
    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
    widthMinPixels, widthMaxPixels) / 2.0);
  vec3 width;

  if (billboard) {
    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);

    clipLine(prevPositionScreen, currPositionScreen);
    clipLine(nextPositionScreen, currPositionScreen);
    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));

    width = vec3(widthPixels, 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(
      prevPositionScreen.xyz / prevPositionScreen.w,
      currPositionScreen.xyz / currPositionScreen.w,
      nextPositionScreen.xyz / nextPositionScreen.w,
      project_pixel_size_to_clipspace(width.xy)
    );

    DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);
    gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);
  } else {
    prevPosition = project_position(prevPosition, prevPosition64Low);
    currPosition = project_position(currPosition, currPosition64Low);
    nextPosition = project_position(nextPosition, nextPosition64Low);

    width = vec3(project_pixel_size(widthPixels), 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);
    geometry.position = vec4(currPosition + offset, 1.0);
    gl_Position = project_common_position_to_clipspace(geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,LG=`#define SHADER_NAME path-layer-fragment-shader

precision highp float;

uniform float miterLimit;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

void main(void) {
  geometry.uv = vPathPosition;

  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
      discard;
    }
    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {
      discard;
    }
  }
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,tC=[0,0,0,255],MG={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:tC},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},Nh={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class K0 extends Xn{constructor(...e){super(...e),_(this,"state",void 0)}getShaders(){return super.getShaders({vs:RG,fs:LG,modules:[bo,xo]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:Nh,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:Nh,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:Nh,defaultValue:tC},instancePickingColors:{size:3,type:5121,accessor:(r,{index:i,target:s})=>this.encodePickingColor(r&&r.__source?r.__source.index:i,s)}}),this.setState({pathTesselator:new PG({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:n,changeFlags:r}=e,i=this.getAttributeManager();if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPath)){const{pathTesselator:a}=this.state,l=n.data.attributes||{};a.updateGeometry({data:n.data,geometryBuffer:l.getPath,buffers:l,normalize:!n._pathType,loop:n._pathType==="loop",getGeometry:n.getPath,positionFormat:n.positionFormat,wrapLongitude:n.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:r.dataChanged}),this.setState({numInstances:a.instanceCount,startIndices:a.vertexStarts}),r.dataChanged||i.invalidateAll()}if(r.extensionsChanged){var o;const{gl:a}=this.context;(o=this.state.model)===null||o===void 0||o.delete(),this.state.model=this._getModel(a),i.invalidateAll()}}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(s=>s.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:n,capRounded:r,billboard:i,miterLimit:s,widthUnits:o,widthScale:a,widthMinPixels:l,widthMaxPixels:c}=this.props;this.state.model.setUniforms(e).setUniforms({jointType:Number(n),capType:Number(r),billboard:i,widthUnits:gr[o],widthScale:a,miterLimit:s,widthMinPixels:l,widthMaxPixels:c}).draw()}_getModel(e){const n=[0,1,2,1,4,2,1,3,4,3,5,4],r=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new si(e,{...this.getShaders(),id:this.props.id,geometry:new Eo({drawMode:4,attributes:{indices:new Uint16Array(n),positions:{value:new Float32Array(r),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateSegmentTypes(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("segmentTypes")}}_(K0,"defaultProps",MG);_(K0,"layerName","PathLayer");var q0={exports:{}};q0.exports=td;q0.exports.default=td;function td(t,e,n){n=n||2;var r=e&&e.length,i=r?e[0]*n:t.length,s=nC(t,0,i,n,!0),o=[];if(!s||s.next===s.prev)return o;var a,l,c,u,d,f,h;if(r&&(s=DG(t,e,s,n)),t.length>80*n){a=c=t[0],l=u=t[1];for(var p=n;p<i;p+=n)d=t[p],f=t[p+1],d<a&&(a=d),f<l&&(l=f),d>c&&(c=d),f>u&&(u=f);h=Math.max(c-a,u-l),h=h!==0?32767/h:0}return Xa(s,o,n,a,l,h,0),o}function nC(t,e,n,r,i){var s,o;if(i===Dg(t,e,n,r)>0)for(s=e;s<n;s+=r)o=aE(s,t[s],t[s+1],o);else for(s=n-r;s>=e;s-=r)o=aE(s,t[s],t[s+1],o);return o&&nd(o,o.next)&&(qa(o),o=o.next),o}function Gi(t,e){if(!t)return t;e||(e=t);var n=t,r;do if(r=!1,!n.steiner&&(nd(n,n.next)||Ye(n.prev,n,n.next)===0)){if(qa(n),n=e=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==e);return e}function Xa(t,e,n,r,i,s,o){if(t){!o&&s&&jG(t,r,i,s);for(var a=t,l,c;t.prev!==t.next;){if(l=t.prev,c=t.next,s?IG(t,r,i,s):kG(t)){e.push(l.i/n|0),e.push(t.i/n|0),e.push(c.i/n|0),qa(t),t=c.next,a=c.next;continue}if(t=c,t===a){o?o===1?(t=OG(Gi(t),e,n),Xa(t,e,n,r,i,s,2)):o===2&&NG(t,e,n,r,i,s):Xa(Gi(t),e,n,r,i,s,1);break}}}}function kG(t){var e=t.prev,n=t,r=t.next;if(Ye(e,n,r)>=0)return!1;for(var i=e.x,s=n.x,o=r.x,a=e.y,l=n.y,c=r.y,u=i<s?i<o?i:o:s<o?s:o,d=a<l?a<c?a:c:l<c?l:c,f=i>s?i>o?i:o:s>o?s:o,h=a>l?a>c?a:c:l>c?l:c,p=r.next;p!==e;){if(p.x>=u&&p.x<=f&&p.y>=d&&p.y<=h&&Rs(i,a,s,l,o,c,p.x,p.y)&&Ye(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function IG(t,e,n,r){var i=t.prev,s=t,o=t.next;if(Ye(i,s,o)>=0)return!1;for(var a=i.x,l=s.x,c=o.x,u=i.y,d=s.y,f=o.y,h=a<l?a<c?a:c:l<c?l:c,p=u<d?u<f?u:f:d<f?d:f,m=a>l?a>c?a:c:l>c?l:c,E=u>d?u>f?u:f:d>f?d:f,v=Og(h,p,e,n,r),g=Og(m,E,e,n,r),y=t.prevZ,b=t.nextZ;y&&y.z>=v&&b&&b.z<=g;){if(y.x>=h&&y.x<=m&&y.y>=p&&y.y<=E&&y!==i&&y!==o&&Rs(a,u,l,d,c,f,y.x,y.y)&&Ye(y.prev,y,y.next)>=0||(y=y.prevZ,b.x>=h&&b.x<=m&&b.y>=p&&b.y<=E&&b!==i&&b!==o&&Rs(a,u,l,d,c,f,b.x,b.y)&&Ye(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;y&&y.z>=v;){if(y.x>=h&&y.x<=m&&y.y>=p&&y.y<=E&&y!==i&&y!==o&&Rs(a,u,l,d,c,f,y.x,y.y)&&Ye(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;b&&b.z<=g;){if(b.x>=h&&b.x<=m&&b.y>=p&&b.y<=E&&b!==i&&b!==o&&Rs(a,u,l,d,c,f,b.x,b.y)&&Ye(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function OG(t,e,n){var r=t;do{var i=r.prev,s=r.next.next;!nd(i,s)&&rC(i,r,r.next,s)&&Ka(i,s)&&Ka(s,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(s.i/n|0),qa(r),qa(r.next),r=t=s),r=r.next}while(r!==t);return Gi(r)}function NG(t,e,n,r,i,s){var o=t;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&GG(o,a)){var l=iC(o,a);o=Gi(o,o.next),l=Gi(l,l.next),Xa(o,e,n,r,i,s,0),Xa(l,e,n,r,i,s,0);return}a=a.next}o=o.next}while(o!==t)}function DG(t,e,n,r){var i=[],s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*r,l=s<o-1?e[s+1]*r:t.length,c=nC(t,a,l,r,!1),c===c.next&&(c.steiner=!0),i.push($G(c));for(i.sort(FG),s=0;s<i.length;s++)n=UG(i[s],n);return n}function FG(t,e){return t.x-e.x}function UG(t,e){var n=BG(t,e);if(!n)return e;var r=iC(n,t);return Gi(r,r.next),Gi(n,n.next)}function BG(t,e){var n=e,r=t.x,i=t.y,s=-1/0,o;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var a=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=r&&a>s&&(s=a,o=n.x<n.next.x?n:n.next,a===r))return o}n=n.next}while(n!==e);if(!o)return null;var l=o,c=o.x,u=o.y,d=1/0,f;n=o;do r>=n.x&&n.x>=c&&r!==n.x&&Rs(i<u?r:s,i,c,u,i<u?s:r,i,n.x,n.y)&&(f=Math.abs(i-n.y)/(r-n.x),Ka(n,t)&&(f<d||f===d&&(n.x>o.x||n.x===o.x&&zG(o,n)))&&(o=n,d=f)),n=n.next;while(n!==l);return o}function zG(t,e){return Ye(t.prev,t,e.prev)<0&&Ye(e.next,t,t.next)<0}function jG(t,e,n,r){var i=t;do i.z===0&&(i.z=Og(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,VG(i)}function VG(t){var e,n,r,i,s,o,a,l,c=1;do{for(n=t,t=null,s=null,o=0;n;){for(o++,r=n,a=0,e=0;e<c&&(a++,r=r.nextZ,!!r);e++);for(l=c;a>0||l>0&&r;)a!==0&&(l===0||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,l--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;n=r}s.nextZ=null,c*=2}while(o>1);return t}function Og(t,e,n,r,i){return t=(t-n)*i|0,e=(e-r)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function $G(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function Rs(t,e,n,r,i,s,o,a){return(i-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(r-a)>=(n-o)*(e-a)&&(n-o)*(s-a)>=(i-o)*(r-a)}function GG(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!WG(t,e)&&(Ka(t,e)&&Ka(e,t)&&HG(t,e)&&(Ye(t.prev,t,e.prev)||Ye(t,e.prev,e))||nd(t,e)&&Ye(t.prev,t,t.next)>0&&Ye(e.prev,e,e.next)>0)}function Ye(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function nd(t,e){return t.x===e.x&&t.y===e.y}function rC(t,e,n,r){var i=xc(Ye(t,e,n)),s=xc(Ye(t,e,r)),o=xc(Ye(n,r,t)),a=xc(Ye(n,r,e));return!!(i!==s&&o!==a||i===0&&bc(t,n,e)||s===0&&bc(t,r,e)||o===0&&bc(n,t,r)||a===0&&bc(n,e,r))}function bc(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function xc(t){return t>0?1:t<0?-1:0}function WG(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&rC(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function Ka(t,e){return Ye(t.prev,t,t.next)<0?Ye(t,e,t.next)>=0&&Ye(t,t.prev,e)>=0:Ye(t,e,t.prev)<0||Ye(t,t.next,e)<0}function HG(t,e){var n=t,r=!1,i=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==t);return r}function iC(t,e){var n=new Ng(t.i,t.x,t.y),r=new Ng(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function aE(t,e,n,r){var i=new Ng(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function qa(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Ng(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}td.deviation=function(t,e,n,r){var i=e&&e.length,s=i?e[0]*n:t.length,o=Math.abs(Dg(t,0,s,n));if(i)for(var a=0,l=e.length;a<l;a++){var c=e[a]*n,u=a<l-1?e[a+1]*n:t.length;o-=Math.abs(Dg(t,c,u,n))}var d=0;for(a=0;a<r.length;a+=3){var f=r[a]*n,h=r[a+1]*n,p=r[a+2]*n;d+=Math.abs((t[f]-t[p])*(t[h+1]-t[f+1])-(t[f]-t[h])*(t[p+1]-t[f+1]))}return o===0&&d===0?0:Math.abs((d-o)/o)};function Dg(t,e,n,r){for(var i=0,s=e,o=n-r;s<n;s+=r)i+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return i}td.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var s=0;s<t[i].length;s++)for(var o=0;o<e;o++)n.vertices.push(t[i][s][o]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n};var YG=q0.exports;const XG=po(YG),Sc=H0.CLOCKWISE,lE=H0.COUNTER_CLOCKWISE,Wr={isClosed:!0};function KG(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}function sa(t){return"positions"in t?t.positions:t}function nu(t){return"holeIndices"in t?t.holeIndices:null}function qG(t){return Array.isArray(t[0])}function ZG(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function QG(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function JG(t,e,n,r){for(let i=0;i<e;i++)if(t[n+i]!==t[r-e+i])return!1;return!0}function cE(t,e,n,r,i){let s=e;const o=n.length;for(let a=0;a<o;a++)for(let l=0;l<r;l++)t[s++]=n[a][l]||0;if(!QG(n))for(let a=0;a<r;a++)t[s++]=n[0][a]||0;return Wr.start=e,Wr.end=s,Wr.size=r,Y0(t,i,Wr),s}function uE(t,e,n,r,i=0,s,o){s=s||n.length;const a=s-i;if(a<=0)return e;let l=e;for(let c=0;c<a;c++)t[l++]=n[i+c];if(!JG(n,r,i,s))for(let c=0;c<r;c++)t[l++]=n[i+c];return Wr.start=e,Wr.end=l,Wr.size=r,Y0(t,o,Wr),l}function eW(t,e){KG(t);const n=[],r=[];if("positions"in t){const{positions:i,holeIndices:s}=t;if(s){let o=0;for(let a=0;a<=s.length;a++)o=uE(n,o,i,e,s[a-1],s[a],a===0?Sc:lE),r.push(o);return r.pop(),{positions:n,holeIndices:r}}t=i}if(!qG(t))return uE(n,0,t,e,0,n.length,Sc),n;if(!ZG(t)){let i=0;for(const[s,o]of t.entries())i=cE(n,i,o,e,s===0?Sc:lE),r.push(i);return r.pop(),{positions:n,holeIndices:r}}return cE(n,0,t,e,Sc),n}function Dh(t,e,n){const r=t.length/3;let i=0;for(let s=0;s<r;s++){const o=(s+1)%r;i+=t[s*3+e]*t[o*3+n],i-=t[o*3+e]*t[s*3+n]}return Math.abs(i/2)}function fE(t,e,n,r){const i=t.length/3;for(let s=0;s<i;s++){const o=s*3,a=t[o+0],l=t[o+1],c=t[o+2];t[o+e]=a,t[o+n]=l,t[o+r]=c}}function tW(t,e,n,r){let i=nu(t);i&&(i=i.map(a=>a/e));let s=sa(t);const o=r&&e===3;if(n){const a=s.length;s=s.slice();const l=[];for(let c=0;c<a;c+=e){l[0]=s[c],l[1]=s[c+1],o&&(l[2]=s[c+2]);const u=n(l);s[c]=u[0],s[c+1]=u[1],o&&(s[c+2]=u[2])}}if(o){const a=Dh(s,0,1),l=Dh(s,0,2),c=Dh(s,1,2);if(!a&&!l&&!c)return[];a>l&&a>c||(l>c?(n||(s=s.slice()),fE(s,0,2,1)):(n||(s=s.slice()),fE(s,2,0,1)))}return XG(s,i,e)}class nW extends XA{constructor(e){const{fp64:n,IndexType:r=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:n?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:r,size:1}}})}get(e){const{attributes:n}=this;return e==="indices"?n.indices&&n.indices.subarray(0,this.vertexCount):n[e]}updateGeometry(e){super.updateGeometry(e);const n=this.buffers.indices;if(n)this.vertexCount=(n.value||n).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const n=eW(e,this.positionSize);return this.opts.resolution?ZA(sa(n),nu(n),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?vG(sa(n),nu(n),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):n}return e}getGeometrySize(e){if(dE(e)){let n=0;for(const r of e)n+=this.getGeometrySize(r);return n}return sa(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,n){if(e&&dE(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i,n.indexStart=this.indexStarts[n.geometryIndex+1]}else this._updateIndices(e,n),this._updatePositions(e,n),this._updateVertexValid(e,n)}_updateIndices(e,{geometryIndex:n,vertexStart:r,indexStart:i}){const{attributes:s,indexStarts:o,typedArrayManager:a}=this;let l=s.indices;if(!l||!e)return;let c=i;const u=tW(e,this.positionSize,this.opts.preproject,this.opts.full3d);l=a.allocate(l,i+u.length,{copy:!0});for(let d=0;d<u.length;d++)l[c++]=u[d]+r;o[n+1]=i+u.length,s.indices=l}_updatePositions(e,{vertexStart:n,geometrySize:r}){const{attributes:{positions:i},positionSize:s}=this;if(!i||!e)return;const o=sa(e);for(let a=n,l=0;l<r;a++,l++){const c=o[l*s],u=o[l*s+1],d=s>2?o[l*s+2]:0;i[a*3]=c,i[a*3+1]=u,i[a*3+2]=d}}_updateVertexValid(e,{vertexStart:n,geometrySize:r}){const{positionSize:i}=this,s=this.attributes.vertexValid,o=e&&nu(e);if(e&&e.edgeTypes?s.set(e.edgeTypes,n):s.fill(1,n,n+r),o)for(let a=0;a<o.length;a++)s[n+o[a]/i-1]=0;s[n+r-1]=0}}function dE(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}const sC=`
attribute vec2 vertexPositions;
attribute float vertexValid;

uniform bool extruded;
uniform bool isWireframe;
uniform float elevationScale;
uniform float opacity;

varying vec4 vColor;

struct PolygonProps {
  vec4 fillColors;
  vec4 lineColors;
  vec3 positions;
  vec3 nextPositions;
  vec3 pickingColors;
  vec3 positions64Low;
  vec3 nextPositions64Low;
  float elevations;
};

vec3 project_offset_normal(vec3 vector) {
  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
    return normalize(vector * project_uCommonUnitsPerWorldUnit);
  }
  return project_normal(vector);
}

void calculatePosition(PolygonProps props) {
#ifdef IS_SIDE_VERTEX
  if(vertexValid < 0.5){
    gl_Position = vec4(0.);
    return;
  }
#endif

  vec3 pos;
  vec3 pos64Low;
  vec3 normal;
  vec4 colors = isWireframe ? props.lineColors : props.fillColors;

  geometry.worldPosition = props.positions;
  geometry.worldPositionAlt = props.nextPositions;
  geometry.pickingColor = props.pickingColors;

#ifdef IS_SIDE_VERTEX
  pos = mix(props.positions, props.nextPositions, vertexPositions.x);
  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);
#else
  pos = props.positions;
  pos64Low = props.positions64Low;
#endif

  if (extruded) {
    pos.z += props.elevations * vertexPositions.y * elevationScale;
  }
  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  if (extruded) {
  #ifdef IS_SIDE_VERTEX
    normal = vec3(
      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),
      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),
      0.0);
    normal = project_offset_normal(normal);
  #else
    normal = project_normal(vec3(0.0, 0.0, 1.0));
  #endif
    geometry.normal = normal;
    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);
    vColor = vec4(lightColor, colors.a * opacity);
  } else {
    vColor = vec4(colors.rgb, colors.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,rW=`#define SHADER_NAME solid-polygon-layer-vertex-shader

attribute vec3 positions;
attribute vec3 positions64Low;
attribute float elevations;
attribute vec4 fillColors;
attribute vec4 lineColors;
attribute vec3 pickingColors;

`.concat(sC,`

void main(void) {
  PolygonProps props;

  props.positions = positions;
  props.positions64Low = positions64Low;
  props.elevations = elevations;
  props.fillColors = fillColors;
  props.lineColors = lineColors;
  props.pickingColors = pickingColors;

  calculatePosition(props);
}
`),iW=`#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX


attribute vec3 instancePositions;
attribute vec3 nextPositions;
attribute vec3 instancePositions64Low;
attribute vec3 nextPositions64Low;
attribute float instanceElevations;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

`.concat(sC,`

void main(void) {
  PolygonProps props;

  #if RING_WINDING_ORDER_CW == 1
    props.positions = instancePositions;
    props.positions64Low = instancePositions64Low;
    props.nextPositions = nextPositions;
    props.nextPositions64Low = nextPositions64Low;
  #else
    props.positions = nextPositions;
    props.positions64Low = nextPositions64Low;
    props.nextPositions = instancePositions;
    props.nextPositions64Low = instancePositions64Low;
  #endif
  props.elevations = instanceElevations;
  props.fillColors = instanceFillColors;
  props.lineColors = instanceLineColors;
  props.pickingColors = instancePickingColors;

  calculatePosition(props);
}
`),sW=`#define SHADER_NAME solid-polygon-layer-fragment-shader

precision highp float;

varying vec4 vColor;

void main(void) {
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Zu=[0,0,0,255],oW={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:Zu},getLineColor:{type:"accessor",value:Zu},material:!0},Tc={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class Z0 extends Xn{constructor(...e){super(...e),_(this,"state",void 0)}getShaders(e){return super.getShaders({vs:e==="top"?rW:iW,fs:sW,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[bo,gA,xo]})}get wrapLongitude(){return!1}initializeState(){const{gl:e,viewport:n}=this.context;let{coordinateSystem:r}=this.props;const{_full3d:i}=this.props;n.isGeospatial&&r===Ce.DEFAULT&&(r=Ce.LNGLAT);let s;r===Ce.LNGLAT&&(i?s=n.projectPosition.bind(n):s=n.projectFlat.bind(n)),this.setState({numInstances:0,polygonTesselator:new nW({preproject:s,fp64:this.use64bitPositions(),IndexType:!e||P0(e,Fe.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const o=this.getAttributeManager(),a=!0;o.remove(["instancePickingColors"]),o.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:a},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:Tc,accessor:"getPolygon",update:this.calculatePositions,noAlloc:a,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:a},elevations:{size:1,transition:Tc,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:Tc,accessor:"getFillColor",defaultValue:Zu,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:Tc,accessor:"getLineColor",defaultValue:Zu,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(l,{index:c,target:u})=>this.encodePickingColor(l&&l.__source?l.__source.index:c,u),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(s=>s.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{extruded:n,filled:r,wireframe:i,elevationScale:s}=this.props,{topModel:o,sideModel:a,polygonTesselator:l}=this.state,c={...e,extruded:!!n,elevationScale:s};a&&(a.setInstanceCount(l.instanceCount-1),a.setUniforms(c),i&&(a.setDrawMode(3),a.setUniforms({isWireframe:!0}).draw()),r&&(a.setDrawMode(6),a.setUniforms({isWireframe:!1}).draw())),o&&(o.setVertexCount(l.vertexCount),o.setUniforms(c).draw())}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:n,oldProps:r,changeFlags:i}=e,s=this.getAttributeManager();if(i.extensionsChanged||n.filled!==r.filled||n.extruded!==r.extruded){var a;(a=this.state.models)===null||a===void 0||a.forEach(l=>l.delete()),this.setState(this._getModels(this.context.gl)),s.invalidateAll()}}updateGeometry({props:e,oldProps:n,changeFlags:r}){if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPolygon)){const{polygonTesselator:s}=this.state,o=e.data.attributes||{};s.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:o.getPolygon,buffers:o,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:r.dataChanged,full3d:e._full3d}),this.setState({numInstances:s.instanceCount,startIndices:s.vertexStarts}),r.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(e){const{id:n,filled:r,extruded:i}=this.props;let s,o;if(r){const a=this.getShaders("top");a.defines.NON_INSTANCED_MODEL=1,s=new si(e,{...a,id:"".concat(n,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return i&&(o=new si(e,{...this.getShaders("side"),id:"".concat(n,"-side"),geometry:new Eo({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),o.userData.excludeAttributes={indices:!0}),{models:[o,s].filter(Boolean),topModel:s,sideModel:o}}calculateIndices(e){const{polygonTesselator:n}=this.state;e.startIndices=n.indexStarts,e.value=n.get("indices")}calculatePositions(e){const{polygonTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}_(Z0,"defaultProps",oW);_(Z0,"layerName","SolidPolygonLayer");function aW({data:t,getIndex:e,dataRange:n,replace:r}){const{startRow:i=0,endRow:s=1/0}=n,o=t.length;let a=o,l=o;for(let f=0;f<o;f++){const h=e(t[f]);if(a>f&&h>=i&&(a=f),h>=s){l=f;break}}let c=a;const d=l-a!==r.length?t.slice(l):void 0;for(let f=0;f<r.length;f++)t[c++]=r[f];if(d){for(let f=0;f<d.length;f++)t[c++]=d[f];t.length=c}return{startRow:a,endRow:a+r.length}}function lW(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,r=t.featureIds.value[n];return n!==-1?cW(t,r,n):null}function cW(t,e,n){const r={properties:{...t.properties[e]}};for(const i in t.numericProps)r.properties[i]=t.numericProps[i].value[n];return r}function uW(t,e){const n={points:null,lines:null,polygons:null};for(const r in n){const i=t[r].globalFeatureIds.value;n[r]=new Uint8ClampedArray(i.length*3);const s=[];for(let o=0;o<i.length;o++)e(i[o],s),n[r][o*3+0]=s[0],n[r][o*3+1]=s[1],n[r][o*3+2]=s[2]}return n}const fW=`#define SHADER_NAME multi-icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float gamma;
uniform bool sdf;
uniform float alphaCutoff;
uniform float sdfBuffer;
uniform float outlineBuffer;
uniform vec4 outlineColor;

varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  if (!picking_uActive) {
    float alpha = texture2D(iconsTexture, vTextureCoords).a;
    vec4 color = vColor;
    if (sdf) {
      float distance = alpha;
      alpha = smoothstep(sdfBuffer - gamma, sdfBuffer + gamma, distance);

      if (outlineBuffer > 0.0) {
        float inFill = alpha;
        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);
        color = mix(outlineColor, vColor, inFill);
        alpha = inBorder;
      }
    }
    float a = alpha * color.a;
    
    if (a < alphaCutoff) {
      discard;
    }

    gl_FragColor = vec4(color.rgb, a * opacity);
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Fh=192/256,hE=[],dW={getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};class Q0 extends Tl{constructor(...e){super(...e),_(this,"state",void 0)}getShaders(){return{...super.getShaders(),fs:fW}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(n,{index:r,target:i})=>this.encodePickingColor(r,i)}})}updateState(e){super.updateState(e);const{props:n,oldProps:r}=e;let{outlineColor:i}=n;i!==r.outlineColor&&(i=i.map(s=>s/255),i[3]=Number.isFinite(i[3])?i[3]:1,this.setState({outlineColor:i})),!n.sdf&&n.outlineWidth&&ye.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(e){const{sdf:n,smoothing:r,outlineWidth:i}=this.props,{outlineColor:s}=this.state,o=i?Math.max(r,Fh*(1-i)):-1;if(e.uniforms={...e.uniforms,sdfBuffer:Fh,outlineBuffer:o,gamma:r,sdf:!!n,outlineColor:s},super.draw(e),n&&i){const{iconManager:a}=this.state;a.getTexture()&&this.state.model.draw({uniforms:{outlineBuffer:Fh}})}}getInstanceOffset(e){return e?Array.from(e).flatMap(n=>super.getInstanceOffset(n)):hE}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(n=>super.getInstanceIconFrame(n)):hE}}_(Q0,"defaultProps",dW);_(Q0,"layerName","MultiIconLayer");const xa=1e20;class hW{constructor({fontSize:e=24,buffer:n=3,radius:r=8,cutoff:i=.25,fontFamily:s="sans-serif",fontWeight:o="normal",fontStyle:a="normal"}={}){this.buffer=n,this.cutoff=i,this.radius=r;const l=this.size=e+n*4,c=this._createCanvas(l),u=this.ctx=c.getContext("2d",{willReadFrequently:!0});u.font=`${a} ${o} ${e}px ${s}`,u.textBaseline="alphabetic",u.textAlign="left",u.fillStyle="black",this.gridOuter=new Float64Array(l*l),this.gridInner=new Float64Array(l*l),this.f=new Float64Array(l),this.z=new Float64Array(l+1),this.v=new Uint16Array(l)}_createCanvas(e){const n=document.createElement("canvas");return n.width=n.height=e,n}draw(e){const{width:n,actualBoundingBoxAscent:r,actualBoundingBoxDescent:i,actualBoundingBoxLeft:s,actualBoundingBoxRight:o}=this.ctx.measureText(e),a=Math.ceil(r),l=0,c=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(o-s))),u=Math.min(this.size-this.buffer,a+Math.ceil(i)),d=c+2*this.buffer,f=u+2*this.buffer,h=Math.max(d*f,0),p=new Uint8ClampedArray(h),m={data:p,width:d,height:f,glyphWidth:c,glyphHeight:u,glyphTop:a,glyphLeft:l,glyphAdvance:n};if(c===0||u===0)return m;const{ctx:E,buffer:v,gridInner:g,gridOuter:y}=this;E.clearRect(v,v,c,u),E.fillText(e,v,v+a);const b=E.getImageData(v,v,c,u);y.fill(xa,0,h),g.fill(0,0,h);for(let T=0;T<u;T++)for(let A=0;A<c;A++){const R=b.data[4*(T*c+A)+3]/255;if(R===0)continue;const I=(T+v)*d+A+v;if(R===1)y[I]=0,g[I]=xa;else{const D=.5-R;y[I]=D>0?D*D:0,g[I]=D<0?D*D:0}}pE(y,0,0,d,f,d,this.f,this.v,this.z),pE(g,v,v,c,u,d,this.f,this.v,this.z);for(let T=0;T<h;T++){const A=Math.sqrt(y[T])-Math.sqrt(g[T]);p[T]=Math.round(255-255*(A/this.radius+this.cutoff))}return m}}function pE(t,e,n,r,i,s,o,a,l){for(let c=e;c<e+r;c++)gE(t,n*s+c,s,i,o,a,l);for(let c=n;c<n+i;c++)gE(t,c*s+e,1,r,o,a,l)}function gE(t,e,n,r,i,s,o){s[0]=0,o[0]=-xa,o[1]=xa,i[0]=t[e];for(let a=1,l=0,c=0;a<r;a++){i[a]=t[e+a*n];const u=a*a;do{const d=s[l];c=(i[a]-i[d]+u-d*d)/(a-d)/2}while(c<=o[l]&&--l>-1);l++,s[l]=a,o[l]=c,o[l+1]=xa}for(let a=0,l=0;a<r;a++){for(;o[l+1]<a;)l++;const c=s[l],u=a-c;t[e+a*n]=i[c]+u*u}}const pW=32,gW=[];function mW(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function vW({characterSet:t,getFontWidth:e,fontHeight:n,buffer:r,maxCanvasWidth:i,mapping:s={},xOffset:o=0,yOffset:a=0}){let l=0,c=o;const u=n+r*2;for(const d of t)if(!s[d]){const f=e(d);c+f+r*2>i&&(c=0,l++),s[d]={x:c+r,y:a+l*u+r,width:f,height:u,layoutWidth:f,layoutHeight:n},c+=f+r*2}return{mapping:s,xOffset:c,yOffset:a+l*u,canvasHeight:mW(a+(l+1)*u)}}function oC(t,e,n,r){let i=0;for(let o=e;o<n;o++){var s;const a=t[o];i+=((s=r[a])===null||s===void 0?void 0:s.layoutWidth)||0}return i}function aC(t,e,n,r,i,s){let o=e,a=0;for(let l=e;l<n;l++){const c=oC(t,l,l+1,i);a+c>r&&(o<l&&s.push(l),o=l,a=0),a+=c}return a}function yW(t,e,n,r,i,s){let o=e,a=e,l=e,c=0;for(let u=e;u<n;u++)if((t[u]===" "||t[u+1]===" "||u+1===n)&&(l=u+1),l>a){let d=oC(t,a,l,i);c+d>r&&(o<a&&(s.push(a),o=a,c=0),d>r&&(d=aC(t,a,l,r,i,s),o=s[s.length-1])),a=l,c+=d}return c}function _W(t,e,n,r,i=0,s){s===void 0&&(s=t.length);const o=[];return e==="break-all"?aC(t,i,s,n,r,o):yW(t,i,s,n,r,o),o}function EW(t,e,n,r,i,s){let o=0,a=0;for(let l=e;l<n;l++){const c=t[l],u=r[c];u?(a||(a=u.layoutHeight),i[l]=o+u.layoutWidth/2,o+=u.layoutWidth):(ye.warn("Missing character: ".concat(c," (").concat(c.codePointAt(0),")"))(),i[l]=o,o+=pW)}s[0]=o,s[1]=a}function wW(t,e,n,r,i){const s=Array.from(t),o=s.length,a=new Array(o),l=new Array(o),c=new Array(o),u=(n==="break-word"||n==="break-all")&&isFinite(r)&&r>0,d=[0,0],f=[0,0];let h=0,p=0,m=0;for(let v=0;v<=o;v++){const g=s[v];if((g===`
`||v===o)&&(m=v),m>p){const y=u?_W(s,n,r,i,p,m):gW;for(let b=0;b<=y.length;b++){const T=b===0?p:y[b-1],A=b<y.length?y[b]:m;EW(s,T,A,i,a,f);for(let R=T;R<A;R++){var E;const I=s[R],D=((E=i[I])===null||E===void 0?void 0:E.layoutOffsetY)||0;l[R]=h+f[1]/2+D,c[R]=f[0]}h=h+f[1]*e,d[0]=Math.max(d[0],f[0])}p=m}g===`
`&&(a[p]=0,l[p]=0,c[p]=0,p++)}return d[1]=h,{x:a,y:l,rowWidth:c,size:d}}function bW({value:t,length:e,stride:n,offset:r,startIndices:i,characterSet:s}){const o=t.BYTES_PER_ELEMENT,a=n?n/o:1,l=r?r/o:0,c=i[e]||Math.ceil((t.length-l)/a),u=s&&new Set,d=new Array(e);let f=t;if(a>1||l>0){const h=t.constructor;f=new h(c);for(let p=0;p<c;p++)f[p]=t[p*a+l]}for(let h=0;h<e;h++){const p=i[h],m=i[h+1]||c,E=f.subarray(p,m);d[h]=String.fromCodePoint.apply(null,E),u&&E.forEach(u.add,u)}if(u)for(const h of u)s.add(String.fromCodePoint(h));return{texts:d,characterCount:c}}class lC{constructor(e=5){_(this,"limit",void 0),_(this,"_cache",{}),_(this,"_order",[]),this.limit=e}get(e){const n=this._cache[e];return n&&(this._deleteOrder(e),this._appendOrder(e)),n}set(e,n){this._cache[e]?(this.delete(e),this._cache[e]=n,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=n,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const n=this._order.indexOf(e);n>=0&&this._order.splice(n,1)}_appendOrder(e){this._order.push(e)}}function xW(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}const zs={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:xW(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},mE=1024,vE=.9,yE=1.2,cC=3;let Qu=new lC(cC);function SW(t,e){let n;typeof e=="string"?n=new Set(Array.from(e)):n=new Set(e);const r=Qu.get(t);if(!r)return n;for(const i in r.mapping)n.has(i)&&n.delete(i);return n}function TW(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function _E(t,e,n,r){t.font="".concat(r," ").concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}function AW(t){ye.assert(Number.isFinite(t)&&t>=cC,"Invalid cache limit"),Qu=new lC(t)}class CW{constructor(){_(this,"props",{...zs}),_(this,"_key",void 0),_(this,"_atlas",void 0)}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:e,buffer:n}=this.props;return(e*yE+n*2)/e}setProps(e={}){Object.assign(this.props,e),this._key=this._getKey();const n=SW(this._key,this.props.characterSet),r=Qu.get(this._key);if(r&&n.size===0){this._atlas!==r&&(this._atlas=r);return}const i=this._generateFontAtlas(n,r);this._atlas=i,Qu.set(this._key,i)}_generateFontAtlas(e,n){const{fontFamily:r,fontWeight:i,fontSize:s,buffer:o,sdf:a,radius:l,cutoff:c}=this.props;let u=n&&n.data;u||(u=document.createElement("canvas"),u.width=mE);const d=u.getContext("2d",{willReadFrequently:!0});_E(d,r,s,i);const{mapping:f,canvasHeight:h,xOffset:p,yOffset:m}=vW({getFontWidth:E=>d.measureText(E).width,fontHeight:s*yE,buffer:o,characterSet:e,maxCanvasWidth:mE,...n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset}});if(u.height!==h){const E=d.getImageData(0,0,u.width,u.height);u.height=h,d.putImageData(E,0,0)}if(_E(d,r,s,i),a){const E=new hW({fontSize:s,buffer:o,radius:l,cutoff:c,fontFamily:r,fontWeight:"".concat(i)});for(const v of e){const{data:g,width:y,height:b,glyphTop:T}=E.draw(v);f[v].width=y,f[v].layoutOffsetY=s*vE-T;const A=d.createImageData(y,b);TW(g,A),d.putImageData(A,f[v].x,f[v].y)}}else for(const E of e)d.fillText(E,f[E].x,f[E].y+o+s*vE);return{xOffset:p,yOffset:m,mapping:f,data:u,width:u.width,height:u.height}}_getKey(){const{fontFamily:e,fontWeight:n,fontSize:r,buffer:i,sdf:s,radius:o,cutoff:a}=this.props;return s?"".concat(e," ").concat(n," ").concat(r," ").concat(i," ").concat(o," ").concat(a):"".concat(e," ").concat(n," ").concat(r," ").concat(i)}}const PW=`#define SHADER_NAME text-background-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute vec4 instanceRects;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec2 instancePixelOffsets;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform bool billboard;
uniform float opacity;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform vec4 padding;
uniform int sizeUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = radians(angle);
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;
  vLineWidth = instanceLineWidths;
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),
    sizeMinPixels, sizeMaxPixels
  );

  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;

  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);
  pixelOffset += instancePixelOffsets;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,RW=`#define SHADER_NAME text-background-layer-fragment-shader

precision highp float;

uniform bool stroked;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

void main(void) {
  geometry.uv = uv;

  vec2 pixelPosition = uv * dimensions;
  if (stroked) {
    float distToEdge = min(
      min(pixelPosition.x, dimensions.x - pixelPosition.x),
      min(pixelPosition.y, dimensions.y - pixelPosition.y)
    );
    float isBorder = smoothedge(distToEdge, vLineWidth);
    gl_FragColor = mix(vFillColor, vLineColor, isBorder);
  } else {
    gl_FragColor = vFillColor;
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,LW={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class J0 extends Xn{constructor(...e){super(...e),_(this,"state",void 0)}getShaders(){return super.getShaders({vs:PW,fs:RW,modules:[bo,xo]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);const{changeFlags:n}=e;if(n.extensionsChanged){var r;const{gl:i}=this.context;(r=this.state.model)===null||r===void 0||r.delete(),this.state.model=this._getModel(i),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{billboard:n,sizeScale:r,sizeUnits:i,sizeMinPixels:s,sizeMaxPixels:o,getLineWidth:a}=this.props;let{padding:l}=this.props;l.length<4&&(l=[l[0],l[1],l[0],l[1]]),this.state.model.setUniforms(e).setUniforms({billboard:n,stroked:!!a,padding:l,sizeUnits:gr[i],sizeScale:r,sizeMinPixels:s,sizeMaxPixels:o}).draw()}_getModel(e){const n=[0,0,1,0,1,1,0,1];return new si(e,{...this.getShaders(),id:this.props.id,geometry:new Eo({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}}_(J0,"defaultProps",LW);_(J0,"layerName","TextBackgroundLayer");const EE={start:1,middle:0,end:-1},wE={top:1,center:0,bottom:-1},Uh=[0,0,0,255],MW=1,kW={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:Uh},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:zs.characterSet},fontFamily:zs.fontFamily,fontWeight:zs.fontWeight,lineHeight:MW,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:Uh},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:Uh},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class ev extends G0{constructor(...e){super(...e),_(this,"state",void 0),_(this,"getBoundingRect",(n,r)=>{let{size:[i,s]}=this.transformParagraph(n,r);const{fontSize:o}=this.state.fontAtlasManager.props;i/=o,s/=o;const{getTextAnchor:a,getAlignmentBaseline:l}=this.props,c=EE[typeof a=="function"?a(n,r):a],u=wE[typeof l=="function"?l(n,r):l];return[(c-1)*i/2,(u-1)*s/2,i,s]}),_(this,"getIconOffsets",(n,r)=>{const{getTextAnchor:i,getAlignmentBaseline:s}=this.props,{x:o,y:a,rowWidth:l,size:[c,u]}=this.transformParagraph(n,r),d=EE[typeof i=="function"?i(n,r):i],f=wE[typeof s=="function"?s(n,r):s],h=o.length,p=new Array(h*2);let m=0;for(let E=0;E<h;E++){const v=(1-d)*(c-l[E])/2;p[m++]=(d-1)*c/2+v+o[E],p[m++]=(f-1)*u/2+a[E]}return p})}initializeState(){this.state={styleVersion:0,fontAtlasManager:new CW},this.props.maxWidth>0&&ye.warn("v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(e){const{props:n,oldProps:r,changeFlags:i}=e;(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||n.lineHeight!==r.lineHeight||n.wordBreak!==r.wordBreak||n.maxWidth!==r.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:e,fontFamily:n,fontWeight:r}=this.props,{fontAtlasManager:i,characterSet:s}=this.state,o={...e,characterSet:s,fontFamily:n,fontWeight:r};if(!i.mapping)return i.setProps(o),!0;for(const a in o)if(o[a]!==i.props[a])return i.setProps(o),!0;return!1}_updateText(){var e;const{data:n,characterSet:r}=this.props,i=(e=n.attributes)===null||e===void 0?void 0:e.getText;let{getText:s}=this.props,o=n.startIndices,a;const l=r==="auto"&&new Set;if(i&&o){const{texts:c,characterCount:u}=bW({...ArrayBuffer.isView(i)?{value:i}:i,length:n.length,startIndices:o,characterSet:l});a=u,s=(d,{index:f})=>c[f]}else{const{iterable:c,objectInfo:u}=ed(n);o=[0],a=0;for(const d of c){u.index++;const f=Array.from(s(d,u)||"");l&&f.forEach(l.add,l),a+=f.length,o.push(a)}}this.setState({getText:s,startIndices:o,numInstances:a,characterSet:l||r})}transformParagraph(e,n){const{fontAtlasManager:r}=this.state,i=r.mapping,s=this.state.getText,{wordBreak:o,lineHeight:a,maxWidth:l}=this.props,c=s(e,n)||"";return wW(c,a,o,l*r.props.fontSize,i)}renderLayers(){const{startIndices:e,numInstances:n,getText:r,fontAtlasManager:{scale:i,texture:s,mapping:o},styleVersion:a}=this.state,{data:l,_dataDiff:c,getPosition:u,getColor:d,getSize:f,getAngle:h,getPixelOffset:p,getBackgroundColor:m,getBorderColor:E,getBorderWidth:v,backgroundPadding:g,background:y,billboard:b,fontSettings:T,outlineWidth:A,outlineColor:R,sizeScale:I,sizeUnits:D,sizeMinPixels:N,sizeMaxPixels:F,transitions:q,updateTriggers:G}=this.props,W=this.getSubLayerClass("characters",Q0),xe=this.getSubLayerClass("background",J0);return[y&&new xe({getFillColor:m,getLineColor:E,getLineWidth:v,padding:g,getPosition:u,getSize:f,getAngle:h,getPixelOffset:p,billboard:b,sizeScale:I,sizeUnits:D,sizeMinPixels:N,sizeMaxPixels:F,transitions:q&&{getPosition:q.getPosition,getAngle:q.getAngle,getSize:q.getSize,getFillColor:q.getBackgroundColor,getLineColor:q.getBorderColor,getLineWidth:q.getBorderWidth,getPixelOffset:q.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:G.getPosition,getAngle:G.getAngle,getSize:G.getSize,getFillColor:G.getBackgroundColor,getLineColor:G.getBorderColor,getLineWidth:G.getBorderWidth,getPixelOffset:G.getPixelOffset,getBoundingRect:{getText:G.getText,getTextAnchor:G.getTextAnchor,getAlignmentBaseline:G.getAlignmentBaseline,styleVersion:a}}}),{data:l.attributes&&l.attributes.background?{length:l.length,attributes:l.attributes.background}:l,_dataDiff:c,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new W({sdf:T.sdf,smoothing:Number.isFinite(T.smoothing)?T.smoothing:zs.smoothing,outlineWidth:A/(T.radius||zs.radius),outlineColor:R,iconAtlas:s,iconMapping:o,getPosition:u,getColor:d,getSize:f,getAngle:h,getPixelOffset:p,billboard:b,sizeScale:I*i,sizeUnits:D,sizeMinPixels:N*i,sizeMaxPixels:F*i,transitions:q&&{getPosition:q.getPosition,getAngle:q.getAngle,getColor:q.getColor,getSize:q.getSize,getPixelOffset:q.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:G.getText,getPosition:G.getPosition,getAngle:G.getAngle,getColor:G.getColor,getSize:G.getSize,getPixelOffset:G.getPixelOffset,getIconOffsets:{getTextAnchor:G.getTextAnchor,getAlignmentBaseline:G.getAlignmentBaseline,styleVersion:a}}}),{data:l,_dataDiff:c,startIndices:e,numInstances:n,getIconOffsets:this.getIconOffsets,getIcon:r})]}static set fontAtlasCacheLimit(e){AW(e)}}_(ev,"defaultProps",kW);_(ev,"layerName","TextLayer");const ru={circle:{type:W0,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:Tl,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:ev,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},iu={type:K0,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},Fg={type:Z0,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function Ko({type:t,props:e}){const n={};for(const r in e)n[r]=t.defaultProps[e[r]];return n}function Bh(t,e){const{transitions:n,updateTriggers:r}=t.props,i={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const s in e){const o=e[s];let a=t.props[s];s.startsWith("get")&&(a=t.getSubLayerAccessor(a),i.updateTriggers[o]=r[s],n&&(i.transitions[o]=n[s])),i[o]=a}return i}function IW(t){if(Array.isArray(t))return t;switch(ye.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return ye.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}function bE(t,e,n={}){const r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:i=0,endRow:s=t.length}=n;for(let o=i;o<s;o++){const a=t[o],{geometry:l}=a;if(l)if(l.type==="GeometryCollection"){ye.assert(Array.isArray(l.geometries),"GeoJSON does not have geometries array");const{geometries:c}=l;for(let u=0;u<c.length;u++){const d=c[u];xE(d,r,e,a,o)}}else xE(l,r,e,a,o)}return r}function xE(t,e,n,r,i){const{type:s,coordinates:o}=t,{pointFeatures:a,lineFeatures:l,polygonFeatures:c,polygonOutlineFeatures:u}=e;if(!NW(s,o)){ye.warn("".concat(s," coordinates are malformed"))();return}switch(s){case"Point":a.push(n({geometry:t},r,i));break;case"MultiPoint":o.forEach(d=>{a.push(n({geometry:{type:"Point",coordinates:d}},r,i))});break;case"LineString":l.push(n({geometry:t},r,i));break;case"MultiLineString":o.forEach(d=>{l.push(n({geometry:{type:"LineString",coordinates:d}},r,i))});break;case"Polygon":c.push(n({geometry:t},r,i)),o.forEach(d=>{u.push(n({geometry:{type:"LineString",coordinates:d}},r,i))});break;case"MultiPolygon":o.forEach(d=>{c.push(n({geometry:{type:"Polygon",coordinates:d}},r,i)),d.forEach(f=>{u.push(n({geometry:{type:"LineString",coordinates:f}},r,i))})});break}}const OW={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function NW(t,e){let n=OW[t];for(ye.assert(n,"Unknown GeoJSON type ".concat(t));e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}function uC(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function Ac(t){return t.geometry.coordinates}function DW(t,e){const n=uC(),{pointFeatures:r,lineFeatures:i,polygonFeatures:s,polygonOutlineFeatures:o}=t;return n.points.data=r,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=Ac,n.lines.data=i,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=Ac,n.polygons.data=s,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=Ac,n.polygonsOutline.data=o,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=Ac,n}function FW(t,e){const n=uC(),{points:r,lines:i,polygons:s}=t,o=uW(t,e);return n.points.data={length:r.positions.value.length/r.positions.size,attributes:{...r.attributes,getPosition:r.positions,instancePickingColors:{size:3,value:o.points}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines.data={length:i.pathIndices.value.length-1,startIndices:i.pathIndices.value,attributes:{...i.attributes,getPath:i.positions,instancePickingColors:{size:3,value:o.lines}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines._pathType="open",n.polygons.data={length:s.polygonIndices.value.length-1,startIndices:s.polygonIndices.value,attributes:{...s.attributes,getPolygon:s.positions,pickingColors:{size:3,value:o.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygons._normalize=!1,s.triangles&&(n.polygons.data.attributes.indices=s.triangles.value),n.polygonsOutline.data={length:s.primitivePolygonIndices.value.length-1,startIndices:s.primitivePolygonIndices.value,attributes:{...s.attributes,getPath:s.positions,instancePickingColors:{size:3,value:o.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygonsOutline._pathType="open",n}const UW=["points","linestrings","polygons"],BW={...Ko(ru.circle),...Ko(ru.icon),...Ko(ru.text),...Ko(iu),...Ko(Fg),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class rd extends G0{initializeState(){this.state={layerProps:{},features:{}}}updateState({props:e,changeFlags:n}){if(!n.dataChanged)return;const{data:r}=this.props,i=r&&"points"in r&&"polygons"in r&&"lines"in r;this.setState({binary:i}),i?this._updateStateBinary({props:e,changeFlags:n}):this._updateStateJSON({props:e,changeFlags:n})}_updateStateBinary({props:e,changeFlags:n}){const r=FW(e.data,this.encodePickingColor);this.setState({layerProps:r})}_updateStateJSON({props:e,changeFlags:n}){const r=IW(e.data),i=this.getSubLayerRow.bind(this);let s={};const o={};if(Array.isArray(n.dataChanged)){const l=this.state.features;for(const c in l)s[c]=l[c].slice(),o[c]=[];for(const c of n.dataChanged){const u=bE(r,i,c);for(const d in l)o[d].push(aW({data:s[d],getIndex:f=>f.__source.index,dataRange:c,replace:u[d]}))}}else s=bE(r,i);const a=DW(s,o);this.setState({features:s,featuresDiff:o,layerProps:a})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r,sourceLayer:i}=n;return n.featureType=UW.find(s=>i.id.startsWith("".concat(this.id,"-").concat(s,"-"))),r>=0&&i.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(n.index=this.props.data.points.globalFeatureIds.value[r]),n}_updateAutoHighlight(e){const n="".concat(this.id,"-points-"),r=e.featureType==="points";for(const i of this.getSubLayers())i.id.startsWith(n)===r&&i.updateAutoHighlight(e)}_renderPolygonLayer(){const{extruded:e,wireframe:n}=this.props,{layerProps:r}=this.state,i="polygons-fill",s=this.shouldRenderSubLayer(i,r.polygons.data)&&this.getSubLayerClass(i,Fg.type);if(s){const o=Bh(this,Fg.props),a=e&&n;return a||delete o.getLineColor,o.updateTriggers.lineColors=a,new s(o,this.getSubLayerProps({id:i,updateTriggers:o.updateTriggers}),r.polygons)}return null}_renderLineLayers(){const{extruded:e,stroked:n}=this.props,{layerProps:r}=this.state,i="polygons-stroke",s="linestrings",o=!e&&n&&this.shouldRenderSubLayer(i,r.polygonsOutline.data)&&this.getSubLayerClass(i,iu.type),a=this.shouldRenderSubLayer(s,r.lines.data)&&this.getSubLayerClass(s,iu.type);if(o||a){const l=Bh(this,iu.props);return[o&&new o(l,this.getSubLayerProps({id:i,updateTriggers:l.updateTriggers}),r.polygonsOutline),a&&new a(l,this.getSubLayerProps({id:s,updateTriggers:l.updateTriggers}),r.lines)]}return null}_renderPointLayers(){const{pointType:e}=this.props,{layerProps:n,binary:r}=this.state;let{highlightedObjectIndex:i}=this.props;!r&&Number.isFinite(i)&&(i=n.points.data.findIndex(a=>a.__source.index===i));const s=new Set(e.split("+")),o=[];for(const a of s){const l="points-".concat(a),c=ru[a],u=c&&this.shouldRenderSubLayer(l,n.points.data)&&this.getSubLayerClass(l,c.type);if(u){const d=Bh(this,c.props);let f=n.points;if(a==="text"&&r){const{instancePickingColors:h,...p}=f.data.attributes;f={...f,data:{...f.data,attributes:p}}}o.push(new u(d,this.getSubLayerProps({id:l,updateTriggers:d.updateTriggers,highlightedObjectIndex:i}),f))}}return o}renderLayers(){const{extruded:e}=this.props,n=this._renderPolygonLayer(),r=this._renderLineLayers(),i=this._renderPointLayers();return[!e&&n,r,i,e&&n]}getSubLayerAccessor(e){const{binary:n}=this.state;return!n||typeof e!="function"?super.getSubLayerAccessor(e):(r,i)=>{const{data:s,index:o}=i,a=lW(s,o);return e(a,i)}}}_(rd,"layerName","GeoJsonLayer");_(rd,"defaultProps",BW);const zW=typeof window<"u"?S.useLayoutEffect:S.useEffect,jW=zW;function Ju(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}const VW={position:"absolute",zIndex:-1};function fC(t,e){if(typeof t=="function")return t(e);if(Array.isArray(t))return t.map(n=>fC(n,e));if(id(t)){if($W(t))return e.style=VW,S.cloneElement(t,e);if(GW(t))return S.cloneElement(t,e)}return t}function id(t){return t&&typeof t=="object"&&"type"in t||!1}function $W(t){var e;return(e=t.props)===null||e===void 0?void 0:e.mapStyle}function GW(t){const e=t.type;return e&&e.deckGLViewProps}function Ug(t){if(typeof t=="function")return S.createElement(uo,{},t);if(Array.isArray(t))return t.map(Ug);if(id(t)){if(t.type===S.Fragment)return Ug(t.props.children);if(Ju(t.type,uo))return t}return t}function WW({children:t,layers:e=[],views:n=null}){const r=[],i=[],s={};return S.Children.forEach(Ug(t),o=>{if(id(o)){const a=o.type;if(Ju(a,Xn)){const l=HW(a,o.props);i.push(l)}else r.push(o);if(Ju(a,uo)&&a!==uo&&o.props.id){const l=new a(o.props);s[l.id]=l}}else o&&r.push(o)}),Object.keys(s).length>0&&(Array.isArray(n)?n.forEach(o=>{s[o.id]=o}):n&&(s[n.id]=n),n=Object.values(s)),e=i.length>0?[...i,...e]:e,{layers:e,children:r,views:n}}function HW(t,e){const n={},r=t.defaultProps||{};for(const i in e)r[i]!==e[i]&&(n[i]=e[i]);return new t(n)}function YW({children:t,deck:e,ContextProvider:n}){const{viewManager:r}=e||{};if(!r||!r.views.length)return[];const i={},s=r.views[0].id;for(const o of t){let a=s,l=o;id(o)&&Ju(o.type,uo)&&(a=o.props.id||s,l=o.props.children);const c=r.getViewport(a),u=r.getViewState(a);if(c){u.padding=c.padding;const{x:d,y:f,width:h,height:p}=c;l=fC(l,{x:d,y:f,width:h,height:p,viewport:c,viewState:u}),i[a]||(i[a]={viewport:c,children:[]}),i[a].children.push(l)}}return Object.keys(i).map(o=>{const{viewport:a,children:l}=i[o],{x:c,y:u,width:d,height:f}=a,h={position:"absolute",left:c,top:u,width:d,height:f},p="view-".concat(o),m=S.createElement("div",{key:p,id:p,style:h},...l);if(n){const E={viewport:a,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:v=>{v.viewId=o,e._onViewStateChange(v)}};return S.createElement(n,{key:p,value:E},m)}return m})}const XW={mixBlendMode:null};function KW({width:t,height:e,style:n}){const r={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},i={left:0,top:0};if(n)for(const s in n)s in XW?i[s]=n[s]:r[s]=n[s];return{containerStyle:r,canvasStyle:i}}function qW(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}function dC(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}function ZW(t,e,n){const r=new e({...n,_customRender:i=>{t.redrawReason=i;const s=r.getViewports();t.lastRenderedViewports!==s?t.forceUpdate():dC(t)}});return r}const hC=S.forwardRef((t,e)=>{const[n,r]=S.useState(0),s=S.useRef({control:null,version:n,forceUpdate:()=>r(T=>T+1)}).current,o=S.useRef(null),a=S.useRef(null),l=S.useMemo(()=>WW(t),[t.layers,t.views,t.children]);let c=!0;const u=T=>{var A;return c&&t.viewState?(s.viewStateUpdateRequested=T,null):(s.viewStateUpdateRequested=null,(A=t.onViewStateChange)===null||A===void 0?void 0:A.call(t,T))},d=T=>{if(c)s.interactionStateUpdateRequested=T;else{var A;s.interactionStateUpdateRequested=null,(A=t.onInteractionStateChange)===null||A===void 0||A.call(t,T)}},f=S.useMemo(()=>{const T={...t,style:null,width:"100%",height:"100%",parent:o.current,canvas:a.current,layers:l.layers,views:l.views,onViewStateChange:u,onInteractionStateChange:d};return delete T._customRender,s.deck&&s.deck.setProps(T),T},[t]);S.useEffect(()=>{const T=t.Deck||Jf;return s.deck=ZW(s,T,{...f,parent:o.current,canvas:a.current}),()=>{var A;return(A=s.deck)===null||A===void 0?void 0:A.finalize()}},[]),jW(()=>{dC(s);const{viewStateUpdateRequested:T,interactionStateUpdateRequested:A}=s;T&&u(T),A&&d(A)}),S.useImperativeHandle(e,()=>qW(s),[]);const h=s.deck&&s.deck.isInitialized?s.deck.getViewports():void 0,{ContextProvider:p,width:m,height:E,id:v,style:g}=t,{containerStyle:y,canvasStyle:b}=S.useMemo(()=>KW({width:m,height:E,style:g}),[m,E,g]);if(!s.viewStateUpdateRequested&&s.lastRenderedViewports===h||s.version!==n){s.lastRenderedViewports=h,s.version=n;const T=YW({children:l.children,deck:s.deck,ContextProvider:p}),A=S.createElement("canvas",{key:"canvas",id:v||"deckgl-overlay",ref:a,style:b});s.control=S.createElement("div",{id:"".concat(v||"deckgl","-wrapper"),ref:o,style:y},[A,T])}return c=!1,s.control});hC.defaultProps=Jf.defaultProps;const QW=hC,JW=qe({key:"viewState",default:{longitude:109.695,latitude:35.862,zoom:4,pitch:33,bearing:0,minZoom:5}}),tv=qe({key:"yearsState",default:[0,100]});qe({key:"oceansState",default:{}});const pC=qe({key:"isTableState",default:!1}),gC=qe({key:"tableDataState",default:[]}),mC=qe({key:"tableHeaderState",default:""}),vC=qe({key:"isEntryModalState",default:!0}),eH=qe({key:"isLayersMenuState",default:!1});qe({key:"isNavMenuState",default:!1});const yC=qe({key:"isSourceModalState",default:!1}),_C=qe({key:"sourceModalInfoState",default:{}}),tH=qe({key:"dynastiesState",default:{}}),nH=qe({key:"erasState",default:{}}),Al=qe({key:"visibilityState",default:{"Study Area":!1,Rivers:!1}}),rH=qe({key:"sliderWidthState",default:500}),iH=qe({key:"ChinaBorderState",default:[]}),SE=qe({key:"StudyBorderState",default:[]}),nv=qe({key:"riverState",default:[]}),EC=pl({key:"riverRoutesState",get:({get:t})=>{const e=t(nv),[n,r]=t(tv);return e.filter(i=>r>i.properties.yearstart&&n<i.properties.yearend)}}),sH=qe({key:"studyAreaState",default:[]}),wC=qe({key:"eventsState",default:[]}),bC=pl({key:"eventState1",get:({get:t})=>{const e=t(wC),n=[];return e.forEach(r=>{const s=r.events.map(o=>Object.values(o)[0].reduce((l,c)=>{const u=l.find(d=>d.en_date_start===c.en_date_start);return u?(u.en_cat=new Set(u.en_cat),u.en_title=new Set(u.en_title),u.en_type=new Set(u.en_type),u.source=new Set(u.source)):l.push({ch_date:c.ch_date,en_date_start:c.en_date_start,en_cat:new Set([c.en_cat]),en_title:new Set([c.en_title]),en_type:new Set([c.en_type]),source:new Set([c.source])}),l},[]));n.push({...r,events:s})}),n}}),xC=qe({key:"typesArrayState",default:{}}),oH=pl({key:"filteredEventsState",get:({get:t})=>{const e=t(bC),[n,r]=t(tv),i=t(xC);Object.keys(i).filter(l=>i[l]);const s=Object.keys(i).filter(l=>i[l]);return e.map(l=>{const c=l.events.filter(u=>{if(s.length===0)return r>u[0].en_date_start&&n<u[0].en_date_start;if(s.length>0)return r>u[0].en_date_start&&n<u[0].en_date_start&&s.some(d=>u[0].en_type.has(d))});return{...l,events:c}}).filter(l=>l.events.length>0&&l.place_class!=="administrative units")}}),SC=pl({key:"groupedEventsState",get:({get:t})=>{const e=t(bC),n=[];e.forEach(i=>n.push(...i.events.flat()));const r=Array.from(RD(n,i=>i.en_date_start),([i,s])=>({date:i,events:s}));return r.sort((i,s)=>i.date-s.date),r}}),TC=qe({key:"upstreamState",default:[]}),sd=qe({key:"upstreamChoicesState",default:{}}),aH=pl({key:"upstreamDataState",get:({get:t})=>{const e=t(TC),n=t(sd);return e.filter(r=>r.date in n&&n[r.date]===!0)}});function lH(){const[t,e]=Le(tH),[n,r]=Le(nH);return S.useEffect(()=>{(async()=>{if(Object.keys(t).length===0){const o=await(await fetch("https://raw.githubusercontent.com/YellowRiverDatabase/geodata/main/relational-datadata/dynasties.geojson?token=GHSAT0AAAAAACGFEEKKSQU7WGR7IYU5S26UZGVEODA")).json(),a={};o.features&&o.features.forEach(l=>{a[l.properties.name_en]=[l.properties.start_date,l.properties.end_date]}),e(a)}if(Object.keys(n).length===0){const o=await(await fetch("https://raw.githubusercontent.com/YellowRiverDatabase/geodata/main/relational-datadata/eras.geojson?token=GHSAT0AAAAAACGFEEKKQGFQ6VWXB3LUMO7CZGVESPQ")).json(),a={};t.features&&o.features.forEach(l=>{a[l.properties.name_en]=[l.properties.start_date,l.properties.end_date]}),r(a)}})()},[]),null}/**
 * @remix-run/router v1.21.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ef(){return ef=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ef.apply(this,arguments)}var Hr;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Hr||(Hr={}));const TE="popstate";function cH(t){t===void 0&&(t={});function e(r,i){let{pathname:s,search:o,hash:a}=r.location;return Bg("",{pathname:s,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:CC(i)}return fH(e,n,null,t)}function zt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function AC(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function uH(){return Math.random().toString(36).substr(2,8)}function AE(t,e){return{usr:t.state,key:t.key,idx:e}}function Bg(t,e,n,r){return n===void 0&&(n=null),ef({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?od(e):e,{state:n,key:e&&e.key||r||uH()})}function CC(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function od(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function fH(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,a=Hr.Pop,l=null,c=u();c==null&&(c=0,o.replaceState(ef({},o.state,{idx:c}),""));function u(){return(o.state||{idx:null}).idx}function d(){a=Hr.Pop;let E=u(),v=E==null?null:E-c;c=E,l&&l({action:a,location:m.location,delta:v})}function f(E,v){a=Hr.Push;let g=Bg(m.location,E,v);n&&n(g,E),c=u()+1;let y=AE(g,c),b=m.createHref(g);try{o.pushState(y,"",b)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;i.location.assign(b)}s&&l&&l({action:a,location:m.location,delta:1})}function h(E,v){a=Hr.Replace;let g=Bg(m.location,E,v);n&&n(g,E),c=u();let y=AE(g,c),b=m.createHref(g);o.replaceState(y,"",b),s&&l&&l({action:a,location:m.location,delta:0})}function p(E){let v=i.location.origin!=="null"?i.location.origin:i.location.href,g=typeof E=="string"?E:CC(E);return g=g.replace(/ $/,"%20"),zt(v,"No window.location.(origin|href) available to create URL for href: "+g),new URL(g,v)}let m={get action(){return a},get location(){return t(i,o)},listen(E){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(TE,d),l=E,()=>{i.removeEventListener(TE,d),l=null}},createHref(E){return e(i,E)},createURL:p,encodeLocation(E){let v=p(E);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:f,replace:h,go(E){return o.go(E)}};return m}var CE;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(CE||(CE={}));function dH(t,e,n){return n===void 0&&(n="/"),hH(t,e,n,!1)}function hH(t,e,n,r){let i=typeof e=="string"?od(e):e,s=LC(i.pathname||"/",n);if(s==null)return null;let o=PC(t);pH(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=TH(s);a=xH(o[l],c,r)}return a}function PC(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(s,o,a)=>{let l={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};l.relativePath.startsWith("/")&&(zt(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let c=js([r,l.relativePath]),u=n.concat(l);s.children&&s.children.length>0&&(zt(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),PC(s.children,e,u,c)),!(s.path==null&&!s.index)&&e.push({path:c,score:wH(c,s.index),routesMeta:u})};return t.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))i(s,o);else for(let l of RC(s.path))i(s,o,l)}),e}function RC(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=RC(r.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),i&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function pH(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:bH(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const gH=/^:[\w-]+$/,mH=3,vH=2,yH=1,_H=10,EH=-2,PE=t=>t==="*";function wH(t,e){let n=t.split("/"),r=n.length;return n.some(PE)&&(r+=EH),e&&(r+=vH),n.filter(i=>!PE(i)).reduce((i,s)=>i+(gH.test(s)?mH:s===""?yH:_H),r)}function bH(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function xH(t,e,n){n===void 0&&(n=!1);let{routesMeta:r}=t,i={},s="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],c=a===r.length-1,u=s==="/"?e:e.slice(s.length)||"/",d=RE({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),f=l.route;if(!d&&c&&n&&!r[r.length-1].route.index&&(d=RE({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!d)return null;Object.assign(i,d.params),o.push({params:i,pathname:js([s,d.pathname]),pathnameBase:AH(js([s,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(s=js([s,d.pathnameBase]))}return o}function RE(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=SH(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((c,u,d)=>{let{paramName:f,isOptional:h}=u;if(f==="*"){let m=a[d]||"";o=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}const p=a[d];return h&&!p?c[f]=void 0:c[f]=(p||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:o,pattern:t}}function SH(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),AC(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function TH(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return AC(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function LC(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}const js=t=>t.join("/").replace(/\/\/+/g,"/"),AH=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/");function CH(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const MC=["post","put","patch","delete"];new Set(MC);const PH=["get",...MC];new Set(PH);/**
 * React Router v6.28.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function tf(){return tf=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},tf.apply(this,arguments)}const RH=S.createContext(null),LH=S.createContext(null),kC=S.createContext(null),ad=S.createContext(null),ld=S.createContext({outlet:null,matches:[],isDataRoute:!1}),IC=S.createContext(null);function rv(){return S.useContext(ad)!=null}function OC(){return rv()||zt(!1),S.useContext(ad).location}function MH(t,e){return kH(t,e)}function kH(t,e,n,r){rv()||zt(!1);let{navigator:i}=S.useContext(kC),{matches:s}=S.useContext(ld),o=s[s.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let c=OC(),u;if(e){var d;let E=typeof e=="string"?od(e):e;l==="/"||(d=E.pathname)!=null&&d.startsWith(l)||zt(!1),u=E}else u=c;let f=u.pathname||"/",h=f;if(l!=="/"){let E=l.replace(/^\//,"").split("/");h="/"+f.replace(/^\//,"").split("/").slice(E.length).join("/")}let p=dH(t,{pathname:h}),m=FH(p&&p.map(E=>Object.assign({},E,{params:Object.assign({},a,E.params),pathname:js([l,i.encodeLocation?i.encodeLocation(E.pathname).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?l:js([l,i.encodeLocation?i.encodeLocation(E.pathnameBase).pathname:E.pathnameBase])})),s,n,r);return e&&m?S.createElement(ad.Provider,{value:{location:tf({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Hr.Pop}},m):m}function IH(){let t=jH(),e=CH(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},s=null;return S.createElement(S.Fragment,null,S.createElement("h2",null,"Unexpected Application Error!"),S.createElement("h3",{style:{fontStyle:"italic"}},e),n?S.createElement("pre",{style:i},n):null,s)}const OH=S.createElement(IH,null);class NH extends S.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?S.createElement(ld.Provider,{value:this.props.routeContext},S.createElement(IC.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function DH(t){let{routeContext:e,match:n,children:r}=t,i=S.useContext(RH);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),S.createElement(ld.Provider,{value:e},r)}function FH(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var s;if(!n)return null;if(n.errors)t=n.matches;else if((s=r)!=null&&s.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(i=n)==null?void 0:i.errors;if(a!=null){let u=o.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id])!==void 0);u>=0||zt(!1),o=o.slice(0,Math.min(o.length,u+1))}let l=!1,c=-1;if(n&&r&&r.v7_partialHydration)for(let u=0;u<o.length;u++){let d=o[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=u),d.route.id){let{loaderData:f,errors:h}=n,p=d.route.loader&&f[d.route.id]===void 0&&(!h||h[d.route.id]===void 0);if(d.route.lazy||p){l=!0,c>=0?o=o.slice(0,c+1):o=[o[0]];break}}}return o.reduceRight((u,d,f)=>{let h,p=!1,m=null,E=null;n&&(h=a&&d.route.id?a[d.route.id]:void 0,m=d.route.errorElement||OH,l&&(c<0&&f===0?(VH("route-fallback",!1),p=!0,E=null):c===f&&(p=!0,E=d.route.hydrateFallbackElement||null)));let v=e.concat(o.slice(0,f+1)),g=()=>{let y;return h?y=m:p?y=E:d.route.Component?y=S.createElement(d.route.Component,null):d.route.element?y=d.route.element:y=u,S.createElement(DH,{match:d,routeContext:{outlet:u,matches:v,isDataRoute:n!=null},children:y})};return n&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?S.createElement(NH,{location:n.location,revalidation:n.revalidation,component:m,error:h,children:g(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):g()},null)}var zg=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(zg||{});function UH(t){let e=S.useContext(LH);return e||zt(!1),e}function BH(t){let e=S.useContext(ld);return e||zt(!1),e}function zH(t){let e=BH(),n=e.matches[e.matches.length-1];return n.route.id||zt(!1),n.route.id}function jH(){var t;let e=S.useContext(IC),n=UH(zg.UseRouteError),r=zH(zg.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}const LE={};function VH(t,e,n){!e&&!LE[t]&&(LE[t]=!0)}const ME={};function $H(t,e){ME[e]||(ME[e]=!0,console.warn(e))}const us=(t,e,n)=>$H(t,"⚠️ React Router Future Flag Warning: "+e+". "+("You can use the `"+t+"` future flag to opt-in early. ")+("For more information, see "+n+"."));function GH(t,e){t!=null&&t.v7_startTransition||us("v7_startTransition","React Router will begin wrapping state updates in `React.startTransition` in v7","https://reactrouter.com/v6/upgrading/future#v7_starttransition"),!(t!=null&&t.v7_relativeSplatPath)&&(!e||!e.v7_relativeSplatPath)&&us("v7_relativeSplatPath","Relative route resolution within Splat routes is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath"),e&&(e.v7_fetcherPersist||us("v7_fetcherPersist","The persistence behavior of fetchers is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_fetcherpersist"),e.v7_normalizeFormMethod||us("v7_normalizeFormMethod","Casing of `formMethod` fields is being normalized to uppercase in v7","https://reactrouter.com/v6/upgrading/future#v7_normalizeformmethod"),e.v7_partialHydration||us("v7_partialHydration","`RouterProvider` hydration behavior is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_partialhydration"),e.v7_skipActionErrorRevalidation||us("v7_skipActionErrorRevalidation","The revalidation behavior after 4xx/5xx `action` responses is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_skipactionerrorrevalidation"))}function Ei(t){zt(!1)}function WH(t){let{basename:e="/",children:n=null,location:r,navigationType:i=Hr.Pop,navigator:s,static:o=!1,future:a}=t;rv()&&zt(!1);let l=e.replace(/^\/*/,"/"),c=S.useMemo(()=>({basename:l,navigator:s,static:o,future:tf({v7_relativeSplatPath:!1},a)}),[l,a,s,o]);typeof r=="string"&&(r=od(r));let{pathname:u="/",search:d="",hash:f="",state:h=null,key:p="default"}=r,m=S.useMemo(()=>{let E=LC(u,l);return E==null?null:{location:{pathname:E,search:d,hash:f,state:h,key:p},navigationType:i}},[l,u,d,f,h,p,i]);return m==null?null:S.createElement(kC.Provider,{value:c},S.createElement(ad.Provider,{children:n,value:m}))}function HH(t){let{children:e,location:n}=t;return MH(jg(e),n)}new Promise(()=>{});function jg(t,e){e===void 0&&(e=[]);let n=[];return S.Children.forEach(t,(r,i)=>{if(!S.isValidElement(r))return;let s=[...e,i];if(r.type===S.Fragment){n.push.apply(n,jg(r.props.children,s));return}r.type!==Ei&&zt(!1),!r.props.index||!r.props.children||zt(!1);let o={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=jg(r.props.children,s)),n.push(o)}),n}var NC={exports:{}},YH="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",XH=YH,KH=XH;function DC(){}function FC(){}FC.resetWarningCache=DC;var qH=function(){function t(r,i,s,o,a,l){if(l!==KH){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:FC,resetWarningCache:DC};return n.PropTypes=n,n};NC.exports=qH();var ZH=NC.exports;const zh=po(ZH),QH="modulepreload",JH=function(t){return"/"+t},kE={},e9=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=JH(s),s in kE)return;kE[s]=!0;const o=s.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!r)for(let u=i.length-1;u>=0;u--){const d=i[u];if(d.href===s&&(!o||d.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const c=document.createElement("link");if(c.rel=o?"stylesheet":QH,o||(c.as="script",c.crossOrigin=""),c.href=s,document.head.appendChild(c),o)return new Promise((u,d)=>{c.addEventListener("load",u),c.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})},t9=S.createContext(null);function n9(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0,i=Array.isArray(e)?e[0]:e?e.x:0,s=Array.isArray(e)?e[1]:e?e.y:0;return n===i&&r===s}function ir(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!ir(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const i of n)if(!e.hasOwnProperty(i)||!ir(t[i],e[i]))return!1;return!0}return!1}function r9(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function IE(t,e){if(!t.getProjection)return;const n=t.getProjection(),r=e.getProjection();ir(n,r)||e.setProjection(n)}function OE(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function NE(t,e){const n=e.viewState||e;let r=!1;if("longitude"in n&&"latitude"in n){const i=t.center;t.center=new i.constructor(n.longitude,n.latitude),r=r||i!==t.center}if("zoom"in n){const i=t.zoom;t.zoom=n.zoom,r=r||i!==t.zoom}if("bearing"in n){const i=t.bearing;t.bearing=n.bearing,r=r||i!==t.bearing}if("pitch"in n){const i=t.pitch;t.pitch=n.pitch,r=r||i!==t.pitch}return n.padding&&!t.isPaddingEqual(n.padding)&&(r=!0,t.padding=n.padding),r}const i9=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function DE(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const r of t.layers)e[r.id]=r;const n=t.layers.map(r=>{let i=null;"interactive"in r&&(i=Object.assign({},r),delete i.interactive);const s=e[r.ref];if(s){i=i||Object.assign({},r),delete i.ref;for(const o of i9)o in s&&(i[o]=s[o])}return i||r});return{...t,layers:n}}const FE={version:8,sources:{},layers:[]},UE={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},jh={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},BE={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},s9=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],o9=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class fo{constructor(e,n,r){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=i=>{const s=this.props[BE[i.type]];s?s(i):i.type==="error"&&console.error(i.error)},this._onPointerEvent=i=>{(i.type==="mousemove"||i.type==="mouseout")&&this._updateHover(i);const s=this.props[UE[i.type]];s&&(this.props.interactiveLayerIds&&i.type!=="mouseover"&&i.type!=="mouseout"&&(i.features=this._hoveredFeatures||this._queryRenderedFeatures(i.point)),s(i),delete i.features)},this._onCameraEvent=i=>{if(!this._internalUpdate){const s=this.props[jh[i.type]];s&&s(i)}i.type in this._deferredEvents&&(this._deferredEvents[i.type]=!1)},this._MapClass=e,this.props=n,this._initialize(r)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const n=this.props;this.props=e;const r=this._updateSettings(e,n);r&&this._createShadowTransform(this._map);const i=this._updateSize(e),s=this._updateViewState(e,!0);this._updateStyle(e,n),this._updateStyleComponents(e,n),this._updateHandlers(e,n),(r||i||s&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const r=fo.savedMaps.pop();if(!r)return null;const i=r.map,s=i.getContainer();for(n.className=s.className;s.childNodes.length>0;)n.appendChild(s.childNodes[0]);i._container=n;const o=i._resizeObserver;o&&(o.disconnect(),o.observe(n)),r.setProps({...e,styleDiffing:!1}),i.resize();const{initialViewState:a}=e;return a&&(a.bounds?i.fitBounds(a.bounds,{...a.fitBoundsOptions,duration:0}):r._updateViewState(a,!1)),i.isStyleLoaded()?i.fire("load"):i.once("styledata",()=>i.fire("load")),i._update(),r}_initialize(e){const{props:n}=this,{mapStyle:r=FE}=n,i={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||a9()||null,container:e,style:DE(r)},s=i.initialViewState||i.viewState||i;if(Object.assign(i,{center:[s.longitude||0,s.latitude||0],zoom:s.zoom||0,pitch:s.pitch||0,bearing:s.bearing||0}),n.gl){const u=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=u,n.gl)}const o=new this._MapClass(i);s.padding&&o.setPadding(s.padding),n.cursor&&(o.getCanvas().style.cursor=n.cursor),this._createShadowTransform(o);const a=o._render;o._render=u=>{this._inRender=!0,a.call(o,u),this._inRender=!1};const l=o._renderTaskQueue.run;o._renderTaskQueue.run=u=>{l.call(o._renderTaskQueue,u),this._onBeforeRepaint()},o.on("render",()=>this._onAfterRepaint());const c=o.fire;o.fire=this._fireEvent.bind(this,c),o.on("resize",()=>{this._renderTransform.resize(o.transform.width,o.transform.height)}),o.on("styledata",()=>{this._updateStyleComponents(this.props,{}),IE(o.transform,this._renderTransform)}),o.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const u in UE)o.on(u,this._onPointerEvent);for(const u in jh)o.on(u,this._onCameraEvent);for(const u in BE)o.on(u,this._onEvent);this._map=o}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n==null||n.remove(),fo.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const n=r9(e.transform);e.painter.transform=n,this._renderTransform=n}_updateSize(e){const{viewState:n}=e;if(n){const r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(e,n){if(this._internalUpdate)return!1;const r=this._map,i=this._renderTransform,{zoom:s,pitch:o,bearing:a}=i,l=r.isMoving();l&&(i.cameraElevationReference="sea");const c=NE(i,{...OE(r.transform),...e});if(l&&(i.cameraElevationReference="ground"),c&&n){const u=this._deferredEvents;u.move=!0,u.zoom||(u.zoom=s!==i.zoom),u.rotate||(u.rotate=a!==i.bearing),u.pitch||(u.pitch=o!==i.pitch)}return l||NE(r.transform,e),c}_updateSettings(e,n){const r=this._map;let i=!1;for(const s of s9)if(s in e&&!ir(e[s],n[s])){i=!0;const o=r[`set${s[0].toUpperCase()}${s.slice(1)}`];o==null||o.call(r,e[s])}return i}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==n.mapStyle){const{mapStyle:r=FE,styleDiffing:i=!0}=e,s={diff:i};return"localIdeographFontFamily"in e&&(s.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(DE(r),s),!0}return!1}_updateStyleComponents(e,n){const r=this._map;let i=!1;return r.isStyleLoaded()&&("light"in e&&r.setLight&&!ir(e.light,n.light)&&(i=!0,r.setLight(e.light)),"fog"in e&&r.setFog&&!ir(e.fog,n.fog)&&(i=!0,r.setFog(e.fog)),"terrain"in e&&r.setTerrain&&!ir(e.terrain,n.terrain)&&(!e.terrain||r.getSource(e.terrain.source))&&(i=!0,r.setTerrain(e.terrain))),i}_updateHandlers(e,n){var r,i;const s=this._map;let o=!1;for(const a of o9){const l=(r=e[a])!==null&&r!==void 0?r:!0,c=(i=n[a])!==null&&i!==void 0?i:!0;ir(l,c)||(o=!0,l?s[a].enable(l):s[a].disable())}return o}_queryRenderedFeatures(e){const n=this._map,r=n.transform,{interactiveLayerIds:i=[]}=this.props;try{return n.transform=this._renderTransform,n.queryRenderedFeatures(e,{layers:i.filter(n.getLayer.bind(n))})}catch{return[]}finally{n.transform=r}}_updateHover(e){var n;const{props:r}=this;if(r.interactiveLayerIds&&(r.onMouseMove||r.onMouseEnter||r.onMouseLeave)){const s=e.type,o=((n=this._hoveredFeatures)===null||n===void 0?void 0:n.length)>0,a=this._queryRenderedFeatures(e.point),l=a.length>0;!l&&o&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=a,l&&!o&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=s}else this._hoveredFeatures=null}_fireEvent(e,n,r){const i=this._map,s=i.transform,o=typeof n=="string"?n:n.type;return o==="move"&&this._updateViewState(this.props,!1),o in jh&&(typeof n=="object"&&(n.viewState=OE(s)),this._map.isMoving())?(i.transform=this._renderTransform,e.call(i,n,r),i.transform=s,i):(e.call(i,n,r),i)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const r in this._deferredEvents)this._deferredEvents[r]&&e.fire(r);this._internalUpdate=!1;const n=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{IE(this._renderTransform,n),e.transform=n}}}fo.savedMaps=[];function a9(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||{}.MapboxAccessToken}catch{}try{t=t||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const l9=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function c9(t){if(!t)return null;const e=t.map,n={getMap:()=>e,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:r=>{const i=e.transform;e.transform=t.transform;const s=e.project(r);return e.transform=i,s},unproject:r=>{const i=e.transform;e.transform=t.transform;const s=e.unproject(r);return e.transform=i,s},queryTerrainElevation:(r,i)=>{const s=e.transform;e.transform=t.transform;const o=e.queryTerrainElevation(r,i);return e.transform=s,o},queryRenderedFeatures:(r,i)=>{const s=e.transform;e.transform=t.transform;const o=e.queryRenderedFeatures(r,i);return e.transform=s,o}};for(const r of u9(e))!(r in n)&&!l9.includes(r)&&(n[r]=e[r].bind(e));return n}function u9(t){const e=new Set;let n=t;for(;n;){for(const r of Object.getOwnPropertyNames(n))r[0]!=="_"&&typeof t[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&e.add(r);n=Object.getPrototypeOf(n)}return Array.from(e)}const f9=typeof document<"u"?S.useLayoutEffect:S.useEffect,d9=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function h9(t,e){for(const r of d9)r in e&&(t[r]=e[r]);const{RTLTextPlugin:n="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=e;n&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(n,r=>{r&&console.error(r)},!0)}const cd=S.createContext(null);function p9(t,e,n){const r=S.useContext(t9),[i,s]=S.useState(null),o=S.useRef(),{current:a}=S.useRef({mapLib:null,map:null});S.useEffect(()=>{const u=t.mapLib;let d=!0,f;return Promise.resolve(u||n).then(h=>{if(!d)return;if(!h)throw new Error("Invalid mapLib");const p="Map"in h?h:h.default;if(!p.Map)throw new Error("Invalid mapLib");if(h9(p,t),!p.supported||p.supported(t))t.reuseMaps&&(f=fo.reuse(t,o.current)),f||(f=new fo(p.Map,t,o.current)),a.map=c9(f),a.mapLib=p,s(f),r==null||r.onMapMount(a.map,t.id);else throw new Error("Map is not supported by this browser")}).catch(h=>{const{onError:p}=t;p?p({type:"error",target:null,originalEvent:null,error:h}):console.error(h)}),()=>{d=!1,f&&(r==null||r.onMapUnmount(t.id),t.reuseMaps?f.recycle():f.destroy())}},[]),f9(()=>{i&&i.setProps(t)}),S.useImperativeHandle(e,()=>a.map,[i]);const l=S.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),c={height:"100%"};return S.createElement("div",{id:t.id,ref:o,style:l},i&&S.createElement(cd.Provider,{value:a},S.createElement("div",{"mapboxgl-children":"",style:c},t.children)))}const g9=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function Qi(t,e){if(!t||!e)return;const n=t.style;for(const r in e){const i=e[r];Number.isFinite(i)&&!g9.test(r)?n[r]=`${i}px`:n[r]=i}}function m9(t,e){const{map:n,mapLib:r}=S.useContext(cd),i=S.useRef({props:t});i.current.props=t;const s=S.useMemo(()=>{let m=!1;S.Children.forEach(t.children,g=>{g&&(m=!0)});const E={...t,element:m?document.createElement("div"):null},v=new r.Marker(E);return v.setLngLat([t.longitude,t.latitude]),v.getElement().addEventListener("click",g=>{var y,b;(b=(y=i.current.props).onClick)===null||b===void 0||b.call(y,{type:"click",target:v,originalEvent:g})}),v.on("dragstart",g=>{var y,b;const T=g;T.lngLat=s.getLngLat(),(b=(y=i.current.props).onDragStart)===null||b===void 0||b.call(y,T)}),v.on("drag",g=>{var y,b;const T=g;T.lngLat=s.getLngLat(),(b=(y=i.current.props).onDrag)===null||b===void 0||b.call(y,T)}),v.on("dragend",g=>{var y,b;const T=g;T.lngLat=s.getLngLat(),(b=(y=i.current.props).onDragEnd)===null||b===void 0||b.call(y,T)}),v},[]);S.useEffect(()=>(s.addTo(n.getMap()),()=>{s.remove()}),[]);const{longitude:o,latitude:a,offset:l,style:c,draggable:u=!1,popup:d=null,rotation:f=0,rotationAlignment:h="auto",pitchAlignment:p="auto"}=t;return S.useEffect(()=>{Qi(s.getElement(),c)},[c]),S.useImperativeHandle(e,()=>s,[]),(s.getLngLat().lng!==o||s.getLngLat().lat!==a)&&s.setLngLat([o,a]),l&&!n9(s.getOffset(),l)&&s.setOffset(l),s.isDraggable()!==u&&s.setDraggable(u),s.getRotation()!==f&&s.setRotation(f),s.getRotationAlignment()!==h&&s.setRotationAlignment(h),s.getPitchAlignment()!==p&&s.setPitchAlignment(p),s.getPopup()!==d&&s.setPopup(d),Cf.createPortal(t.children,s.getElement())}S.memo(S.forwardRef(m9));function zE(t){return new Set(t?t.trim().split(/\s+/):[])}function v9(t,e){const{map:n,mapLib:r}=S.useContext(cd),i=S.useMemo(()=>document.createElement("div"),[]),s=S.useRef({props:t});s.current.props=t;const o=S.useMemo(()=>{const a={...t},l=new r.Popup(a);return l.setLngLat([t.longitude,t.latitude]),l.once("open",c=>{var u,d;(d=(u=s.current.props).onOpen)===null||d===void 0||d.call(u,c)}),l},[]);if(S.useEffect(()=>{const a=l=>{var c,u;(u=(c=s.current.props).onClose)===null||u===void 0||u.call(c,l)};return o.on("close",a),o.setDOMContent(i).addTo(n.getMap()),()=>{o.off("close",a),o.isOpen()&&o.remove()}},[]),S.useEffect(()=>{Qi(o.getElement(),t.style)},[t.style]),S.useImperativeHandle(e,()=>o,[]),o.isOpen()&&((o.getLngLat().lng!==t.longitude||o.getLngLat().lat!==t.latitude)&&o.setLngLat([t.longitude,t.latitude]),t.offset&&!ir(o.options.offset,t.offset)&&o.setOffset(t.offset),(o.options.anchor!==t.anchor||o.options.maxWidth!==t.maxWidth)&&(o.options.anchor=t.anchor,o.setMaxWidth(t.maxWidth)),o.options.className!==t.className)){const a=zE(o.options.className),l=zE(t.className);for(const c of a)l.has(c)||o.removeClassName(c);for(const c of l)a.has(c)||o.addClassName(c);o.options.className=t.className}return Cf.createPortal(t.children,i)}S.memo(S.forwardRef(v9));function Cl(t,e,n,r){const i=S.useContext(cd),s=S.useMemo(()=>t(i),[]);return S.useEffect(()=>{const o=r||n||e,a=typeof e=="function"&&typeof n=="function"?e:null,l=typeof n=="function"?n:typeof e=="function"?e:null,{map:c}=i;return c.hasControl(s)||(c.addControl(s,o==null?void 0:o.position),a&&a(i)),()=>{l&&l(i),c.hasControl(s)&&c.removeControl(s)}},[]),s}function y9(t){const e=Cl(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return S.useEffect(()=>{Qi(e._container,t.style)},[t.style]),null}S.memo(y9);function _9(t){const e=Cl(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return S.useEffect(()=>{Qi(e._controlContainer,t.style)},[t.style]),null}S.memo(_9);function E9(t,e){const n=S.useRef({props:t}),r=Cl(({mapLib:i})=>{const s=new i.GeolocateControl(t),o=s._setupUI;return s._setupUI=a=>{s._container.hasChildNodes()||o(a)},s.on("geolocate",a=>{var l,c;(c=(l=n.current.props).onGeolocate)===null||c===void 0||c.call(l,a)}),s.on("error",a=>{var l,c;(c=(l=n.current.props).onError)===null||c===void 0||c.call(l,a)}),s.on("outofmaxbounds",a=>{var l,c;(c=(l=n.current.props).onOutOfMaxBounds)===null||c===void 0||c.call(l,a)}),s.on("trackuserlocationstart",a=>{var l,c;(c=(l=n.current.props).onTrackUserLocationStart)===null||c===void 0||c.call(l,a)}),s.on("trackuserlocationend",a=>{var l,c;(c=(l=n.current.props).onTrackUserLocationEnd)===null||c===void 0||c.call(l,a)}),s},{position:t.position});return n.current.props=t,S.useImperativeHandle(e,()=>r,[]),S.useEffect(()=>{Qi(r._container,t.style)},[t.style]),null}S.memo(S.forwardRef(E9));function w9(t){const e=Cl(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return S.useEffect(()=>{Qi(e._container,t.style)},[t.style]),null}S.memo(w9);function b9(t){const e=Cl(({mapLib:s})=>new s.ScaleControl(t),{position:t.position}),n=S.useRef(t),r=n.current;n.current=t;const{style:i}=t;return t.maxWidth!==void 0&&t.maxWidth!==r.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==r.unit&&e.setUnit(t.unit),S.useEffect(()=>{Qi(e._container,i)},[i]),null}S.memo(b9);const x9=e9(()=>import("./mapbox-gl-73d1d069.js").then(t=>t.m),[]),S9=(()=>S.forwardRef(function(e,n){return p9(e,n,x9)}))();function iv(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function UC(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Pl(){}var Za=.7,nf=1/Za,Vs="\\s*([+-]?\\d+)\\s*",Qa="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",$n="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",T9=/^#([0-9a-f]{3,8})$/,A9=new RegExp(`^rgb\\(${Vs},${Vs},${Vs}\\)$`),C9=new RegExp(`^rgb\\(${$n},${$n},${$n}\\)$`),P9=new RegExp(`^rgba\\(${Vs},${Vs},${Vs},${Qa}\\)$`),R9=new RegExp(`^rgba\\(${$n},${$n},${$n},${Qa}\\)$`),L9=new RegExp(`^hsl\\(${Qa},${$n},${$n}\\)$`),M9=new RegExp(`^hsla\\(${Qa},${$n},${$n},${Qa}\\)$`),jE={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};iv(Pl,Ja,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:VE,formatHex:VE,formatHex8:k9,formatHsl:I9,formatRgb:$E,toString:$E});function VE(){return this.rgb().formatHex()}function k9(){return this.rgb().formatHex8()}function I9(){return BC(this).formatHsl()}function $E(){return this.rgb().formatRgb()}function Ja(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=T9.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?GE(e):n===3?new Nt(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Cc(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Cc(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=A9.exec(t))?new Nt(e[1],e[2],e[3],1):(e=C9.exec(t))?new Nt(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=P9.exec(t))?Cc(e[1],e[2],e[3],e[4]):(e=R9.exec(t))?Cc(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=L9.exec(t))?YE(e[1],e[2]/100,e[3]/100,1):(e=M9.exec(t))?YE(e[1],e[2]/100,e[3]/100,e[4]):jE.hasOwnProperty(t)?GE(jE[t]):t==="transparent"?new Nt(NaN,NaN,NaN,0):null}function GE(t){return new Nt(t>>16&255,t>>8&255,t&255,1)}function Cc(t,e,n,r){return r<=0&&(t=e=n=NaN),new Nt(t,e,n,r)}function O9(t){return t instanceof Pl||(t=Ja(t)),t?(t=t.rgb(),new Nt(t.r,t.g,t.b,t.opacity)):new Nt}function Vg(t,e,n,r){return arguments.length===1?O9(t):new Nt(t,e,n,r??1)}function Nt(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}iv(Nt,Vg,UC(Pl,{brighter(t){return t=t==null?nf:Math.pow(nf,t),new Nt(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Za:Math.pow(Za,t),new Nt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Nt(Oi(this.r),Oi(this.g),Oi(this.b),rf(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:WE,formatHex:WE,formatHex8:N9,formatRgb:HE,toString:HE}));function WE(){return`#${Li(this.r)}${Li(this.g)}${Li(this.b)}`}function N9(){return`#${Li(this.r)}${Li(this.g)}${Li(this.b)}${Li((isNaN(this.opacity)?1:this.opacity)*255)}`}function HE(){const t=rf(this.opacity);return`${t===1?"rgb(":"rgba("}${Oi(this.r)}, ${Oi(this.g)}, ${Oi(this.b)}${t===1?")":`, ${t})`}`}function rf(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Oi(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Li(t){return t=Oi(t),(t<16?"0":"")+t.toString(16)}function YE(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new xn(t,e,n,r)}function BC(t){if(t instanceof xn)return new xn(t.h,t.s,t.l,t.opacity);if(t instanceof Pl||(t=Ja(t)),!t)return new xn;if(t instanceof xn)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),o=NaN,a=s-i,l=(s+i)/2;return a?(e===s?o=(n-r)/a+(n<r)*6:n===s?o=(r-e)/a+2:o=(e-n)/a+4,a/=l<.5?s+i:2-s-i,o*=60):a=l>0&&l<1?0:o,new xn(o,a,l,t.opacity)}function D9(t,e,n,r){return arguments.length===1?BC(t):new xn(t,e,n,r??1)}function xn(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}iv(xn,D9,UC(Pl,{brighter(t){return t=t==null?nf:Math.pow(nf,t),new xn(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Za:Math.pow(Za,t),new xn(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Nt(Vh(t>=240?t-240:t+120,i,r),Vh(t,i,r),Vh(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new xn(XE(this.h),Pc(this.s),Pc(this.l),rf(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=rf(this.opacity);return`${t===1?"hsl(":"hsla("}${XE(this.h)}, ${Pc(this.s)*100}%, ${Pc(this.l)*100}%${t===1?")":`, ${t})`}`}}));function XE(t){return t=(t||0)%360,t<0?t+360:t}function Pc(t){return Math.max(0,Math.min(1,t||0))}function Vh(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function F9(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}const sv=t=>()=>t;function U9(t,e){return function(n){return t+n*e}}function B9(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function z9(t){return(t=+t)==1?zC:function(e,n){return n-e?B9(e,n,t):sv(isNaN(e)?n:e)}}function zC(t,e){var n=e-t;return n?U9(t,n):sv(isNaN(t)?e:t)}const KE=function t(e){var n=z9(e);function r(i,s){var o=n((i=Vg(i)).r,(s=Vg(s)).r),a=n(i.g,s.g),l=n(i.b,s.b),c=zC(i.opacity,s.opacity);return function(u){return i.r=o(u),i.g=a(u),i.b=l(u),i.opacity=c(u),i+""}}return r.gamma=t,r}(1);function j9(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=t[i]*(1-s)+e[i]*s;return r}}function V9(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function $9(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),s=new Array(n),o;for(o=0;o<r;++o)i[o]=ov(t[o],e[o]);for(;o<n;++o)s[o]=e[o];return function(a){for(o=0;o<r;++o)s[o]=i[o](a);return s}}function G9(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function sf(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function W9(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=ov(t[i],e[i]):r[i]=e[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var $g=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,$h=new RegExp($g.source,"g");function H9(t){return function(){return t}}function Y9(t){return function(e){return t(e)+""}}function X9(t,e){var n=$g.lastIndex=$h.lastIndex=0,r,i,s,o=-1,a=[],l=[];for(t=t+"",e=e+"";(r=$g.exec(t))&&(i=$h.exec(e));)(s=i.index)>n&&(s=e.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(r=r[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,l.push({i:o,x:sf(r,i)})),n=$h.lastIndex;return n<e.length&&(s=e.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?l[0]?Y9(l[0].x):H9(e):(e=l.length,function(c){for(var u=0,d;u<e;++u)a[(d=l[u]).i]=d.x(c);return a.join("")})}function ov(t,e){var n=typeof e,r;return e==null||n==="boolean"?sv(e):(n==="number"?sf:n==="string"?(r=Ja(e))?(e=r,KE):X9:e instanceof Ja?KE:e instanceof Date?G9:V9(e)?j9:Array.isArray(e)?$9:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?W9:sf)(t,e)}function K9(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function q9(t){return function(){return t}}function Z9(t){return+t}var qE=[0,1];function Ls(t){return t}function Gg(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:q9(isNaN(e)?NaN:.5)}function Q9(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function J9(t,e,n){var r=t[0],i=t[1],s=e[0],o=e[1];return i<r?(r=Gg(i,r),s=n(o,s)):(r=Gg(r,i),s=n(s,o)),function(a){return s(r(a))}}function e7(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),s=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)i[o]=Gg(t[o],t[o+1]),s[o]=n(e[o],e[o+1]);return function(a){var l=SD(t,a,1,r)-1;return s[l](i[l](a))}}function t7(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function n7(){var t=qE,e=qE,n=ov,r,i,s,o=Ls,a,l,c;function u(){var f=Math.min(t.length,e.length);return o!==Ls&&(o=Q9(t[0],t[f-1])),a=f>2?e7:J9,l=c=null,d}function d(f){return f==null||isNaN(f=+f)?s:(l||(l=a(t.map(r),e,n)))(r(o(f)))}return d.invert=function(f){return o(i((c||(c=a(e,t.map(r),sf)))(f)))},d.domain=function(f){return arguments.length?(t=Array.from(f,Z9),u()):t.slice()},d.range=function(f){return arguments.length?(e=Array.from(f),u()):e.slice()},d.rangeRound=function(f){return e=Array.from(f),n=K9,u()},d.clamp=function(f){return arguments.length?(o=f?!0:Ls,u()):o!==Ls},d.interpolate=function(f){return arguments.length?(n=f,u()):n},d.unknown=function(f){return arguments.length?(s=f,d):s},function(f,h){return r=f,i=h,u()}}function r7(){return n7()(Ls,Ls)}function i7(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function of(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function ho(t){return t=of(Math.abs(t)),t?t[1]:NaN}function s7(t,e){return function(n,r){for(var i=n.length,s=[],o=0,a=t[0],l=0;i>0&&a>0&&(l+a+1>r&&(a=Math.max(1,r-l)),s.push(n.substring(i-=a,i+a)),!((l+=a+1)>r));)a=t[o=(o+1)%t.length];return s.reverse().join(e)}}function o7(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var a7=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function af(t){if(!(e=a7.exec(t)))throw new Error("invalid format: "+t);var e;return new av({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}af.prototype=av.prototype;function av(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}av.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function l7(t){e:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var jC;function c7(t,e){var n=of(t,e);if(!n)return t+"";var r=n[0],i=n[1],s=i-(jC=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return s===o?r:s>o?r+new Array(s-o+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+of(t,Math.max(0,e+s-1))[0]}function ZE(t,e){var n=of(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const QE={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:i7,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>ZE(t*100,e),r:ZE,s:c7,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function JE(t){return t}var ew=Array.prototype.map,tw=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function u7(t){var e=t.grouping===void 0||t.thousands===void 0?JE:s7(ew.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?JE:o7(ew.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",a=t.minus===void 0?"−":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function c(d){d=af(d);var f=d.fill,h=d.align,p=d.sign,m=d.symbol,E=d.zero,v=d.width,g=d.comma,y=d.precision,b=d.trim,T=d.type;T==="n"?(g=!0,T="g"):QE[T]||(y===void 0&&(y=12),b=!0,T="g"),(E||f==="0"&&h==="=")&&(E=!0,f="0",h="=");var A=m==="$"?n:m==="#"&&/[boxX]/.test(T)?"0"+T.toLowerCase():"",R=m==="$"?r:/[%p]/.test(T)?o:"",I=QE[T],D=/[defgprs%]/.test(T);y=y===void 0?6:/[gprs]/.test(T)?Math.max(1,Math.min(21,y)):Math.max(0,Math.min(20,y));function N(F){var q=A,G=R,W,xe,de;if(T==="c")G=I(F)+G,F="";else{F=+F;var Pe=F<0||1/F<0;if(F=isNaN(F)?l:I(Math.abs(F),y),b&&(F=l7(F)),Pe&&+F==0&&p!=="+"&&(Pe=!1),q=(Pe?p==="("?p:a:p==="-"||p==="("?"":p)+q,G=(T==="s"?tw[8+jC/3]:"")+G+(Pe&&p==="("?")":""),D){for(W=-1,xe=F.length;++W<xe;)if(de=F.charCodeAt(W),48>de||de>57){G=(de===46?i+F.slice(W+1):F.slice(W))+G,F=F.slice(0,W);break}}}g&&!E&&(F=e(F,1/0));var z=q.length+F.length+G.length,ne=z<v?new Array(v-z+1).join(f):"";switch(g&&E&&(F=e(ne+F,ne.length?v-G.length:1/0),ne=""),h){case"<":F=q+F+G+ne;break;case"=":F=q+ne+F+G;break;case"^":F=ne.slice(0,z=ne.length>>1)+q+F+G+ne.slice(z);break;default:F=ne+q+F+G;break}return s(F)}return N.toString=function(){return d+""},N}function u(d,f){var h=c((d=af(d),d.type="f",d)),p=Math.max(-8,Math.min(8,Math.floor(ho(f)/3)))*3,m=Math.pow(10,-p),E=tw[8+p/3];return function(v){return h(m*v)+E}}return{format:c,formatPrefix:u}}var Rc,VC,$C;f7({thousands:",",grouping:[3],currency:["$",""]});function f7(t){return Rc=u7(t),VC=Rc.format,$C=Rc.formatPrefix,Rc}function d7(t){return Math.max(0,-ho(Math.abs(t)))}function h7(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(ho(e)/3)))*3-ho(Math.abs(t)))}function p7(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,ho(e)-ho(t))+1}function g7(t,e,n,r){var i=ND(t,e,n),s;switch(r=af(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(s=h7(i,o))&&(r.precision=s),$C(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=p7(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=d7(i))&&(r.precision=s-(r.type==="%")*2);break}}return VC(r)}function m7(t){var e=t.domain;return t.ticks=function(n){var r=e();return OD(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return g7(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,s=r.length-1,o=r[i],a=r[s],l,c,u=10;for(a<o&&(c=o,o=a,a=c,c=i,i=s,s=c);u-- >0;){if(c=sg(o,a,n),c===l)return r[i]=o,r[s]=a,e(r);if(c>0)o=Math.floor(o/c)*c,a=Math.ceil(a/c)*c;else if(c<0)o=Math.ceil(o*c)/c,a=Math.floor(a*c)/c;else break;l=c}return t},t}function Wg(){var t=r7();return t.copy=function(){return t7(t,Wg())},F9.apply(t,arguments),m7(t)}function v7(){const[t,e]=Le(nv),n=gn(EC),r=gn(Al);return S.useEffect(()=>{Object.keys(t).length===0&&(async()=>{const a=await(await fetch("https://raw.githubusercontent.com/YellowRiverDatabase/geodata/main/physical_data/yellow-river-course-changes.geojson")).json();e(a.features)})()},[]),S.useMemo(()=>new rd({id:"river-routes",data:n,pickable:!0,visible:r.Rivers,stroked:!0,extruded:!1,lineWidthMinPixels:5,getLineColor:[0,0,245,66],getLineWidth:5}),[r,n])}const GC={Flood:[255,0,0],Breach:[0,128,0],Drought:[0,0,255],Disaster:[255,255,0],"Intentional Breach":[0,255,255],"Risky situation":[0,255,255],Omen:[255,0,255],"Course change":[255,165,0],"Extinction (river dries up)":[128,0,128],"Blockage (from too much silt)":[0,255,0],"Proposals and Discussion":[255,192,203],"Settlement Relocation":[0,128,128],"Dam/Sluice Opening":[230,230,250],Dredging:[165,42,42],"Using water for a purpose":[245,245,220],Management:[128,0,0],"Repair of Structures":[189,252,201],"Emergency Repair":[128,128,0],"New Construction":[255,215,180],"Fieldtrip/survey":[0,0,128]},Hg={"Flood 溢":"rgb(255, 0, 0)","Breach 決":"rgb(0, 128, 0)","Drought 旱":"rgb(0, 0, 255)","Intentional Breach 毀":"rgb(0, 255, 255)","Risky situation 險":"rgb(0, 255, 255)","Omen 兆":"rgb(255, 0, 255)","Course change 徙":"rgb(255, 165, 0)","Extinction (river dries up) 絕":"rgb(128, 0, 128)","Blockage (from too much silt) 塞":"rgb(0, 255, 0)","Proposals and Discussion 議":"rgb(255, 192, 203)","Settlement Relocation 遷":"rgb(0, 128, 128)","Dam/Sluice Opening 放":"rgb(230, 230, 250)","Dredging 疏":"rgb(165, 42, 42)","Using water for a purpose 助":"rgb(245, 245, 220)","Management 修":"rgb(128, 0, 0)","Repair of Structures 修":"rgb(189, 252, 201)","Emergency Repair 救":"rgb(128, 128, 0)","New Construction 建":"rgb(255, 215, 180)","Fieldtrip/survey 探":"rgb(0, 0, 128)"};function y7(){const[t,e]=Le(wC),n=gn(oH);S.useEffect(()=>{t.length===0&&(async()=>{const a=await(await fetch("https://raw.githubusercontent.com/YellowRiverDatabase/geodata/refs/heads/main/atlas_data/yrdb-places-and-events.json")).json();e(a)})()},[]),S.useEffect(()=>{console.log(t)},[t]);const r=s=>{const o=s.flat().map(u=>Array.from(u.en_type)),a={};o.forEach(u=>u.forEach(d=>a[d]=(a[d]||0)+1));const c=(u=>Object.entries(u).reduce((d,f)=>u[d]>u[f]?d:f))(a);return GC[c[0]]};return S.useMemo(()=>new X0({id:"events-layers",extruded:!0,data:n,pickable:!0,opacity:.8,stroked:!0,filled:!0,radius:9e3,elevationScale:1,lineWidthMinPixels:500,getElevation:s=>300*s.events.length,getPosition:s=>[s.Latitude,s.Longitude],getRadius:s=>1500,getFillColor:s=>r(s.events),getLineColor:s=>[100,0,0]}),[n])}function lf(t){var e=Math.abs(t).toString(),n=t<0?" BCE":" CE";return e+n}function _7(){const[t,e]=Le(SE),n=gn(Al);return S.useEffect(()=>{Object.keys(t).length===0&&(async()=>{const o=await(await fetch("https://raw.githubusercontent.com/YellowRiverDatabase/geodata/main/cultural_data/studyarea.geojson")).json();e(o)})()},[]),S.useMemo(()=>new rd({id:"study-border",data:t,pickable:!1,visible:n["Study Area"],stroked:!0,extruded:!1,lineWidthMinPixels:1,getFillColor:[39,106,245,44],getLineWidth:0}),[n,SE,t])}const E7={flexDirection:"column",position:"absolute",top:"11%",left:"5px",backgroundColor:"white",color:"black",justifyContent:"center",alignItems:"center",maxHeight:"65vh",padding:"2em",border:"1px solid black",borderRadius:"10px",overflow:"auto",zIndex:999},w7={maxHeight:"60%",overflow:"auto",position:"relative"},b7={display:"flex",justifyContent:"center",color:"black",alignItems:"center",height:"3em"},Gh={cursor:"pointer",border:"1px solid black",padding:"0.5em"},x7={position:"absolute",right:"10px",top:"10px",cursor:"pointer",border:"1px solid black",padding:"5px",borderRadius:"5px",backgroundColor:"lightgray"};function S7(){const[t,e]=Le(pC),n=gn(gC),r=gn(mC),[i,s]=Le(_C),[o,a]=Le(yC),l=S.useMemo(()=>[...n].sort((c,u)=>+c.en_date_start-+u.en_date_start),[n]);return t?C.jsxs(C.Fragment,{children:[C.jsxs("div",{style:E7,children:[C.jsxs("div",{style:b7,children:[C.jsx("h1",{children:r}),C.jsx("div",{style:x7,onClick:()=>e(!1),children:"×"})]}),C.jsxs("table",{style:w7,children:[C.jsx("thead",{children:C.jsxs("tr",{children:[C.jsx("th",{children:"Date"}),C.jsx("th",{children:"Event"}),C.jsx("th",{children:"Category"})]})}),C.jsx("tbody",{children:l.map((c,u)=>{const d=c[0];return C.jsxs("tr",{onClick:()=>{s({place:r,...d}),a(!0)},children:[C.jsx("td",{style:Gh,children:lf(d.en_date_start)}),C.jsx("td",{style:Gh,children:d.en_cat}),C.jsx("td",{style:Gh,children:d.en_type})]},`table-row-${u}`)})})]})]}),")"]}):null}function T7(t){let e;for(;e=t.sourceEvent;)t=e;return t}function nw(t,e){if(t=T7(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}const Yg=Math.PI,Xg=2*Yg,wi=1e-6,A7=Xg-wi;function WC(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function C7(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return WC;const n=10**e;return function(r){this._+=r[0];for(let i=1,s=r.length;i<s;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class P7{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?WC:C7(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,i){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(e,n,r,i,s,o){this._append`C${+e},${+n},${+r},${+i},${this._x1=+s},${this._y1=+o}`}arcTo(e,n,r,i,s){if(e=+e,n=+n,r=+r,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,a=this._y1,l=r-e,c=i-n,u=o-e,d=a-n,f=u*u+d*d;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(f>wi)if(!(Math.abs(d*l-c*u)>wi)||!s)this._append`L${this._x1=e},${this._y1=n}`;else{let h=r-o,p=i-a,m=l*l+c*c,E=h*h+p*p,v=Math.sqrt(m),g=Math.sqrt(f),y=s*Math.tan((Yg-Math.acos((m+f-E)/(2*v*g)))/2),b=y/g,T=y/v;Math.abs(b-1)>wi&&this._append`L${e+b*u},${n+b*d}`,this._append`A${s},${s},0,0,${+(d*h>u*p)},${this._x1=e+T*l},${this._y1=n+T*c}`}}arc(e,n,r,i,s,o){if(e=+e,n=+n,r=+r,o=!!o,r<0)throw new Error(`negative radius: ${r}`);let a=r*Math.cos(i),l=r*Math.sin(i),c=e+a,u=n+l,d=1^o,f=o?i-s:s-i;this._x1===null?this._append`M${c},${u}`:(Math.abs(this._x1-c)>wi||Math.abs(this._y1-u)>wi)&&this._append`L${c},${u}`,r&&(f<0&&(f=f%Xg+Xg),f>A7?this._append`A${r},${r},0,1,${d},${e-a},${n-l}A${r},${r},0,1,${d},${this._x1=c},${this._y1=u}`:f>wi&&this._append`A${r},${r},0,${+(f>=Yg)},${d},${this._x1=e+r*Math.cos(s)},${this._y1=n+r*Math.sin(s)}`)}rect(e,n,r,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function fs(t){return function(){return t}}function R7(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new P7(e)}function L7(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function HC(t){this._context=t}HC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function M7(t){return new HC(t)}function k7(t){return t[0]}function I7(t){return t[1]}function O7(t,e){var n=fs(!0),r=null,i=M7,s=null,o=R7(a);t=typeof t=="function"?t:t===void 0?k7:fs(t),e=typeof e=="function"?e:e===void 0?I7:fs(e);function a(l){var c,u=(l=L7(l)).length,d,f=!1,h;for(r==null&&(s=i(h=o())),c=0;c<=u;++c)!(c<u&&n(d=l[c],c,l))===f&&((f=!f)?s.lineStart():s.lineEnd()),f&&s.point(+t(d,c,l),+e(d,c,l));if(h)return s=null,h+""||null}return a.x=function(l){return arguments.length?(t=typeof l=="function"?l:fs(+l),a):t},a.y=function(l){return arguments.length?(e=typeof l=="function"?l:fs(+l),a):e},a.defined=function(l){return arguments.length?(n=typeof l=="function"?l:fs(!!l),a):n},a.curve=function(l){return arguments.length?(i=l,r!=null&&(s=i(r)),a):i},a.context=function(l){return arguments.length?(l==null?r=s=null:s=i(r=l),a):r},a}function oa(t,e,n){this.k=t,this.x=e,this.y=n}oa.prototype={constructor:oa,scale:function(t){return t===1?this:new oa(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new oa(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};oa.prototype;const N7={display:"flex",flexDirection:"column",gap:"1em",alignItems:"center",maxHeight:"80vh",top:"12%",right:"10px",zIndex:2,backgroundColor:"white",padding:"10px",paddingBottom:"25px",color:"black",border:"1px solid black",borderRadius:"10px"},D7={display:"flex",flexDirection:"row",gap:"1em",alignItems:"space-between",width:"100%",overflow:"auto"},F7={width:"50%"},Lc={backgroundColor:"lightgrey",color:"black",border:"solid black 1px",fontSize:"1.1em",padding:"10px",borderRadius:"5px"},U7={display:"flex",flexDirection:"row",gap:"1em",width:"100%",justifyContent:"space-around"},rw={backgroundColor:"blue",color:"white"},B7={alignSelf:"flex-end"},z7={backgroundColor:"white",color:"black",border:"solid black 1px",padding:"5px",borderRadius:"5px"},j7={height:"25px",width:"25px",justifySelf:"end",position:"absolute",right:"0px",top:"0px"},iw={display:"flex",flexDirection:"column",gap:"5px",justifyContent:"start"};function V7(){var p;const t=ve.useRef(),[e,n]=ve.useState(!1),r=[["Flood","溢"],["Breach","決"],["Drought","旱"],["Intentional Breach","毀"],["Risky situation","險"],["Omen","兆"],["Course change","徙"]],i=[["Proposals and Discussion","議"],["Settlement Relocation","遷"],["Dam/Sluice Opening","放"],["Dredging","疏"],["Using water for a purpose","助"],["Repair of Structures","修"],["Emergency Repair","救"],["New Construction","建"],["Fieldtrip/survey","探"]];(p=t==null?void 0:t.current)==null||p.offsetWidth;const[s,o]=Le(xC),a=()=>{n(!e)},[l,c]=ve.useState(!1),[u,d]=ve.useState(!1);S.useEffect(()=>{if(u===!0){o({...s,"Proposals and Discussion":!0,"Settlement Relocation":!0,"Movement of refugeess":!0,"Dam/Sluice Opening":!0,Dredging:!0,"Using water for a purpose":!0,"Repair of Structures":!0,"Emergency Repair":!0,"New Construction":!0,"Fieldtrip/survey":!0});return}if(u===!1){o({...s,"Proposals and Discussion":!1,"Settlement Relocation":!1,"Movement of refugeess":!1,"Dam/Sluice Opening":!1,Dredging:!1,"Using water for a purpose":!1,"Repair of Structures":!1,"Emergency Repair":!1,"New Construction":!1,"Fieldtrip/survey":!1});return}},[u]),S.useEffect(()=>{if(l===!0){o({...s,Flood:!0,Drought:!0,Breach:!0,"Intentional Breach":!0,"Risky situation":!0,Omen:!0,"Course change":!0,Extinction:!0,Blockage:!0});return}if(l===!1){o({...s,Flood:!1,Drought:!1,Breach:!1,"Intentional Breach":!1,"Risky situation":!1,Omen:!1,"Course change":!1,Extinction:!1,Blockage:!1});return}},[l]);const f=()=>{c(!l)},h=()=>{d(!u)};return e?C.jsx(C.Fragment,{children:C.jsxs("div",{style:N7,ref:t,children:[C.jsxs("div",{style:{display:"flex",width:"100%",justifyContent:"center",position:"relative"},children:[C.jsx("h3",{style:{flex:1,textAlign:"center"},children:"Filter Types"}),C.jsx("button",{style:j7,className:"rounded border-dark",onClick:a,children:C.jsx("strong",{children:"×"})})]}),C.jsxs("div",{style:U7,children:[C.jsx("button",{type:"button",id:"disasters",onClick:f,style:l?{...Lc,...rw}:{...Lc},children:"Disasters 水災"}),C.jsx("button",{type:"button",onClick:h,style:u?{...Lc,...rw}:{...Lc},children:"Management 水利"})]}),C.jsx("hr",{style:F7}),C.jsxs("div",{style:D7,children:[C.jsx("div",{style:iw,children:r.map((m,E)=>(console.log(m.join(" ")),C.jsxs("button",{type:"button",id:m,style:s[m[0]]?{backgroundColor:Hg[m.join(" ")]}:null,className:"border-dark rounded",value:m[0],onClick:()=>{o({...s,[m[0]]:!s[m[0]]})},children:[m[0]," ",m[1]]},`type-${E}`)))}),C.jsx("div",{style:iw,children:i.map((m,E)=>C.jsxs("button",{type:"button",id:m[0],style:s[m[0]]?{backgroundColor:Hg[m.join(" ")]}:null,className:"border-dark rounded",value:m,onClick:()=>{o({...s,[m[0]]:!s[m[0]]})},children:[m[0]," ",m[1]]},`type-${E}`))})]})]})}):C.jsx("div",{style:B7,children:C.jsx("button",{style:z7,onClick:a,children:"Filters"})})}function $7(){return`<svg
      xmlns="http://www.w3.org/2000/svg"
      height="24px"
      viewBox="0 -960 960 960"
      width="24px"
      fill="black"
    >
      <path d="M480-360q50 0 85-35t35-85q0-50-35-85t-85-35q-50 0-85 35t-35 85q0 50 35 85t85 35Zm0 280q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z" />
    </svg>`}function G7(t){return`data:image/svg+xml;charset=utf-8,${encodeURIComponent(t)}`}function W7(){const t=gn(Al),[e,n]=Le(TC),r=gn(aH),[i,s]=Le(sd);return S.useEffect(()=>{(async()=>{const c=await(await fetch("https://raw.githubusercontent.com/YellowRiverDatabase/geodata/main/atlas_data/upstream-data.json")).json();n(c)})()},[]),S.useEffect(()=>{const l=[...new Set(e.map(u=>u.date))].sort((u,d)=>d-u),c=Object.fromEntries(l.map(u=>[u,!1]));s(c)},[e]),new Tl({id:"upstream-layer",data:r,pickable:!0,sizeScale:10,visibility:t["Upstream Places"],getPosition:a=>[a.x_coor,a.y_coor],getIcon:a=>({url:G7($7()),width:250,height:250,mask:!0}),getSize:a=>a.size})}function H7(t){return t.split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}function Y7(){const[t,e]=Le(JW);Le(Al),Le(iH),Le(nv),Le(sH),gn(EC);const n=gn(SC),[r,i]=Le(gC),[s,o]=Le(pC),[a,l]=Le(mC);return S.useEffect(()=>{},[n]),C.jsxs(C.Fragment,{children:[C.jsx(QW,{viewState:{...t},style:{position:"relative",zIndex:1},controller:!0,map:!0,layers:[y7(),v7(),_7(),W7()],onViewStateChange:c=>{e(c.viewState)},onClick:c=>{c.object&&c.object.events&&(i(c.object.events),l(`${H7(c.object.ch_pinyin)} ${c.object.tr_title}`),o(!0))},getTooltip:({object:c})=>{if(c&&c.properties)return c.properties.yearstart+" - "+c.properties.yearend;if(c&&!c.properties&&c.events)return`${c.ch_pinyin} (${c.ft_id}): ${c.events.length} events from ${lf(FD(c.events.map(u=>Object.values(u).flat().map(d=>d.en_date_start)).flat(),u=>u))} to ${lf(DD(c.events.map(u=>Object.values(u).flat().map(d=>d.en_date_start)).flat(),u=>u))}`},children:C.jsx(S9,{reuseMaps:!0,mapStyle:"mapbox://styles/nkmwicz123/clsg5aqky03gr01pb30cmebxd",preventStyleDiffing:!0,mapboxAccessToken:"pk.eyJ1Ijoibmttd2ljejEyMyIsImEiOiJjbHNnM2ZzOHkxdm1lMmpwZDhvZjg0c2k1In0.LNAvpGf1bQbrhcDT2QC4dg"})}),C.jsx(S7,{})]})}function X7(){const[t,e]=Le(vC),[n,r]=S.useState();S.useEffect(()=>{function h(){r(window.innerWidth)}return window.addEventListener("resize",h),()=>{window.removeEventListener("resize",h)}}),S.useRef();const i=()=>{e(!1)},s={position:"absolute",top:0,left:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100vh",width:"100vw",zIndex:"100",backgroundColor:"rgba(0, 0, 0, 0.5)"},o={display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundColor:"white",border:"1px solid grey",borderRadius:"10px",padding:"10px",zIndex:200},a={width:"100%",height:"100%",border:"none",zIndex:999,justifyContent:"space-between"},l={width:"500px"},c={textAlign:"center",color:"black",margin:"0 20px"},u={display:"flex",flexDirection:"column",justifyContent:"start",width:"100%",marginBottom:"20px"},d={width:"20%",minWidth:"75px",borderRadius:"5px"},f={color:"black",margin:"20px"};return C.jsx(C.Fragment,{children:t?C.jsx("div",{style:s,children:C.jsxs("div",{style:{...o,...window.innerWidth<=500?a:l},children:[C.jsxs("section",{style:u,children:[C.jsxs("h2",{style:c,children:["Welcome to the Web Atlas",C.jsx("br",{}),"for the Yellow River Database"]}),C.jsx("p",{style:f,children:"There will be more content here as we write a simple description."})]}),C.jsx("button",{style:d,className:"",onClick:i,children:n>500?"Close":"Go to Web Atlas"})]})}):null})}const K7={display:"flex",justifyContent:"space-between",alignItems:"center"},q7={flex:"0 0 20px",height:"20px",width:"20px"},Z7={marginLeft:"8px"};function Q7({checked:t,onChange:e,label:n}){return C.jsxs("label",{style:K7,children:[C.jsx("input",{type:"checkbox",checked:t,onChange:e,style:q7}),C.jsx("span",{style:Z7,children:n})]})}const J7={zIndex:1,color:"black",backgroundColor:"white",padding:"10px",border:"1px solid black",borderRadius:"5px",width:"150px",alignSelf:"end"};function eY(){Le(eH);const[t,e]=Le(Al);return C.jsx("div",{style:J7,children:C.jsx("div",{children:Object.keys(t).map(n=>{function r(i){e({...t,[n]:i.target.checked})}return C.jsx(Q7,{value:n,label:n,checked:t[n],onChange:r},n)})})})}var YC={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(t){(function(){var e={}.hasOwnProperty;function n(){for(var s="",o=0;o<arguments.length;o++){var a=arguments[o];a&&(s=i(s,r(a)))}return s}function r(s){if(typeof s=="string"||typeof s=="number")return s;if(typeof s!="object")return"";if(Array.isArray(s))return n.apply(null,s);if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]"))return s.toString();var o="";for(var a in s)e.call(s,a)&&s[a]&&(o=i(o,a));return o}function i(s,o){return o?s?s+" "+o:s+o:s}t.exports?(n.default=n,t.exports=n):window.classNames=n})()})(YC);var tY=YC.exports;const ft=po(tY),nY=["as","disabled"];function rY(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function iY(t){return!t||t.trim()==="#"}function XC({tagName:t,disabled:e,href:n,target:r,rel:i,role:s,onClick:o,tabIndex:a=0,type:l}){t||(n!=null||r!=null||i!=null?t="a":t="button");const c={tagName:t};if(t==="button")return[{type:l||"button",disabled:e},c];const u=f=>{if((e||t==="a"&&iY(n))&&f.preventDefault(),e){f.stopPropagation();return}o==null||o(f)},d=f=>{f.key===" "&&(f.preventDefault(),u(f))};return t==="a"&&(n||(n="#"),e&&(n=void 0)),[{role:s??"button",disabled:void 0,tabIndex:e?void 0:a,href:n,target:t==="a"?r:void 0,"aria-disabled":e||void 0,rel:t==="a"?i:void 0,onClick:u,onKeyDown:d},c]}const KC=S.forwardRef((t,e)=>{let{as:n,disabled:r}=t,i=rY(t,nY);const[s,{tagName:o}]=XC(Object.assign({tagName:n,disabled:r},i));return C.jsx(o,Object.assign({},i,s,{ref:e}))});KC.displayName="Button";const sY=["xxl","xl","lg","md","sm","xs"],oY="xs",aY=S.createContext({prefixes:{},breakpoints:sY,minBreakpoint:oY});function Vt(t,e){const{prefixes:n}=S.useContext(aY);return t||n[e]||e}const qC=S.forwardRef(({bsPrefix:t,fluid:e=!1,as:n="div",className:r,...i},s)=>{const o=Vt(t,"container"),a=typeof e=="string"?`-${e}`:"-fluid";return C.jsx(n,{ref:s,...i,className:ft(r,e?`${o}${a}`:o)})});qC.displayName="Container";const lY=qC;var sw={exports:{}},Kg={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=n;function n(r){function i(o,a,l,c,u,d){var f=c||"<<anonymous>>",h=d||l;if(a[l]==null)return o?new Error("Required "+u+" `"+h+"` was not specified "+("in `"+f+"`.")):null;for(var p=arguments.length,m=Array(p>6?p-6:0),E=6;E<p;E++)m[E-6]=arguments[E];return r.apply(void 0,[a,l,f,u,h].concat(m))}var s=i.bind(null,!1);return s.isRequired=i.bind(null,!0),s}t.exports=e.default})(Kg,Kg.exports);var cY=Kg.exports;(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=s;var n=cY,r=i(n);function i(o){return o&&o.__esModule?o:{default:o}}function s(){for(var o=arguments.length,a=Array(o),l=0;l<o;l++)a[l]=arguments[l];function c(){for(var u=arguments.length,d=Array(u),f=0;f<u;f++)d[f]=arguments[f];var h=null;return a.forEach(function(p){if(h==null){var m=p.apply(void 0,d);m!=null&&(h=m)}}),h}return(0,r.default)(c)}t.exports=e.default})(sw,sw.exports);function qg(){return qg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},qg.apply(null,arguments)}function ZC(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.includes(r))continue;n[r]=t[r]}return n}function ow(t){return"default"+t.charAt(0).toUpperCase()+t.substr(1)}function uY(t){var e=fY(t,"string");return typeof e=="symbol"?e:String(e)}function fY(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dY(t,e,n){var r=S.useRef(t!==void 0),i=S.useState(e),s=i[0],o=i[1],a=t!==void 0,l=r.current;return r.current=a,!a&&l&&s!==e&&o(e),[a?t:s,S.useCallback(function(c){for(var u=arguments.length,d=new Array(u>1?u-1:0),f=1;f<u;f++)d[f-1]=arguments[f];n&&n.apply(void 0,[c].concat(d)),o(c)},[n])]}function QC(t,e){return Object.keys(e).reduce(function(n,r){var i,s=n,o=s[ow(r)],a=s[r],l=ZC(s,[ow(r),r].map(uY)),c=e[r],u=dY(a,o,t[c]),d=u[0],f=u[1];return qg({},l,(i={},i[r]=d,i[c]=f,i))},t)}function Zg(t,e){return Zg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Zg(t,e)}function hY(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,Zg(t,e)}var pY=Function.prototype.bind.call(Function.prototype.call,[].slice);function bi(t,e){return pY(t.querySelectorAll(e))}function gY(){const[,t]=S.useReducer(e=>!e,!1);return t}const aw=t=>!t||typeof t=="function"?t:e=>{t.current=e};function mY(t,e){const n=aw(t),r=aw(e);return i=>{n&&n(i),r&&r(i)}}function Rl(t,e){return S.useMemo(()=>mY(t,e),[t,e])}const JC=S.createContext(null);JC.displayName="NavContext";const eP=JC,vY=S.createContext(null),lv=(t,e=null)=>t!=null?String(t):e||null,cf=vY,yY=S.createContext(null),tP=yY,_Y="data-rr-ui-",EY="rrUi";function ud(t){return`${_Y}${t}`}function wY(t){return`${EY}${t}`}function bY(t){const e=S.useRef(t);return S.useEffect(()=>{e.current=t},[t]),e}function qt(t){const e=bY(t);return S.useCallback(function(...n){return e.current&&e.current(...n)},[e])}const xY=["as","active","eventKey"];function SY(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function nP({key:t,onClick:e,active:n,id:r,role:i,disabled:s}){const o=S.useContext(cf),a=S.useContext(eP),l=S.useContext(tP);let c=n;const u={role:i};if(a){!i&&a.role==="tablist"&&(u.role="tab");const d=a.getControllerId(t??null),f=a.getControlledId(t??null);u[ud("event-key")]=t,u.id=d||r,c=n==null&&t!=null?a.activeKey===t:n,(c||!(l!=null&&l.unmountOnExit)&&!(l!=null&&l.mountOnEnter))&&(u["aria-controls"]=f)}return u.role==="tab"&&(u["aria-selected"]=c,c||(u.tabIndex=-1),s&&(u.tabIndex=-1,u["aria-disabled"]=!0)),u.onClick=qt(d=>{s||(e==null||e(d),t!=null&&o&&!d.isPropagationStopped()&&o(t,d))}),[u,{isActive:c}]}const rP=S.forwardRef((t,e)=>{let{as:n=KC,active:r,eventKey:i}=t,s=SY(t,xY);const[o,a]=nP(Object.assign({key:lv(i,s.href),active:r},s));return o[ud("active")]=a.isActive,C.jsx(n,Object.assign({},s,o,{ref:e}))});rP.displayName="NavItem";const TY=rP,AY=["as","onSelect","activeKey","role","onKeyDown"];function CY(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}const lw=()=>{},cw=ud("event-key"),iP=S.forwardRef((t,e)=>{let{as:n="div",onSelect:r,activeKey:i,role:s,onKeyDown:o}=t,a=CY(t,AY);const l=gY(),c=S.useRef(!1),u=S.useContext(cf),d=S.useContext(tP);let f,h;d&&(s=s||"tablist",i=d.activeKey,f=d.getControlledId,h=d.getControllerId);const p=S.useRef(null),m=y=>{const b=p.current;if(!b)return null;const T=bi(b,`[${cw}]:not([aria-disabled=true])`),A=b.querySelector("[aria-selected=true]");if(!A||A!==document.activeElement)return null;const R=T.indexOf(A);if(R===-1)return null;let I=R+y;return I>=T.length&&(I=0),I<0&&(I=T.length-1),T[I]},E=(y,b)=>{y!=null&&(r==null||r(y,b),u==null||u(y,b))},v=y=>{if(o==null||o(y),!d)return;let b;switch(y.key){case"ArrowLeft":case"ArrowUp":b=m(-1);break;case"ArrowRight":case"ArrowDown":b=m(1);break;default:return}b&&(y.preventDefault(),E(b.dataset[wY("EventKey")]||null,y),c.current=!0,l())};S.useEffect(()=>{if(p.current&&c.current){const y=p.current.querySelector(`[${cw}][aria-selected=true]`);y==null||y.focus()}c.current=!1});const g=Rl(e,p);return C.jsx(cf.Provider,{value:E,children:C.jsx(eP.Provider,{value:{role:s,activeKey:lv(i),getControlledId:f||lw,getControllerId:h||lw},children:C.jsx(n,Object.assign({},a,{onKeyDown:v,ref:g,role:s}))})})});iP.displayName="Nav";const PY=Object.assign(iP,{Item:TY}),sP=S.createContext(null);sP.displayName="NavbarContext";const Ll=sP,oP=S.createContext(null);oP.displayName="CardHeaderContext";const RY=oP,aP=S.forwardRef(({className:t,bsPrefix:e,as:n="div",...r},i)=>(e=Vt(e,"nav-item"),C.jsx(n,{ref:i,className:ft(t,e),...r})));aP.displayName="NavItem";const LY=aP;function MY(){const t=S.useRef(!0),e=S.useRef(()=>t.current);return S.useEffect(()=>(t.current=!0,()=>{t.current=!1}),[]),e.current}function kY(t){const e=S.useRef(null);return S.useEffect(()=>{e.current=t}),e.current}const IY=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",OY=typeof document<"u",Qg=OY||IY?S.useLayoutEffect:S.useEffect,NY=["onKeyDown"];function DY(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function FY(t){return!t||t.trim()==="#"}const lP=S.forwardRef((t,e)=>{let{onKeyDown:n}=t,r=DY(t,NY);const[i]=XC(Object.assign({tagName:"a"},r)),s=qt(o=>{i.onKeyDown(o),n==null||n(o)});return FY(r.href)||r.role==="button"?C.jsx("a",Object.assign({ref:e},r,i,{onKeyDown:s})):C.jsx("a",Object.assign({ref:e},r,{onKeyDown:n}))});lP.displayName="Anchor";const UY=lP,cP=S.forwardRef(({bsPrefix:t,className:e,as:n=UY,active:r,eventKey:i,disabled:s=!1,...o},a)=>{t=Vt(t,"nav-link");const[l,c]=nP({key:lv(i,o.href),active:r,disabled:s,...o});return C.jsx(n,{...o,...l,ref:a,disabled:s,className:ft(e,t,s&&"disabled",c.isActive&&"active")})});cP.displayName="NavLink";const BY=cP,uP=S.forwardRef((t,e)=>{const{as:n="div",bsPrefix:r,variant:i,fill:s=!1,justify:o=!1,navbar:a,navbarScroll:l,className:c,activeKey:u,...d}=QC(t,{activeKey:"onSelect"}),f=Vt(r,"nav");let h,p,m=!1;const E=S.useContext(Ll),v=S.useContext(RY);return E?(h=E.bsPrefix,m=a??!0):v&&({cardHeaderBsPrefix:p}=v),C.jsx(PY,{as:n,ref:e,activeKey:u,className:ft(c,{[f]:!m,[`${h}-nav`]:m,[`${h}-nav-scroll`]:m&&l,[`${p}-${i}`]:!!p,[`${f}-${i}`]:!!i,[`${f}-fill`]:s,[`${f}-justified`]:o}),...d})});uP.displayName="Nav";const Wh=Object.assign(uP,{Item:LY,Link:BY}),fP=S.forwardRef(({bsPrefix:t,className:e,as:n,...r},i)=>{t=Vt(t,"navbar-brand");const s=n||(r.href?"a":"span");return C.jsx(s,{...r,ref:i,className:ft(e,t)})});fP.displayName="NavbarBrand";const zY=fP;function cv(t){return t&&t.ownerDocument||document}function jY(t){var e=cv(t);return e&&e.defaultView||window}function VY(t,e){return jY(t).getComputedStyle(t,e)}var $Y=/([A-Z])/g;function GY(t){return t.replace($Y,"-$1").toLowerCase()}var WY=/^ms-/;function Mc(t){return GY(t).replace(WY,"-ms-")}var HY=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function YY(t){return!!(t&&HY.test(t))}function cr(t,e){var n="",r="";if(typeof e=="string")return t.style.getPropertyValue(Mc(e))||VY(t).getPropertyValue(Mc(e));Object.keys(e).forEach(function(i){var s=e[i];!s&&s!==0?t.style.removeProperty(Mc(i)):YY(i)?r+=i+"("+s+") ":n+=Mc(i)+": "+s+";"}),r&&(n+="transform: "+r+";"),t.style.cssText+=";"+n}const uw={disabled:!1},dP=ve.createContext(null);var XY=function(e){return e.scrollTop},aa="unmounted",Ur="exited",bn="entering",sr="entered",el="exiting",xr=function(t){hY(e,t);function e(r,i){var s;s=t.call(this,r,i)||this;var o=i,a=o&&!o.isMounting?r.enter:r.appear,l;return s.appearStatus=null,r.in?a?(l=Ur,s.appearStatus=bn):l=sr:r.unmountOnExit||r.mountOnEnter?l=aa:l=Ur,s.state={status:l},s.nextCallback=null,s}e.getDerivedStateFromProps=function(i,s){var o=i.in;return o&&s.status===aa?{status:Ur}:null};var n=e.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(i){var s=null;if(i!==this.props){var o=this.state.status;this.props.in?o!==bn&&o!==sr&&(s=bn):(o===bn||o===sr)&&(s=el)}this.updateStatus(!1,s)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var i=this.props.timeout,s,o,a;return s=o=a=i,i!=null&&typeof i!="number"&&(s=i.exit,o=i.enter,a=i.appear!==void 0?i.appear:o),{exit:s,enter:o,appear:a}},n.updateStatus=function(i,s){if(i===void 0&&(i=!1),s!==null)if(this.cancelNextCallback(),s===bn){if(this.props.unmountOnExit||this.props.mountOnEnter){var o=this.props.nodeRef?this.props.nodeRef.current:Pi.findDOMNode(this);o&&XY(o)}this.performEnter(i)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Ur&&this.setState({status:aa})},n.performEnter=function(i){var s=this,o=this.props.enter,a=this.context?this.context.isMounting:i,l=this.props.nodeRef?[a]:[Pi.findDOMNode(this),a],c=l[0],u=l[1],d=this.getTimeouts(),f=a?d.appear:d.enter;if(!i&&!o||uw.disabled){this.safeSetState({status:sr},function(){s.props.onEntered(c)});return}this.props.onEnter(c,u),this.safeSetState({status:bn},function(){s.props.onEntering(c,u),s.onTransitionEnd(f,function(){s.safeSetState({status:sr},function(){s.props.onEntered(c,u)})})})},n.performExit=function(){var i=this,s=this.props.exit,o=this.getTimeouts(),a=this.props.nodeRef?void 0:Pi.findDOMNode(this);if(!s||uw.disabled){this.safeSetState({status:Ur},function(){i.props.onExited(a)});return}this.props.onExit(a),this.safeSetState({status:el},function(){i.props.onExiting(a),i.onTransitionEnd(o.exit,function(){i.safeSetState({status:Ur},function(){i.props.onExited(a)})})})},n.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(i,s){s=this.setNextCallback(s),this.setState(i,s)},n.setNextCallback=function(i){var s=this,o=!0;return this.nextCallback=function(a){o&&(o=!1,s.nextCallback=null,i(a))},this.nextCallback.cancel=function(){o=!1},this.nextCallback},n.onTransitionEnd=function(i,s){this.setNextCallback(s);var o=this.props.nodeRef?this.props.nodeRef.current:Pi.findDOMNode(this),a=i==null&&!this.props.addEndListener;if(!o||a){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var l=this.props.nodeRef?[this.nextCallback]:[o,this.nextCallback],c=l[0],u=l[1];this.props.addEndListener(c,u)}i!=null&&setTimeout(this.nextCallback,i)},n.render=function(){var i=this.state.status;if(i===aa)return null;var s=this.props,o=s.children;s.in,s.mountOnEnter,s.unmountOnExit,s.appear,s.enter,s.exit,s.timeout,s.addEndListener,s.onEnter,s.onEntering,s.onEntered,s.onExit,s.onExiting,s.onExited,s.nodeRef;var a=ZC(s,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return ve.createElement(dP.Provider,{value:null},typeof o=="function"?o(i,a):ve.cloneElement(ve.Children.only(o),a))},e}(ve.Component);xr.contextType=dP;xr.propTypes={};function ds(){}xr.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:ds,onEntering:ds,onEntered:ds,onExit:ds,onExiting:ds,onExited:ds};xr.UNMOUNTED=aa;xr.EXITED=Ur;xr.ENTERING=bn;xr.ENTERED=sr;xr.EXITING=el;const KY=xr,fd=!!(typeof window<"u"&&window.document&&window.document.createElement);var Jg=!1,em=!1;try{var Hh={get passive(){return Jg=!0},get once(){return em=Jg=!0}};fd&&(window.addEventListener("test",Hh,Hh),window.removeEventListener("test",Hh,!0))}catch{}function qY(t,e,n,r){if(r&&typeof r!="boolean"&&!em){var i=r.once,s=r.capture,o=n;!em&&i&&(o=n.__once||function a(l){this.removeEventListener(e,a,s),n.call(this,l)},n.__once=o),t.addEventListener(e,o,Jg?r:s)}t.addEventListener(e,n,r)}function ZY(t,e,n,r){var i=r&&typeof r!="boolean"?r.capture:r;t.removeEventListener(e,n,i),n.__once&&t.removeEventListener(e,n.__once,i)}function uf(t,e,n,r){return qY(t,e,n,r),function(){ZY(t,e,n,r)}}function QY(t,e,n,r){if(n===void 0&&(n=!1),r===void 0&&(r=!0),t){var i=document.createEvent("HTMLEvents");i.initEvent(e,n,r),t.dispatchEvent(i)}}function JY(t){var e=cr(t,"transitionDuration")||"",n=e.indexOf("ms")===-1?1e3:1;return parseFloat(e)*n}function eX(t,e,n){n===void 0&&(n=5);var r=!1,i=setTimeout(function(){r||QY(t,"transitionend",!0)},e+n),s=uf(t,"transitionend",function(){r=!0},{once:!0});return function(){clearTimeout(i),s()}}function tX(t,e,n,r){n==null&&(n=JY(t)||0);var i=eX(t,n,r),s=uf(t,"transitionend",e);return function(){i(),s()}}function fw(t,e){const n=cr(t,e)||"",r=n.indexOf("ms")===-1?1e3:1;return parseFloat(n)*r}function uv(t,e){const n=fw(t,"transitionDuration"),r=fw(t,"transitionDelay"),i=tX(t,s=>{s.target===t&&(i(),e(s))},n+r)}function qo(...t){return t.filter(e=>e!=null).reduce((e,n)=>{if(typeof n!="function")throw new Error("Invalid Argument Type, must only provide functions, undefined, or null.");return e===null?n:function(...i){e.apply(this,i),n.apply(this,i)}},null)}function hP(t){t.offsetHeight}function nX(t){return t&&"setState"in t?Pi.findDOMNode(t):t??null}const rX=ve.forwardRef(({onEnter:t,onEntering:e,onEntered:n,onExit:r,onExiting:i,onExited:s,addEndListener:o,children:a,childRef:l,...c},u)=>{const d=S.useRef(null),f=Rl(d,l),h=A=>{f(nX(A))},p=A=>R=>{A&&d.current&&A(d.current,R)},m=S.useCallback(p(t),[t]),E=S.useCallback(p(e),[e]),v=S.useCallback(p(n),[n]),g=S.useCallback(p(r),[r]),y=S.useCallback(p(i),[i]),b=S.useCallback(p(s),[s]),T=S.useCallback(p(o),[o]);return C.jsx(KY,{ref:u,...c,onEnter:m,onEntered:v,onEntering:E,onExit:g,onExited:b,onExiting:y,addEndListener:T,nodeRef:d,children:typeof a=="function"?(A,R)=>a(A,{...R,ref:h}):ve.cloneElement(a,{ref:h})})}),fv=rX,iX={height:["marginTop","marginBottom"],width:["marginLeft","marginRight"]};function sX(t,e){const n=`offset${t[0].toUpperCase()}${t.slice(1)}`,r=e[n],i=iX[t];return r+parseInt(cr(e,i[0]),10)+parseInt(cr(e,i[1]),10)}const oX={[Ur]:"collapse",[el]:"collapsing",[bn]:"collapsing",[sr]:"collapse show"},aX=ve.forwardRef(({onEnter:t,onEntering:e,onEntered:n,onExit:r,onExiting:i,className:s,children:o,dimension:a="height",in:l=!1,timeout:c=300,mountOnEnter:u=!1,unmountOnExit:d=!1,appear:f=!1,getDimensionValue:h=sX,...p},m)=>{const E=typeof a=="function"?a():a,v=S.useMemo(()=>qo(A=>{A.style[E]="0"},t),[E,t]),g=S.useMemo(()=>qo(A=>{const R=`scroll${E[0].toUpperCase()}${E.slice(1)}`;A.style[E]=`${A[R]}px`},e),[E,e]),y=S.useMemo(()=>qo(A=>{A.style[E]=null},n),[E,n]),b=S.useMemo(()=>qo(A=>{A.style[E]=`${h(E,A)}px`,hP(A)},r),[r,h,E]),T=S.useMemo(()=>qo(A=>{A.style[E]=null},i),[E,i]);return C.jsx(fv,{ref:m,addEndListener:uv,...p,"aria-expanded":p.role?l:null,onEnter:v,onEntering:g,onEntered:y,onExit:b,onExiting:T,childRef:o.ref,in:l,timeout:c,mountOnEnter:u,unmountOnExit:d,appear:f,children:(A,R)=>ve.cloneElement(o,{...R,className:ft(s,o.props.className,oX[A],E==="width"&&"collapse-horizontal")})})}),lX=aX,pP=S.forwardRef(({children:t,bsPrefix:e,...n},r)=>{e=Vt(e,"navbar-collapse");const i=S.useContext(Ll);return C.jsx(lX,{in:!!(i&&i.expanded),...n,children:C.jsx("div",{ref:r,className:e,children:t})})});pP.displayName="NavbarCollapse";const cX=pP,gP=S.forwardRef(({bsPrefix:t,className:e,children:n,label:r="Toggle navigation",as:i="button",onClick:s,...o},a)=>{t=Vt(t,"navbar-toggler");const{onToggle:l,expanded:c}=S.useContext(Ll)||{},u=qt(d=>{s&&s(d),l&&l()});return i==="button"&&(o.type="button"),C.jsx(i,{...o,ref:a,onClick:u,"aria-label":r,className:ft(e,t,!c&&"collapsed"),children:n||C.jsx("span",{className:`${t}-icon`})})});gP.displayName="NavbarToggle";const uX=gP,tm=new WeakMap,dw=(t,e)=>{if(!t||!e)return;const n=tm.get(e)||new Map;tm.set(e,n);let r=n.get(t);return r||(r=e.matchMedia(t),r.refCount=0,n.set(r.media,r)),r};function fX(t,e=typeof window>"u"?void 0:window){const n=dw(t,e),[r,i]=S.useState(()=>n?n.matches:!1);return Qg(()=>{let s=dw(t,e);if(!s)return i(!1);let o=tm.get(e);const a=()=>{i(s.matches)};return s.refCount++,s.addListener(a),a(),()=>{s.removeListener(a),s.refCount--,s.refCount<=0&&(o==null||o.delete(s.media)),s=void 0}},[t]),r}function dX(t){const e=Object.keys(t);function n(a,l){return a===l?l:a?`${a} and ${l}`:l}function r(a){return e[Math.min(e.indexOf(a)+1,e.length-1)]}function i(a){const l=r(a);let c=t[l];return typeof c=="number"?c=`${c-.2}px`:c=`calc(${c} - 0.2px)`,`(max-width: ${c})`}function s(a){let l=t[a];return typeof l=="number"&&(l=`${l}px`),`(min-width: ${l})`}function o(a,l,c){let u;typeof a=="object"?(u=a,c=l,l=!0):(l=l||!0,u={[a]:l});let d=S.useMemo(()=>Object.entries(u).reduce((f,[h,p])=>((p==="up"||p===!0)&&(f=n(f,s(h))),(p==="down"||p===!0)&&(f=n(f,i(h))),f),""),[JSON.stringify(u)]);return fX(d,c)}return o}const hX=dX({xs:0,sm:576,md:768,lg:992,xl:1200,xxl:1400});function Yh(t){t===void 0&&(t=cv());try{var e=t.activeElement;return!e||!e.nodeName?null:e}catch{return t.body}}function hw(t,e){if(t.contains)return t.contains(e);if(t.compareDocumentPosition)return t===e||!!(t.compareDocumentPosition(e)&16)}function pX(t){const e=S.useRef(t);return e.current=t,e}function gX(t){const e=pX(t);S.useEffect(()=>()=>e.current(),[])}function mX(t=document){const e=t.defaultView;return Math.abs(e.innerWidth-t.documentElement.clientWidth)}const pw=ud("modal-open");class vX{constructor({ownerDocument:e,handleContainerOverflow:n=!0,isRTL:r=!1}={}){this.handleContainerOverflow=n,this.isRTL=r,this.modals=[],this.ownerDocument=e}getScrollbarWidth(){return mX(this.ownerDocument)}getElement(){return(this.ownerDocument||document).body}setModalAttributes(e){}removeModalAttributes(e){}setContainerStyle(e){const n={overflow:"hidden"},r=this.isRTL?"paddingLeft":"paddingRight",i=this.getElement();e.style={overflow:i.style.overflow,[r]:i.style[r]},e.scrollBarWidth&&(n[r]=`${parseInt(cr(i,r)||"0",10)+e.scrollBarWidth}px`),i.setAttribute(pw,""),cr(i,n)}reset(){[...this.modals].forEach(e=>this.remove(e))}removeContainerStyle(e){const n=this.getElement();n.removeAttribute(pw),Object.assign(n.style,e.style)}add(e){let n=this.modals.indexOf(e);return n!==-1||(n=this.modals.length,this.modals.push(e),this.setModalAttributes(e),n!==0)||(this.state={scrollBarWidth:this.getScrollbarWidth(),style:{}},this.handleContainerOverflow&&this.setContainerStyle(this.state)),n}remove(e){const n=this.modals.indexOf(e);n!==-1&&(this.modals.splice(n,1),!this.modals.length&&this.handleContainerOverflow&&this.removeContainerStyle(this.state),this.removeModalAttributes(e))}isTopModal(e){return!!this.modals.length&&this.modals[this.modals.length-1]===e}}const dv=vX,mP=S.createContext(fd?window:void 0);mP.Provider;function hv(){return S.useContext(mP)}const Xh=(t,e)=>fd?t==null?(e||cv()).body:(typeof t=="function"&&(t=t()),t&&"current"in t&&(t=t.current),t&&("nodeType"in t||t.getBoundingClientRect)?t:null):null;function yX(t,e){const n=hv(),[r,i]=S.useState(()=>Xh(t,n==null?void 0:n.document));if(!r){const s=Xh(t);s&&i(s)}return S.useEffect(()=>{e&&r&&e(r)},[e,r]),S.useEffect(()=>{const s=Xh(t);s!==r&&i(s)},[t,r]),r}function _X({children:t,in:e,onExited:n,mountOnEnter:r,unmountOnExit:i}){const s=S.useRef(null),o=S.useRef(e),a=qt(n);S.useEffect(()=>{e?o.current=!0:a(s.current)},[e,a]);const l=Rl(s,t.ref),c=S.cloneElement(t,{ref:l});return e?c:i||!o.current&&r?null:c}function EX(t){return t.code==="Escape"||t.keyCode===27}function vP(){const t=S.version.split(".");return{major:+t[0],minor:+t[1],patch:+t[2]}}const wX=["onEnter","onEntering","onEntered","onExit","onExiting","onExited","addEndListener","children"];function bX(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function xX(t){let{onEnter:e,onEntering:n,onEntered:r,onExit:i,onExiting:s,onExited:o,addEndListener:a,children:l}=t,c=bX(t,wX);const{major:u}=vP(),d=u>=19?l.props.ref:l.ref,f=S.useRef(null),h=Rl(f,typeof l=="function"?null:d),p=A=>R=>{A&&f.current&&A(f.current,R)},m=S.useCallback(p(e),[e]),E=S.useCallback(p(n),[n]),v=S.useCallback(p(r),[r]),g=S.useCallback(p(i),[i]),y=S.useCallback(p(s),[s]),b=S.useCallback(p(o),[o]),T=S.useCallback(p(a),[a]);return Object.assign({},c,{nodeRef:f},e&&{onEnter:m},n&&{onEntering:E},r&&{onEntered:v},i&&{onExit:g},s&&{onExiting:y},o&&{onExited:b},a&&{addEndListener:T},{children:typeof l=="function"?(A,R)=>l(A,Object.assign({},R,{ref:h})):S.cloneElement(l,{ref:h})})}const SX=["component"];function TX(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}const AX=S.forwardRef((t,e)=>{let{component:n}=t,r=TX(t,SX);const i=xX(r);return C.jsx(n,Object.assign({ref:e},i))}),CX=AX;function PX({in:t,onTransition:e}){const n=S.useRef(null),r=S.useRef(!0),i=qt(e);return Qg(()=>{if(!n.current)return;let s=!1;return i({in:t,element:n.current,initial:r.current,isStale:()=>s}),()=>{s=!0}},[t,i]),Qg(()=>(r.current=!1,()=>{r.current=!0}),[]),n}function RX({children:t,in:e,onExited:n,onEntered:r,transition:i}){const[s,o]=S.useState(!e);e&&s&&o(!1);const a=PX({in:!!e,onTransition:c=>{const u=()=>{c.isStale()||(c.in?r==null||r(c.element,c.initial):(o(!0),n==null||n(c.element)))};Promise.resolve(i(c)).then(u,d=>{throw c.in||o(!0),d})}}),l=Rl(a,t.ref);return s&&!e?null:S.cloneElement(t,{ref:l})}function gw(t,e,n){return t?C.jsx(CX,Object.assign({},n,{component:t})):e?C.jsx(RX,Object.assign({},n,{transition:e})):C.jsx(_X,Object.assign({},n))}const LX=["show","role","className","style","children","backdrop","keyboard","onBackdropClick","onEscapeKeyDown","transition","runTransition","backdropTransition","runBackdropTransition","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","renderDialog","renderBackdrop","manager","container","onShow","onHide","onExit","onExited","onExiting","onEnter","onEntering","onEntered"];function MX(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}let Kh;function kX(t){return Kh||(Kh=new dv({ownerDocument:t==null?void 0:t.document})),Kh}function IX(t){const e=hv(),n=t||kX(e),r=S.useRef({dialog:null,backdrop:null});return Object.assign(r.current,{add:()=>n.add(r.current),remove:()=>n.remove(r.current),isTopModal:()=>n.isTopModal(r.current),setDialogRef:S.useCallback(i=>{r.current.dialog=i},[]),setBackdropRef:S.useCallback(i=>{r.current.backdrop=i},[])})}const yP=S.forwardRef((t,e)=>{let{show:n=!1,role:r="dialog",className:i,style:s,children:o,backdrop:a=!0,keyboard:l=!0,onBackdropClick:c,onEscapeKeyDown:u,transition:d,runTransition:f,backdropTransition:h,runBackdropTransition:p,autoFocus:m=!0,enforceFocus:E=!0,restoreFocus:v=!0,restoreFocusOptions:g,renderDialog:y,renderBackdrop:b=Se=>C.jsx("div",Object.assign({},Se)),manager:T,container:A,onShow:R,onHide:I=()=>{},onExit:D,onExited:N,onExiting:F,onEnter:q,onEntering:G,onEntered:W}=t,xe=MX(t,LX);const de=hv(),Pe=yX(A),z=IX(T),ne=MY(),Y=kY(n),[re,M]=S.useState(!n),V=S.useRef(null);S.useImperativeHandle(e,()=>z,[z]),fd&&!Y&&n&&(V.current=Yh(de==null?void 0:de.document)),n&&re&&M(!1);const U=qt(()=>{if(z.add(),he.current=uf(document,"keydown",fe),X.current=uf(document,"focus",()=>setTimeout(Q),!0),R&&R(),m){var Se,Oe;const Be=Yh((Se=(Oe=z.dialog)==null?void 0:Oe.ownerDocument)!=null?Se:de==null?void 0:de.document);z.dialog&&Be&&!hw(z.dialog,Be)&&(V.current=Be,z.dialog.focus())}}),oe=qt(()=>{if(z.remove(),he.current==null||he.current(),X.current==null||X.current(),v){var Se;(Se=V.current)==null||Se.focus==null||Se.focus(g),V.current=null}});S.useEffect(()=>{!n||!Pe||U()},[n,Pe,U]),S.useEffect(()=>{re&&oe()},[re,oe]),gX(()=>{oe()});const Q=qt(()=>{if(!E||!ne()||!z.isTopModal())return;const Se=Yh(de==null?void 0:de.document);z.dialog&&Se&&!hw(z.dialog,Se)&&z.dialog.focus()}),ie=qt(Se=>{Se.target===Se.currentTarget&&(c==null||c(Se),a===!0&&I())}),fe=qt(Se=>{l&&EX(Se)&&z.isTopModal()&&(u==null||u(Se),Se.defaultPrevented||I())}),X=S.useRef(),he=S.useRef(),Ie=(...Se)=>{M(!0),N==null||N(...Se)};if(!Pe)return null;const _e=Object.assign({role:r,ref:z.setDialogRef,"aria-modal":r==="dialog"?!0:void 0},xe,{style:s,className:i,tabIndex:-1});let Te=y?y(_e):C.jsx("div",Object.assign({},_e,{children:S.cloneElement(o,{role:"document"})}));Te=gw(d,f,{unmountOnExit:!0,mountOnEnter:!0,appear:!0,in:!!n,onExit:D,onExiting:F,onExited:Ie,onEnter:q,onEntering:G,onEntered:W,children:Te});let Ze=null;return a&&(Ze=b({ref:z.setBackdropRef,onClick:ie}),Ze=gw(h,p,{in:!!n,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:Ze})),C.jsx(C.Fragment,{children:Pi.createPortal(C.jsxs(C.Fragment,{children:[Ze,Te]}),Pe)})});yP.displayName="Modal";const OX=Object.assign(yP,{Manager:dv}),NX={[bn]:"show",[sr]:"show"},_P=S.forwardRef(({className:t,children:e,transitionClasses:n={},onEnter:r,...i},s)=>{const o={in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1,...i},a=S.useCallback((u,d)=>{hP(u),r==null||r(u,d)},[r]),{major:l}=vP(),c=l>=19?e.props.ref:e.ref;return C.jsx(fv,{ref:s,addEndListener:uv,...o,onEnter:a,childRef:c,children:(u,d)=>S.cloneElement(e,{...d,className:ft("fade",t,e.props.className,NX[u],n[u])})})});_P.displayName="Fade";const DX=_P,EP=S.forwardRef(({className:t,bsPrefix:e,as:n="div",...r},i)=>(e=Vt(e,"offcanvas-body"),C.jsx(n,{ref:i,className:ft(t,e),...r})));EP.displayName="OffcanvasBody";const FX=EP,UX={[bn]:"show",[sr]:"show"},wP=S.forwardRef(({bsPrefix:t,className:e,children:n,in:r=!1,mountOnEnter:i=!1,unmountOnExit:s=!1,appear:o=!1,...a},l)=>(t=Vt(t,"offcanvas"),C.jsx(fv,{ref:l,addEndListener:uv,in:r,mountOnEnter:i,unmountOnExit:s,appear:o,...a,childRef:n.ref,children:(c,u)=>S.cloneElement(n,{...u,className:ft(e,n.props.className,(c===bn||c===el)&&`${t}-toggling`,UX[c])})})));wP.displayName="OffcanvasToggling";const BX=wP,zX=S.createContext({onHide(){}}),bP=zX,jX={"aria-label":zh.string,onClick:zh.func,variant:zh.oneOf(["white"])},pv=S.forwardRef(({className:t,variant:e,"aria-label":n="Close",...r},i)=>C.jsx("button",{ref:i,type:"button",className:ft("btn-close",e&&`btn-close-${e}`,t),"aria-label":n,...r}));pv.displayName="CloseButton";pv.propTypes=jX;const VX=pv,$X=S.forwardRef(({closeLabel:t="Close",closeVariant:e,closeButton:n=!1,onHide:r,children:i,...s},o)=>{const a=S.useContext(bP),l=qt(()=>{a==null||a.onHide(),r==null||r()});return C.jsxs("div",{ref:o,...s,children:[i,n&&C.jsx(VX,{"aria-label":t,variant:e,onClick:l})]})}),GX=$X,xP=S.forwardRef(({bsPrefix:t,className:e,closeLabel:n="Close",closeButton:r=!1,...i},s)=>(t=Vt(t,"offcanvas-header"),C.jsx(GX,{ref:s,...i,className:ft(e,t),closeLabel:n,closeButton:r})));xP.displayName="OffcanvasHeader";const WX=xP,HX=t=>S.forwardRef((e,n)=>C.jsx("div",{...e,ref:n,className:ft(e.className,t)})),YX=HX("h5"),SP=S.forwardRef(({className:t,bsPrefix:e,as:n=YX,...r},i)=>(e=Vt(e,"offcanvas-title"),C.jsx(n,{ref:i,className:ft(t,e),...r})));SP.displayName="OffcanvasTitle";const XX=SP;function KX(t,e){return t.classList?!!e&&t.classList.contains(e):(" "+(t.className.baseVal||t.className)+" ").indexOf(" "+e+" ")!==-1}function qX(t,e){t.classList?t.classList.add(e):KX(t,e)||(typeof t.className=="string"?t.className=t.className+" "+e:t.setAttribute("class",(t.className&&t.className.baseVal||"")+" "+e))}function mw(t,e){return t.replace(new RegExp("(^|\\s)"+e+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function ZX(t,e){t.classList?t.classList.remove(e):typeof t.className=="string"?t.className=mw(t.className,e):t.setAttribute("class",mw(t.className&&t.className.baseVal||"",e))}const hs={FIXED_CONTENT:".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",STICKY_CONTENT:".sticky-top",NAVBAR_TOGGLER:".navbar-toggler"};class TP extends dv{adjustAndStore(e,n,r){const i=n.style[e];n.dataset[e]=i,cr(n,{[e]:`${parseFloat(cr(n,e))+r}px`})}restore(e,n){const r=n.dataset[e];r!==void 0&&(delete n.dataset[e],cr(n,{[e]:r}))}setContainerStyle(e){super.setContainerStyle(e);const n=this.getElement();if(qX(n,"modal-open"),!e.scrollBarWidth)return;const r=this.isRTL?"paddingLeft":"paddingRight",i=this.isRTL?"marginLeft":"marginRight";bi(n,hs.FIXED_CONTENT).forEach(s=>this.adjustAndStore(r,s,e.scrollBarWidth)),bi(n,hs.STICKY_CONTENT).forEach(s=>this.adjustAndStore(i,s,-e.scrollBarWidth)),bi(n,hs.NAVBAR_TOGGLER).forEach(s=>this.adjustAndStore(i,s,e.scrollBarWidth))}removeContainerStyle(e){super.removeContainerStyle(e);const n=this.getElement();ZX(n,"modal-open");const r=this.isRTL?"paddingLeft":"paddingRight",i=this.isRTL?"marginLeft":"marginRight";bi(n,hs.FIXED_CONTENT).forEach(s=>this.restore(r,s)),bi(n,hs.STICKY_CONTENT).forEach(s=>this.restore(i,s)),bi(n,hs.NAVBAR_TOGGLER).forEach(s=>this.restore(i,s))}}let qh;function QX(t){return qh||(qh=new TP(t)),qh}const JX=TP;function eK(t){return C.jsx(BX,{...t})}function tK(t){return C.jsx(DX,{...t})}const AP=S.forwardRef(({bsPrefix:t,className:e,children:n,"aria-labelledby":r,placement:i="start",responsive:s,show:o=!1,backdrop:a=!0,keyboard:l=!0,scroll:c=!1,onEscapeKeyDown:u,onShow:d,onHide:f,container:h,autoFocus:p=!0,enforceFocus:m=!0,restoreFocus:E=!0,restoreFocusOptions:v,onEntered:g,onExit:y,onExiting:b,onEnter:T,onEntering:A,onExited:R,backdropClassName:I,manager:D,renderStaticNode:N=!1,...F},q)=>{const G=S.useRef();t=Vt(t,"offcanvas");const[W,xe]=S.useState(!1),de=qt(f),Pe=hX(s||"xs","up");S.useEffect(()=>{xe(s?o&&!Pe:o)},[o,s,Pe]);const z=S.useMemo(()=>({onHide:de}),[de]);function ne(){return D||(c?(G.current||(G.current=new JX({handleContainerOverflow:!1})),G.current):QX())}const Y=(U,...oe)=>{U&&(U.style.visibility="visible"),T==null||T(U,...oe)},re=(U,...oe)=>{U&&(U.style.visibility=""),R==null||R(...oe)},M=S.useCallback(U=>C.jsx("div",{...U,className:ft(`${t}-backdrop`,I)}),[I,t]),V=U=>C.jsx("div",{...U,...F,className:ft(e,s?`${t}-${s}`:t,`${t}-${i}`),"aria-labelledby":r,children:n});return C.jsxs(C.Fragment,{children:[!W&&(s||N)&&V({}),C.jsx(bP.Provider,{value:z,children:C.jsx(OX,{show:W,ref:q,backdrop:a,container:h,keyboard:l,autoFocus:p,enforceFocus:m&&!c,restoreFocus:E,restoreFocusOptions:v,onEscapeKeyDown:u,onShow:d,onHide:de,onEnter:Y,onEntering:A,onEntered:g,onExit:y,onExiting:b,onExited:re,manager:ne(),transition:eK,backdropTransition:tK,renderBackdrop:M,renderDialog:V})})]})});AP.displayName="Offcanvas";const su=Object.assign(AP,{Body:FX,Header:WX,Title:XX}),CP=S.forwardRef(({onHide:t,...e},n)=>{const r=S.useContext(Ll),i=qt(()=>{r==null||r.onToggle==null||r.onToggle(),t==null||t()});return C.jsx(su,{ref:n,show:!!(r!=null&&r.expanded),...e,renderStaticNode:!0,onHide:i})});CP.displayName="NavbarOffcanvas";const nK=CP,PP=S.forwardRef(({className:t,bsPrefix:e,as:n="span",...r},i)=>(e=Vt(e,"navbar-text"),C.jsx(n,{ref:i,className:ft(t,e),...r})));PP.displayName="NavbarText";const rK=PP,RP=S.forwardRef((t,e)=>{const{bsPrefix:n,expand:r=!0,variant:i="light",bg:s,fixed:o,sticky:a,className:l,as:c="nav",expanded:u,onToggle:d,onSelect:f,collapseOnSelect:h=!1,...p}=QC(t,{expanded:"onToggle"}),m=Vt(n,"navbar"),E=S.useCallback((...y)=>{f==null||f(...y),h&&u&&(d==null||d(!1))},[f,h,u,d]);p.role===void 0&&c!=="nav"&&(p.role="navigation");let v=`${m}-expand`;typeof r=="string"&&(v=`${v}-${r}`);const g=S.useMemo(()=>({onToggle:()=>d==null?void 0:d(!u),bsPrefix:m,expanded:!!u,expand:r}),[m,u,r,d]);return C.jsx(Ll.Provider,{value:g,children:C.jsx(cf.Provider,{value:E,children:C.jsx(c,{ref:e,...p,className:ft(l,m,r&&v,i&&`${m}-${i}`,s&&`bg-${s}`,a&&`sticky-${a}`,o&&`fixed-${o}`)})})})});RP.displayName="Navbar";const kc=Object.assign(RP,{Brand:zY,Collapse:cX,Offcanvas:nK,Text:rK,Toggle:uX});/**
 * React Router DOM v6.28.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const iK="6";try{window.__reactRouterVersion=iK}catch{}const sK="startTransition",vw=vR[sK];function oK(t){let{basename:e,children:n,future:r,window:i}=t,s=S.useRef();s.current==null&&(s.current=cH({window:i,v5Compat:!0}));let o=s.current,[a,l]=S.useState({action:o.action,location:o.location}),{v7_startTransition:c}=r||{},u=S.useCallback(d=>{c&&vw?vw(()=>l(d)):l(d)},[l,c]);return S.useLayoutEffect(()=>o.listen(u),[o,u]),S.useEffect(()=>GH(r),[r]),S.createElement(WH,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:r})}var yw;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(yw||(yw={}));var _w;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(_w||(_w={}));function gv(){const[t,e]=Le(vC),[n,r]=S.useState(!1),i=OC().pathname,s=()=>r(!1),o=()=>r(!0),a=[{name:"Web Atlas",path:"/"},{name:"Contributors",path:"/about-us"},{name:"Database Build Instructions",path:"/how-to-build"},{name:"Database Description",path:"/db-description"},{name:"Database History",path:"/db-history"},{name:"Data on GitHub",path:"https://github.com/YellowRiverDatabase/geodata/tree/main/relational-datadata",newTab:!0}];return C.jsx(C.Fragment,{children:[!1].map(l=>C.jsx("div",{children:C.jsx(kc,{style:{pointerEvents:"auto",width:"100%"},expand:l,className:"bg-body-tertiary",children:C.jsxs(lY,{fluid:!0,children:[C.jsxs(kc.Brand,{href:"#",children:["The Tracks of Yu Database",C.jsx("br",{})," A Web Atlas"," "]}),C.jsx(kc.Toggle,{"aria-controls":`offcanvasNavbar-expand-${l}`,onClick:o}),C.jsxs(kc.Offcanvas,{id:`offcanvasNavbar-expand-${l}`,"aria-labelledby":`offcanvasNavbarLabel-expand-${l}`,placement:"end",show:n,onHide:s,children:[C.jsx(su.Header,{closeButton:!0,children:C.jsx(su.Title,{id:`offcanvasNavbarLabel-expand-${l}`,children:"Project Information"})}),C.jsx(su.Body,{children:C.jsxs(Wh,{className:"justify-content-end flex-grow-1 pe-3",children:[a.map((c,u)=>c.path===i?null:C.jsx(Wh.Link,{href:c.path,target:c.newTab?"_blank":"_self",children:c.name},`${c.name}-${u}`)),i==="/"?C.jsx(Wh.Link,{href:"#",onClick:()=>{e(!0),s()},children:"Open Intro Modal"}):null]})})]})]})},l)}))})}function aK({children:t}){const e={height:"100vh",width:"100vw",margin:0,padding:0,zIndex:1};return C.jsx("div",{style:e,children:t})}const lK={position:"absolute",bottom:"10px",left:0,width:"100vw",height:"200px",zIndex:5},cK={position:"relative",margin:"40px auto 0 auto",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",height:"150px"},uK={position:"relative",margin:"0 auto 0 auto",backgroundColor:"rgba(255, 255, 255, 0.6)"},fK={position:"absolute",bottom:50,height:"25px",width:"75px",borderRadius:"10pt",border:"solid 1px black",textAlign:"center",color:"black",backgroundColor:"white"},dK={position:"absolute",bottom:50,height:"25px",width:"75px",borderRadius:"10pt",border:"solid 1px black",textAlign:"center",color:"black",backgroundColor:"white"};function hK(){Le(sd);const t=gn(SC);S.useRef(),S.useRef();const[e,n]=Le(rH);S.useState(500);const[r,i]=S.useState(!1),[s,o]=S.useState(!1),[a,l]=Le(tv),[c,u]=S.useState(a),[d,f]=S.useState(e),[h,p]=S.useState(e-e),m=S.useRef(),E=S.useRef(),v=S.useRef();S.useEffect(()=>{const W=()=>{const de=window.innerWidth*.8;n(de)};return W(),window.addEventListener("resize",W),()=>{window.removeEventListener("resize",W)}},[]);const g={top:10,right:30,bottom:30,left:30},y=e,b=150-g.top-g.bottom,T=Wg().domain(s_(t,W=>W.date)).range([0,y]),A=Wg().domain(s_(t,W=>W.events.length)).range([b,-b]),I=O7().x(W=>T(W.date)).y(W=>A(W.events.length))(t),D=Math.round(T.invert(d+5)),N=Math.round(T.invert(h-5));S.useEffect(()=>{u([N<-1700?-1700:N,D>1916?1916:D])},[N,D]),S.useEffect(()=>{r===!1&&(D<1916&&l([a[0],c[1]]),D>1916&&l([a[0],1916]))},[r,d]),S.useEffect(()=>{s===!1&&(N>-2070&&l([c[0],a[1]]),N<-2070&&l([-2070,a[1]]))},[s,h]),p0(W=>W.date).left;const F=(W,xe)=>{const[de]=nw(W);T.invert(de),(de===0||de===e)&&(o(!1),i(!1)),xe==="right"&&de>0&&de<e&&de>h&&f(de+5),xe==="left"&&de>0&&de<e&&de<d&&p(de-5)},q=W=>{i(!1),o(!1)},G=W=>{const[xe]=nw(W);(d-xe<xe-h?"right":"left")==="right"?xe+5<T(1916)?f(xe+5):f(T(1916)-5):p(xe-5)};return C.jsx("div",{style:lK,children:C.jsxs("div",{style:{...uK,width:e+20,marginBottom:"100px"},children:[C.jsx("div",{style:{...fK,left:-95},children:c[0]}),C.jsx("div",{style:{...dK,right:-95},children:c[1]}),C.jsxs("svg",{style:{...cK,width:e+20,height:"100%",cursor:s||r?"ew-resize":"default",border:"solid 1px black"},onClick:W=>G(W),ref:v,onMouseUp:W=>q(),onMouseMove:W=>{r&&F(W,"right"),s&&F(W,"left")},children:[C.jsx("path",{fill:"none",stroke:"steelblue",style:{marginLeft:g.left},d:I,strokeWidth:1.25,width:e-20}),C.jsx("rect",{id:"fillColor",x:h,y:0,width:d-h,height:b+50,fill:"rgba(0,0,0,0.2)"}),C.jsxs("g",{id:"RigthRect",ref:m,style:{cursor:"ew-resize"},onMouseDown:()=>i(!0),children:[C.jsx("rect",{x:d-2.5,y:0,width:5,height:b+50,fill:"steelblue",stroke:"black"}),C.jsx("rect",{x:d-7,y:65,width:15,height:25,fill:"steelblue",stroke:"black",style:{cursor:"ew-resize"},pointerEvents:"all"})]}),C.jsxs("g",{id:"LeftRect",ref:E,onMouseDown:()=>o(!0),cursor:"ew-resize",pointerEvents:"all",children:[C.jsx("rect",{x:h,y:0,width:5,height:b+50,fill:"steelblue",stroke:"black"}),C.jsx("rect",{x:h-5,y:65,width:15,height:25,fill:"steelblue",stroke:"black",style:{cursor:"ew-resize"},pointerEvents:"all"})]})]})]})})}const pK={position:"absolute",top:"0",left:"0",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(0, 0, 0, 0.5)",width:"100vw",height:"100vh",zIndex:"999"},Ew={display:"flex",flexDirection:"column",alignItems:"center",backgroundColor:"azure",borderRadius:"10pt",padding:"20px",minWidth:"250px",minHeight:"250px",maxWidth:"33vw",border:"solid 1px black",color:"black"},gK={position:"relative",display:"flex",textAlign:"center",flexDirection:"column",alignItems:"center",justifyContent:"center",color:"black"},mK={border:"1px solid black",backgroundColor:"azure",borderRadius:"10px"},Zh={borderBottom:"1px solid black"};function vK({sources:t,onClose:e}){const[n,r]=Le(yC),i=gn(_C);if(n){const s=GC[Array.from(i.en_type)[0]];return C.jsx("div",{style:pK,children:C.jsx("div",{style:{...Ew,backgroundColor:`rgba(${s[0]}, ${s[1]}, ${s[2]}, 0.8`},children:C.jsx("div",{style:Ew,children:C.jsxs("div",{style:gK,children:[C.jsxs("h2",{children:[i.place,C.jsx("br",{}),"(",lf(i.en_date_start),")"]}),C.jsx("button",{style:{position:"absolute",top:"0px",right:"0px",cursor:"pointer",border:"1px solid black",padding:"5px",borderRadius:"5px",backgroundColor:"lightgray"},onClick:()=>r(!1),children:"×"}),C.jsx("table",{style:mK,children:C.jsxs("tbody",{children:[C.jsxs("tr",{style:Zh,children:[C.jsx("td",{style:{textAlign:"start"},children:"Category: "}),C.jsx("td",{children:Array.from(i.en_cat).join(", ")})]}),C.jsxs("tr",{style:Zh,children:[C.jsx("td",{style:{textAlign:"start"},children:"Type:"}),C.jsx("td",{children:Array.from(i.en_type).join(", ")})]}),C.jsxs("tr",{style:Zh,children:[C.jsx("td",{style:{textAlign:"start"},children:"Description:"}),C.jsx("td",{children:Array.from(i.source).join(", ")})]})]})})]})})})})}else return null}const ww={display:"flex",flexDirection:"column",border:"1px solid black",borderRadius:"5px",zIndex:999,color:"black",backgroundColor:"white",padding:"5px",maxHeight:"400px",overflow:"auto",gap:"2px",pointerEvents:"auto",overflowX:"hidden"},yK={display:"flex",alignItems:"center",justifyContent:"space-between"};function _K(){const t=Hg,[e,n]=S.useState(!1);return e?C.jsxs("div",{style:{...ww,padding:"15px"},children:[C.jsxs("div",{style:yK,children:[C.jsx("p",{children:"Category Colors"}),C.jsx("button",{style:{backgroundColor:"lightgrey",color:"black",padding:"5px",width:"25px",height:"25px"},className:"rounded border-dark",onClick:()=>{n(!1)},children:"×"})]}),C.jsx("hr",{style:{width:"100%"}}),Object.entries(t).map(([r,i])=>C.jsx("div",{styles:{display:"flex",flexDirection:"row",alignItems:"center"},children:C.jsxs("section",{style:{padding:"0",margin:"0",display:"flex",gap:"15px"},children:[C.jsx("svg",{height:20,width:20,children:C.jsx("circle",{cx:10,cy:10,r:9,fill:i,strokeWidth:1,stroke:"black"})})," ",r]})}))]}):C.jsx("button",{style:{...ww,height:"50px"},onClick:()=>{n(!0)},children:"Legend"})}const EK={zIndex:1,width:"125px",backgroundColor:"white",border:"1px solid black",alignSelf:"end",borderRadius:"5px"},wK={display:"flex",flexDirection:"column",gap:"1em",alignItems:"center",backgroundColor:"white",border:"1px solid black",borderRadius:"10px",color:"black",padding:"10px",maxHeight:"60vh",zIndex:2,overflow:"auto",width:"300px"},bK={width:"100%",position:"relative",display:"flex",flexDirection:"row",justifyContent:"space-between"},xK={display:"flex",flexDirection:"row",gap:"1em",flexWrap:"wrap",margin:"0 10px",overflow:"auto"},SK={display:"flex",width:"75px",flexDirection:"row",justifyContent:"center",gap:"1em",cursor:"pointer"},TK=({onClick:t})=>C.jsx("svg",{onClick:t,xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"black",children:C.jsx("path",{d:"M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q8 0 15 1.5t14 4.5l-74 74H200v560h560v-266l80-80v346q0 33-23.5 56.5T760-120H200Zm261-160L235-506l56-56 170 170 367-367 57 55-424 424Z"})}),AK=({onClick:t})=>C.jsx("svg",{onClick:t,xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 -960 960 960",width:"24px",stroke:"black",fill:"black",zIndex:"2",children:C.jsx("path",{d:"M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Z"})});function CK(){const[t,e]=S.useState(!1),[n,r]=Le(sd),i=s=>{console.log("key",s),r({...n,[s]:!n[s]})};return t?C.jsxs("div",{style:wK,children:[C.jsxs("div",{style:bK,children:[C.jsx("div",{}),C.jsx("section",{children:"Upstream locations by Year"}),C.jsx("button",{style:{borderRadius:"5px",border:"solid black 1px"},onClick:()=>e(!1),children:"×"})]}),C.jsx("div",{style:xK,children:Object.entries(n).map(([s,o],a)=>C.jsxs("div",{style:SK,onClick:()=>i(s),children:[n[s]?C.jsx(TK,{}):C.jsx(AK,{})," ",C.jsx("section",{children:s})]},`${s}`))})]}):C.jsx("button",{style:{...EK},onClick:()=>e(!0),children:"Upstream Places"})}function PK(){return C.jsxs("div",{style:{position:"absolute",height:"100vh",width:"100vw",display:"flex",flexDirection:"column",zIndex:2,pointerEvents:"none"},children:[C.jsx(gv,{}),C.jsxs("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",pointerEvents:"none",margin:"1em"},children:[C.jsx(_K,{}),C.jsxs("div",{style:{zIndex:3,pointerEvents:"auto",display:"flex",flexDirection:"column",gap:"1em",margin:"0"},children:[C.jsx(V7,{}),C.jsx(CK,{}),C.jsx(eY,{})]})]})]})}function RK(){return C.jsxs(C.Fragment,{children:[C.jsx(PK,{}),C.jsxs(aK,{children:[C.jsx(Y7,{}),C.jsx(X7,{})]}),C.jsx(hK,{}),C.jsx(vK,{})]})}function LK({children:t}){return C.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100vh",width:"100vw"},children:[C.jsx(gv,{}),C.jsx("div",{style:{margin:0,display:"flex",justifyContent:"center",height:"100%"},children:C.jsx("div",{style:{display:"flex",flexDirection:"row",maxWidth:"620px",height:"100%",color:"black",padding:"2em"},children:t})})]})}function Si(){return Si=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Si.apply(this,arguments)}const MK=["children","options"],le={blockQuote:"0",breakLine:"1",breakThematic:"2",codeBlock:"3",codeFenced:"4",codeInline:"5",footnote:"6",footnoteReference:"7",gfmTask:"8",heading:"9",headingSetext:"10",htmlBlock:"11",htmlComment:"12",htmlSelfClosing:"13",image:"14",link:"15",linkAngleBraceStyleDetector:"16",linkBareUrlDetector:"17",linkMailtoDetector:"18",newlineCoalescer:"19",orderedList:"20",paragraph:"21",ref:"22",refImage:"23",refLink:"24",table:"25",tableSeparator:"26",text:"27",textBolded:"28",textEmphasized:"29",textEscaped:"30",textMarked:"31",textStrikethroughed:"32",unorderedList:"33"};var bw;(function(t){t[t.MAX=0]="MAX",t[t.HIGH=1]="HIGH",t[t.MED=2]="MED",t[t.LOW=3]="LOW",t[t.MIN=4]="MIN"})(bw||(bw={}));const xw=["allowFullScreen","allowTransparency","autoComplete","autoFocus","autoPlay","cellPadding","cellSpacing","charSet","classId","colSpan","contentEditable","contextMenu","crossOrigin","encType","formAction","formEncType","formMethod","formNoValidate","formTarget","frameBorder","hrefLang","inputMode","keyParams","keyType","marginHeight","marginWidth","maxLength","mediaGroup","minLength","noValidate","radioGroup","readOnly","rowSpan","spellCheck","srcDoc","srcLang","srcSet","tabIndex","useMap"].reduce((t,e)=>(t[e.toLowerCase()]=e,t),{class:"className",for:"htmlFor"}),Sw={amp:"&",apos:"'",gt:">",lt:"<",nbsp:" ",quot:"“"},kK=["style","script"],IK=/([-A-Z0-9_:]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|(?:\{((?:\\.|{[^}]*?}|[^}])*)\})))?/gi,OK=/mailto:/i,NK=/\n{2,}$/,LP=/^(\s*>[\s\S]*?)(?=\n{2,})/,DK=/^ *> ?/gm,FK=/^ {2,}\n/,UK=/^(?:( *[-*_])){3,} *(?:\n *)+\n/,MP=/^\s*(`{3,}|~{3,}) *(\S+)?([^\n]*?)?\n([\s\S]+?)\s*\1 *(?:\n *)*\n?/,kP=/^(?: {4}[^\n]+\n*)+(?:\n *)+\n?/,BK=/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/,zK=/^(?:\n *)*\n/,jK=/\r\n?/g,VK=/^\[\^([^\]]+)](:(.*)((\n+ {4,}.*)|(\n(?!\[\^).+))*)/,$K=/^\[\^([^\]]+)]/,GK=/\f/g,WK=/^---[ \t]*\n(.|\n)*\n---[ \t]*\n/,HK=/^\s*?\[(x|\s)\]/,IP=/^ *(#{1,6}) *([^\n]+?)(?: +#*)?(?:\n *)*(?:\n|$)/,OP=/^ *(#{1,6}) +([^\n]+?)(?: +#*)?(?:\n *)*(?:\n|$)/,NP=/^([^\n]+)\n *(=|-){3,} *(?:\n *)+\n/,nm=/^ *(?!<[a-z][^ >/]* ?\/>)<([a-z][^ >/]*) ?((?:[^>]*[^/])?)>\n?(\s*(?:<\1[^>]*?>[\s\S]*?<\/\1>|(?!<\1\b)[\s\S])*?)<\/\1>(?!<\/\1>)\n*/i,YK=/&([a-z0-9]+|#[0-9]{1,6}|#x[0-9a-fA-F]{1,6});/gi,DP=/^<!--[\s\S]*?(?:-->)/,XK=/^(data|aria|x)-[a-z_][a-z\d_.-]*$/,rm=/^ *<([a-z][a-z0-9:]*)(?:\s+((?:<.*?>|[^>])*))?\/?>(?!<\/\1>)(\s*\n)?/i,KK=/^\{.*\}$/,qK=/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,ZK=/^<([^ >]+@[^ >]+)>/,QK=/^<([^ >]+:\/[^ >]+)>/,JK=/-([a-z])?/gi,FP=/^(.*\|.*)\n(?: *(\|? *[-:]+ *\|[-| :]*)\n((?:.*\|.*\n)*))?\n?/,eq=/^\[([^\]]*)\]:\s+<?([^\s>]+)>?\s*("([^"]*)")?/,tq=/^!\[([^\]]*)\] ?\[([^\]]*)\]/,nq=/^\[([^\]]*)\] ?\[([^\]]*)\]/,rq=/(\n|^[-*]\s|^#|^ {2,}|^-{2,}|^>\s)/,iq=/\t/g,sq=/(^ *\||\| *$)/g,oq=/^ *:-+: *$/,aq=/^ *:-+ *$/,lq=/^ *-+: *$/,dd="((?:\\[.*?\\][([].*?[)\\]]|<.*?>(?:.*?<.*?>)?|`.*?`|~~.*?~~|==.*?==|.|\\n)*?)",cq=new RegExp(`^([*_])\\1${dd}\\1\\1(?!\\1)`),uq=new RegExp(`^([*_])${dd}\\1(?!\\1|\\w)`),fq=new RegExp(`^==${dd}==`),dq=new RegExp(`^~~${dd}~~`),hq=/^\\([^0-9A-Za-z\s])/,pq=/^[\s\S]+?(?=[^0-9A-Z\s\u00c0-\uffff&#;.()'"]|\d+\.|\n\n| {2,}\n|\w+:\S|$)/i,gq=/^\n+/,mq=/^([ \t]*)/,vq=/\\([^\\])/g,Tw=/ *\n+$/,yq=/(?:^|\n)( *)$/,mv="(?:\\d+\\.)",vv="(?:[*+-])";function UP(t){return"( *)("+(t===1?mv:vv)+") +"}const BP=UP(1),zP=UP(2);function jP(t){return new RegExp("^"+(t===1?BP:zP))}const _q=jP(1),Eq=jP(2);function VP(t){return new RegExp("^"+(t===1?BP:zP)+"[^\\n]*(?:\\n(?!\\1"+(t===1?mv:vv)+" )[^\\n]*)*(\\n|$)","gm")}const $P=VP(1),GP=VP(2);function WP(t){const e=t===1?mv:vv;return new RegExp("^( *)("+e+") [\\s\\S]+?(?:\\n{2,}(?! )(?!\\1"+e+" (?!"+e+" ))\\n*|\\s*\\n*$)")}const HP=WP(1),YP=WP(2);function Aw(t,e){const n=e===1,r=n?HP:YP,i=n?$P:GP,s=n?_q:Eq;return{match(o,a){const l=yq.exec(a.prevCapture);return l&&(a.list||!a.inline&&!a.simple)?r.exec(o=l[1]+o):null},order:1,parse(o,a,l){const c=n?+o[2]:void 0,u=o[0].replace(NK,`
`).match(i);let d=!1;return{items:u.map(function(f,h){const p=s.exec(f)[0].length,m=new RegExp("^ {1,"+p+"}","gm"),E=f.replace(m,"").replace(s,""),v=h===u.length-1,g=E.indexOf(`

`)!==-1||v&&d;d=g;const y=l.inline,b=l.list;let T;l.list=!0,g?(l.inline=!1,T=E.replace(Tw,`

`)):(l.inline=!0,T=E.replace(Tw,""));const A=a(T,l);return l.inline=y,l.list=b,A}),ordered:n,start:c}},render:(o,a,l)=>t(o.ordered?"ol":"ul",{key:l.key,start:o.type===le.orderedList?o.start:void 0},o.items.map(function(c,u){return t("li",{key:u},a(c,l))}))}}const wq=new RegExp(`^\\[((?:\\[[^\\]]*\\]|[^\\[\\]]|\\](?=[^\\[]*\\]))*)\\]\\(\\s*<?((?:\\([^)]*\\)|[^\\s\\\\]|\\\\.)*?)>?(?:\\s+['"]([\\s\\S]*?)['"])?\\s*\\)`),bq=/^!\[(.*?)\]\( *((?:\([^)]*\)|[^() ])*) *"?([^)"]*)?"?\)/,XP=[LP,MP,kP,IP,NP,OP,DP,FP,$P,HP,GP,YP],xq=[...XP,/^[^\n]+(?:  \n|\n{2,})/,nm,rm];function Ic(t){return t.replace(/[ÀÁÂÃÄÅàáâãäåæÆ]/g,"a").replace(/[çÇ]/g,"c").replace(/[ðÐ]/g,"d").replace(/[ÈÉÊËéèêë]/g,"e").replace(/[ÏïÎîÍíÌì]/g,"i").replace(/[Ññ]/g,"n").replace(/[øØœŒÕõÔôÓóÒò]/g,"o").replace(/[ÜüÛûÚúÙù]/g,"u").replace(/[ŸÿÝý]/g,"y").replace(/[^a-z0-9- ]/gi,"").replace(/ /gi,"-").toLowerCase()}function Sq(t){return lq.test(t)?"right":oq.test(t)?"center":aq.test(t)?"left":null}function Cw(t,e,n,r){const i=n.inTable;n.inTable=!0;let s=t.trim().split(/( *(?:`[^`]*`|<.*?>.*?<\/.*?>(?!<\/.*?>)|\\\||\|) *)/).reduce((a,l)=>(l.trim()==="|"?a.push(r?{type:le.tableSeparator}:{type:le.text,text:l}):l!==""&&a.push.apply(a,e(l,n)),a),[]);n.inTable=i;let o=[[]];return s.forEach(function(a,l){a.type===le.tableSeparator?l!==0&&l!==s.length-1&&o.push([]):(a.type!==le.text||s[l+1]!=null&&s[l+1].type!==le.tableSeparator||(a.text=a.text.trimEnd()),o[o.length-1].push(a))}),o}function Tq(t,e,n){n.inline=!0;const r=t[2]?t[2].replace(sq,"").split("|").map(Sq):[],i=t[3]?function(o,a,l){return o.trim().split(`
`).map(function(c){return Cw(c,a,l,!0)})}(t[3],e,n):[],s=Cw(t[1],e,n,!!i.length);return n.inline=!1,i.length?{align:r,cells:i,header:s,type:le.table}:{children:s,type:le.paragraph}}function Pw(t,e){return t.align[e]==null?{}:{textAlign:t.align[e]}}function Ir(t){return function(e,n){return n.inline?t.exec(e):null}}function Or(t){return function(e,n){return n.inline||n.simple?t.exec(e):null}}function er(t){return function(e,n){return n.inline||n.simple?null:t.exec(e)}}function Zo(t){return function(e){return t.exec(e)}}function Aq(t,e,n){if(e.inline||e.simple||n&&!n.endsWith(`
`))return null;let r="";t.split(`
`).every(s=>!XP.some(o=>o.test(s))&&(r+=s+`
`,s.trim()));const i=r.trimEnd();return i==""?null:[r,i]}function Cq(t){try{if(decodeURIComponent(t).replace(/[^A-Za-z0-9/:]/g,"").match(/^\s*(javascript|vbscript|data(?!:image)):/i))return null}catch{return null}return t}function Rw(t){return t.replace(vq,"$1")}function ou(t,e,n){const r=n.inline||!1,i=n.simple||!1;n.inline=!0,n.simple=!0;const s=t(e,n);return n.inline=r,n.simple=i,s}function Pq(t,e,n){const r=n.inline||!1,i=n.simple||!1;n.inline=!1,n.simple=!0;const s=t(e,n);return n.inline=r,n.simple=i,s}function Rq(t,e,n){const r=n.inline||!1;n.inline=!1;const i=t(e,n);return n.inline=r,i}const Qh=(t,e,n)=>({children:ou(e,t[1],n)});function Jh(){return{}}function ep(){return null}function Lq(...t){return t.filter(Boolean).join(" ")}function tp(t,e,n){let r=t;const i=e.split(".");for(;i.length&&(r=r[i[0]],r!==void 0);)i.shift();return r||n}function Mq(t="",e={}){function n(f,h,...p){const m=tp(e.overrides,`${f}.props`,{});return e.createElement(function(E,v){const g=tp(v,E);return g?typeof g=="function"||typeof g=="object"&&"render"in g?g:tp(v,`${E}.component`,E):E}(f,e.overrides),Si({},h,m,{className:Lq(h==null?void 0:h.className,m.className)||void 0}),...p)}function r(f){f=f.replace(WK,"");let h=!1;e.forceInline?h=!0:e.forceBlock||(h=rq.test(f)===!1);const p=c(l(h?f:`${f.trimEnd().replace(gq,"")}

`,{inline:h}));for(;typeof p[p.length-1]=="string"&&!p[p.length-1].trim();)p.pop();if(e.wrapper===null)return p;const m=e.wrapper||(h?"span":"div");let E;if(p.length>1||e.forceWrapper)E=p;else{if(p.length===1)return E=p[0],typeof E=="string"?n("span",{key:"outer"},E):E;E=null}return S.createElement(m,{key:"outer"},E)}function i(f,h){const p=h.match(IK);return p?p.reduce(function(m,E,v){const g=E.indexOf("=");if(g!==-1){const y=function(R){return R.indexOf("-")!==-1&&R.match(XK)===null&&(R=R.replace(JK,function(I,D){return D.toUpperCase()})),R}(E.slice(0,g)).trim(),b=function(R){const I=R[0];return(I==='"'||I==="'")&&R.length>=2&&R[R.length-1]===I?R.slice(1,-1):R}(E.slice(g+1).trim()),T=xw[y]||y,A=m[T]=function(R,I,D,N){return I==="style"?D.split(/;\s?/).reduce(function(F,q){const G=q.slice(0,q.indexOf(":"));return F[G.trim().replace(/(-[a-z])/g,W=>W[1].toUpperCase())]=q.slice(G.length+1).trim(),F},{}):I==="href"||I==="src"?N(D,R,I):(D.match(KK)&&(D=D.slice(1,D.length-1)),D==="true"||D!=="false"&&D)}(f,y,b,e.sanitizer);typeof A=="string"&&(nm.test(A)||rm.test(A))&&(m[T]=S.cloneElement(r(A.trim()),{key:v}))}else E!=="style"&&(m[xw[E]||E]=!0);return m},{}):null}e.overrides=e.overrides||{},e.sanitizer=e.sanitizer||Cq,e.slugify=e.slugify||Ic,e.namedCodesToUnicode=e.namedCodesToUnicode?Si({},Sw,e.namedCodesToUnicode):Sw,e.createElement=e.createElement||S.createElement;const s=[],o={},a={[le.blockQuote]:{match:er(LP),order:1,parse:(f,h,p)=>({children:h(f[0].replace(DK,""),p)}),render:(f,h,p)=>n("blockquote",{key:p.key},h(f.children,p))},[le.breakLine]:{match:Zo(FK),order:1,parse:Jh,render:(f,h,p)=>n("br",{key:p.key})},[le.breakThematic]:{match:er(UK),order:1,parse:Jh,render:(f,h,p)=>n("hr",{key:p.key})},[le.codeBlock]:{match:er(kP),order:0,parse:f=>({lang:void 0,text:f[0].replace(/^ {4}/gm,"").replace(/\n+$/,"")}),render:(f,h,p)=>n("pre",{key:p.key},n("code",Si({},f.attrs,{className:f.lang?`lang-${f.lang}`:""}),f.text))},[le.codeFenced]:{match:er(MP),order:0,parse:f=>({attrs:i("code",f[3]||""),lang:f[2]||void 0,text:f[4],type:le.codeBlock})},[le.codeInline]:{match:Or(BK),order:3,parse:f=>({text:f[2]}),render:(f,h,p)=>n("code",{key:p.key},f.text)},[le.footnote]:{match:er(VK),order:0,parse:f=>(s.push({footnote:f[2],identifier:f[1]}),{}),render:ep},[le.footnoteReference]:{match:Ir($K),order:1,parse:f=>({target:`#${e.slugify(f[1],Ic)}`,text:f[1]}),render:(f,h,p)=>n("a",{key:p.key,href:e.sanitizer(f.target,"a","href")},n("sup",{key:p.key},f.text))},[le.gfmTask]:{match:Ir(HK),order:1,parse:f=>({completed:f[1].toLowerCase()==="x"}),render:(f,h,p)=>n("input",{checked:f.completed,key:p.key,readOnly:!0,type:"checkbox"})},[le.heading]:{match:er(e.enforceAtxHeadings?OP:IP),order:1,parse:(f,h,p)=>({children:ou(h,f[2],p),id:e.slugify(f[2],Ic),level:f[1].length}),render:(f,h,p)=>n(`h${f.level}`,{id:f.id,key:p.key},h(f.children,p))},[le.headingSetext]:{match:er(NP),order:0,parse:(f,h,p)=>({children:ou(h,f[1],p),level:f[2]==="="?1:2,type:le.heading})},[le.htmlBlock]:{match:Zo(nm),order:1,parse(f,h,p){const[,m]=f[3].match(mq),E=new RegExp(`^${m}`,"gm"),v=f[3].replace(E,""),g=(y=v,xq.some(I=>I.test(y))?Rq:ou);var y;const b=f[1].toLowerCase(),T=kK.indexOf(b)!==-1,A=(T?b:f[1]).trim(),R={attrs:i(A,f[2]),noInnerParse:T,tag:A};return p.inAnchor=p.inAnchor||b==="a",T?R.text=f[3]:R.children=g(h,v,p),p.inAnchor=!1,R},render:(f,h,p)=>n(f.tag,Si({key:p.key},f.attrs),f.text||(f.children?h(f.children,p):""))},[le.htmlSelfClosing]:{match:Zo(rm),order:1,parse(f){const h=f[1].trim();return{attrs:i(h,f[2]||""),tag:h}},render:(f,h,p)=>n(f.tag,Si({},f.attrs,{key:p.key}))},[le.htmlComment]:{match:Zo(DP),order:1,parse:()=>({}),render:ep},[le.image]:{match:Or(bq),order:1,parse:f=>({alt:f[1],target:Rw(f[2]),title:f[3]}),render:(f,h,p)=>n("img",{key:p.key,alt:f.alt||void 0,title:f.title||void 0,src:e.sanitizer(f.target,"img","src")})},[le.link]:{match:Ir(wq),order:3,parse:(f,h,p)=>({children:Pq(h,f[1],p),target:Rw(f[2]),title:f[3]}),render:(f,h,p)=>n("a",{key:p.key,href:e.sanitizer(f.target,"a","href"),title:f.title},h(f.children,p))},[le.linkAngleBraceStyleDetector]:{match:Ir(QK),order:0,parse:f=>({children:[{text:f[1],type:le.text}],target:f[1],type:le.link})},[le.linkBareUrlDetector]:{match:(f,h)=>h.inAnchor||e.disableAutoLink?null:Ir(qK)(f,h),order:0,parse:f=>({children:[{text:f[1],type:le.text}],target:f[1],title:void 0,type:le.link})},[le.linkMailtoDetector]:{match:Ir(ZK),order:0,parse(f){let h=f[1],p=f[1];return OK.test(p)||(p="mailto:"+p),{children:[{text:h.replace("mailto:",""),type:le.text}],target:p,type:le.link}}},[le.orderedList]:Aw(n,1),[le.unorderedList]:Aw(n,2),[le.newlineCoalescer]:{match:er(zK),order:3,parse:Jh,render:()=>`
`},[le.paragraph]:{match:Aq,order:3,parse:Qh,render:(f,h,p)=>n("p",{key:p.key},h(f.children,p))},[le.ref]:{match:Ir(eq),order:0,parse:f=>(o[f[1]]={target:f[2],title:f[4]},{}),render:ep},[le.refImage]:{match:Or(tq),order:0,parse:f=>({alt:f[1]||void 0,ref:f[2]}),render:(f,h,p)=>o[f.ref]?n("img",{key:p.key,alt:f.alt,src:e.sanitizer(o[f.ref].target,"img","src"),title:o[f.ref].title}):null},[le.refLink]:{match:Ir(nq),order:0,parse:(f,h,p)=>({children:h(f[1],p),fallbackChildren:f[0],ref:f[2]}),render:(f,h,p)=>o[f.ref]?n("a",{key:p.key,href:e.sanitizer(o[f.ref].target,"a","href"),title:o[f.ref].title},h(f.children,p)):n("span",{key:p.key},f.fallbackChildren)},[le.table]:{match:er(FP),order:1,parse:Tq,render(f,h,p){const m=f;return n("table",{key:p.key},n("thead",null,n("tr",null,m.header.map(function(E,v){return n("th",{key:v,style:Pw(m,v)},h(E,p))}))),n("tbody",null,m.cells.map(function(E,v){return n("tr",{key:v},E.map(function(g,y){return n("td",{key:y,style:Pw(m,y)},h(g,p))}))})))}},[le.text]:{match:Zo(pq),order:4,parse:f=>({text:f[0].replace(YK,(h,p)=>e.namedCodesToUnicode[p]?e.namedCodesToUnicode[p]:h)}),render:f=>f.text},[le.textBolded]:{match:Or(cq),order:2,parse:(f,h,p)=>({children:h(f[2],p)}),render:(f,h,p)=>n("strong",{key:p.key},h(f.children,p))},[le.textEmphasized]:{match:Or(uq),order:3,parse:(f,h,p)=>({children:h(f[2],p)}),render:(f,h,p)=>n("em",{key:p.key},h(f.children,p))},[le.textEscaped]:{match:Or(hq),order:1,parse:f=>({text:f[1],type:le.text})},[le.textMarked]:{match:Or(fq),order:3,parse:Qh,render:(f,h,p)=>n("mark",{key:p.key},h(f.children,p))},[le.textStrikethroughed]:{match:Or(dq),order:3,parse:Qh,render:(f,h,p)=>n("del",{key:p.key},h(f.children,p))}};e.disableParsingRawHTML===!0&&(delete a[le.htmlBlock],delete a[le.htmlSelfClosing]);const l=function(f){let h=Object.keys(f);function p(m,E){let v=[];for(E.prevCapture=E.prevCapture||"";m;){let g=0;for(;g<h.length;){const y=h[g],b=f[y],T=b.match(m,E);if(T){const A=T[0];E.prevCapture+=A,m=m.substring(A.length);const R=b.parse(T,p,E);R.type==null&&(R.type=y),v.push(R);break}g++}}return E.prevCapture="",v}return h.sort(function(m,E){let v=f[m].order,g=f[E].order;return v!==g?v-g:m<E?-1:1}),function(m,E){return p(function(v){return v.replace(jK,`
`).replace(GK,"").replace(iq,"    ")}(m),E)}}(a),c=(u=function(f,h){return function(p,m,E){const v=f[p.type].render;return h?h(()=>v(p,m,E),p,m,E):v(p,m,E)}}(a,e.renderRule),function f(h,p={}){if(Array.isArray(h)){const m=p.key,E=[];let v=!1;for(let g=0;g<h.length;g++){p.key=g;const y=f(h[g],p),b=typeof y=="string";b&&v?E[E.length-1]+=y:y!==null&&E.push(y),v=b}return p.key=m,E}return u(h,f,p)});var u;const d=r(t);return s.length?n("div",null,d,n("footer",{key:"footer"},s.map(function(f){return n("div",{id:e.slugify(f.identifier,Ic),key:f.identifier},f.identifier,c(l(f.footnote,{inline:!0})))}))):d}const kq=t=>{let{children:e="",options:n}=t,r=function(i,s){if(i==null)return{};var o,a,l={},c=Object.keys(i);for(a=0;a<c.length;a++)s.indexOf(o=c[a])>=0||(l[o]=i[o]);return l}(t,MK);return S.cloneElement(Mq(e,n),r)};function np({url:t}){const[e,n]=S.useState("");return S.useEffect(()=>{(async()=>{const s=await(await fetch(t)).text();n(s)})()},[t]),C.jsx("div",{children:C.jsx(LK,{children:C.jsx(kq,{children:e})})})}const Iq={border:"solid white 1px",display:"flex",flexDirection:"column",gap:"5px"};function Oq(){console.log(" You are on the correct page");const t=[{name:"Ruth Mostern",url:"https://www.history.pitt.edu/sites/default/files/person-images/May%202023%20Mostern%20headshot%20cropped%20%281%29.jpeg",description:"Project Manager"},{name:"Nathan Michalewicz",url:"https://www.worldhistory.pitt.edu/sites/default/files/nkm.jpg",description:""},{name:"Ryan Horne",url:"/ryanhorne.jpg",description:""},{name:"Sharon Zhang",url:"https://www.history.pitt.edu/sites/default/files/person-images/Zhang.jpg",description:""}];return C.jsx(C.Fragment,{children:C.jsxs("div",{style:{height:"100vh",width:"100vw",display:"flex",flexDirection:"column",gap:"2em"},children:[C.jsx(gv,{}),C.jsx("div",{style:{maxWidth:"950px",display:"flex",flexWrap:"wrap",gap:"1em",alignContent:"center",justifyContent:"center"},children:t.map((e,n)=>C.jsxs("div",{style:Iq,children:[C.jsx("img",{src:e.url,width:325}),C.jsx("p",{style:{textAlign:"center"},children:e.name})," "]},n))})]})})}function Nq(){return C.jsxs("div",{style:{height:"100vh",width:"100vw",display:"flex",flexDirection:"column",alignContent:"center",alignItems:"center",fontSize:"3em",textAlign:"center",margin:"2em 0"},children:[C.jsx("h1",{children:"404"}),C.jsx("p",{children:"Oh, snap. We cannot find that page."})]})}function Dq(){return C.jsxs(HH,{children:[C.jsx(Ei,{path:"/",element:C.jsx(RK,{})}),C.jsx(Ei,{path:"/db-history",element:C.jsx(np,{url:"https://raw.githubusercontent.com/YellowRiverDatabase/Documentation/refs/heads/main/database-history.md"})}),C.jsx(Ei,{path:"/db-description",element:C.jsx(np,{url:"https://raw.githubusercontent.com/YellowRiverDatabase/Documentation/refs/heads/main/table-descriptions.md"})}),C.jsx(Ei,{path:"/how-to-build",element:C.jsx(np,{url:"https://raw.githubusercontent.com/YellowRiverDatabase/Documentation/refs/heads/main/how-to-build.md"})}),C.jsx(Ei,{path:"/about-us",element:C.jsx(Oq,{})}),C.jsx(Ei,{path:"*",element:C.jsx(Nq,{})})]})}function Fq(){return lH(),C.jsx(Dq,{})}rp.createRoot(document.getElementById("root")).render(C.jsx(ve.StrictMode,{children:C.jsx(yD,{children:C.jsx(oK,{children:C.jsx(Fq,{})})})}));export{Uq as c,po as g};
